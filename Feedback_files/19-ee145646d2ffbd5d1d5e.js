(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{"+H8J":function(e,t,n){"use strict";n.r(t)},"09zc":function(e,t,n){"use strict";n.r(t)},"6yDj":function(e,t,n){"use strict";n.r(t)},"8UYM":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SearchInput=void 0;const s=n("D57K"),a=s.__importStar(n("ERkP")),o=s.__importStar(n("nsO7")),i=n("np6O"),r=n("0x+l"),l=n("FS8K"),c=n("myse");n("+H8J");class u extends a.PureComponent{constructor(e){super(e),this.debouncedSearch=o.debounce((()=>{const{courseId:e,notifyStateChange:t,searchAnnouncements:n}=this.props;this.setState({shouldNotify:!0}),this.state.isValidSearch&&n(e,{searchText:encodeURIComponent(this.state.text.trim())})}),this.props.debounceTime),this.focusElement=e=>{e.focus()},this.shouldStartSearching=e=>!e.trim().length||e.trim().length>=this.props.minCharToStartSearching,this.showCharacterInsufficient=e=>!!e.trim()&&e.trim().length<this.props.minCharToStartSearching,this.handleSearchTextChange=e=>{const t=e.target.value;this.setState({text:t,isValidSearch:this.shouldStartSearching(t),shouldNotify:!1}),this.debouncedSearch()},this.handleEnterToSearch=e=>{const{searchAnnouncements:t,courseId:n,notifyStateChange:s}=this.props;"Enter"===e.key&&(this.setState((e=>({isValidSearch:e.text.trim().length>0}))),this.state.isValidSearch&&(s(this.state.text,this.state.isCollapsed,this.state.isValidSearch),t(n,{searchText:encodeURIComponent(this.state.text.trim())})))},this.closeSearchInput=()=>{this.setState({text:"",isCollapsed:!0,isValidSearch:!1})},this.state={text:"",isCollapsed:!1,isValidSearch:!1,shouldNotify:!0}}UNSAFE_componentWillReceiveProps(e){e.isCollapsed&&!e.searchText.trim().length&&this.debouncedSearch.cancel(),this.setState({text:e.searchText,isCollapsed:e.isCollapsed})}componentDidUpdate(e,t){const{isCollapsed:n,notifyStateChange:s}=this.props;!0===e.isCollapsed&&n!==e.isCollapsed&&this.focusElement(this.searchInput),this.showCharacterInsufficient(this.state.text)?this.searchInput.addEventListener("keyup",this.handleEnterToSearch):this.searchInput.removeEventListener("keyup",this.handleEnterToSearch),this.state.shouldNotify&&s(this.state.text,this.state.isCollapsed,this.state.isValidSearch)}render(){const{t:e,analyticsId:t,analyticsEventAugmentor:n}=this.props,s=n(c.AnalyticsEventTypes.CLICK_EVENT,(()=>{}),t);return a.createElement("div",{className:"search-input-wrap","data-analytics-id":t},a.createElement(r.Search,{className:"search-icon"}),a.createElement("label",{className:"sr-only",htmlFor:"search-input"},this.props.placeHolder),a.createElement("input",{className:"left",id:"search-input",onChange:this.handleSearchTextChange,placeholder:this.props.placeHolder,ref:e=>{this.searchInput=e},type:"text",value:this.state.text,onClick:s}),a.createElement(i.AnalyticsIconButton,{"aria-label":e("course.announcements.button.closeSearch"),className:"search-controls button super-clear",onClick:this.closeSearchInput,title:e("course.announcements.button.closeSearch"),analyticsId:"course.announcements.listPanel.closeSearch.button"},a.createElement(r.Clear,null)))}}t.SearchInput=u,t.default=(0,c.withAnalytics)((0,l.withTranslate)(u))},AfBz:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BaseAnnouncementListItem=void 0;const s=n("D57K"),a=s.__importStar(n("ERkP")),o=s.__importDefault(n("wgY5")),i=n("FS8K"),r=n("MC1S"),l=n("WBPx"),c=n("caKH"),u=s.__importDefault(n("RK7K")),d=n("vSnM");n("cwrT");const m=n("myse"),h=n("Pam5"),p=n("0x+l");class E extends a.Component{constructor(e){super(e),this.timerHandler=null,this.onClickActionMenu=e=>{this.setState({target:e.currentTarget})},this.onOpenDeleteConfirmDialog=()=>{this.setState({hideDialog:!1})},this.onCloseDeleteConfirmDialog=()=>{this.setState({hideDialog:!0})},this.onOpenAnnouncement=()=>{const{courseId:e,announcement:t,permissions:n}=this.props;this.props.openAnnouncementDetailPanel(e,t.id,n)},this.onPostAnnouncement=()=>{this.setState({disablePostButton:!0});const{saveAnnouncement:e,courseId:t,announcement:n}=this.props;e(t,{...n,isDraft:!1,startDateRestriction:(0,o.default)().toDate(),endDateRestriction:null}).catch((()=>this.setState({disablePostButton:!1})))},this.onEditAnnouncement=()=>{this.setState({disablePostButton:!1});const{courseId:e,announcement:t,permissions:n}=this.props;this.props.openAnnouncementDetailPanel(e,t.id,n,u.default.EDIT)},this.onDuplicateAnnouncement=()=>{const{courseId:e,announcement:t,permissions:n}=this.props;this.props.openAnnouncementDetailPanel(e,t.id,n,u.default.DUPLICATE)},this.onDeleteAnnouncement=()=>{const{removeAnnouncement:e,announcement:t,loadAnnouncements:n,courseId:s}=this.props;e(t.courseId,t.id).then((()=>{this.onCloseDeleteConfirmDialog(),n(s,{})}))},this.isPostedAnnouncement=e=>!(e.isDraft||e.startDateRestriction&&(0,o.default)(e.startDateRestriction).isAfter((0,o.default)())),this.getActionOptions=()=>{const{permissions:e,analyticsId:t,analyticsEventAugmentor:n,localize:s}=this.props,o={items:[]},i=n(m.AnalyticsEventTypes.CLICK_EVENT,this.onEditAnnouncement,t+".listItem.edit.button"),r=n(m.AnalyticsEventTypes.CLICK_EVENT,this.onDuplicateAnnouncement,t+".listItem.duplicate.button"),l=n(m.AnalyticsEventTypes.CLICK_EVENT,this.onOpenDeleteConfirmDialog,t+".listItem.delete.button");return e&&e.modify&&o.items.push({key:u.default.EDIT,name:s.translate("course.announcements.button.edit"),icon:a.createElement(p.Edit,null),onClick:i}),e&&e.create&&o.items.push({key:u.default.DUPLICATE,name:s.translate("course.announcements.button.duplicate"),icon:a.createElement(p.Duplicate,null),onClick:r}),e&&e.delete&&o.items.push({key:u.default.DELETE,name:s.translate("course.announcements.button.delete"),icon:a.createElement(p.Trash,null),onClick:l}),o},this.renderItemStatus=()=>{const{announcement:e,localize:t,permissions:n,analyticsId:s,isCourseAvailable:o,isCompact:i}=this.props;let r=`course.announcements.status.${this.isPostedAnnouncement(e)?"posted":"inSchedule"}.${i?"uppercase":"capitalize"}`;return e.isDraft&&(r="course.announcements.status.draft"),a.createElement("div",{className:"item-status-info"},e.isDraft&&n.modify?a.createElement(l.AnalyticsDefaultButton,{"data-automation-id":"test",onClick:this.onPostAnnouncement,disabled:!n.viewUnposted||!o||this.state.disablePostButton,analyticsId:`${s}.listItem.postNow`},t.translate("course.announcements.button.postNow")):a.createElement("div",null,a.createElement("span",{className:"list-item-status"},n.viewUnposted&&t.translate(r)),a.createElement("span",{className:"list-item-date-sent"},e.startDateRestriction&&!e.isDraft&&(0,d.displayDateTime)(e.startDateRestriction.toISOString(),t))))},this.registerTimeoutEvent=()=>{const{debounceTime:e,onExpire:t,announcement:n}=this.props;this.timerHandler=setTimeout((()=>{t(n.id)}),e)},this.renderDialog=()=>{const{localize:e,analyticsId:t}=this.props;return a.createElement(c.UltraModalDialog,{onDismiss:()=>{this.setState({hideDialog:!0})},showAsCallout:!this.state.hideDialog,target:this.state.target,dialogContentProps:{type:r.DialogType.actionConfirmation,title:e.translate("course.announcements.dialogText.deleteAnnouncement"),subText:e.translate("course.announcements.dialogText.confirmDeleteAnnouncement"),showCloseButton:!1},analyticsId:t+".listItem.deleteDialog"},a.createElement(r.DialogFooter,null,a.createElement(l.AnalyticsDefaultButton,{onClick:this.onCloseDeleteConfirmDialog,analyticsId:t+".listItem.deleteDialog.cancel.button"},e.translate("course.announcements.button.cancel")),a.createElement(l.AnalyticsPrimaryButton,{onClick:this.onDeleteAnnouncement,className:"deleteConfirmBtn",analyticsId:t+".listItem.deleteDialog.confirm.button"},e.translate("course.announcements.button.delete"))))},this.state={hideDialog:!0,target:null,disablePostButton:!1}}componentDidMount(){this.props.isNewlyCreated&&this.registerTimeoutEvent()}componentDidUpdate(e){!e.isNewlyCreated&&this.props.isNewlyCreated&&this.registerTimeoutEvent()}componentWillUnmount(){this.timerHandler&&clearTimeout(this.timerHandler)}render(){const{announcement:e,localize:t,permissions:n,isNewlyCreated:s,analyticsId:o,analyticsEventAugmentor:i,isCompact:l}=this.props,c=this.getActionOptions(),u=i(m.AnalyticsEventTypes.CLICK_EVENT,this.onOpenAnnouncement,o+".listItem.open.link");return a.createElement("tr",{className:"announcement-item-row "+(s?"is-new":""),role:"row"},a.createElement("td",{className:"announcement-header-column "+(n.viewUnposted?"small-1-2":"large-1"),role:"gridcell"},a.createElement("div",{className:"announcement-header"},a.createElement("div",{className:"small-1-1 announcement-icon"+(e.isDraft?" is-restricted":"")},a.createElement("div",{className:"element-image"},a.createElement(h.Announcement,{color:"primary"}))),a.createElement("div",{className:"click-message-detail"},a.createElement("div",{className:"announcement-title-detail"},a.createElement("a",{className:`list-item-title ${n.viewUnposted?"entitled":""} `,href:"#","data-analytics-id":`${o}.listItem.open.link`,onClick:u},(0,d.decodeHtmlEntities)(e.title)),e.isDraft&&a.createElement("span",{className:"draft-status one-line"},t.translate("course.announcements.status.draft"))),a.createElement("a",{className:"list-item-body "+(n.viewUnposted?"one-line":"three-lines multiple-line-ellipsis"),href:"#",onClick:this.onOpenAnnouncement},e.body&&(0,d.decodeHtmlBodyText)(e.body.rawText,this.props.localize))),l&&this.renderItemStatus())),!l&&a.createElement("td",{className:"announcement-status-column",role:"gridcell"}," ",this.renderItemStatus()," "),n.viewUnposted&&a.createElement("td",{className:"announcement-viewers-column",role:"gridcell"},a.createElement("div",{className:"announcement-viewers",onClick:this.onClickActionMenu},a.createElement("span",{className:"list-item-view-count"},e.readCount||0," / ",e.totalParticipants),c&&c.items&&c.items.length>0&&a.createElement(r.ActionMenu,{ariaLabel:`${t.translate("course.announcements.moreOptions",{announcementTitle:e.title})}`,className:"announcement-item-action-menu",disabled:!this.state.hideDialog,menuProps:c,maintainExpandedProperties:!this.state.hideDialog,analyticsId:o+".listItem.actionMenu"}),this.renderDialog())))}}t.BaseAnnouncementListItem=E,t.default=(0,m.withAnalytics)((0,i.withLocalize)(E))},CAxA:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SortControl=t.ICON_CHEVRON_DOWN=t.ICON_CHEVRON_UP=void 0;const s=n("D57K").__importStar(n("ERkP")),a=n("FS8K"),o=n("zGdY"),i=n("myse");n("idFC"),t.ICON_CHEVRON_UP="arrow-up",t.ICON_CHEVRON_DOWN="arrow-down";class r extends s.PureComponent{constructor(){super(...arguments),this.getArrowDirection=()=>{const{currentSort:e,sortField:n}=this.props;return n&&(null==e?void 0:e.field)===n?(this.localSort=e,this.isDescendingSort(e)?t.ICON_CHEVRON_DOWN:t.ICON_CHEVRON_UP):""},this.updateSortCriteria=()=>{const{sortField:e,onSwitchSortCriteria:t}=this.props;this.localSort?this.localSort={field:e,direction:this.localSort.direction===o.SortDirection.Ascending?o.SortDirection.Descending:o.SortDirection.Ascending}:this.localSort={field:e,direction:o.SortDirection.Ascending},t(this.localSort)},this.isDescendingSort=e=>e.direction===o.SortDirection.Descending}render(){const{t:e,viewText:t,analyticsId:n,analyticsEventAugmentor:a}=this.props,o=a(i.AnalyticsEventTypes.CLICK_EVENT,this.updateSortCriteria,n);return s.createElement(s.Fragment,null,s.createElement("button",{id:`sort-by-${t}-button`,className:"active clear",onClick:o,"data-analytics-id":n},s.createElement("span",{className:"sort-description"},e(`course.announcements.sort.${t}.description`)),s.createElement("div",{className:"sort-list-arrows "+this.getArrowDirection(),role:"presentation"},s.createElement("div",{className:"sort-list-arrow-up"}),s.createElement("div",{className:"sort-list-arrow-down"}))))}}t.SortControl=r,t.default=(0,i.withAnalytics)((0,a.withTranslate)(r))},Hhhn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DatePicker=t.getDatePickerDefaultStrings=void 0;const s=n("D57K").__importStar(n("ERkP")),a=n("MC1S"),o=n("np6O"),i=n("0x+l"),r=n("n7/H"),l=n("FS8K"),c=n("myse");n("6yDj");t.getDatePickerDefaultStrings=e=>({months:[e("course.announcements.datePicker.months.january"),e("course.announcements.datePicker.months.february"),e("course.announcements.datePicker.months.march"),e("course.announcements.datePicker.months.april"),e("course.announcements.datePicker.months.may"),e("course.announcements.datePicker.months.june"),e("course.announcements.datePicker.months.july"),e("course.announcements.datePicker.months.august"),e("course.announcements.datePicker.months.september"),e("course.announcements.datePicker.months.october"),e("course.announcements.datePicker.months.november"),e("course.announcements.datePicker.months.december")],shortMonths:[e("course.announcements.datePicker.shortMonths.january"),e("course.announcements.datePicker.shortMonths.february"),e("course.announcements.datePicker.shortMonths.march"),e("course.announcements.datePicker.shortMonths.april"),e("course.announcements.datePicker.shortMonths.may"),e("course.announcements.datePicker.shortMonths.june"),e("course.announcements.datePicker.shortMonths.july"),e("course.announcements.datePicker.shortMonths.august"),e("course.announcements.datePicker.shortMonths.september"),e("course.announcements.datePicker.shortMonths.october"),e("course.announcements.datePicker.shortMonths.november"),e("course.announcements.datePicker.shortMonths.december")],days:[e("course.announcements.datePicker.days.sunday"),e("course.announcements.datePicker.days.monday"),e("course.announcements.datePicker.days.tuesday"),e("course.announcements.datePicker.days.wednesday"),e("course.announcements.datePicker.days.thursday"),e("course.announcements.datePicker.days.friday"),e("course.announcements.datePicker.days.saturday")],shortDays:[e("course.announcements.datePicker.shortDays.sunday"),e("course.announcements.datePicker.shortDays.monday"),e("course.announcements.datePicker.shortDays.tuesday"),e("course.announcements.datePicker.shortDays.wednesday"),e("course.announcements.datePicker.shortDays.thursday"),e("course.announcements.datePicker.shortDays.friday"),e("course.announcements.datePicker.shortDays.saturday")],goToToday:e("course.announcements.datePicker.goToToday"),prevMonthAriaLabel:e("course.announcements.datePicker.prevMonthAriaLabel"),nextMonthAriaLabel:e("course.announcements.datePicker.nextMonthAriaLabel"),prevYearAriaLabel:e("course.announcements.datePicker.prevYearAriaLabel"),nextYearAriaLabel:e("course.announcements.datePicker.nextYearAriaLabel")});class u extends s.PureComponent{constructor(e){super(e),this.timeoutPromiseWrapper=(e,t,n)=>new Promise((s=>{e.apply(this,t),setTimeout((()=>{const a=e.apply(n,t);s(a)}))})),this.errorMessage=()=>{const{isValueValid:e,errorEmptyMessage:t,errorFormatMessage:n}=this.props;if(!e){let e=n;return this.state.uiDateStr||(e=t),s.createElement("span",{className:"error-message"},s.createElement(i.Attention,null),e)}return null},this.toggleCalendar=()=>{this.setState((e=>({isDisplayCalendar:!e.isDisplayCalendar})),(()=>{this.state.isDisplayCalendar&&setTimeout((()=>{this.calRef.focus()}),100)}))},this.onSelectDate=e=>{const{localize:t,onChangeValue:n}=this.props;this.timeoutPromiseWrapper(t.formatDate,[e,r.ILocaleDateFormat.Short],t).then((t=>{n(e),this.setState({uiDateStr:t}),this.toggleCalendar()}))},this.onTypeDate=e=>{this.setState({uiDateStr:e.target.value})},this.onHandleBlur=()=>{const{uiDateStr:e}=this.state,{onChangeValue:t,localize:n}=this.props;setTimeout((()=>{this.datePickerRef.contains(document.activeElement)||this.setState({isDisplayCalendar:!1})})),this.timeoutPromiseWrapper(n.parseDate,[e,r.ILocaleDateFormat.Short],n).then((e=>{e&&t(e)}))},this.state={isDisplayCalendar:!1,uiDateStr:""}}componentDidMount(){const{value:e,onChangeValue:t,localize:n}=this.props;e&&this.timeoutPromiseWrapper(n.formatDate,[e,r.ILocaleDateFormat.Short],n).then((n=>{t(e),this.setState({uiDateStr:n})}))}componentDidUpdate(e,t){const{uiDateStr:n}=this.state,{value:s,onValidateCallback:a,disabled:o,localize:i}=this.props;s&&s!==e.value&&this.timeoutPromiseWrapper(i.formatDate,[s,r.ILocaleDateFormat.Short],i).then((e=>{this.setState({uiDateStr:e}),a(!0)})),s||s===e.value||(this.setState({uiDateStr:""}),a(!0)),this.state.uiDateStr===t.uiDateStr||o||this.timeoutPromiseWrapper(i.parseDate,[n,r.ILocaleDateFormat.Short],i).then((e=>{a(!!e)}))}render(){const{isDisplayCalendar:e,uiDateStr:n}=this.state,{value:r,disabled:l,localize:{translate:u},analyticsId:d,analyticsEventAugmentor:m}=this.props,h=m(c.AnalyticsEventTypes.CLICK_EVENT,(()=>{}),d+".input.text");return s.createElement("div",{ref:e=>this.datePickerRef=e,className:"date-picker"},s.createElement("div",{className:"calendar-input-container","data-analytics-id":`${d}.input.text`},s.createElement("input",{className:"date-input",ref:e=>this.dateInputRef=e,type:"text",value:n,onChange:this.onTypeDate,disabled:l,onClick:h,onBlur:this.onHandleBlur}),s.createElement(o.AnalyticsIconButton,{"aria-label":u("course.announcements.datePicker.dueDate"),className:"btn-date open-datepicker",disabled:l,onClick:this.toggleCalendar,title:u("course.announcements.datePicker.dueDate"),analyticsId:d+".open.button"},s.createElement(i.Calendar,null)),this.errorMessage()),e&&s.createElement(a.Callout,{target:this.dateInputRef,doNotLayer:!0,directionalHint:5,isBeakVisible:!1,gapSpace:0,setInitialFocus:!1},s.createElement(a.Calendar,{componentRef:e=>this.calRef=e,className:"date-picker-dropdown",value:r,strings:(0,t.getDatePickerDefaultStrings)(u),isMonthPickerVisible:!1,showGoToToday:!1,onSelectDate:this.onSelectDate,analyticsId:d+".calendar"})))}}t.DatePicker=u,t.default=(0,c.withAnalytics)((0,l.withLocalize)(u))},IVgG:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnouncementListPanel=t.ANNOUNCEMENT_LIMIT=void 0;const s=n("D57K"),a=s.__importStar(n("ERkP")),o=n("uDfI"),i=s.__importDefault(n("7O4Y")),r=n("np6O"),l=n("FS8K"),c=s.__importDefault(n("AfBz")),u=n("AuQm"),d=s.__importDefault(n("8UYM")),m=s.__importDefault(n("CAxA")),h=s.__importDefault(n("RK7K")),p=s.__importDefault(n("xG9T")),E=n("50Q+"),g=n("Y+9S"),C=n("E1pj"),S=n("0x+l"),f=n("8jBL");n("RDrG");const D=n("zGdY"),b=n("IbyE"),A=n("9OUN"),y=n("zGdY");t.ANNOUNCEMENT_LIMIT=10;class T extends a.PureComponent{constructor(){super(...arguments),this.renderAnnouncementItem=e=>{const{courseId:t,courseContext:n,openAnnouncementDetailPanel:s,permissions:o,removeAnnouncement:i,saveAnnouncement:r,recentUpdatedAnnouncementIds:l,removeFromRecentUpdated:u,UltraWindowSize:d}=this.props,m=Object.values(this.props.announcements)[e];return a.createElement(c.default,{announcement:m,courseId:t,debounceTime:2e3,isCompact:null==d?void 0:d.isSmallBreakpoint(),isCourseAvailable:n.isAvailable,isNewlyCreated:l&&l.indexOf(m.id)>-1,key:m.id,onExpire:u,openAnnouncementDetailPanel:s,permissions:o,removeAnnouncement:i,saveAnnouncement:r,loadAnnouncements:this.loadAnnByCurrentSettings,analyticsId:"course.announcements.listPanel"})},this.loadMore=()=>{const{announcements:e,paging:t,loadAnnouncements:n,courseId:s,searchInputState:a,sortCriteria:o}=this.props,i=a.searchText;n(s,{paging:{offset:Object.keys(e).length,limit:t.limit},searchText:i,sort:o},!0)},this.searchInputStateChange=(e,t,n)=>{const{searchInputState:s,changeSearchInputState:a}=this.props;t&&t!==s.isCollapsed?this.onToggleSearchInput():e===s.searchText&&t===s.isCollapsed&&n===s.isValidSearch||a({searchText:e,isCollapsed:t,isValidSearch:n})},this.onToggleSearchInput=()=>{const{courseId:e,searchInputState:t,changeSearchInputState:n}=this.props,s=!t.isCollapsed,a=s?"":t.searchText;n({searchText:a,isCollapsed:s}),s&&t.searchText.trim().length>0&&this.loadAnnByCurrentSettings(e,{searchText:a})},this.onSwitchSortCriteria=e=>{const{courseId:t,switchSortCriteria:n}=this.props;n([e]),this.loadAnnByCurrentSettings(t,{sort:[e]})},this.sortAriaValueForAnnouncement=e=>{const t=e[0];return(null==t?void 0:t.field)===y.LearnCourseAnnouncementSortField.Title?t.direction===D.SortDirection.Ascending?p.default.Ascending:p.default.Descending:p.default.None},this.sortAriaValueByStatus=e=>{const t=e[0];return(null==t?void 0:t.field)===y.LearnCourseAnnouncementSortField.Status?t.direction===D.SortDirection.Ascending?p.default.Ascending:p.default.Descending:p.default.None},this.sortAriaValueByViewers=e=>{const t=e[0];return(null==t?void 0:t.field)===y.LearnCourseAnnouncementSortField.ReadCount?t.direction===D.SortDirection.Ascending?p.default.Ascending:p.default.Descending:p.default.None},this.onCreateAnnouncement=()=>{this.props.openAnnouncementDetailPanel(this.props.courseId,null,this.props.permissions,h.default.CREATE)},this.loadAnnByCurrentSettings=(e,n)=>{const{announcements:s,searchInputState:a,loadAnnouncements:o,sortCriteria:i}=this.props,r=n||{},l=null!=r.searchText?r.searchText:!a.isCollapsed&&a.searchText.trim()||"",c=r.sort||i,u=s&&Object.keys(s).length||0;o(e,{searchText:l,paging:{limit:r.limit||Math.max(u,t.ANNOUNCEMENT_LIMIT),offset:r.offset||0},sort:c})},this.renderNoResultString=e=>{const{searchInputState:t,t:n,isLoading:s,paging:o,isSearchingSuccessful:i,courseContext:r}=this.props;return t.searchText?e?a.createElement("p",{className:"search-insufficient","aria-live":"assertive"},n("course.announcements.characterInsufficient")):i&&a.createElement("p",{className:"search-no-results ng-scope","aria-live":"assertive"},n("course.announcements.noSearchResult")):!s&&0===(null==o?void 0:o.count)&&t.isCollapsed&&a.createElement("p",{className:"search-no-results ng-scope"},n((0,E.resolveCourseOrgToken)("announcements.noResult",null==r?void 0:r.isOrganization)))},this.getMessageAnnouncementInCourse=()=>{const{t:e,announcementsCounts:t,announcements:n}=this.props;return e("course.announcements.totalAnnouncementInCourse",{filterCount:Object.values(n).length,announcementCount:t.draftCount+t.postedCount+t.scheduledCount})},this.renderAnnouncementListView=e=>{const{t,searchInputState:n,sortCriteria:s,isSearchingSuccessful:o,permissions:r,courseContext:l,UltraWindowSize:c}=this.props,u=n.searchText.trim(),d=!n.isCollapsed&&u.length&&u.length<2&&!n.isValidSearch;return e>0&&!d?a.createElement("div",{className:(0,i.default)("tabular-list-container",{"-with-seach-bar":!n.isCollapsed})},a.createElement("div",{className:"tabular-list"},a.createElement("table",{className:"table-content sortable-table",role:"grid","aria-readonly":!0,"aria-labelledby":"announcement-table-caption"},a.createElement("caption",{id:"announcement-table-caption",className:"sr-only"},t((0,E.resolveCourseOrgToken)("announcements.pageTitle",null==l?void 0:l.isOrganization))),a.createElement("thead",{className:"list-item-columns announcement-sort-header"},a.createElement("tr",{className:"list-item-row announcement-sort-row",role:"row"},a.createElement("th",{className:"column-title sort",role:"columnheader",id:"title","aria-sort":this.sortAriaValueForAnnouncement(s)},a.createElement(m.default,{courseId:this.props.courseId,currentSort:s[0],onSwitchSortCriteria:this.onSwitchSortCriteria,sortField:y.LearnCourseAnnouncementSortField.Title,viewText:"title",analyticsId:"course.announcements.listPanel.sortByTitle.button"})),!c.isSmallBreakpoint()&&a.createElement("th",{className:`column-${r.viewUnposted?"status":"date"} sort`,role:"columnheader",id:r.viewUnposted?"status":"date","aria-sort":this.sortAriaValueByStatus(s)},a.createElement(m.default,{courseId:this.props.courseId,currentSort:s[0],onSwitchSortCriteria:this.onSwitchSortCriteria,sortField:r.viewUnposted?y.LearnCourseAnnouncementSortField.Status:y.LearnCourseAnnouncementSortField.StartDateRestriction,viewText:t(r.viewUnposted?"status":"date"),analyticsId:"course.announcements.listPanel.sortByDate.button"})),r.viewUnposted&&a.createElement("th",{className:"column-viewers sort",role:"columnheader",id:"viewers","aria-sort":this.sortAriaValueByViewers(s)},a.createElement(m.default,{courseId:this.props.courseId,currentSort:s[0],onSwitchSortCriteria:this.onSwitchSortCriteria,sortField:y.LearnCourseAnnouncementSortField.ReadCount,viewText:"viewers",analyticsId:"course.announcements.listPanel.sortByViews.button"})))),a.createElement("tbody",null,Object.values(this.props.announcements).map(((e,t)=>a.createElement(a.Fragment,null,this.renderAnnouncementItem(t))))),n.isValidSearch&&o&&a.createElement("div",{"aria-live":"polite","aria-hidden":!1,className:"sr-only",role:"status"},t("course.announcements.searchResults"))),this.renderScroll()),a.createElement("span",{role:"status",className:"sr-only"},this.getMessageAnnouncementInCourse())):a.createElement("div",{className:"columns small-12 no-result-section"},a.createElement("div",{className:"row"},a.createElement("div",{className:"columns small-12 small-centered text-center ftue-container"},this.renderNoResultString(d))))}}componentDidMount(){const{courseId:e,courseContext:t,getAnnouncementsCounts:n,getCourseContext:s,permissions:a,switchSortCriteria:o}=this.props;if((0,g.isInMobileApp)()){const e={type:g.MessageType.AnnouncementListOpened,status:g.MessageStatus.Success,permission:{search:!0}},t=(0,g.registerMobileEventHandler)(e);t.response.subscribe((e=>{e.event===g.EventType.Search&&this.onToggleSearchInput()})),this.correlationId=t.correlationId}const i=a.viewUnposted?[{field:y.LearnCourseAnnouncementSortField.ModifiedDate,direction:D.SortDirection.Descending}]:[{field:y.LearnCourseAnnouncementSortField.StartDateRestriction,direction:D.SortDirection.Descending}];o(i),this.loadAnnByCurrentSettings(e,{sort:i}),n(e),t&&t.courseId===e||s(e)}componentDidUpdate(e){this.props.listener.refreshAnnouncementsCounts&&!e.listener.refreshAnnouncementsCounts&&this.props.getAnnouncementsCounts(this.props.courseId),this.props.listener.resetSortSetting&&!e.listener.resetSortSetting&&this.props.switchSortCriteria([{field:y.LearnCourseAnnouncementSortField.ModifiedDate,direction:D.SortDirection.Descending}]),this.props.listener.resetSearchSetting&&!e.listener.resetSearchSetting&&this.props.changeSearchInputState({searchText:"",isCollapsed:!0}),this.props.listener.refreshAnnouncements&&!e.listener.refreshAnnouncements&&this.props.loadAnnouncements(this.props.courseId,{searchText:this.props.searchInputState.searchText})}componentWillUnmount(){const{root:e,clearAnnouncements:t}=this.props;(0,g.isInMobileApp)()&&(0,g.clearMobileEventHandler)(this.correlationId),t()}renderScroll(){const{paging:e,isLoading:t}=this.props,n=!t&&(null==e?void 0:e.count)>Object.keys(this.props.announcements).length;return n&&a.createElement(u.UseIScrollComponent,{loader:this.loadMore,hasMore:n})}render(){const{announcements:e,paging:t,permissions:n,searchInputState:s,courseId:o,courseContext:i,t:l,announcementsCounts:c,UltraWindowSize:u}=this.props,m=e&&Object.keys(e).length||0,h=(null==u?void 0:u.isMediumBreakpoint())||(null==u?void 0:u.isSmallBreakpoint());return a.createElement("div",{className:"page-announcement course-announcement-layer"},a.createElement("div",{className:"panel-wrap"},a.createElement("header",{className:"panel-header simple-header"},a.createElement("div",{className:"panel-titles-container"},a.createElement("span",{className:"panel-sub-title"},i&&i.displayName||""),a.createElement("div",{className:"editable-title-container black-header-contents"},a.createElement(r.AnalyticsIconButton,{"aria-label":l("base.menu"),className:"left-off-canvas-toggle menu-toggle  standard-button dark-background",title:l("base.menu"),analyticsId:"course.announcements.listPanel.menu.button"},a.createElement(S.MainMenu,null)),a.createElement("h1",{className:"panel-title"},l((0,E.resolveCourseOrgToken)("announcements.pageTitle",null==i?void 0:i.isOrganization))))),a.createElement("div",{className:"header-actions-menu__item active no-select"},a.createElement("div",{className:"active no-select"},a.createElement(r.AnalyticsIconButton,{"aria-label":l("course.announcements.search.placeHolder"),className:"anchor-button",id:"search-button",onClick:this.onToggleSearchInput,title:l("course.announcements.search.placeHolder"),analyticsId:"course.announcements.listPanel.search.button"},h?a.createElement(S.Search,null):a.createElement(f.Search,null))))),a.createElement("div",{className:"guidance-wrapper "+(s.isCollapsed?"":"hide")},c&&(null==t?void 0:t.count)>=0&&a.createElement("span",null,n.viewUnposted?l("course.announcements.guidance.instructor",{postedCount:c.postedCount||0,scheduledCount:c.scheduledCount||0})+l("course.announcements.guidance.draftCount.plural",{draftCount:c.draftCount||0}):l("course.announcements.guidance.student",{totalCount:(null==t?void 0:t.count)||0})),n.create&&a.createElement(r.AnalyticsIconButton,{"aria-label":l("course.announcements.createAnnouncement"),className:"create-announcement",onClick:this.onCreateAnnouncement,title:l("course.announcements.createAnnouncement"),analyticsId:"course.announcements.listPanel.create.button"},h?a.createElement(S.Add,null):a.createElement(f.AddCircle,null))),a.createElement("div",{className:"panel-content"},a.createElement("div",{className:"row collapse "+(s.isCollapsed?"hide":""),id:"announcement-search"},a.createElement(d.default,{courseId:o,debounceTime:1500,isCollapsed:s.isCollapsed,minCharToStartSearching:2,notifyStateChange:this.searchInputStateChange,placeHolder:l("course.announcements.search.placeHolder"),searchAnnouncements:this.loadAnnByCurrentSettings,searchText:s.searchText,analyticsId:"course.announcements.listPanel.search.input.text"})),a.createElement("div",{className:"row collapse"},this.renderAnnouncementListView(m),this.props.isLoading?a.createElement("div",{className:"spinner bb-secondary-color-2"}):""))))}}t.AnnouncementListPanel=T,t.default=(0,o.connect)((e=>({announcements:e.announcement.announcements,isLoading:e.announcement.isLoading,isSearchingSuccessful:e.announcement.isSearchingSuccessful,searchInputState:e.announcement.searchInputState,paging:e.announcement.paging,announcementsCounts:e.announcement.announcementsCounts,courseContext:e.announcement.courseContext,sortCriteria:e.announcement.sortCriteria,listener:e.announcement.listener,recentUpdatedAnnouncementIds:e.announcement.recentUpdatedAnnouncementIds})),(e=>(0,A.bindActionCreators)({loadAnnouncements:b.actions.announcement.loadAnnouncements,removeAnnouncement:b.actions.announcement.removeAnnouncement,saveAnnouncement:b.actions.announcement.saveAnnouncement,changeSearchInputState:b.actions.announcement.changeSearchInputState,getAnnouncementsCounts:b.actions.announcement.getAnnouncementsCounts,getCourseContext:b.actions.announcement.getCourseContext,switchSortCriteria:b.actions.announcement.switchSortCriteria,clearAnnouncements:b.actions.announcement.clearAnnouncements,removeFromRecentUpdated:b.actions.announcement.removeFromRecentUpdated},e)))((0,C.windowResizingResponsiveComponentWrapper)((0,l.withTranslate)(T)))},KasK:function(e,t,n){"use strict";n.r(t)},"Kc+f":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnouncementSlide=void 0;const s=n("D57K").__importStar(n("ERkP")),a=n("uDfI"),o=n("FS8K"),i=n("np6O"),r=n("WBPx"),l=n("gh1U"),c=n("Pam5"),u=n("IbyE"),d=n("vSnM"),m=n("0x+l"),h=n("50Q+");n("KasK");const p=n("9OUN");class E extends s.Component{constructor(e){super(e),this.onOpenAllAnnouncements=()=>{const{onOpenAllAnnouncements:e}=this.props;e(),this.onDismissAll()},this.openAnnouncementDetail=e=>{const{openAnnouncementDetail:t}=this.props;t(e),this.onDismissAll()},this.onDismissAll=()=>{this.announcementSlides.forEach((e=>this.props.dismissAnnouncementItem(e.sourceEntry))),this.onCloseSlideModal()},this.updateContext=()=>{const{currentViewingIndex:e,currentAnnouncement:t}=this.state,{courseContext:n,getCourseContext:s}=this.props;t&&t.courseId&&e>=0&&(n&&n.courseId===t.courseId||s(t.courseId))},this.onCloseSlideModal=()=>{this.setState({showModal:!1})},this.state={currentAnnouncement:null,currentViewingIndex:-1,showModal:!1}}componentDidMount(){this.props.fetchAnnouncementSlides().then((e=>{e.sort((function(e,t){return e.startDateRestriction&&t.startDateRestriction?e.startDateRestriction.toISOString().localeCompare(t.startDateRestriction.toISOString()):0})),this.announcementSlides=e.slice(),this.announcementSlides.length>0&&this.setState({currentViewingIndex:0,currentAnnouncement:{...this.announcementSlides[0]},showModal:!0},this.updateContext),this.elementCards=this.announcementSlides.map((e=>{var t;return s.createElement("li",{className:"element-card",key:e.id},s.createElement("div",{className:"element-image"},s.createElement(c.Announcement,{color:"primary"})),s.createElement("div",{className:"element-details"},s.createElement("div",{className:"name"},s.createElement("a",{className:"rows-block header-title",onClick:()=>{this.openAnnouncementDetail(e.id)},href:"#"},(0,d.decodeHtmlEntities)(e.title)),s.createElement("span",{className:"rows-block header-sent-date"},(0,d.displayDateTime)(null===(t=e.startDateRestriction)||void 0===t?void 0:t.toISOString(),this.props.localize))),s.createElement("br",null),s.createElement("div",{className:"rows-block body-text message-entries"},s.createElement("p",null,(0,d.decodeHtmlBodyText)(e.body.rawText,this.props.localize)))))}))}))}render(){const{localize:e,courseContext:t}=this.props;return s.createElement(l.Modal,{isOpen:this.state.showModal,containerClassName:"ms-modalExample-container container-inherit"},s.createElement("div",{className:"notice notification "+this.props.courseColorClass+" reveal-modal course-announcements-slide open in"},s.createElement("div",{className:"title-container"},s.createElement("h1",{className:"title-modal"},e.translate((0,h.resolveCourseOrgToken)("announcements.newCourseAnnouncements",null==t?void 0:t.isOrganization))),s.createElement(i.AnalyticsIconButton,{"aria-label":e.translate("course.announcements.closeModal"),className:"close-modal-button",onClick:this.onDismissAll,analyticsId:"course.announcements.modal.close.button"},s.createElement(m.Close,null))),s.createElement("div",{className:"modal-contents"},s.createElement("ul",{className:"modal-notifications"},this.elementCards)),s.createElement("div",{className:"announcement-modal-footer"},s.createElement(r.AnalyticsPrimaryButton,{onClick:this.onOpenAllAnnouncements,className:"view-all-announcements-button",analyticsId:"course.announcements.slide.view.all.button"},e.translate("course.announcements.button.viewAll")))))}}t.AnnouncementSlide=E,t.default=(0,a.connect)((e=>({courseContext:e.announcement.courseContext})),(e=>(0,p.bindActionCreators)({getCourseContext:u.actions.announcement.getCourseContext},e)))((0,o.withLocalize)(E))},RDpL:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnouncementDetailPanel=t.TITLE_CHARACTER_LENGTH=void 0;const s=n("D57K"),a=s.__importStar(n("ERkP")),o=n("uDfI"),i=s.__importDefault(n("wgY5")),r=s.__importDefault(n("7O4Y")),l=n("FS8K"),c=n("MC1S"),u=n("WBPx"),d=n("np6O"),m=n("0x+l"),h=s.__importDefault(n("RK7K")),p=n("vSnM"),E=n("50Q+"),g=n("Y+9S"),C=s.__importDefault(n("Hhhn")),S=n("AuQm"),f=n("Vvvt"),D=n("IbyE"),b=n("vSnM"),A=n("9OUN");n("09zc"),t.TITLE_CHARACTER_LENGTH=256;class y extends a.Component{constructor(e){super(e),this.mappingAnnouncementToState=e=>{const{courseId:t,courseContext:n,getCourseContext:s}=this.props;if(e){const{title:t="",startDateRestriction:n,endDateRestriction:s,isDraft:a,pushNotify:o}=e,r=e.body&&e.body.rawText||"";this.setState({currentBbml:r,currentAnnouncement:e,title:t,isValid:!!t.trim()&&!!r.trim(),isDraft:a,isSendEmailChecked:o}),a||(o||this.setState({isShowOnChecked:!0,startDate:(0,i.default)(n).toDate(),startTime:(0,i.default)(n).toDate()}),s&&this.setState({isEndChecked:!0,endDate:(0,i.default)(s).toDate(),endTime:(0,i.default)(s).toDate()}))}this.notifyMobileApp(e),n&&n.courseId===t||s(t);const a=this.getMode();this.titleTextField&&this.isEditableMode(a)&&this.titleTextField.focus(),this.updateAnnouncementPanelState(h.default.DUPLICATE.isEqualTo(a),!1)},this.notifyMobileApp=e=>{const t={type:g.MessageType.AnnouncementDetailOpened,status:g.MessageStatus.Success,pageTitle:this.getTitle(e)};(0,g.sendMessageToMobile)(t)},this.getMode=()=>this.props.mode||h.default.VIEW,this.isEditableMode=e=>h.default.EDIT.isEqualTo(e)||h.default.DUPLICATE.isEqualTo(e)||h.default.CREATE.isEqualTo(e),this.onTitleChange=e=>{this.setState((n=>({title:e,isTitleInputPristine:!1,isValid:!!e.trim()&&e.trim().length<=t.TITLE_CHARACTER_LENGTH&&!!n.currentBbml.trim()}))),this.updateAnnouncementPanelState(!!e.trim())},this.onMessageChange=e=>{const{currentAnnouncement:n,isMessageEditorPristine:s}=this.state,a=e.toBbML();this.setState((e=>({currentBbml:a,isMessageEditorPristine:!1,isValid:!!a.trim()&&!!e.title.trim()&&e.title.trim().length<=t.TITLE_CHARACTER_LENGTH}))),n&&!s?this.updateAnnouncementPanelState(n.body.rawText!==a):n||this.updateAnnouncementPanelState(!!a)},this.onTitleErrorMessage=e=>{const{isTitleInputPristine:n}=this.state,{t:s}=this.props;let a="";return n||e.trim().length?!n&&e.trim().length>t.TITLE_CHARACTER_LENGTH&&(a=s("course.announcements.errors.messages.titleMaxlength",{maxLength:t.TITLE_CHARACTER_LENGTH})):a=s("course.announcements.errors.messages.titleRequired"),a},this.onSave=()=>{if(this.state.isSaving)return;this.setState({isSaving:!0});const e=this.getMode();let{currentAnnouncement:t}=this.state;const{currentBbml:n,title:s,isSendEmailChecked:a,isScheduleChecked:o,isShowOnChecked:i,isEndChecked:r,startDate:l,startTime:c,endDate:u,endTime:d}=this.state,{courseId:m,saveAnnouncement:p,closePanel:E}=this.props;if(l&&c&&l.setHours(c.getHours(),c.getMinutes(),c.getSeconds()),u&&d&&u.setHours(d.getHours(),d.getMinutes(),d.getSeconds()),!t&&h.default.CREATE.isEqualTo(e))t={},t.isDraft=!0,t.title=s,t.body={rawText:n},t.pushNotify=a,o&&(t.isDraft=!1,i&&(t.startDateRestriction=(0,b.buildDateTimeMoment)(l,c).toDate()),t.endDateRestriction=r?(0,b.buildDateTimeMoment)(u,d).toDate():null);else{if(!h.default.DUPLICATE.isEqualTo(e)&&!h.default.EDIT.isEqualTo(e))return console.error("Failed to save announcement!"),void this.setState({isSaving:!1});{const m={...t.body,rawText:n};t={...t,title:s,body:m},h.default.DUPLICATE.isEqualTo(e)&&(t={...t,isDraft:!0,id:null}),t.pushNotify=a,o?(t.isDraft=!1,i&&(t.startDateRestriction=(0,b.buildDateTimeMoment)(l,c).toDate()),t.endDateRestriction=r?(0,b.buildDateTimeMoment)(u,d).toDate():null):(t.isDraft=!0,t.startDateRestriction=null,t.endDateRestriction=null)}}p(m,t).then((()=>{this.updateAnnouncementPanelState(!1,!0),E()}))},this.onCancel=()=>{this.props.closePanel()},this.validateInputs=()=>!!this.state.title.trim()&&!!this.state.currentBbml.trim()&&this.state.title.trim().length<=t.TITLE_CHARACTER_LENGTH,this.validateSchedule=()=>{const{isScheduleChecked:e,isShowOnChecked:t,isEndChecked:n,isStartDateValid:s,isStartTimeValid:a,isEndDateValid:o,isEndTimeValid:i}=this.state;if(e){if(t&&(!s||!a))return!1;if(n&&(!o||!i))return!1}return!0},this.onSendEmailChange=()=>{this.updateAnnouncementPanelState(!0),this.setState((e=>({isSendEmailChecked:!e.isSendEmailChecked})))},this.onScheduleChange=()=>{this.updateAnnouncementPanelState(!0),this.setState((e=>({isScheduleChecked:!e.isScheduleChecked,isShowOnChecked:!e.isScheduleChecked&&!e.isSendEmailChecked})))},this.onShowOnChange=()=>{this.setState((e=>({isShowOnChecked:!e.isShowOnChecked}))),this.updateAnnouncementPanelState(!0)},this.onHideOnChange=()=>{this.setState((e=>({isEndChecked:!e.isEndChecked}))),this.updateAnnouncementPanelState(!0)},this.isEndLaterThanStart=()=>{const{isScheduleChecked:e,isEndChecked:t,isStartDateValid:n,isStartTimeValid:s,isEndDateValid:a,isEndTimeValid:o,startDate:i,startTime:r,endDate:l,endTime:c}=this.state;return!(e&&t&&n&&s&&a&&o&&i&&r&&l&&c)||(0,b.buildDateTimeMoment)(l,c).diff((0,b.buildDateTimeMoment)(i,r))>0},this.state={currentBbml:"",currentAnnouncement:null,title:"",isMessageEditorPristine:!0,isTitleInputPristine:!0,isSaving:!1,isValid:!1,isDraft:!1,isSendEmailChecked:!1,isScheduleChecked:!1,isShowOnChecked:!1,isEndChecked:!1,startDate:null,startTime:null,endDate:null,endTime:null,isStartDateValid:!0,isStartTimeValid:!0,isEndDateValid:!0,isEndTimeValid:!0}}componentDidMount(){const{courseId:e,announcementId:t,announcements:n,announcement:s,getAnnouncement:a,permissions:o}=this.props;h.default.CREATE.isEqualTo(this.getMode())?o.create?this.mappingAnnouncementToState(null):console.error("User is not authorized to create announcement!"):n&&n[t]?this.mappingAnnouncementToState(n[t]):s&&s.id===t?this.mappingAnnouncementToState(s):t?a(e,t).then((()=>{this.mappingAnnouncementToState(this.props.announcement)})):console.error("Unexpected behavior!")}componentDidUpdate(e,t){const{isScheduleChecked:n,isShowOnChecked:s,isSendEmailChecked:a}=this.state;if((t.isScheduleChecked!==n&&n||t.isShowOnChecked!==s&&s)&&!a&&(this.state.startDate&&this.state.startTime||this.setState({startDate:(0,i.default)().toDate(),startTime:(0,i.default)().toDate()})),t.isSendEmailChecked!==a&&a&&(this.state.startDate||this.state.startTime)&&this.setState({startDate:null,startTime:null}),this.state.isEndChecked!==t.isEndChecked&&this.state.isEndChecked&&(!this.state.endDate||!this.state.endTime)){const{startDate:e,startTime:t}=this.state;if(e&&t)this.setState({endDate:(0,i.default)(e).add(1,"days").toDate(),endTime:(0,i.default)(t).add(1,"days").toDate()});else{const e=(0,i.default)().toDate();this.setState({endDate:(0,i.default)(e).add(1,"days").toDate(),endTime:(0,i.default)(e).add(1,"days").toDate()})}}}getTitle(e){const t=this.getMode(),{t:n}=this.props;let s=e&&(0,p.decodeHtmlEntities)(e.title)||"";return h.default.CREATE.isEqualTo(t)?s=n("course.announcements.newAnnouncement"):h.default.EDIT.isEqualTo(t)?s=n("course.announcements.editAnnouncement",{announcement:s}):h.default.DUPLICATE.isEqualTo(t)&&(s=n("course.announcements.copyAnnouncement",{announcement:s})),s}updateAnnouncementPanelState(e,t=!1){this.props.changeAnnouncementPanelState({isDirty:e,isSaved:t})}get isEditorInputValid(){const{currentBbml:e,isMessageEditorPristine:t}=this.state;return t||e.length>0}renderBbEditorErrorMessage(){return this.isEditorInputValid?null:a.createElement("div",{className:"error-message",role:"alert"},a.createElement(m.Attention,null),a.createElement("span",null,this.props.t("course.announcements.errors.messages.messageRequired")))}render(){const e=this.getMode(),{permissions:t,courseContext:n,t:s,pluginConfig:o,fileUploadSettings:i}=this.props,{currentAnnouncement:l,isSaving:g,isValid:D,isSendEmailChecked:b,isScheduleChecked:A,isShowOnChecked:y,isEndChecked:T,startDate:v,startTime:I,endDate:P,endTime:k,isStartDateValid:N,isStartTimeValid:w,isEndDateValid:x,isEndTimeValid:M}=this.state,_=this.getTitle(l),O=(null==l?void 0:l.body.rawText)||"";return(t.viewUnposted||h.default.VIEW.isEqualTo(e))&&a.createElement("div",{className:"announcement-detail-panel"},h.default.VIEW.isEqualTo(e)&&a.createElement("div",{className:"panel-wrap"},a.createElement("header",{className:"panel-header simple-header"},a.createElement("div",{className:"panel-titles-container"},a.createElement("span",{className:"panel-sub-title"},s((0,E.resolveCourseOrgToken)("announcements.pageTitle",null==n?void 0:n.isOrganization))),a.createElement("div",{className:"editable-title-container black-header-contents"},a.createElement(d.AnalyticsIconButton,{className:"left-off-canvas-toggle menu-toggle  standard-button dark-background",title:s("base.menu"),"aria-label":s("base.menu"),analyticsId:"course.announcements.detailPanel.menu.button"},a.createElement(m.MainMenu,null)),a.createElement("h1",{className:"panel-title",title:_},_)))),a.createElement("section",{className:"panel-container panel-content"},a.createElement("div",{className:"body-text"},a.createElement(f.BbEditorWrapper,{editor:{bbml:O,pluginConfig:o,isReadOnly:!0,isToolbarHidden:!0,showWordCount:!1,onChange:this.onMessageChange,placeholder:s("course.announcements.detail.messageDesc")},fileUploadSettings:i})))),this.isEditableMode(e)&&a.createElement("div",{className:"peek-panel-with-footer"},a.createElement("div",{className:"panel-wrap"},a.createElement("header",{className:"panel-header simple-header"},a.createElement("div",{className:"panel-titles-container"},a.createElement("span",{className:"panel-sub-title"},n&&n.displayName||""),a.createElement("div",{className:"editable-title-container black-header-contents"},a.createElement(d.AnalyticsIconButton,{className:"left-off-canvas-toggle menu-toggle standard-button dark-background",title:s("base.menu"),"aria-label":s("base.menu"),analyticsId:"course.announcements.detailPanel.menu.button"},a.createElement(m.MainMenu,null)),a.createElement("h1",{className:"panel-title",title:_},_)))),a.createElement("section",{className:"panel-container panel-content -has-footer"},a.createElement(c.TextField,{className:"label-decorator",label:s("course.announcements.detail.title"),value:(0,p.decodeHtmlEntities)(this.state.title),onChanged:this.onTitleChange,placeholder:s("course.announcements.detail.titleDesc"),ref:e=>{this.titleTextField=e},onGetErrorMessage:this.onTitleErrorMessage,required:!0,analyticsId:"course.announcements.detailPanel.title.input.text"}),a.createElement(c.Dropdown,{label:s("course.announcements.detail.recipients"),defaultSelectedKey:"all",required:!0,options:[{key:"all",text:s((0,E.resolveCourseOrgToken)("announcements.detail.allRecipients",null==n?void 0:n.isOrganization),{studentCount:n&&n.membershipCount||0})}],analyticsId:"course.announcements.detailPanel.recipients.dropdown"}),a.createElement("div",{className:"panel-content__field"},a.createElement(c.Label,{className:"panel-content__field__label",id:"announcement-bb-editor-label",required:!0},s("course.announcements.detail.message")),a.createElement("div",{className:(0,r.default)("panel-content__message",{"-invalid":!this.isEditorInputValid})},a.createElement(f.BbEditorWrapper,{editor:{bbml:O,pluginConfig:o,ariaLabelledBy:"announcement-bb-editor-label",ariaRequired:!0,isReadOnly:!1,isToolbarHidden:!1,onChange:this.onMessageChange,placeholder:s("course.announcements.detail.messageDesc"),showWordCount:!0},fileUploadSettings:i})),this.renderBbEditorErrorMessage()),a.createElement("div",null,a.createElement(c.Checkbox,{label:s("course.announcements.button.email"),checked:b,disabled:A,onChange:this.onSendEmailChange,ariaDescribedBy:"email-checkbox-desc",analyticsId:"course.announcements.detailPanel.sendEmail.input.checkbox"}),a.createElement("p",{className:"information-message",id:"email-checkbox-desc"},s("course.announcements.detail.emailDesc")),a.createElement("p",{className:"information-message",id:"email-checkbox-warning"},s("course.announcements.detail.emailRestriction"))),a.createElement("div",null,a.createElement(c.Checkbox,{label:s("course.announcements.button.schedule"),checked:A,onChange:this.onScheduleChange,analyticsId:"course.announcements.detailPanel.scheduleAnnouncement.input.checkbox",disabled:b,ariaDescribedBy:"email-info-checkbox-desc"}),a.createElement("p",{className:"information-message",id:"email-info-checkbox-desc"},s("course.announcements.detail.scheduleEmailInfo")),A&&!b&&a.createElement("div",null,a.createElement("div",null,a.createElement(c.Checkbox,{label:s("course.announcements.dateTimePicker.showOn"),checked:y,disabled:b,onChange:this.onShowOnChange,analyticsId:"course.announcements.detailPanel.showOn.input.checkbox"}),a.createElement("div",{className:"row collapse date-time-inputs"},a.createElement("div",{className:"columns small-6"},a.createElement(C.default,{value:v,disabled:b,onChangeValue:e=>{this.setState({startDate:e})},onValidateCallback:e=>{this.setState({isStartDateValid:e})},isValueValid:N||!y||b,errorFormatMessage:s("components.directives.validation.messages.errors.date"),errorEmptyMessage:s("components.directives.content-visibility.startDateError"),analyticsId:"course.announcements.detailPanel.showOn.datePicker"})),a.createElement("div",{className:"columns small-6"},a.createElement(S.TimePicker,{value:I,disabled:b,onChangeValue:e=>{this.setState({startTime:e})},onValidateCallback:e=>{this.setState({isStartTimeValid:e})},isValueValid:w||!y||b,errorFormatMessage:s("components.directives.validation.messages.errors.time"),errorEmptyMessage:s("components.directives.content-visibility.startTimeError"),analyticsId:"course.announcements.detailPanel.showOn.timePicker"})))),a.createElement("div",null,a.createElement(c.Checkbox,{label:s("course.announcements.dateTimePicker.hideOn"),checked:T,onChange:this.onHideOnChange,analyticsId:"course.announcements.detailPanel.hideOn.input.checkbox"}),a.createElement("div",{className:"row collapse date-time-inputs"},a.createElement("div",{className:"columns small-6"},a.createElement(C.default,{value:P,onChangeValue:e=>{this.setState({endDate:e})},onValidateCallback:e=>{this.setState({isEndDateValid:e})},isValueValid:x||!T,disabled:!T,errorFormatMessage:s("components.directives.validation.messages.errors.date"),errorEmptyMessage:s("components.directives.content-visibility.endDateError"),analyticsId:"course.announcements.detailPanel.hideOn.datePicker"})),a.createElement("div",{className:"columns small-6"},a.createElement(S.TimePicker,{value:k,onChangeValue:e=>{this.setState({endTime:e})},onValidateCallback:e=>{this.setState({isEndTimeValid:e})},isValueValid:M||!T,disabled:!T,errorFormatMessage:s("components.directives.validation.messages.errors.time"),errorEmptyMessage:s("components.directives.content-visibility.endTimeError"),analyticsId:"course.announcements.detailPanel.hideOn.timePicker"})))),!this.isEndLaterThanStart()&&a.createElement("span",{className:"error-message"},a.createElement(m.Attention,null),s("course.announcements.errors.messages.hideOnShouldLaterThanShowOn")))))),a.createElement("footer",{className:"panel-footer"},a.createElement("span",{className:"place-holder"}),a.createElement(u.AnalyticsDefaultButton,{className:"button-cancel",onClick:this.onCancel,analyticsId:"course.announcements.detailPanel.cancel.button"},s("course.announcements.button.cancel")),a.createElement(u.AnalyticsPrimaryButton,{className:"button-save",disabled:!(D&&this.validateSchedule()&&this.isEndLaterThanStart()),onClick:this.onSave,analyticsId:"course.announcements.detailPanel.save.button"},s("course.announcements.button.save")))),g?a.createElement("div",{className:"spinner bb-secondary-color-2"}):"")}}t.AnnouncementDetailPanel=y,t.default=(0,o.connect)((e=>({announcements:e.announcement.announcements,courseContext:e.announcement.courseContext,announcement:e.announcement.announcement,detailPanelState:e.announcement.detailPanelState,fileUploadSettings:D.select.fileUploadSettings.getFileUploadSettings(e)})),(e=>(0,A.bindActionCreators)({saveAnnouncement:D.actions.announcement.saveAnnouncement,getCourseContext:D.actions.announcement.getCourseContext,getAnnouncement:D.actions.announcement.getAnnouncement,changeAnnouncementPanelState:D.actions.announcement.changeAnnouncementPanelState},e)))((0,l.withTranslate)(y))},RDrG:function(e,t,n){"use strict";n.r(t)},RK7K:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const s=n("D57K").__importDefault(n("nbDY"));class a extends s.default{}t.default=a,a.VIEW=new a("view"),a.CREATE=new a("create"),a.EDIT=new a("edit"),a.DUPLICATE=new a("duplicate"),a.DELETE=new a("delete")},Vvvt:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BbEditorWrapper=t.BaseBbEditorWrapper=void 0;const s=n("D57K").__importStar(n("ERkP")),a=n("nsO7"),o=n("ERsv"),i=n("FS8K"),r=n("IbyE");class l extends s.Component{constructor(){super(...arguments),this.getEditorElement=()=>document.querySelector(".bb-editor"),this.prepareEditorPlugins=()=>{const{localize:e,editor:t,fileUploadSettings:n}=this.props,s={...t.pluginConfig,babelfishFormatInstance:e.babelfishFormat,babelfishInstance:e.babelfish,apiBasePath:r.config.apiBasePath,locale:e.locale,xsrfToken:r.config.xsrf,fileUploadSettings:n},a=[(0,o.link)(),(0,o.image)(),(0,o.video)(),(0,o.insertLocalFile)(s),(0,o.videoEverywhere)(s)];return s.openCloudStorageIntegrationModal&&a.push((0,o.insertCloudStorageIntegrationFile)({openCloudStorageIntegrationModal:s.openCloudStorageIntegrationModal,...s})),s.getEmbedSrc&&a.push((0,o.insertYoutubeVideo)({getEmbedSrc:s.getEmbedSrc,...s})),a},this.focusEditor=()=>{const e=this.getEditorElement();e&&e.focus()}}componentDidMount(){this.props.editor.isReadOnly||this.focusEditor()}shouldComponentUpdate(e){return(0,a.differenceWith)([e.editor],[this.props.editor],a.isEqual).length>0}componentDidUpdate(){this.props.editor.isReadOnly||this.focusEditor()}render(){const{editor:e}=this.props,t=this.prepareEditorPlugins();return s.createElement(o.BbEditor,{...e,plugins:t})}}t.BaseBbEditorWrapper=l,t.BbEditorWrapper=(0,i.withLocalize)(l)},cwrT:function(e,t,n){"use strict";n.r(t)},idFC:function(e,t,n){"use strict";n.r(t)},m3mx:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PanelModeEnum=t.renderAnnouncementSlide=t.renderAnnouncementDetailPanel=t.renderAnnouncementListPanel=void 0;const s=n("D57K"),a=s.__importStar(n("ERkP")),o=s.__importStar(n("7nmT")),i=s.__importDefault(n("IVgG")),r=s.__importDefault(n("RDpL")),l=s.__importDefault(n("Kc+f")),c=n("uDfI"),u=n("FS8K"),d=s.__importDefault(n("RK7K"));t.PanelModeEnum=d.default;const m=n("tN4z"),h=(e,t,n,s,i,r)=>{let l=n;null==n&&"undefined"!=typeof window&&window.location.search.match("setLang=")&&(l=window.location.search.match(/setLang=([^$&]+)/)[1]),o.render(a.createElement(m.AnalyticsJssThemeProvider,{theme:"light",isRtl:r},a.createElement(u.Locale,{locale:l,babelfishInstance:s,babelfishFormatInstance:i,bundlesToLoad:["announcements/locales/[locale]/announcements.json"],isRtl:r},a.createElement("div",null,e))),t)};t.renderAnnouncementListPanel=(e,t,n,s,o,r,l,u,d)=>{h(a.createElement(c.Provider,{store:t},a.createElement(i.default,{courseId:l,permissions:u,root:e,openAnnouncementDetailPanel:d})),e,n,s,o,r)};t.renderAnnouncementDetailPanel=(e,t,n,s,o,i,l,u,d,m,p,E)=>{h(a.createElement(c.Provider,{store:t},a.createElement(r.default,{courseId:l,announcementId:u,permissions:d,mode:m,closePanel:p,pluginConfig:E})),e,n,s,o,i)};t.renderAnnouncementSlide=(e,t,n,s,o,i,r,u,d,m,p)=>{h(a.createElement(c.Provider,{store:t},a.createElement(l.default,{courseColorClass:r,fetchAnnouncementSlides:u,dismissAnnouncementItem:p,onOpenAllAnnouncements:d,openAnnouncementDetail:m})),e,n,s,o,i)};const p={renderAnnouncementListPanel:t.renderAnnouncementListPanel,destroyAnnouncementListPanel:e=>{o.unmountComponentAtNode(e)},renderAnnouncementDetailPanel:t.renderAnnouncementDetailPanel,destroyAnnouncementDetailPanel:e=>{o.unmountComponentAtNode(e)},renderAnnouncementSlide:t.renderAnnouncementSlide,destroyAnnouncementSlide:e=>{o.unmountComponentAtNode(e)}};t.default=p},vSnM:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildDateTimeMoment=t.encodeHtmlEntities=t.decodeOnlyAngleBracketHtmlEntities=t.decodeHtmlBodyText=t.decodeHtmlEntities=t.displayDateTime=void 0;const s=n("D57K"),a=s.__importDefault(n("wgY5")),o=s.__importStar(n("n7/H")),i=n("ERsv"),r=n("RPob");t.displayDateTime=function(e,t){let n="";if(e&&(0,a.default)(e).isValid()){const s=(0,a.default)(e).toDate();if(function(e,t,n){return e>=t&&e<n}((new Date).getTime()-s.getTime(),0,864e5)){const e=t.formatDuration(s,{},o.ILocaleDateFormat.Short);n=t.translate("components.directives.duration.agoText",{durationDate:e.date||"",durationTime:e.time||""})}else n=t.formatDatetime(s,o.ILocaleDatetimeFormat.Short)}return n};const l=document.createElement("textarea");t.decodeHtmlEntities=function(e){return l.innerHTML=e,l.value},t.decodeHtmlBodyText=function(e,t){e=e.replace(/"{"/g,"'{\"").replace(/"}"/g,"\"}'");let n=(new DOMParser).parseFromString(e,"text/html");const s=[{tag:"table",replacementText:`[${t.translate("course.announcements.tableWithContent")}]`}];return n=(0,r.replaceContentInHTML)(n,s),Array.from(n.getElementsByTagName("a")).forEach((e=>{const t=JSON.parse((0,i.fixDoubleQuotesInJSONValues)(e.getAttribute("data-bbfile")));(null==t?void 0:t.alternativeText)?e.textContent=`[${t.alternativeText}]`:(null==t?void 0:t.alt)?e.textContent=`[${t.alt}]`:e.textContent=`[${e.textContent}]`})),n.body.innerHTML=n.body.innerHTML.replace(/</g," <"),(n.body.innerText||n.body.innerHTML).trim()},t.decodeOnlyAngleBracketHtmlEntities=function(e){return null==e?e:e.replace(/&gt;/g,">").replace(/&lt;/g,"<")},t.encodeHtmlEntities=function(e){return null==e?e:e.replace(/[\u00A0-\u9999<>\&]/gim,(function(e){return"&#"+e.charCodeAt(0)+";"}))},t.buildDateTimeMoment=function(e,t){const n=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds());return(0,a.default)(n)}},xG9T:function(e,t,n){"use strict";var s;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Ascending="ascending",e.Descending="descending",e.None="none",e.Other="other"}(s||(s={})),t.default=s}}]);