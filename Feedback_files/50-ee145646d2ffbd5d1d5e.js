(window.webpackJsonp=window.webpackJsonp||[]).push([[50,8,24,34,35,39,45,55,56],{"+fEV":function(e,t){e.exports='<div class="slider-tab-navigation-small">\n  <div class="slider-tab-navigation-small__tabs-container">\n    <ul\n      class="slider-tab-navigation-small__tabs"\n      role="tablist"\n      aria-orientation="horizontal"\n      bb-arrow-key-navigation="{ wrap: true, layout: \'rows\', upEqualsLeft: true }"\n      bb-arrow-key-container\n    >\n      <li\n        id="{{\'slider-tab-\' + sliderTabNavigation.scope.tabs.transcludedSection.nameId}}"\n        analytics-id="{{::sliderTabNavigation.scope.tabs.transcludedSection.analyticsIdPrefix}}.li"\n        class="slider-tab-navigation-small__tab"\n        ng-click="sliderTabNavigation.goToTab(sliderTabNavigation.scope.tabs.transcludedSection)"\n        ng-class="{\'slider-tab-navigation-small__tab_active\': sliderTabNavigation.activeTab.nameId === sliderTabNavigation.scope.tabs.transcludedSection.nameId}"\n        ng-keydown="sliderTabNavigation.handleTabKeyDown($event, sliderTabNavigation.scope.tabs.transcludedSection)"\n        role="tab"\n        aria-controls="browsable-section-panel"\n        tabindex="0"\n        aria-label="{{sliderTabNavigation.scope.tabs.transcludedSection.title}}"\n        aria-selected="{{sliderTabNavigation.activeTab.nameId === sliderTabNavigation.scope.tabs.transcludedSection.nameId}}"\n        bb-arrow-key-destination\n      >\n        <div class="slider-tab-navigation-small__tab-icon">\n          <bb-slider-tab-item-icon icon-name="sliderTabNavigation.scope.tabs.transcludedSection.iconName"></bb-slider-tab-item-icon>\n        </div>\n\n        <div class="slider-tab-navigation-small__tab-title">\n          {{sliderTabNavigation.scope.tabs.transcludedSection.title}}\n        </div>\n      </li>\n\n      <li\n        id="{{\'slider-tab-\' + sliderTabNavigation.scope.tabs.browsableSection.main.nameId}}"\n        analytics-id="{{::sliderTabNavigation.scope.tabs.browsableSection.main.analyticsIdPrefix}}.li"\n        class="slider-tab-navigation-small__tab"\n        ng-click="sliderTabNavigation.goToTab(sliderTabNavigation.scope.tabs.browsableSection.main)"\n        ng-class="{\'slider-tab-navigation-small__tab_active\': sliderTabNavigation.activeTab.nameId === sliderTabNavigation.scope.tabs.browsableSection.main.nameId}"\n        ng-keydown="sliderTabNavigation.handleTabKeyDown($event, sliderTabNavigation.scope.tabs.browsableSection.main)"\n        role="tab"\n        aria-controls="browsable-section-panel"\n        tabindex="0"\n        aria-label="{{sliderTabNavigation.scope.tabs.browsableSection.main.title}}"\n        aria-selected="{{sliderTabNavigation.activeTab.nameId === sliderTabNavigation.scope.tabs.browsableSection.main.nameId}}"\n        bb-arrow-key-destination\n      >\n        <div class="slider-tab-navigation-small__tab-icon">\n          <bb-slider-tab-item-icon icon-name="sliderTabNavigation.scope.tabs.browsableSection.main.iconName"></bb-slider-tab-item-icon>\n        </div>\n\n        <div class="slider-tab-navigation-small__tab-title">\n          {{sliderTabNavigation.scope.tabs.browsableSection.main.title}}\n        </div>\n      </li>\n\n      <li\n        id="{{\'slider-tab-\' + tab.nameId}}"\n        analytics-id="{{::tab.analyticsIdPrefix}}.li"\n        class="slider-tab-navigation-small__tab"\n        ng-repeat="tab in sliderTabNavigation.scope.tabs.browsableSection.browsableTabs"\n        ng-click="sliderTabNavigation.goToTab(tab)"\n        ng-class="{\'slider-tab-navigation-small__tab_active\': sliderTabNavigation.activeTab.nameId === tab.nameId}"\n        ng-keydown="sliderTabNavigation.handleTabKeyDown($event, tab)"\n        role="tab"\n        aria-label="{{tab.title}}"\n        aria-controls="browsable-section-panel"\n        tabindex="0"\n        aria-selected="{{sliderTabNavigation.activeTab.nameId === tab.nameId}}"\n        bb-arrow-key-destination\n      >\n        <div class="slider-tab-navigation-small__tab-icon">\n          <bb-slider-tab-item-icon icon-name="tab.iconName"></bb-slider-tab-item-icon>\n        </div>\n\n        <div class="slider-tab-navigation-small__tab-title">\n          {{tab.title}}\n        </div>\n      </li>\n    </ul>\n  </div>\n\n  <div\n    id="browsable-section-panel"\n    class="slider-tab-navigation-small__tab-content"\n    aria-labelledby="{{\'slider-tab-\' + sliderTabNavigation.activeTab.nameId}}"\n  >\n    <div ng-if="sliderTabNavigation.shouldRenderTranscludedElement()">\n      <div ng-transclude></div>\n    </div>\n\n    <div ng-if="sliderTabNavigation.shouldRenderPeekRoutedElement()">\n      <div ui-view="{{sliderTabNavigation.viewName}}" ng-if="!sliderTabNavigation.shouldHideView"></div>\n    </div>\n  </div>\n</div>\n'},"+sRu":function(e,t,s){"use strict";var n;!function(e){e.IsSelected="is-selected",e.AnswerSelectedNotPosted="answer-selected-not-posted",e.AnswerNotSelected="answer-not-selected",e.CorrectAnswerSelected="correct-answer-selected",e.CorrectAnswerNotSelected="correct-answer-not-selected",e.IncorrectAnswerSelected="incorrect-answer-selected"}(n||(n={})),t.a=n},"+wu9":function(e,t){e.exports='<div class="typeahead-selected-options" ng-class="{\'empty\': selectedOptions.length === 0}" bb-load-bundle="components/directives/typeahead">\n  <ul bb-translate-attrs="{ \'aria-label\': selectedOptionsListLabel }">\n    <li ng-repeat="option in selectedOptions">\n      <span>{{::option.displayName}}</span>\n      <button class="button button--text"\n              ng-click="typeaheadSelectedOptions.removeOption(option)"\n              bb-translate-attrs="{ \'aria-label\': \'typeahead.typeahead-options.remove\' }"\n              translate-attrs-values="{ displayName: option.displayName }"\n              analytics-id="components.directives.typeaheadSelectedOptions.removeOption.button">\n        <bb-svg-icon size="small" icon="clear" />\n      </button>\n    </li>\n  </ul>\n</div>'},"/9iQ":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-documents",use:"icon-small-documents-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-documents"><path d="M1 4h7.0084L11 7v8H1V4z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M8.0005 4v3h3.0015M4 8h1M4 11h3.9722" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M3 1h11v12" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"/R3n":function(e,t){e.exports='<div class="content-item-course-outline">\n  <div class="name">\n    <ng-switch on="content.getContentDisplay().linkAction()" ng-class="{\'has-indicator\': content.ui.hasIndicator}">\n      <div ng-switch-when="resource/x-bb-folder">\n        <bb-content-item-folder></bb-content-item-folder>\n      </div>\n      <div ng-switch-when="contenturl">\n        \x3c!-- Center content title when it is only one line of text (without edit capability, description, or date restrictions). --\x3e\n        <a bb-prevent-click-if="content.isConditionalReleaseLocked()"\n            ng-click="contentItemBase.onExternalLinkClick()"\n            ng-href="{{content.getContentDisplay().contentUrl()}}" target="_blank" rel="noopener noreferrer" class="content-title"\n            ng-class="{\'name-middle\': contentItemCourseOutline.shouldAlignMiddle()}"\n            aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n            analytics-id="content.item.course.outline.courseContent.link"\n            analytics-context="{{::content.getContentDisplay().contentUrl()}}"\n            aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n            tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}">\n          <span>{{ content.title }}</span>\n        </a>\n      </div>\n      <div ng-switch-when="fileurl">\n        \x3c!-- Open the file preview panel for content that can be previewed --\x3e\n        <a bb-prevent-click-if="content.isConditionalReleaseLocked()"\n            ng-click="contentItemBase.onExternalLinkClick()"\n            bb-peek-sref="preview-file({id: content.id})"\n            ng-class="{\'name-middle\': contentItemCourseOutline.shouldAlignMiddle()}"\n            class="content-title"\n            aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n            analytics-id="content.item.course.outline.courseContent.link"\n            analytics-context="{{::content.getContentDisplay().contentUrl()}}"\n            aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n            tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}">\n          <span>{{ content.title }}</span>\n        </a>\n      </div>\n      <div ng-switch-when="ltilaunch">\n        <bb-content-item-ltilaunch></bb-content-item-ltilaunch>\n      </div>\n      <div ng-switch-when="scormlaunch">\n        <bb-content-item-scormlaunch></bb-content-item-scormlaunch>\n      </div>\n      <div ng-switch-when="resource/x-bb-asmt-agn-link">\n        \x3c!-- open  edit page when an instructor(=entitledToDesignAssessment) is accessing an assignment in a complete course. page will become read only based on canEdit() --\x3e\n        <a ng-if="contentItemBase.entitledToDesignAssessment"\n           class="content-title"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           bb-peek-sref="gradebook-item.assignment({\n                                 courseId: content.courseId,\n                                 contentId: content.id,\n                                 gradeitemView: \'details\' })"\n           analytics-id="content.item.course.outline.gradebook.item.assignment.link"><span>{{ content.title }}</span></a>\n        \x3c!-- user cannot modify --\x3e\n        <a ng-if="!contentItemBase.entitledToDesignAssessment"\n           bb-peek-sref="assignment.view({assignmentId:content.id})" bb-prevent-click-if="content.isConditionalReleaseLocked()"\n           ng-class="{\'is-late\': contentItemBase.isLate, \'is-restricted\': content.isRestricted()}"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           class="content-title"\n           analytics-id="content.item.course.outline.gradebook.item.assignment.readOnly.link"\n           aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n           tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      </div>\n      <div ng-switch-when="resource/x-bb-assignment">\n        <a bb-peek-sref="assignment.view({assignmentId:content.id})" class="content-title"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           ng-class="{\'is-late\': contentItemBase.isLate}"\n           analytics-id="content.item.coures.outline.assignment.link"\n           aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n           tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      </div>\n      <div ng-switch-when="resource/x-bb-document">\n        <a bb-peek-sref="content-manage.edit.document({id:content.id})" class="content-title"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           ng-class="{\'is-late\': contentItemBase.isLate}"\n           analytics-id="content.item.coures.outline.document.link"\n           aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n           tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      </div>\n      <div ng-switch-when="resource/x-bb-page">\n        <bb-content-item-page></bb-content-item-page>\n      </div>\n      <div ng-switch-when="resource/x-bb-asmt-test-link">\n        \x3c!-- open edit page when an instructor(=entitledToDesignAssessment) is accessing content. In a complete course, page will become read only based on canEdit() --\x3e\n        <a ng-if="contentItemBase.entitledToDesignAssessment" class="content-title"\n           bb-peek-sref="gradebook-item.assessment({\n                                 courseId: content.courseId,\n                                 contentId: content.id,\n                                 gradeitemView: \'details\',\n                                 assessmentType: \'test\'})"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           analytics-id="content.item.courses.outline.gradebook.item.assessment.link"><span>{{ content.title }}</span></a>\n        \x3c!-- user cannot modify --\x3e\n        <a ng-if="!contentItemBase.entitledToDesignAssessment" href="javascript:void(0);"\n           ng-click="contentItemBase.openAssessmentItem()" bb-prevent-click-if="content.isConditionalReleaseLocked()"\n           ng-class="{\'is-late\': contentItemBase.isLate, \'is-restricted\': content.isRestricted()}"\n           class="content-title"\n           aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n           analytics-id="content.item.courses.outline.gradebook.item.assessment.readOnly.link"\n           aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n           tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      </div>\n      <a ng-switch-when="resource/x-bb-forumlink" bb-peek-sref="discussion.view.with-grading({contentId:content.id})"\n         bb-prevent-click-if="content.isConditionalReleaseLocked()"\n         class="content-title" aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n         analytics-id="content.item.courses.outline.gradebook.item.forum.link"\n         aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n         tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      <div ng-switch-when="resource/x-bb-courselink">\n        <bb-web-link-item content="content" target-content="contentItemBase.targetContent" prefix="\'course.outline\'"/>\n      </div>\n      <div ng-switch-when="resource/x-bb-journallink">\n        <a bb-peek-sref="journal.view.with-participation({contentId:content.id})"\n          bb-prevent-click-if="content.isConditionalReleaseLocked()"\n          class="content-title" aria-describedby="activity-indicator-{{::content.id}}"\n          analytics-id="content.item.courses.outline.journal.link"\n          aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n          tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n      </div>\n      <div ng-switch-default class="content-title">{{ content.title }}</div>\n      <bb-svg-icon role="img" aria-hidden="false" bb-translate-attrs="::{\'aria-label\':\'components.directives.content-item-base.aria-label.indicator\'}" ng-if="content.ui.hasIndicator" id="activity-indicator-{{::content.id}}" class="indicator" size="small" icon="activity-indicator"></bb-svg-icon>\n    </ng-switch>\n  </div>\n  <div ng-if="content.canViewAsInstructor() && content.canHaveAttempts() && content.hasDueDate()" class="due-date">\n    \x3c!-- no due date --\x3e\n    <span bb-translate ng-if="!dueDate" class="content-no-due-date-label">components.directives.content-item-base.no-due-date</span>\n    \x3c!-- due date --\x3e\n    <span bb-translate ng-if="dueDate && !gradeDetail" class="content-due-date-label">components.directives.content-item-base.due-date</span>\n    <bb-datetime format="Short" value="dueDate" ng-if="dueDate && !gradeDetail" class="content-due-date"></bb-datetime>\n    <span ng-if="content.getTimedTestDetail().hasTimeLimit" class="time-limit ellipse">\n      <span class="vertical-bar"></span>\n      <span bb-translate>components.directives.content-item-base.time-limit</span>\n      <span ng-bind-html="content.getTimedTestDetail().displayedTimeLimitSeconds | timeSpan: \'m\': this "></span>\n    </span>\n    <span class="content-item-course-outline__proctored-tag" ng-if="contentItemCourseOutline.displayProctoredTag()">\n      <span class="vertical-bar"></span>\n      <bb-ui-icon-small-proctor-shield\n        class="content-item-course-outline__proctored-icon"\n        class-name="content-item-course-outline__proctored-icon-svg"\n      >\n      </bb-ui-icon-small-proctor-shield>\n      <span bb-translate>components.services.proctoring.outline.proctored</span>\n    </span>\n  </div>\n  <div ng-if="!content.canViewAsInstructor() && content.canHaveAttempts() && content.hasDueDate()" class="due-date"\n       ng-class="{\'is-late\': contentItemBase.isLate}" ng-switch="dueDate != null">\n    \x3c!-- submission card --\x3e\n    \x3c!--  TODO: submissionCard is disabled until LRN-101279 is fixed --\x3e\n    \x3c!-- <bb-submission-card ng-if="gradeDetail"  grade-detail="gradeDetail" inline="true"></bb-submission-card>\n    <bb-submission-card ng-if="!gradeDetail" grading-column="gradingColumn" inline="true"></bb-submission-card> --\x3e\n    \x3c!-- no due date --\x3e\n    <span bb-translate ng-switch-default class="content-no-due-date-label">components.directives.content-item-base.no-due-date</span>\n    \x3c!-- due date --\x3e\n    <span bb-translate ng-switch-when="true" class="content-no-due-date-label" ng-if="!dueDate">components.directives.content-item-base.no-due-date</span>\n    <span bb-translate ng-switch-when="true"\n          class="content-due-date-label" ng-if="dueDate">components.directives.content-item-base.due-date</span>\n    <bb-datetime format="Short" value="dueDate" ng-switch-when="true" class="content-due-date" ng-if="dueDate"></bb-datetime>\n    <span ng-if="content.getTimedTestDetail().hasTimeLimit" class="time-limit ellipse">\n      <span class="vertical-bar"></span>\n      <span bb-translate>components.directives.content-item-base.time-limit</span>\n      <span ng-bind-html="content.getTimedTestDetail().displayedTimeLimitSeconds | timeSpan: \'m\': this "></span>\n    </span>\n    <span class="content-item-course-outline__proctored-tag" ng-if="contentItemCourseOutline.displayProctoredTag()">\n      <span class="vertical-bar"></span>\n      <bb-ui-icon-small-proctor-shield\n        class="content-item-course-outline__proctored-icon"\n        class-name="content-item-course-outline__proctored-icon-svg"\n      >\n      </bb-ui-icon-small-proctor-shield>\n      <span bb-translate>components.services.proctoring.outline.proctored</span>\n    </span>\n  </div>\n  <bb-content-item-peer-assessment ng-if="content.id" content="content"></bb-content-item-peer-assessment>\n  <div ng-if="contentItemBase.isModifyPermissionLoaded && content.canHaveAttempts() && content.isGroupContent" class="group-info">\n    <div class="guidance-wrapper">\n      <div class="group-name">\n        <span><bb-svg-icon size="small" icon="groups"></bb-svg-icon></span>\n        <span class="group-target-guided" bb-guidance-target component-key="contentGroupInfo"\n              ng-if="!contentItemBase.contextCourse.course.isComplete()">\n        </span>\n        <a ng-if="contentItemBase.hasViewGroupsAsAdmin"\n           class="js-groups-link"\n           href="javascript:void(0);"\n           ng-click="contentItemBase.editGroups()"\n           analytics-id="content.item.course.outline.contentItemBase.editGroups.link">\n          <bb-group-count content="content"></bb-group-count>\n        </a>\n        <span ng-if="contentItemBase.canViewGroups && !contentItemBase.hasViewGroupsAsAdmin" class="js-groups-link">\n          <bb-group-count content="content"></bb-group-count>\n        </span>\n        <div ng-if="!(contentItemBase.canViewGroups || contentItemBase.hasViewGroupsAsAdmin)" class="student-group-enrollment">\n          <bb-group-student-enrollment content="content"></bb-group-student-enrollment>\n        </div>\n        \x3c!-- For complete course, will not show this guidance: LRN-107718 --\x3e\n        <span>\n          <bb-guidance ng-if="!contentItemBase.contextCourse.course.isComplete() && !contentItemBase.entitledToDesignAssessment" component-key="contentGroupInfo"\n                       class="guidance-element-group guidance-is-empty-student guidance-element-overlay push-left">\n            <span bb-translate="{{::contentItemCourseOutline.groupAssessmentFtueKey}}" translate-values="{title: contentItemCourseOutline.customCategory}"></span>\n          </bb-guidance>\n        </span>\n      </div>\n    </div>\n  </div>\n  <div ng-if="!content.canViewAsInstructor() && content.isConditionalReleaseLocked()"\n    role="tooltip"\n    aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n    tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"\n    class="lock-info"\n    bb-complex-tooltip\n    enhanced-tooltip="true"\n    tooltip-position="bottom"\n    tooltip-open-on-activation="true"\n    tooltip-disable-on-mouse-over="false"\n    tooltip-scope="contentItemBase.conditionalRelease.tooltipScope"\n    tooltip-template="{{::contentItemBase.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}">\n    <span bb-translate="components.directives.content-item-base.conditionalRelease.lock-info"></span>\n    <span class="sr-only">{{contentItemBase.conditionalRelease.tooltips}}</span>\n  </div>\n  <div class="name-controls stop-click-propagation"\n    ng-class="{\n      \'name-conditional-release\': !content.canViewAsInstructor() && content.isConditionalReleaseLocked(),\n      \'selector-disabled\': content.isInForcedSequenceModule()\n    }"\n    ng-if="contentItemBase.showVisibility()">\n    <bb-content-visibility-selector content="content"\n                                    link-content="contentItemBase.targetContent"\n                                    onchange-func="contentItemBase.updateContentVisibility()"\n                                    open-panel-on-restricted="true"\n                                    enable-conditional-release="content.canAccessAdaptiveRelease()"\n                                    disable-restricted="contentItemBase.disableRestricted"\n                                    verbose-restricted-label="true"></bb-content-visibility-selector>\n  </div>\n  <div ng-if="content.canViewAsInstructor() && content.isConditionalRelease()" class="conditional-release-control"\n       ng-class="{\'conditional-release-control-for-complete-course\': contentItemCourseOutline.isCourseCompletedAndInInstructorView()}">\n    <div class="rules">\n      <a href="javascript:void(0);"\n        ng-click="contentItemCourseOutline.canOpenConditionalRelease && contentItemCourseOutline.openConditionalRelease()"\n        bb-complex-tooltip\n        enhanced-tooltip="true"\n        tooltip-position="bottom"\n        tooltip-disable-on-mouse-over="{{!contentItemCourseOutline.canOpenConditionalRelease}}"\n        tooltip-enable-on-mouse-leave-for-all-breakpoints="{{contentItemCourseOutline.canOpenConditionalRelease}}"\n        tooltip-enable-on-mouse-over-for-all-breakpoints="{{contentItemCourseOutline.canOpenConditionalRelease}}"\n        tooltip-open-on-activation="{{!contentItemCourseOutline.canOpenConditionalRelease}}"\n        tooltip-auto-update="true"\n        tooltip-scope="contentItemBase.conditionalRelease.tooltipScope"\n        tooltip-template="{{::contentItemBase.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}"\n        analytics-id="components.directives.content-item-base.conditionalRelease.link">\n        <span>{{contentItemBase.conditionalRelease.getConditionDescription()}}</span>\n        <span class="sr-only">{{contentItemBase.conditionalRelease.tooltips}}</span>\n      </a>\n    </div>\n  </div>\n</div>\n'},"/UyG":function(e,t){e.exports='<div class="fimb-question-container fimb-attempt-authoring" bb-first-time-container>\n  <div class="fimb-question">\n    <bb-rich-text-editor\n      ng-model="assessmentQuestion.viewHelper.questionText"\n      plugin-options="editorPluginOptions"\n      supports-inline-document-render="true"\n      is-read-only="true">\n    </bb-rich-text-editor>\n  </div>\n  <ul class="fimb-answers-container">\n    <li class="fimb-answer" ng-repeat="blankIdentifier in assessmentQuestion.viewHelper.orderedIdentifiers track by $index">\n      <bb-guidance ng-if="::assessmentQuestion.viewHelper.shouldShowFTUEOnAnswer($index)"\n                   component-key="components.features.course.content.assessment.ftue.fimb-question.attempt"\n                   class="guidance-element-overlay">\n        <span bb-translate>components.directives.assessment-question.fimb.attempt-authoring.ftue</span>\n      </bb-guidance>\n      <div ng-if="::assessmentQuestion.viewHelper.shouldShowFTUEOnAnswer($index)"\n           class="answer-guidance-container"\n           bb-guidance-target\n           component-key="components.features.course.content.assessment.ftue.fimb-question.attempt">\n      </div>\n      <label class="fimb-answer-label"\n             for="{{assessmentQuestion.elementId}}-fimb-answers-{{$index}}">\n        {{assessmentQuestion.viewHelper.translatedIdentifiers.get(blankIdentifier)}}\n      </label>\n      <input id="{{assessmentQuestion.elementId}}-fimb-answers-{{$index}}"\n             name="{{assessmentQuestion.elementId}}-fimb-answers-{{$index}}"\n             class="fimb-answer-input"\n             type="text"\n             ng-model="assessmentQuestion.givenAnswer[blankIdentifier]"\n             ng-blur="assessmentQuestion.viewHelper.replaceAnswerInQuestionTextWithText($index, assessmentQuestion.givenAnswer[blankIdentifier])"\n             bb-translate-attrs="{placeholder: \'components.directives.assessment-question.fimb.attempt-authoring.input-placeholder\'}"\n             analytics-id="components.directives.assessment-question.fimb.attempt-authoring.input-placeholder.input.text"\n      />\n    </li>\n  </ul>\n</div>\n'},"/hmo":function(e,t){e.exports='<ng-switch on="targetContent.contentHandler.toString()">\n  <a ng-switch-when="resource/x-bb-blti-link" \n     bb-component-sref="{{prefix}}.engagement.edit({contentId:\'{{targetContent.id}}\'})"\n     class="content-title"\n     analytics-id="course.content.lti.link"><span>{{ content.title }}</span></a>\n</ng-switch>\n'},"/qTg":function(e,t){e.exports='<div class="matching-attempt-authoring matching">\n  <div class="matching-question question-container">\n    <bb-rich-text-editor\n      plugin-options="editorPluginOptions"\n      ng-model="questionAttempt.question.questionText.rawText"\n      supports-inline-document-render="true"\n      is-read-only="true">\n    </bb-rich-text-editor>\n  </div>\n  <div bb-first-time-container class="guidance-wrapper question-answer-container">\n    <div bb-guidance-target component-key="components.directives.assessment-question.ftue.matching-attempt-authoring">\n      <bb-matching-attempt\n        answers="questionAttempt.question.answers"\n        given-answers="questionAttempt.givenAnswers"\n        prompts="questionAttempt.question.prompts"\n        on-change="assessmentQuestion.onAnswersChange"\n        question-index="questionAttempt.question.position"\n      ></bb-matching-attempt>\n    </div>\n\n    <bb-guidance component-key="components.directives.assessment-question.ftue.matching-attempt-authoring"\n                 class="guidance-element-overlay stacked push-bottom" ng-if="questionAttempt.question.ui.questionTypePosition === 0">\n      <span bb-translate>components.directives.assessment-question.ftue.matching-attempt-authoring</span>\n    </bb-guidance>\n  </div>\n</div>\n'},"/z4E":function(e,t,s){"use strict";s.d(t,"a",(function(){return m}));var n=s("Llzl"),i=s("Oyr+"),o=s("0JpG"),a=s("Vsv2"),r=s("zXZW"),c=s("pjml"),l=s("12mu"),d=s("lEL+"),u=s("DMV0"),p=s("ol3u");const m="ultra.directives.bbCloudStorageIntegration";class h{constructor(e,t,s,n,i,o,a,r){this.scope=e,this.$q=t,this.$exceptionHandler=s,this.bbLocalize=n,this.$modal=i,this.CloudDriveModel=o,this.CloudDriveTaskModel=a,this.timeout=r,this.bbLocalize.loadBundle("components/directives/cloudStorageIntegration")}getFileId(e){return e.account+"|"+e.id}onFileSelect(e){this.scope.$emit(i.d,e,this.scope.primaryKey&&this.scope.primaryKey()),this.scope.onFilesSelected&&this.scope.onFilesSelected(e)}getDownloadFileInfo(e){const t=this.getFileId(e);return this.CloudDriveModel.$new("CloudStorageIntegration").contents.$new(t).$fetch({accessToken:this.accessToken}).$asPromise()}downloadFiles(e,t,s,n){const o={accessToken:this.accessToken,expand:"mimeType,isMedia"};this.scope.fileLocation&&(o.fileLocation=this.scope.fileLocation),this.scope.webLocation&&(o.webLocation=this.scope.webLocation),(s?this.CloudDriveTaskModel.$new(n||e.id):this.CloudDriveModel.$new("CloudStorageIntegration").contents.$new(n||e.id).download).$fetch(o).$then((s=>{if("COMPLETE"===s.status){const n=this.scope.$on(i.e,((o,a,r)=>{r!==i.c.UploadProgressComplete||e.ui.fileId&&a!==e.ui.fileId||(this.attachHandler(s,e,t),n())}))}else this.timeout((()=>{this.downloadFiles(e,t,!0,s.taskId)}),this.scope,2e3);(s.completePercentage<100||"COMPLETE"===s.status)&&this.scope.$root.$broadcast(i.e,e.ui.index,s.completePercentage,null,i.c.UpdateProgress,e.inProgressFileId,e.ui.targetDiv,e.ui.fileId)}),(t=>{this.displayUploadError(),this.scope.$root.$broadcast(i.e,e.ui.fileId,e,i.c.Error,e.ui.targetDiv,this.scope.primaryKey&&this.scope.primaryKey()),this.$exceptionHandler(t,"source")}))}attachHandler(e,t,s){const n=this.$q.defer(),i={fileName:null,fileLocation:null};return e&&(i.fileName=e.fileName,i.fileLocation=e.fileLocation,i.webLocation=e.webLocation,i.mimeType=e.mimeType,i.isMedia=e.isMedia),this.scope.attachHandler(i,t,this.scope.isUploadMultipleFiles,void 0,s).then((e=>{n.resolve(e)}),(e=>{n.reject(e)})),n.promise}displayUploadError(){this.$modal.open({template:u,scope:this.scope})}}h.$inject=["scope","$q","$exceptionHandler",o.serviceName,l.b,c.h.serviceName,c.i.serviceName,d.b];class b{constructor(e,t,s,i,o){this.$injector=e,this.$q=t,this.$modal=s,this.CloudDriveService=i,this.bbLocalize=o,this.scope={attachHandler:"=",isFlatten:"=?",primaryKey:"&?",primaryKeyValue:"@?",fileLocation:"@?",webLocation:"@?",disableClick:"&?",allowMultiple:"=?",onFilesSelected:"=?",onCancelFocus:"=?"},this.restrict="A",this.link=(e,t,s)=>{const i=this;e.cloudStorageIntegration=this.$injector.instantiate(h,{scope:e}),e.folderBranchCounts=0,e.isInitialized=!!i.CloudDriveService.cloudDriveStorage,e.isInitialized||i.CloudDriveService.initializeCloudDrive();const o=function(t){const s=[];if(t&&t.length>0){for(let n=0;n<t.length;n++)s.push(e.cloudStorageIntegration.getDownloadFileInfo(t[n]));i.$q.all(s).then((t=>{i.CloudDriveService.isGettingFilesInfo=!1,e.cloudStorageIntegration.onFileSelect(t),t.length>1&&(e.isUploadMultipleFiles=!0)}),(()=>{i.CloudDriveService.isGettingFilesInfo=!1}))}};t.on("click",(()=>{if((!e.disableClick||!e.disableClick())&&e.isInitialized){const s=this.bbLocalize.getLocale(e);i.CloudDriveService.cloudDriveStorage.openFilePicker(s,e.allowMultiple).then((s=>{if((s||[]).length>0){if(!s[0]||!s[0].bearer_token||!s[0].bearer_token.key)return void this.$modal.open({template:p,scope:e});e.cloudStorageIntegration.accessToken=s[0].bearer_token.key,i.CloudDriveService.isGettingFilesInfo=!0,n.isDefined(e.allowMultiple)&&!1===e.allowMultiple&&s.length>1?o([s[0]]):o(s)}else e.onCancelFocus?e.onCancelFocus():t.focus()})),e.$on("$destroy",(()=>{i.CloudDriveService.isGettingFilesInfo=!1,t.off("click")}))}})),e.$on("downloadFile",((t,s,n)=>{s.ui.primaryKey===(e.primaryKey&&e.primaryKey())&&s.file.$url().indexOf("CloudStorageIntegration")>=0&&e.cloudStorageIntegration.downloadFiles(s,n)}))}}}b.$inject=["$injector","$q","$modal",a.b,o.serviceName],n.module(m,[o.moduleName,a.a,r.a,l.a,d.a]).directive("bbCloudStorageIntegration",["$injector",e=>e.instantiate(b)])},"0/Nk":function(e,t){e.exports='<div class="group-student-self-enroll-directive" bb-load-bundle="components/directives/group/group-student-enrollment">\n  <div ng-if="$ctrl.content.assignedGroups.length > 0">\n    <span ng-if="!$ctrl.isOpenEnrollment()" class="ellipse title">\n      {{$ctrl.content.assignedGroups[0].groupTitle}}\n    </span>\n    <a ng-if="$ctrl.isSelfEnrollment && $ctrl.isOpenEnrollment()" class="self-enroll-link js-self-enroll-link"\n       href="javascript:void(0);" ng-click="$ctrl.openContentEnrollPanel()"\n       analytics-id="components.directives.group-student-enrollment.groupTitle.link">\n      {{$ctrl.content.assignedGroups[0].groupTitle}}\n    </a>\n  </div>\n  <span ng-if="!($ctrl.content.assignedGroups.length > 0) && !$ctrl.isSelfEnrollment" class="ellipse title" bb-translate\n        translate-values="{title: components.directives.group-student-enrollment.unknown}">\n    components.directives.group-student-enrollment.unknown\n  </span>\n  <div ng-if="!($ctrl.content.assignedGroups.length > 0) && $ctrl.isSelfEnrollment">\n    <div ng-if="$ctrl.isOpenEnrollment()">\n      <a href="javascript:void(0);" ng-click="$ctrl.openContentEnrollPanel()" class="self-enroll-link js-self-enroll-link"\n         bb-translate analytics-id="components.directives.group-student-enrollment.self-enroll-to-participate">components.directives.group-student-enrollment.self-enroll-to-participate</a>\n    </div>\n    <div ng-if="$ctrl.isBeforeEnrollment()" class="self-enroll-date" translate-values="{time: $ctrl.selfEnrollGroupInfo.relativeDate}"\n         bb-translate>components.directives.group-student-enrollment.enrollment-starts</div>\n    <div ng-if="$ctrl.isOpenEnrollmentWithEnding()" class="self-enroll-date"\n         ng-class="{\'is-important\': $ctrl.selfEnrollGroupInfo.isEnrollmentDateImportant}"\n         translate-values="{time: $ctrl.selfEnrollGroupInfo.relativeDate}"\n         bb-translate>components.directives.group-student-enrollment.enrollment-closes</div>\n    <div ng-if="$ctrl.isAfterEnrollment()" class="self-enroll-date"\n         bb-translate>components.directives.group-student-enrollment.enrollment-closed</div>\n  </div>\n</div>\n'},"01PJ":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-post",use:"icon-small-post-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-post"><path d="M9 15L1 9l14-8-6 14zM5 12L15 1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M5 12v3l1.5-1.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"06yj":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("6/tG");const o="ultra.components.directives.bbUiIcon.large.DocumentCloud";Object(n.a)(i.DocumentCloud,o,"bbUiIconLargeDocumentCloud")},"07HN":function(e,t){e.exports='<div tabindex="-1" id="{{::addContentButton.getButtonWrapperId()}}">\n  <button\n    aria-expanded="{{addContentButton.isMenuVisible}}"\n    aria-label="{{addContentButton.addButtonAriaLabel}}"\n    ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n    ng-focus="addContentButton.showButton()"\n    ng-blur="addContentButton.hideButton()"\n    class="button-add-content"\n    id="{{::addContentButton.getTargetId()}}"\n    ng-click="addContentButton.toggleAddContentMenu()"\n    analytics-id="components.directives.add-content-button.grades.button"\n  >\n  </button>\n</div>\n<bb-ui-contextual-menu\n  items="addContentButton.items"\n  target-id="::addContentButton.getTargetId()"\n  show="addContentButton.isMenuVisible"\n  directional-hint="::addContentButton.getDirectionalHint()"\n  dismiss="addContentButton.hideAddContentMenu"\n  analytics-id="components.directives.add-content-button.contextualMenu"\n>\n</bb-ui-contextual-menu>'},"0BVo":function(e,t){e.exports='<bb-modal role="alertdialog" class="notification gradebook-upload-failed-modal upload-failed-button" bb-translate-attrs="{\'aria-label\': \'course.grades.grades-upload-settings.failedToUpload.title\'}" \n          modal-title-key="course.grades.grades-upload-settings.failedToUpload.title" aria-describedby="failed-to-upload"\n          analytics-id-tag-prefix="course.grades.gradesUploadSettingsFailed">\n<div name="modal-contents">\n    <p id="failed-to-upload" translate-values="{ count: failedItemsCount, errorItems: failedItems }"\n       bb-translate="course.grades.grades-upload-settings.failedToUpload.content.plural"></p>\n</div>\n  <button name="modal-footer-button-primary" \n          class="button js-discard-changes js-primary-button failed-to-upload-button" \n          ng-click="$dismiss()"\n          analytics-id="course.grades.gradesUploadSettingsFailed.closeButton.button">\n      <span bb-translate="course.grades.grades-upload-settings.closeButton"></span>\n  </button>\n</bb-modal>'},"0V7O":function(e,t){e.exports='<div class="attempt-authoring-container" bb-load-bundle="components/directives/assessment/attempt-canvas" ng-switch="::attemptCanvas.hasQuestions()">\n  \x3c!-- Add empty form to import autosave-directive.ts when there is no question content --\x3e\n  <form bb-autosave save-func="" validation-func="" novalidate ng-class="::{\'empty-form\' : !attemptCanvas.hasQuestions()}"></form>\n  \x3c!-- has questions --\x3e\n  <div ng-if="::attemptCanvas.hasQuestions()">\n    <div class="attempt-header assessment-header uneditable">\n      <h2 bb-translate="{{attemptCanvas.headerKey}}" translate-values="{\'title\': attemptCanvas.customCategory}"></h2>\n    </div>\n    <bb-assessment-page-counts\n      ng-if="attemptCanvas.showPageCountHeader"\n      total-pages="attemptCanvas.totalPagesCount"\n      current-page="attemptCanvas.currentPageCount"\n    ></bb-assessment-page-counts>\n    <div ng-if="attemptCanvas.showQuestionFilterMessage" class="no-visible-questions">\n      <bb-ui-icon-small-attention class="no-visible-questions-attention-icon"></bb-ui-icon-small-attention>\n      <span bb-translate>components.directives.attempt-canvas.no-visible-questions</span>\n    </div>\n    <ol class="question-list attempt-question-list">\n      <li ng-repeat="questionAttempt in attemptCanvas.questionAttemptView.currentVisibleQuestionAttemptsPage track by questionAttempt.id">\n        <bb-assessment-question question-attempt="questionAttempt"\n                                mode="attemptCanvas.AttemptMode()"\n                                content-id="attemptCanvas.content.id"\n                                index="$index">\n        </bb-assessment-question>\n      </li>\n    </ol>\n    <div class="freeform-response-divider"></div>\n  </div>\n\n  \x3c!-- empty state --\x3e\n  <div class="is-empty-page is-empty-fade"\n        ng-switch-when="false"\n        ng-if="!attemptCanvas.studentSubmission().rawText">\n    <div class="is-empty-wrapper">\n      <div class="is-empty-explanation">\n        <img src="./static/images/ftue/zero-state-assessment-student-addcontent.svg" alt="" />\n        <h3 class="is-empty-heading" bb-translate>components.directives.attempt-canvas.freeform-response.author.banner.submission</h3>\n        <span bb-translate>components.directives.attempt-canvas.freeform-response.author.subtext.submission</span>\n      </div>\n    </div>\n  </div>\n\n  <div class="freeform-response" ng-if="attemptCanvas.displayFreeformResponse()">\n    <ng-form name="freeform-response-form" novalidate>\n      <span class="additional-content-label" bb-translate>{{::attemptCanvas.getFreeformResponseBundleKey()}}</span>\n      <bb-freeform-response-editor\n        is-privileged="true"\n        bbml="attemptCanvas.studentSubmission()"\n        save-func="attemptCanvas.save()"\n        auto-save-context-area="{{::attemptCanvas.autoSaveContextArea}}"\n        text-editor-placeholder-key="attemptCanvas.getFreeformPlaceholderBundleKey()"\n        expand-inline-files-on-load="true"\n      >\n      </bb-freeform-response-editor>\n    </ng-form>\n  </div>\n\n  <div ng-if="attemptCanvas.isContinueVisible"\n       class="continue-to-next-page">\n    <button\n      analytics-id="components.directives.attempt-canvas.continue-to-next-page"\n      ng-click="attemptCanvas.navigateNext()"\n      class="button button--secondary"\n      bb-translate>\n      components.directives.attempt-canvas.continue-to-next-page\n    </button>\n  </div>\n\n  <div ng-if="attemptCanvas.isFilterToUnansweredVisible"\n       class="filter-to-unanswered"\n       bb-translate>\n    components.directives.attempt-canvas.filter-to-unanswered-desc\n  </div>\n  <div ng-if="attemptCanvas.isFilterToUnansweredVisible"\n       class="filter-to-unanswered filter-to-unanswered-button">\n    <button analytics-id="components.directives.attempt-canvas.filter-to-unanswered"\n            ng-click="attemptCanvas.filterToUnanswered()"\n            class="button button--secondary"\n            bb-translate>\n      components.directives.attempt-canvas.filter-to-unanswered-button\n    </button>\n  </div>\n\n</div>\n'},"0Vbm":function(e,t,s){"use strict";var n=s("D57K"),i=(s("6Fqm"),s("67oV"),s("+brj")),o=s("yC9S"),a=s("aHpC"),r=s("QzaB");s.d(t,"a",(function(){return c}));const c="ultra.components.directives.searchBox";let l=class{constructor(e,t){this.browserStorage=e,this.$element=t}$onInit(){this.localStorageKey&&this.browserStorage.getFromStorage(this.localStorageKey,i.a.LocalStorage).then((e=>{this.searchText(e)}))}searchText(e){return null!=e&&(this.onSearch({searchText:e}),this._searchText=e,this.localStorageKey&&(""===e?this.browserStorage.deleteFromStorage(this.localStorageKey,i.a.LocalStorage):this.browserStorage.saveToStorage(this.localStorageKey,e,i.a.LocalStorage))),this._searchText}clearSearchInput(){this.searchText(""),this.$element.find("input").focus()}};l=Object(n.__decorate)([Object(o.a)({moduleName:c,componentName:"bbSearchBox",template:r,bindings:{onSearch:"&",localStorageKey:"@?",placeholderKey:"@",analyticsIdTagPrefix:"@?"},requireModules:[i.b]}),Object(n.__param)(0,Object(a.b)(i.c)),Object(n.__param)(1,Object(a.b)("$element"))],l)},"0lMW":function(e,t,s){},"0rzL":function(e,t,s){"use strict";s.d(t,"a",(function(){return m}));var n=s("D57K"),i=(s("eWdw"),s("Llzl")),o=s("nbDY"),a=s.n(o),r=s("ckcj"),c=s("dJ97"),l=s("aHpC"),d=s("Bu0u"),u=s("UODz"),p=s("zGdY");const m="ultra.components.directives.submissionCard";class h extends a.a{}h.ATTEMPT=new h("ATTEMPT"),h.GRADE=new h("GRADE"),h.INFO=new h("INFO");let b=class{constructor(e){if(this.scope=e,!e.gradingColumn&&!e.gradeDetail)throw new d.a({message:"gradingColumn or gradeDetail must be provided."});if(this.scope.gradeDetail&&!this.scope.gradeDetail.column)throw new d.a({message:"gradeDetail.column must be provided to display attempt mode."});let t,s;switch(this.scope.gradeDetail&&(this.scope.gradeDetail.ui.groupAttempt||this.scope.gradeDetail.ui.attempt)&&(this.attempt=this.scope.gradeDetail.ui.groupAttempt||this.scope.gradeDetail.ui.attempt,this.currentGradeStatus=this.scope.gradeDetail.ui.attempt.status),(!e.gradeDetail||e.gradeDetail&&!this.attempt)&&e.gradingColumn?this.scope.mode=h.INFO:e.gradeDetail&&this.attempt&&(this.scope.mode=h.ATTEMPT,this.scope.gradingColumn=this.scope.gradeDetail.column),this.showLate=!e.showLate||e.showLate(),e.mode){case h.INFO:s=e.gradingColumn.dueDate?"DUE":"NO_DUE_DATE",t=this.showLate?"UNOPENED_LATE":"UNOPENED";break;case h.ATTEMPT:s=this.attempt.status.toString(),e.hasAttempt=!0,t=p.AttemptStatus.InProgress===this.attempt.status&&this.showLate?"SUBMISSION_LATE":"SUBMISSION";case h.GRADE:}e.status="components.directives.submission-card.attemptStatus."+s,e.title="components.directives.submission-card.title."+t}shouldExpandForRubricIcon(){return(this.scope.showRubricButton&&this.scope.showRubricButton()||this.scope.showRubricDiv&&this.scope.showRubricDiv())&&this.scope.gradingColumn.hasRubricAssociation&&this.scope.gradingColumn.hasRubricAssociation()}get showLateIcon(){return this.showLate&&(!this.scope.gradeDetail||!this.attempt||this.attempt.isInProgress())}};b=Object(n.__decorate)([Object(n.__param)(0,Object(l.b)("scope"))],b);let g=class{constructor(e){this.$injector=e,this.restrict="AE",this.template=u,this.scope={gradeDetail:"=?",gradingColumn:"=?",inline:"@?",clickable:"=?",showLate:"&?",showRubricButton:"&?",showRubricDiv:"&?"},this.link=e=>{e.submissionCard=this.$injector.instantiate(b,{scope:e})}}};g=Object(n.__decorate)([Object(n.__param)(0,Object(l.b)("$injector"))],g),i.module(m,[r.a,c.a]).directive("bbSubmissionCard",["$injector",e=>e.instantiate(g)])},"0wep":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("IEHd");const o="ultra.components.directives.bbUiIcon.large.Goal";Object(n.a)(i.a,o,"bbUiIconLargeGoal")},"1/hr":function(e,t,s){},"10QP":function(e,t,s){},"15AK":function(e,t,s){"use strict";s.r(t);var n=s("D57K"),i=s("Llzl"),o=s("5MwF"),a=s("pjml"),r=s("nsO7"),c=s("zGdY"),l=s("0JpG"),d=s("k9iv"),u=s("mnBQ"),p=s("DDBr"),m=s("eAnr"),h=s("TnpK"),b=s("Fvsw"),g=s("Qbdf"),v=s("bF8R"),f=s("fYJU"),w=s("12mu"),S=s("X8JP"),C=s("R4kC"),y=s("jhBu"),O=s("ZQFV"),A=s("X/qj"),I=s("o5Lu"),D=s("aHpC"),k=s("9hUw"),_=s("n0bV");let j=class{constructor(e,t,s,n,i,o,a,r,l,d,u){this.$q=e,this.ultraStateService=t,this.gradebookPermissionService=s,this.feedbackService=n,this.currentUser=i,this.isGroupAttempt=o,this.userModel=a,this.peerService=r,this.grade=l,this.attemptId=d,this.delegatedAttemptAdapter=u,this.bbml={},this.attemptGrader=null,this.onUploadSuccess=e=>{this.bbml.fileLocation=this.bbml.fileLocation||e.fileLocation,this.bbml.webLocation=this.bbml.webLocation||e.webLocation},this.feedbackTextDidChange=e=>{this.bbml.current=e.toBbML(),this.bbml.isDirty=e.isDirty},this.save=(e=!1)=>(this.bbml.forSave=this.bbml.current,this.attempt?(this.attempt.feedbackToUser||(this.attempt.feedbackToUser={rawText:""}),this.attempt.feedbackToUser.rawText=this.bbml.forSave,this.attempt.feedbackToUser.fileLocation=this.attempt.feedbackToUser.fileLocation||this.bbml.fileLocation,this.attempt.feedbackToUser.webLocation=this.attempt.feedbackToUser.webLocation||this.bbml.webLocation,this.getCurrentColumn().peerGrading&&(this.attempt.status=e?c.AttemptStatus.Completed:null),this.getCurrentColumn().delegatedGrading&&this.getCurrentColumn().isUserReconciler(this.currentUser.userId)&&(this.attempt.reconciliationMode=c.ReconciliationMode.Custom),this.attempt.$save(["feedbackToUser.rawText","feedbackToUser.fileLocation","feedbackToUser.webLocation","status","reconciliationMode"]).$asPromise().then((e=>(this.bbml.initial=e.feedbackToUser.rawText,this.bbml.isDirty=!1,this.attempt.feedbackToUser.webLocation=e.feedbackToUser.webLocation,this.attempt.feedbackToUser.fileLocation=e.feedbackToUser.fileLocation,this.attempt.overrideStatus=e.overrideStatus,this.feedbackService.refreshAfterAssessmentAttemptFeedbackSave(e.feedbackToUser,e),e.feedbackToUser)))):this._loadAttempt().then((()=>{if(this.attempt)return this.save()}))),this.getInitialBbml=()=>this.bbml.initial,this.peerService.getOrCreatePeerContentWithAttemptsFromColumn(this.getCurrentColumn()).then((e=>this.peerReviewContentObject=e))}load(){return this._loadAttempt().then((e=>this.populateFeedbackObject(e)))}populateFeedbackObject(e){const t=e&&e.getFeedbackToUser();return this.bbml.initial=t?t.rawText:"",this.bbml.current=this.bbml.current||this.bbml.initial,this.bbml.fileLocation=t&&t.fileLocation||"",this.bbml.webLocation=t&&t.webLocation||"",t||{rawText:"",fileLocation:"",webLocation:"",displayText:""}}getCurrentColumn(){const{currentColumn:e}=this.ultraStateService.getCurrentResolvedValues();return e}getCurrentCourse(){const{currentCourse:e}=this.ultraStateService.getCurrentResolvedValues();return e}fetchGroupAttempt(){return this.getCurrentCourse().gradebook.groupAttempts.$find(this.attemptId,{expand:"attempts,feedbackToUser"}).$asPromise()}fetchAttempt(){const e=this.getCurrentColumn();return this.getCurrentCourse().gradebook.attempts.$find(this.attemptId,{expand:"feedbackToUser"}).$asPromise().then((t=>{const s=this.gradebookPermissionService.canDelegatedReconcileAttempt(e),n=e.peerGrading&&t.userId===this.currentUser.userId;return s||n?this.grade.loadGrade({courseId:this.getCurrentCourse().id,column:this.getCurrentColumn(),userId:t.userId},!1).then((s=>t.isCompleted()||null!=s.manualGrade||this.getCurrentColumn().isUserReconciler(this.currentUser.userId)?e.grades.$new(t.gradeId).attempts.$new(t.id).$asPromise().then((()=>this.delegatedAttemptAdapter.loadDelegatedGradesOnAttempt({courseId:this.getCurrentCourse().id,columnId:this.getCurrentColumn().id,gradeId:t.gradeId,attemptId:t.id}))).then((e=>(t.stagedAttemptGrades=e,t))):this.$q.when(t))):t})).then((t=>{var s;return(null===(s=this.peerReviewContentObject)||void 0===s?void 0:s.canPeerReviewAttempt(e,t))?this.userModel.$find(this.currentUser.userId,{fields:"avatar,familyName,givenName"}).$asPromise().then((e=>(this.attemptGrader=e,t))):this.$q.when(t)}))}_loadAttempt(){return(this.isGroupAttempt?this.fetchGroupAttempt():this.fetchAttempt()).then((e=>this.attempt=e))}feedbackIsDirty(){return this.bbml.isDirty}canEnterFeedback(){var e;return this.attempt&&(this.gradebookPermissionService.canDelegatedEnterAttemptFeedback(this.getCurrentColumn(),this.attempt)||this.gradebookPermissionService.canDelegatedEnterAttemptGrades(this.getCurrentColumn(),this.attempt)||(null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.canPeerAddFeedbackToAttempt(this.getCurrentColumn(),this.attempt)))}canViewAttemptGrades(){return this.attempt&&this.gradebookPermissionService.canViewGrades()}getStagedAttemptGrades(){return this.attempt&&"stagedAttemptGrades"in this.attempt&&this.attempt.stagedAttemptGrades.length>0?this.attempt.stagedAttemptGrades:null}};j=Object(n.__decorate)([Object(n.__param)(0,Object(D.b)("$q")),Object(n.__param)(1,Object(D.b)(h.d)),Object(n.__param)(2,Object(D.b)(A.b)),Object(n.__param)(3,Object(D.b)(m.c)),Object(n.__param)(4,Object(D.b)(f.b)),Object(n.__param)(5,Object(D.b)("isGroupAttempt")),Object(n.__param)(6,Object(D.b)(a.Jb.serviceName)),Object(n.__param)(7,Object(D.b)(k.b)),Object(n.__param)(8,Object(D.b)(I.k)),Object(n.__param)(9,Object(D.b)("attemptId")),Object(n.__param)(10,Object(D.b)(_.b))],j);class T{constructor(e,t,s){this.ultraStateService=e,this.gradebookPermissionService=t,this.feedbackService=s,this.bbml={},this.onUploadSuccess=e=>{this.bbml.fileLocation=this.bbml.fileLocation||e.fileLocation,this.bbml.webLocation=this.bbml.webLocation||e.webLocation},this.feedbackTextDidChange=e=>{this.bbml.current=e.toBbML(),this.bbml.isDirty=e.isDirty},this.save=()=>{this.bbml.forSave=this.bbml.current||"";const{currentCourse:e}=this.ultraStateService.getCurrentResolvedValues();this.attempt.feedbackToUser||(this.attempt.feedbackToUser={rawText:""});const t=e.gradebook.attempts.$buildRaw(this.attempt);return t.feedbackToUser.rawText=this.attempt.feedbackToUser.rawText=this.bbml.forSave,t.feedbackToUser.fileLocation=this.attempt.feedbackToUser.fileLocation=this.attempt.feedbackToUser.fileLocation||this.bbml.fileLocation,t.feedbackToUser.webLocation=this.attempt.feedbackToUser.fileLocation=this.attempt.feedbackToUser.webLocation||this.bbml.webLocation,t.$save(["feedbackToUser.rawText","feedbackToUser.fileLocation","feedbackToUser.webLocation"]).$asPromise().then((e=>(this.bbml.initial=e.feedbackToUser.rawText,this.bbml.isDirty=!1,this.attempt.feedbackToUser.webLocation=e.feedbackToUser.webLocation,this.attempt.feedbackToUser.fileLocation=e.feedbackToUser.fileLocation,this.attempt.overrideStatus=e.overrideStatus,this.attempt.feedbackToUser.rawText=e.feedbackToUser.rawText,this.feedbackService.refreshAfterIndividualfeedbackSave(e),e.feedbackToUser)))},this.getInitialBbml=()=>this.bbml.initial}feedbackIsDirty(){return this.bbml.isDirty}loadSync(e){this.attempt=e;const t=e.getGroupIndividualFeedbackToUser();return this.bbml.isDirty=!1,this.bbml.initial=t&&t.rawText,this.bbml.current=this.bbml.current||this.bbml.initial,this.bbml.fileLocation=t&&t.fileLocation||"",this.bbml.webLocation=t&&t.webLocation||"",t||{rawText:"",fileLocation:"",webLocation:"",displayText:""}}canEnterFeedback(){return this.gradebookPermissionService.canEnterGrades()||this.gradebookPermissionService.canEnterFeedback()}canViewAttemptGrades(){return this.gradebookPermissionService.canViewGrades()}}T.$inject=[h.d,A.b,m.c];var $=s("yC9S"),R=s("Q/M7"),E=s("kwLz"),x=s("6fZB"),P=s("7cYF"),L=s("oVrE"),G=s("X455"),M=s("lEL+"),N=s("wtKk"),F=s("z6Q5"),B=s("IbyE"),q=s("jx5I"),z=s("fL5R"),U=s("nfhp"),V=s("Htol"),H=s("9OUN");s.d(t,"FEEDBACK_PARAMS_UPDATED",(function(){return Q})),s.d(t,"FEEDBACK_UPDATED",(function(){return K})),s.d(t,"moduleName",(function(){return W})),s.d(t,"componentName",(function(){return J})),s.d(t,"controllerName",(function(){return Y})),s.d(t,"ASSESSMENT_FEEDBACK_SAVE",(function(){return Z})),s.d(t,"ASSESSMENT_FEEDBACK_SAVED",(function(){return X})),s.d(t,"ASSESSMENT_FEEDBACK_CHANGED",(function(){return ee})),s.d(t,"assessmentFeedbackModule",(function(){return te})),s.d(t,"AssessmentFeedback",(function(){return se})),s.d(t,"AssessmentFeedbackParams",(function(){return ne})),s.d(t,"AssessmentFeedbackController",(function(){return ie})),s.d(t,"template",(function(){return oe})),s.d(t,"templateUrl",(function(){return U}));const Q="feedbackParamsUpdated",K="FeedbackUpdated",W="ultra.course.assessment.feedback",J="assessmentFeedback",Y="ultra.course.assessment.feedback",Z="assessment-feedback:save",X="assessment-feedback:saved",ee="assessment-feedback:changed",te=i.module(W,[m.a,u.a,p.a,C.a,k.a,G.a,M.a,F.a,y.a,_.a,q.a]);let se=class{constructor(e,t,s,n,i,o,a,r,c,d,u,p,m,h,b,g,v){this.$rootScope=e,this.$scope=t,this.$q=s,this.$ngRedux=n,this.$injector=i,this.timeout=o,this.localize=a,this.modalService=r,this.context=c,this.contextUser=d,this.errorModalService=u,this.ultraSubmissionListService=p,this.ultraState=m,this.peerReviewService=h,this.currentCourseMembership=b,this.entitlementService=g,this.delegatedAttemptAdapter=v,this.confirmedToClose=!1,this.tabKey=E.FeedbackPivotKey.General,this.isLoading=!1,this.isFeedbackAuthoringPayloadLoaded=!1,this.isInlineMode=!1,this.isCreateMode=()=>!this.feedbackText.getInitialBbml(),this.getFormatUsername=e=>this.localize.formatUsernameSync(e,l.ILocaleUsernameFormat.Short,this.$scope,{noWrap:!0,noEscape:!0}),this.subscribeToReduxChanges()}$onInit(){this.$scope.$on(Q,((e,t)=>{this.buildFeedbackAuthoringPayload({},!0,null==t?void 0:t.tabKey)})),this.$scope.assessmentFeedback=this,this.initializeFeedback(),this.$scope.$on("$stateChangeStart",(e=>{this.onShowCloseConfirmationModal(e)})),this.setRenderMode(),this.subscribeCancelNavigationEvents(),this.$scope.$on(Z,((e,t=!1,s=!1)=>{this.$scope.assessmentFeedback.onClickSave(t,s)})),this.$scope.$on(P.c,(()=>{const{editorIsReadOnly:e}=this.feedbackAuthoringPayload.configProps.primaryFeedbackConfigProps;e&&this.$scope.assessmentFeedback.onClickEdit(),i.element("bb-feedback-authoring div.bb-editor").first().focus()}))}subscribeToReduxChanges(){const e=this.$ngRedux.connect(null,(e=>Object(H.bindActionCreators)({refreshContentReviewStates:B.actions.contentReviewState.getContentReviewState},e)))(this);this.$scope.$on("$destroy",e)}get attemptId(){var e;return null===(e=this.ultraState.getCurrentUrlParams())||void 0===e?void 0:e.attemptId}initializeFeedback(){this.feedbackText=this.$injector.instantiate(j,{isGroupAttempt:this.isGroupSubmission(),attemptId:this.attemptId}),this.feedbackParams=this.$injector.instantiate(ne,{feedbackText:this.feedbackText,$scope:this.$scope}),this.isGroupSubmission()&&(this.feedbackTextIndividual=this.$injector.instantiate(T),this.feedbackParamsIndividual=this.$injector.instantiate(ne,{feedbackText:this.feedbackTextIndividual,$scope:this.$scope})),this.isLoading=!0,this.initialize()}hasEnterFeedbackEntitlement(e){return this.entitlementService.isEntitled(O.GradebookEntitlement.EnterFeedback,e)}setRenderMode(){const{mode:e}=this.ultraState.getCurrentUrlParams();this.isInlineMode="inline"===e}subscribeCancelNavigationEvents(){this.$scope.$on(N.a,((e,t,s)=>{"feedback"===t&&this.feedbackIsDirty()&&(s.navigationPromise=this.$q((e=>{this.resumeNavigation=e,this.showCloseConfirmationModal()})))}))}feedbackIsDirty(){var e,t,s,n,i,o,a,r;if(!this.feedbackAuthoringPayload)return!1;const{editorIsReadOnly:c}=this.feedbackAuthoringPayload.configProps.primaryFeedbackConfigProps;if(c)return!1;if(this.isGroupSubmission()){const{rawTextFeedback:l}=this.feedbackAuthoringPayload.primaryGraderFeedback;if(this.tabKey===E.FeedbackPivotKey.General)return null!=(null===(t=null===(e=this.feedbackText)||void 0===e?void 0:e.bbml)||void 0===t?void 0:t.current)&&(null===(n=null===(s=this.feedbackText)||void 0===s?void 0:s.bbml)||void 0===n?void 0:n.current)!==l&&!c;if(this.tabKey===E.FeedbackPivotKey.Individual)return null!=(null===(o=null===(i=this.feedbackTextIndividual)||void 0===i?void 0:i.bbml)||void 0===o?void 0:o.current)&&null!=l&&(null===(r=null===(a=this.feedbackTextIndividual)||void 0===a?void 0:a.bbml)||void 0===r?void 0:r.current)!==l&&!c}return!c&&this.feedbackParams.feedbackIsDirty()}onShowCloseConfirmationModal(e){this.confirmedToClose||!this.feedbackIsDirty()||this.isInlineMode||(e.preventDefault(),this.showCloseConfirmationModal())}isGroupSubmission(){return this.ultraState.getCurrentResolvedValues().currentContent.isGroupContent}initialize(){try{this.initializeContent().then((()=>{this.isLoading=!1,this.currentCourseMembership.isStudentMembership()&&!this.feedbackParams.gradeDetail||this.buildFeedbackAuthoringPayload({},!0),this.feedbackParams.gradeDetail&&this.$scope.$emit(ee,this.feedbackIsDirty(),0===this.feedbackAuthoringPayload.primaryGraderFeedback.rawTextFeedback.length)}))}catch(e){this.errorModalService.showDefaultErrorModal()}}initializeContent(){return this.feedbackParams.loadAssessmentTitle(),this.$q.all([this.feedbackParams.load(),this.feedbackParams.initializeCloudService(),this.feedbackParams.loadPeerReviewContentObject()]).then((()=>this.$q.all([this.feedbackParams.loadCourseMemberships(this.getUsersThatRequireCourseMemberships()),this.feedbackParams.loadCourseColorAndGradeDetail()])))}onClickSave(e=!1,t=!0){this.confirmedToClose=!0;const s=this.isUserPeerReviewer&&t,n=()=>this.currentFeedbackParams.save(s).then((()=>{this.$rootScope.$broadcast(K);const{courseId:t}=this.ultraState.getCurrentUrlParams(),s=this.ultraState.getCurrentResolvedValues().currentContent;return this.refreshContentReviewStates(t,s.id,!0),this.$rootScope.$broadcast(V.b,s,c.ContentReviewState.Completed),this.$scope.$emit(X),this.buildFeedbackAuthoringPayload(),this.isInlineMode?(this.resumeNavigation&&this.resumeNavigation(),void this.$scope.$emit("peer-review-submitted")):this.isGroupSubmission()?(r.isBoolean(e)&&e&&this.closePanel(),void(this.confirmedToClose=!1)):void this.closePanel()}));if(!s)return n();this.submissionModal=this.modalService.open({template:z,scope:this.$scope}),this.submissionModal.result.then(n)}onClickEdit(){this.feedbackAuthoringPayload.configProps.primaryFeedbackConfigProps.editorIsReadOnly=!1,this.triggerFeedbackAuthoringComponentReRender()}onClickCancel(){this.isGroupSubmission()||!this.isCreateMode()&&!this.isUserPeerReviewer?this.onClickCancelEditMode():this.isInlineMode?this.isUserPeerReviewer&&this.onClickSave(!1,!1):this.performClosePanel()}get currentFeedbackParams(){return this.tabKey===E.FeedbackPivotKey.General?this.feedbackParams:this.feedbackParamsIndividual}onClickCancelEditMode(){this.feedbackAuthoringPayload.primaryGraderFeedback.rawTextFeedback?this.feedbackAuthoringPayload.configProps.primaryFeedbackConfigProps.editorIsReadOnly=!0:this.feedbackAuthoringPayload.configProps.primaryFeedbackConfigProps.editorIsReadOnly=!1,this.triggerFeedbackAuthoringComponentReRender()}showCloseConfirmationModal(){this.$scope.$broadcast("show-confirmation","assessment-feedback")}closeConfirmationModalDismissed(){this.resumeNavigation=null}dontSaveAction(){if(this.isInlineMode){if(!this.isCreateMode())return this.onClickCancelEditMode(),void this.resumeNavigation();this.feedbackAuthoringPayload.primaryGraderFeedback.rawTextFeedback="",this.triggerFeedbackAuthoringComponentReRender(),this.resumeNavigation()}else this.performClosePanel()}performClosePanel(){this.confirmedToClose=!0,this.closePanel()}closePanel(){this.ultraState.leavePeekState()}onTabChange(e){if(this.feedbackIsDirty()&&this.isInlineMode)return this.resumeNavigation=()=>{this.tabKey=e,this.buildFeedbackAuthoringPayload()},void this.showCloseConfirmationModal();this.tabKey=e,this.buildFeedbackAuthoringPayload()}onFeedbackChanged(e){const{onEditorContentChanged:t}=this.currentFeedbackParams.getEditorConfig();t(e),this.$scope.$emit(ee,this.feedbackIsDirty(),0===e.toBbML().length)}onUploadSuccess(e){return this.currentFeedbackParams.feedbackText.onUploadSuccess(e)}getFeedbackConfigProps(e){const{pluginConfig:t}=e,{xsrfToken:s,courseId:n,apiBasePath:i,openCloudStorageIntegrationModal:o,fileUploadSettings:a}=t;return{configProps:{showFeedbackVisibilityToggle:this.feedbackParams.isPeerGrading()&&this.feedbackParams.isReconciler(),currentUserHasEnterFeedbackEntitlement:this.hasEnterFeedbackEntitlement(n),isPeerGrading:this.feedbackParams.isPeerGrading(),isOrganization:this.feedbackParams.isOrganization,courseColorClass:this.feedbackParams.courseColorClass,primaryFeedbackConfigProps:{editorIsReadOnly:e.isReadOnly,onClickEdit:this.onClickEdit.bind(this),onFeedbackChange:this.onFeedbackChanged.bind(this),showPeerReviewerSpecificText:this.feedbackParams.isPeerGrading()&&!this.feedbackParams.isReconciler()},editorConfigProps:{xsrfToken:s,courseId:n,apiBasePath:i,peerReviewer:this.isUserPeerReviewer,openCloudStorageIntegrationModal:()=>Object(x.a)(o()),onUploadSuccess:this.onUploadSuccess.bind(this),onClickCancel:this.onClickCancel.bind(this),onClickSave:this.onClickSave.bind(this),fileUploadSettings:a}}}}isSecondaryFeedbackLate(e){var t;if(!this.feedbackParams.isPeerGrading())return!1;if(!e.grader)return!1;return!this.feedbackParams.findCourseMembership(e.grader).isDueDateExcepted()&&(null===(t=this.feedbackParams.peerReviewContentObject)||void 0===t?void 0:t.isAfterPeerReviewDueDate(e.attemptLastGradedDate))}isPrimaryFeedbackLate(e){var t,s;return!(!this.feedbackParams.isPeerGrading()||!e)&&(!!this.currentCourseMembership.isStudentMembership()&&(this.contextUser.userId!==(null===(t=this.feedbackText.attempt)||void 0===t?void 0:t.userId)&&(!this.currentCourseMembership.isDueDateExcepted()&&(null===(s=this.feedbackParams.peerReviewContentObject)||void 0===s?void 0:s.isAfterPeerReviewDueDate(e)))))}getFeedbackTextAndAttemptDate(e,t){var s,n;let i=e,o=t;const a=(null===(s=this.feedbackParams.gradeDetail)||void 0===s?void 0:s.isGraded())||(null===(n=this.feedbackParams.gradeDetail)||void 0===n?void 0:n.isPosted());return this.isInlineMode&&this.currentCourseMembership.isStudentMembership()&&!a&&!this.isUserPeerReviewer&&(i="",o=null),{rawTextFeedback:i,attemptLastGradedDate:o}}get showPrimaryFeedback(){return!0}getFeedbackAuthoringPrimaryGraderFeedback(e){var t,s,n,i,o;if(!this.showPrimaryFeedback)return null;const{rawTextFeedback:a,attemptLastGradedDate:r}=this.getFeedbackTextAndAttemptDate(e.bbml,null===(s=null===(t=this.feedbackText)||void 0===t?void 0:t.attempt)||void 0===s?void 0:s.attemptLastGradedDate);return{primaryGraderFeedback:{rawTextFeedback:a,attemptLastGradedDate:r,isFeedbackEditable:e.isPrivileged,late:this.isPrimaryFeedbackLate(null===(i=null===(n=this.feedbackText)||void 0===n?void 0:n.attempt)||void 0===i?void 0:i.attemptLastGradedDate),grader:Object(L.a)(null===(o=this.feedbackText)||void 0===o?void 0:o.attemptGrader)}}}getFeedbackAuthoringSecondaryGradersFeedback(){return{secondaryGradersFeedback:this.getStagedAttemptGrades().map(((e,t)=>{const{rawTextFeedback:s,attemptLastGradedDate:n}=this.getFeedbackTextAndAttemptDate(e.feedbackToUser.rawText,e.grader?e.attemptLastGradedDate:null);return{rawTextFeedback:s,attemptLastGradedDate:n,id:e.stagedAttemptId,grader:Object(L.a)(e.grader),showAnonymousWhenNoUserData:!0,late:this.isSecondaryFeedbackLate(e),isFeedbackFromCurrentStudent:!1,isFeedbackVisible:e.showFeedbackToStudent,listIndex:t+1,onClickChangeVisibility:()=>{this.delegatedAttemptAdapter.toggleDelegatedGradeVisibility(e.stagedAttemptId).then((e=>{this.feedbackAuthoringPayload.secondaryGradersFeedback[t].isFeedbackVisible=e.showFeedbackToStudent,this.triggerFeedbackAuthoringComponentReRender()}))}}}))}}getUsersThatRequireCourseMemberships(){return this.getStagedAttemptGrades().filter((e=>e.grader)).map((e=>e.grader))}getStagedAttemptGrades(){const e=this.feedbackText.getStagedAttemptGrades();return this.filterStagedAttemptGrades(e)}filterStagedAttemptGrades(e){return e&&e.filter((e=>e.hasGraderFeedback))||[]}getIndividualFeedbackAuthoringProps(){let e,t,s,n,i=!1;if(this.isIndividualFeedbackAuthoringEditView()){e=this.getUserIdFromParams();const{groupId:o}=this.ultraState.getCurrentUrlParams(),a=r.find(this.ultraSubmissionListService.submissionList.rows,(e=>e.group.id===o&&!!e.group.memberships)),c=a?a.group.memberships:[],l=e?r.findIndex(c,(t=>t.userId===e)):0;e=c[l].userId,t=this.getFormatUsername(c[l].ui.user),c[l+1]&&(s=()=>{if(this.feedbackIsDirty()&&this.isInlineMode)return this.resumeNavigation=()=>{this.ultraState.search("userId",c[l+1].userId).then((()=>this.buildFeedbackAuthoringPayload()))},void this.showCloseConfirmationModal();this.ultraState.search("userId",c[l+1].userId).then((()=>this.buildFeedbackAuthoringPayload()))}),c[l-1]&&(n=()=>{if(this.feedbackIsDirty()&&this.isInlineMode)return this.resumeNavigation=()=>{this.ultraState.search("userId",c[l-1].userId).then((()=>this.buildFeedbackAuthoringPayload()))},void this.showCloseConfirmationModal();this.ultraState.search("userId",c[l-1].userId).then((()=>this.buildFeedbackAuthoringPayload()))}),i=!0}else e=this.contextUser.userId,t=this.getFormatUsername(this.contextUser.userModel);const o=this.getGroupIndividualAttempt(e);return this.feedbackParamsIndividual.loadTextSync(o),{panelTitle:t,configProps:{allowMultipleFeedbackNavigation:i,onNavigateToNextFeedback:s,onNavigateToPreviousFeedback:n}}}getGeneralFeedbackAuthoringProps(){const e=this.isGroupSubmission()&&this.isIndividualFeedbackAuthoringEditView();return{panelTitle:e||!this.isInlineMode?this.getGeneralFeedbackTitle():void 0,configProps:{allowMultipleFeedbackNavigation:e}}}getGeneralFeedbackTitle(){let e;if(this.isGroupSubmission())if(this.isIndividualFeedbackAuthoringEditView()){const{groupId:t}=this.ultraState.getCurrentUrlParams();e=r.find(this.ultraSubmissionListService.submissionList.rows,(e=>e.group.id===t)).group.title}else{e=this.ultraState.getCurrentResolvedValues().currentContent.assignedGroups[0].groupTitle}else{let t;if(this.isIndividualFeedbackAuthoringEditView()&&!this.feedbackParams.isPeerGrading()){const e=this.getUserIdFromParams();t=r.find(this.ultraSubmissionListService.submissionList.rows,(t=>t.user.id===e)).user}else t=this.contextUser.userModel;e=this.getFormatUsername(t)}return e}getFeedbackAuthoringGroupConfig(e=!1,t){if(e&&(this.tabKey=t||(this.isOpenFromGroupAttempt()?E.FeedbackPivotKey.General:E.FeedbackPivotKey.Individual),!this.isIndividualFeedbackAuthoringEditView())){const e=this.getGroupIndividualAttempt(this.contextUser.userId),t=this.feedbackParamsIndividual.loadTextSync(e),s=this.feedbackParams.feedbackText.getInitialBbml();!t||""===t||""!==s&&s||(this.tabKey=E.FeedbackPivotKey.Individual)}return{configProps:{isFeedbackForGroupSubmission:!0,onGroupTabChange:this.onTabChange.bind(this),initialSelectedTabKey:this.tabKey}}}buildFeedbackAuthoringPayload(e={},t=!1,s){let n={},i={};this.isGroupSubmission()&&(i=this.getFeedbackAuthoringGroupConfig(t,s)),n=this.tabKey===E.FeedbackPivotKey.Individual?this.getIndividualFeedbackAuthoringProps():this.getGeneralFeedbackAuthoringProps(),this.isFeedbackAuthoringPayloadLoaded=!0;const o=this.currentFeedbackParams.getEditorConfig();this.feedbackAuthoringPayload=r.merge({analyticsId:"assessment"},n,i,this.getFeedbackConfigProps(o),this.getFeedbackAuthoringPrimaryGraderFeedback(o),this.getFeedbackAuthoringSecondaryGradersFeedback(),e)}triggerFeedbackAuthoringComponentReRender(){this.feedbackAuthoringPayload=r.cloneDeep(this.feedbackAuthoringPayload)}isIndividualFeedbackAuthoringEditView(){return!!this.ultraSubmissionListService.submissionList}getGroupIndividualAttempt(e){return r.find(this.feedbackText.attempt.attempts,{userId:e})}isOpenFromGroupAttempt(){return!this.ultraSubmissionListService.submissionList||!this.getUserIdFromParams()||this.ultraState.params.groupId}getUserIdFromParams(){let e=this.ultraState.getCurrentUrlParams().userId;return r.isArray(e)&&(e=e[0]),e}get isUserPeerReviewer(){if(!this.feedbackParams.isPeerGrading())return!1;const{currentColumn:e}=this.ultraState.getCurrentResolvedValues();return this.feedbackParams.peerReviewContentObject.canPeerReviewAttempt(e,this.feedbackText.attempt)}};Object(n.__decorate)([Object(D.c)()],se.prototype,"onClickSave",null),Object(n.__decorate)([Object(D.c)()],se.prototype,"onClickEdit",null),Object(n.__decorate)([Object(D.c)()],se.prototype,"onClickCancel",null),Object(n.__decorate)([Object(D.c)()],se.prototype,"onTabChange",null),Object(n.__decorate)([Object(D.c)()],se.prototype,"onFeedbackChanged",null),se=Object(n.__decorate)([Object($.a)({module:te,componentName:J,template:U}),Object(n.__param)(0,Object(D.b)("$rootScope")),Object(n.__param)(1,Object(D.b)("$scope")),Object(n.__param)(2,Object(D.b)("$q")),Object(n.__param)(3,Object(D.b)("$ngRedux")),Object(n.__param)(4,Object(D.b)("$injector")),Object(n.__param)(5,Object(D.b)(M.b)),Object(n.__param)(6,Object(D.b)(l.serviceName)),Object(n.__param)(7,Object(D.b)(w.b)),Object(n.__param)(8,Object(D.b)(b.b)),Object(n.__param)(9,Object(D.b)(f.b)),Object(n.__param)(10,Object(D.b)(d.d)),Object(n.__param)(11,Object(D.b)(C.b)),Object(n.__param)(12,Object(D.b)(h.d)),Object(n.__param)(13,Object(D.b)(k.b)),Object(n.__param)(14,Object(D.b)(G.d)),Object(n.__param)(15,Object(D.b)(y.b)),Object(n.__param)(16,Object(D.b)(_.b))],se);let ne=class{constructor(e,t,s,n,i,a,r,l,d,u,p,m,h,b,g,v){this.$q=e,this.localize=t,this.courseModel=s,this.ultraStateService=n,this.context=i,this.feedbackText=a,this.rteCloudStorageIntegrationService=r,this.$scope=l,this.contextUser=d,this.contextCourse=u,this.peerService=p,this.contentData=m,this.currentCourseMembership=h,this.ultraSubmissionListService=b,this.batchService=g,this.fileUploadSettingsService=v,this.placeholder="",this.webLocation="",this.fileLocation="",this.getPlaceholderLocalizeKey=()=>this.canEnterFeedback()?"course.content.assessment.attempt.feedback.placeholder.privileged":this.getPlaceholderReadonlyLocalizeKey(),this.getTranslation=e=>this.localize.translate({locale:this.localize.getLocale(this.$scope),key:e}),this.loadPlaceholder=()=>{const e=this.getPlaceholderLocalizeKey();return this.getTranslation(e).then((e=>{this.placeholder=e}))},this.loadText=()=>this.feedbackText.load().then((e=>(this.bbml=e.rawText,this.webLocation=e.webLocation,this.fileLocation=e.fileLocation,this.isEditorReadOnly=!this.canEnterFeedback()||!!e.rawText,e.rawText))),this.loadTextSync=e=>{const t=this.feedbackText.loadSync(e);return this.bbml=t.rawText,this.webLocation=t.webLocation,this.fileLocation=t.fileLocation,this.isEditorReadOnly=!this.canEnterFeedback()||!!t.rawText,t.rawText},this.load=()=>{const{contentId:e}=this.ultraStateService.getCurrentUrlParams();return this.$q.all([this.getCurrentCourse(),this.loadText()]).then((([e,t])=>{this.loadPlaceholder(),this.isOrganization=e.isOrganization,this.currentCourse=e}))},this.loadCourseMemberships=e=>{var t;if(!this.isPeerGrading()||0===e.length)return this.$q.resolve(null);this.courseMemberships=null!==(t=this.ultraSubmissionListService.submissionList.memberships)&&void 0!==t?t:[];const s=this.courseMemberships.map((e=>e.userId)),n=e.filter((e=>!s.includes(e.id)));return 0===n.length?this.$q.resolve(null):this.batchService.performBatch((()=>this.$q.all(n.map((e=>this.currentCourse.users.$find(e.id,{expand:"courseRole"}).$allow([c.HttpStatus.NotFound]).$asPromise().then((e=>{e&&this.courseMemberships.push(e)})))))))},this.loadCourseColorAndGradeDetail=()=>{const{contentId:e}=this.ultraStateService.getCurrentUrlParams();return this.currentCourse?this.$q.all([this.currentCourse.users.$find(this.contextUser.userId,{expand:"courseRole"}).$allow([404]).$asPromise(),this.currentCourseMembership.isStudentMembership()&&this.contentData.loadContentAndGrades({contentId:e,course:this.currentCourse})]).then((([e,t])=>{this.courseColorClass=e.getCourseColorClass(),this.gradeDetail=null==t?void 0:t.gradeDetail})):this.$q.resolve(void 0)},this.loadAssessmentTitle=()=>{const{currentContent:e}=this.ultraStateService.getCurrentResolvedValues();return this.assessmentTitle=e.title,e.title},this.canViewAttemptGrades=()=>this.feedbackText.canViewAttemptGrades(),this.canEnterFeedback=()=>this.feedbackText.canEnterFeedback(),this.getPluginConfig=()=>{const{courseId:e}=this.ultraStateService.getCurrentUrlParams(),{xsrfToken:t}=this.context;return{courseId:e,xsrfToken:t,apiBasePath:Object(R.c)(o.a.apiBasePath),fileLocation:this.fileLocation,webLocation:this.webLocation,shouldEnableCloudStorageIntegration:this.rteCloudStorageIntegrationService.isCloudServiceAvailable,openCloudStorageIntegrationModal:this.rteCloudStorageIntegrationService.isCloudServiceAvailable?this.rteCloudStorageIntegrationService.getModalCallback(this.$scope):void 0,fileUploadSettings:this.fileUploadSettingsService.getSettings()}},this.getEditorConfig=()=>({bbml:this.bbml,isReadOnly:this.isEditorReadOnly,isPrivileged:this.canEnterFeedback(),onEditorContentChanged:this.feedbackText.feedbackTextDidChange,pluginConfig:this.getPluginConfig()}),this.save=(e=!1)=>this.feedbackText.save(e).then((e=>{this.bbml=e.rawText,this.webLocation=e.webLocation,this.fileLocation=e.fileLocation,this.isEditorReadOnly=!!e.rawText})),this.feedbackIsDirty=()=>this.feedbackText.feedbackIsDirty(),this.isReconciler=()=>{const{currentColumn:e}=this.ultraStateService.getCurrentResolvedValues();return e.isUserReconciler(this.contextUser.userId)},this.isPeerGrading=()=>{var e;return!!(null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.peerGrading)},this.findCourseMembership=e=>this.courseMemberships.find((t=>t.userId===e.id))}getPlaceholderReadonlyLocalizeKey(){const{currentColumn:e}=this.ultraStateService.getCurrentResolvedValues();return e&&e.delegatedGrading?"course.content.assessment.attempt.feedback.placeholder.reconciledReadonly":"course.content.assessment.attempt.feedback.placeholder.readonly"}getCurrentCourse(){const e=this.ultraStateService.getCurrentUrlParams().courseId;return this.courseModel.$find(e).$asPromise()}loadPeerReviewContentObject(){const{currentColumn:e}=this.ultraStateService.getCurrentResolvedValues();return this.peerService.getOrCreatePeerContentFromColumn(e).then((e=>{this.peerReviewContentObject=e}))}initializeCloudService(){return this.rteCloudStorageIntegrationService.initialize()}get currentColumn(){const{currentColumn:e}=this.ultraStateService.getCurrentResolvedValues();return e}};ne=Object(n.__decorate)([Object(n.__param)(0,Object(D.b)("$q")),Object(n.__param)(1,Object(D.b)(l.serviceName)),Object(n.__param)(2,Object(D.b)(a.m.serviceName)),Object(n.__param)(3,Object(D.b)(h.d)),Object(n.__param)(4,Object(D.b)(b.b)),Object(n.__param)(5,Object(D.b)("feedbackText")),Object(n.__param)(6,Object(D.b)(S.b)),Object(n.__param)(7,Object(D.b)("$scope")),Object(n.__param)(8,Object(D.b)(f.b)),Object(n.__param)(9,Object(D.b)(g.e)),Object(n.__param)(10,Object(D.b)(k.b)),Object(n.__param)(11,Object(D.b)(v.b)),Object(n.__param)(12,Object(D.b)(G.d)),Object(n.__param)(13,Object(D.b)(C.b)),Object(n.__param)(14,Object(D.b)(F.b)),Object(n.__param)(15,Object(D.b)(q.b))],ne);class ie{}const oe="<div>\n  <assessment-feedback></assessment-feedback>\n  <div ui-view></div>\n</div>";te.controller(Y,ie)},"1Niw":function(e,t){e.exports='<div tabindex="-1" id="{{::addContentButton.getButtonWrapperId()}}">\n  <button\n    class="button-add-content js-show-add-options"\n    aria-expanded="{{addContentButton.isMenuVisible}}"\n    ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n    aria-label="{{addContentButton.addButtonAriaLabel}}"\n    ng-focus="addContentButton.showButton()"\n    ng-blur="addContentButton.hideButton()"\n    id="{{::addContentButton.getTargetId()}}"\n    ng-click="addContentButton.toggleAddContentMenu()"\n    analytics-id="components.directives.add-content-button.editor.button">\n  </button>\n</div>\n<bb-ui-contextual-menu\n  items="::addContentButton.items"\n  target-id="::addContentButton.getTargetId()"\n  show="addContentButton.isMenuVisible"\n  directional-hint="::addContentButton.getDirectionalHint()"\n  dismiss="addContentButton.hideAddContentMenu"\n  analytics-id="components.directives.add-content-button.contextualMenu"\n>\n</bb-ui-contextual-menu>\n\x3c!--\n  The elements are kept around to trigger download actions.\n  The \'ng-hide\' class is added to prevent the buttons from interfering with AX (tab order, screen readers)\n--\x3e\n<ul class="element-list-add-menu angular-animate ng-hide">\n  <li>\n    <button type="button"\n            class="js-add-text-block"\n            ng-click="addContentButton.addTextBlock()"\n            analytics-id="components.directives.add-content-button.editor.addText.button">\n      <div>\n        <i class="icon-doc-pencil-2"></i>\n        <span bb-translate>components.directives.add-content-button.addContent</span>\n      </div>\n    </button>\n  </li>\n  <li ng-if="addContentButton.canEditUnsafeHtml">\n    <button type="button"\n            ng-click="addContentButton.addHtmlBlock()"\n            analytics-id="components.directives.add-content-button.editor.addHtml.button">\n      <div>\n        <bb-svg-icon size="small" icon="code"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.addHtml</span>\n      </div>\n    </button>\n  </li>\n  <li>\n    <bb-file-upload\n      url="/v1/files"\n      data="{}"\n      monitor-leave="true"\n      allow-multiple="true"\n      hide-transclude-during-upload="false"\n      primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n      skip-zip-file-check="true"\n      click-enabled="true"\n      disable-drag="false"\n      class="js-file-upload"\n      web-location="{{webLocation}}"\n      file-location="{{fileLocation}}"\n      target-div="{{\'#\' + fileListViewId}}"\n      disallow-folder-uploads="true"\n      is-third-party-upload="false"\n      ignored-states="::ignoredStates()">\n        <button\n          type="button"\n          class="file-upload-button"\n          ng-click="addContentButton.assignPosition()"\n          aria-label="{{addContentButton.uploadAriaLabel}}"\n          analytics-id="components.directives.add-content-button.editor.fileUpload.button">\n          <div ng-if="!addContentButton.isMobile">\n            <i class="icon-arrow-upload"></i>\n            <span bb-translate>components.directives.add-content-button.uploadFromComputer</span>\n          </div>\n          <div ng-if="addContentButton.isMobile">\n            <i class="icon-arrow-upload"></i>\n            <span bb-translate>components.directives.add-content-button.uploadFromDevice</span>\n          </div>\n        </button>\n    </bb-file-upload>\n  </li>\n  <li ng-if="addContentButton.isCloudServiceAvailable">\n    <bb-file-upload\n      allow-multiple="false"\n      monitor-leave="true"\n      target-div="{{\'#\' + fileListViewId}}"\n      hide-transclude-during-upload="false"\n      click-enabled="false"\n      primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n      skip-zip-file-check="true"\n      disable-drag="true"\n      is-third-party-upload="true"\n      third-party-download-handler="addContentButton.downloadFile"\n      ignored-states="::ignoredStates()">\n      <button\n        type="button"\n        class="js-upload-from-cloud-storage-integration"\n        ng-click="addContentButton.assignPosition()"\n        bb-cloud-storage-integration\n        primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n        attach-handler="attachHandler || addContentButton.defaultAttachHandler"\n        web-location="{{webLocation}}"\n        file-location="{{fileLocation}}"\n        allow-multiple="false"\n        on-cancel-focus="!initialUpload ? addContentButton.focusAddButton : null"\n        analytics-id="components.directives.add-content-button.editor.uploadFromCloudStorage.button">\n          <div>\n            <i class="icon-cloud"></i>\n            <span bb-translate>components.directives.add-content-button.uploadFromCloudStorage</span>\n          </div>\n        </button>\n    </bb-file-upload>\n  </li>\n  <li>\n    <button type="button"\n            ng-class="{\'disabled\': !isDocumentSaved()}"\n            class="js-browse-content-collection-block"\n            ng-click="addContentButton.browseContentCollection()"\n            analytics-id="components.directives.add-content-collection-button.editor.addText.button">\n      <div>\n        <span bb-translate>course.contentCollection.browseContentCollection</span>\n      </div>\n    </button>\n  </li>\n</ul>\n'},"1jPR":function(e,t){e.exports='\x3c!-- Goals--\x3e\n<div class="goal" ng-class="{\'goal-peek\': !openPeekPanel}">\n  <div class="row hide-for-small" ng-if="!openPeekPanel">\n    <div class="goal-panel">\n      <div class="goal-white-icon" >\n        <bb-svg-icon size="medium" icon="goal" bb-translate-attrs="{\'aria-label\': \'course.goal-alignment.goal.sr-only.goalImage\'}"></bb-svg-icon>\n      </div>\n      <div class="goal-head">\n        <h3 tabindex="-1" class="goal-title" bb-translate>course.goal-alignment.goal.header</h3>\n      </div>\n      <button class="button super-clear icon"\n              ng-click="hideGoals()"\n              analytics-id="course.goalAlignment.goal.closeGoals.button">\n        <i class="icon-times-bold"></i>\n        <span class="sr-only" bb-translate>course.goal-alignment.goal.sr-only.closeGoals</span>\n      </button>\n    </div>\n  </div>\n  <div class="goal-content-container">\n    <div class="row add-goal" ng-if="canAlignGoals() && !isCourseComplete()">\n      <a href="javascript:void(0);"\n         bb-focus="shouldFocus({elementId: \'add-goals\'})"\n         tabindex="0"\n         class="button button--dashed -full-width"\n         ng-if="!isMobile"\n         ng-click="addGoals()"\n         bb-translate\n         analytics-id="course.goal-alignment.goal.addGoalsButton">\n        course.goal-alignment.goal.addGoalsButton\n      </a>\n    </div>\n\n    <div class="goal-alignable-content"\n      ng-repeat="(contentIndex, content) in contents track by content.getContentIdForGoalAlignment()"\n      ng-class="[\'goal-aligned-content-\'+$index]"\n      ng-if="content.alignedGoals.length > 0">\n\n      <h3 class="goal-aligned-label"  ng-class="{\'goal-stu\': !(canAlignGoals() && !isCourseComplete())}">\n        <span>{{content.getContentTitleForGoalAlignment()}}</span>\n        <span bb-translate translate-values="{length: content.alignedGoals.length}">course.goal-alignment.goal.alignedGoalsLength</span>\n      </h3>\n\n      <ul class="goal-ul">\n        <li class="row goal-list" id="goal-{{::alignedGoal.goalId}}"\n            ng-repeat="alignedGoal in content.alignedGoals | orderBy: [\'(alignedGoal.content || content).getContentTitleForGoalAlignment()\', \'goal.goalTitle\', \'goal.goalText\'] track by (alignedGoal.goalId + (alignedGoal.content || content).getContentIdForGoalAlignment())">\n\n          <div class="columns small-12 single-goal"\n            ng-class="{\n              \'is-compacted\': !(alignedGoal.isShowDetails = alignedGoal.isShowDetails === undefined ? false:alignedGoal.isShowDetails),\n              \'goal-specific\': !(canAlignGoals() && !isCourseComplete())\n            }">\n            <div class="goal-icon">\n              <bb-ui-icon-large-goal color="primary" bb-translate-attrs="{\'aria-label\': \'course.goal-alignment.goal.sr-only.goalImage\'}"></bb-ui-icon-large-goal>\n            </div>\n            <div class="goal-description goal-details" ng-class="{\'goal-specific\': !(canAlignGoals() && !isCourseComplete())}">\n              <span class="goal-type js-goal-title" ng-class="{\'ellipse\':!alignedGoal.isShowDetails}">{{alignedGoal.goal.goalTitle}}</span>\n              <div class="goal-content-title" ng-class="{\'ellipse\':!alignedGoal.isShowDetails}" ng-bind="(alignedGoal.content || content).getContentTitleForGoalAlignment()"></div>\n              <span class="goal-content" ng-class="{\'ellipse\':!alignedGoal.isShowDetails}">{{alignedGoal.goal.goalText}}</span>\n              <div class="goal-category" ng-show="alignedGoal.isShowDetails">\n                <span class="goal-type" bb-translate>course.goal-alignment.goal.setAndCategory</span>\n                <span class="goal-category-title vertical-bar js-goal-set">{{alignedGoal.goal.goalSetTitle}}</span>\n                <span class="goal-category-title js-goal-category">{{alignedGoal.goal.goalCategoryTitle}}</span>\n              </div>\n              <button role="button"\n                      class="button anchor js-show-details"\n                      ng-click="alignedGoal.isShowDetails=!alignedGoal.isShowDetails"\n                      analytics-id="course.goalAlignment.goal.showDetails.button">\n                <span bb-translate ng-if="alignedGoal.isShowDetails" translate-attrs-values="{goalName: alignedGoal.goal.goalTitle}" bb-translate-attrs="{\'aria-label\': \'course.goal-alignment.goal.sr-only.showLess\'}">course.goal-alignment.goal.showLess</span>\n                <span bb-translate ng-if="!alignedGoal.isShowDetails" translate-attrs-values="{goalName: alignedGoal.goal.goalTitle}" bb-translate-attrs="{\'aria-label\': \'course.goal-alignment.goal.sr-only.showMore\'}">course.goal-alignment.goal.showMore</span>\n              </button>\n            </div>\n          </div>\n          <div bb-foundation-defer>\n            <bb-overflow-menu element-id="{{ generateControlId((alignedGoal.content || content), alignedGoal) + \'-\' + contentIndex }}"\n                              element-name="{{alignedGoal.goal.goalTitle}}"\n                              is-single-mode="true"\n                              menu-items="getOverflowMenuItems(content, alignedGoal)"\n                              analytics-id-tag-prefix="course.goal-alignment.goal.overflowMenu">\n            </bb-overflow-menu>\n          </div>\n        </li>\n      </ul>\n    </div>\n  </div>\n</div>\n'},"217T":function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="course.content.assessment.groupAlreadySubmitted.title"\n          analytics-id-tag-prefix="course.content.assessment.groupAlreadySubmitted">\n    <div name="modal-contents">\n        <p bb-translate>course.content.assessment.groupAlreadySubmitted.description</p>\n    </div>\n    <button name="modal-footer-button-primary" role="button" class="button js-primary-button" ng-click="$parent.$dismiss()"\n            bb-translate-attrs="{\'aria-label\':\'course.content.assessment.groupAlreadySubmitted.ok\'}" analytics-id="course.content.assessment.groupAlreadySubmitted.ok">\n      <bb-translate>course.content.assessment.groupAlreadySubmitted.ok</bb-translate>\n    </button>\n</bb-modal>\n'},"2E9T":function(e,t){e.exports='<bb-svg-icon size="small" icon="add" class="js-add-plus add-circle-default"></bb-svg-icon>\n<bb-svg-icon size="small" icon="add" status="active" class="js-add-plus add-circle-active"></bb-svg-icon>'},"2Kra":function(e,t){e.exports='<span ng-switch="$ctrl.iconName" class="slider-tab-item-icon-span">\n  <bb-ui-icon-medium-safe-assign ng-switch-when="safe-assign"></bb-ui-icon-medium-safe-assign>\n  <bb-svg-icon ng-switch-default size="medium" icon="{{$ctrl.iconName}}"></bb-svg-icon>\n</span>\n'},"2MQt":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-check-circle",use:"icon-medium-check-circle-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-check-circle"><circle cx="12" cy="12" r="11" stroke-width="2" /><path d="M7 12l4 4 7-8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"2a+M":function(e,t,s){"use strict";(function(e){s.d(t,"c",(function(){return a})),s.d(t,"d",(function(){return r})),s.d(t,"b",(function(){return c})),s.d(t,"a",(function(){return l}));var n=s("nsO7"),i=s("Llzl"),o=s("0JpG");const a="ultra.services.dragDrop",r="dragDropService";var c;!function(e){e.Top="TOP",e.Bottom="BOTTOM",e.Folder="FOLDER",e.Self="SELF"}(c||(c={}));class l{constructor(e,t){this.$timeout=e,this.bbLocalize=t,this.dragHoverClass="dz-drag-hover",this.dragElementSelector=".drag-element",this.onFolderClass="on-folder",this.onNestedFolderClass="on-nested-folder",this.originalElementClass="drag-element-original",this.movableElementClass="drag-element-movable",this.queuedScreenReaderMessages="",this.bbLocalize.loadBundle("components/services/drag-drop").then((()=>{this.folderDepthMessageKey="components.services.drag-drop.folderDepthMessage"}))}createDropPlaceholderElement(t){this.dropPlaceholderElement=e('<div class="dragdropplaceholder js-no-file-drop" style="height: '+t.height()+"px; width: "+t.width()+'px"></div>')}setDropTarget(e){this.lastDropTargetId=this.currentDropTargetId,this.currentDropTargetId=e}clearDropTarget(){this.setDropTarget(void 0)}isCurrentDropTarget(e){return this.currentDropTargetId===e}isNotSameDropTarget(){return this.currentDropTargetId!==this.lastDropTargetId}scrollDragDropItemsContainer(e,t){const s=this._getScrollingContainerElement();if(s){const n=e<l.SCROLLING_CONSTANTS.scrollZoneHeight,i=e>s.height()-l.SCROLLING_CONSTANTS.scrollZoneHeight,o=s.scrollTop();n?s.scrollTop(o-t):i&&s.scrollTop(o+t)}}_getScrollingContainerElement(){const e=l.SCROLL_CONTAINERS_SELECTORS.map((e=>this.originalElement.closest(e)));return n.find(e,(e=>this._elementHasScrollbar(e)))}_elementHasScrollbar(e){return e.get(0).scrollHeight>e.innerHeight()}}l.SCROLLING_CONSTANTS={scrollZoneHeight:200,mouseInteractionDistanceToScroll:30,keyboardInteractionDistanceToScroll:200},l.SCROLL_CONTAINERS_SELECTORS=[".panel-wrap",".panel-content"],l.$inject=["$timeout",o.serviceName];i.module(a,[o.moduleName]).service(r,l)}).call(this,s("71td"))},"2bSy":function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var n=s("Llzl"),i=s("LN5R"),o=s("dF44"),a=s("qH3X"),r=s("KeOq");const c="ultra.components.directives.gradeGridColumnHeaderStudentReborn";class l{constructor(e,t,s,n){this.scope=e,this.element=t,this.attrs=s,this.gradeGridRebornController=n,e.studentsTotal=n.getRowCount(),e.$on(o.b.CELL_FOCUSED,(()=>{t.find(".content").focus()}));[a.a.GRADEBOOK_CLEAR_SEARCHBOX_SELECTION,a.a.ADVANCED_FILTERS_ROWS,o.b.ROW].forEach((t=>{e.$on(t,(()=>{this.scope.studentsTotal=n.getRowCount()}))})),e.$on(a.a.GRADEBOOK_USER_SELECTED,(()=>{this.scope.studentsTotal=1}))}}l.$inject=["scope","element","attrs","gradeGridRebornController"];class d{constructor(e){this.$injector=e,this.restrict="E",this.template=r,this.scope=!0,this.require=`^${i.a}`,this.link=(e,t,s,n)=>{e.gradeGridColumnHeaderStudentReborn=this.$injector.instantiate(l,{scope:e,element:t,attrs:s,gradeGridRebornController:n})}}}d.$inject=["$injector"],n.module(c,[]).directive("bbGradeGridColumnHeaderStudentReborn",["$injector",e=>e.instantiate(d)])},"2i58":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-content-market",use:"icon-small-content-market-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-content-market"><path d="M2 2h13l-1 8H4" stroke-width="2" stroke-linejoin="round" /><circle cx="13" cy="14" r="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="4" cy="14" r="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M3 6h11.5M7 2v8M11 2v8M1 1h1l2 12h9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"2lxm":function(e,t,s){"use strict";s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return d}));var n=s("D57K"),i=s("Llzl"),o=s("pjml"),a=s("aHpC"),r=s("IbyE"),c=s("9OUN");const l="ultra.service.gradable-item-user-option",d="gradableItemUserOptionService";let u=class{constructor(e,t,s){this.$rootScope=e,this.$q=t,this.$ngRedux=s,this.subscribeToRedux()}subscribeToRedux(){const e=this.$ngRedux.connect(null,(e=>Object(c.bindActionCreators)({persistGradableItemUserOption:r.actions.gradableItemUserOption.persistGradableItemUserOption,deleteGradableItemUserOption:r.actions.gradableItemUserOption.deleteGradableItemUserOption,fetchGradableItemUserOption:r.actions.gradableItemUserOption.fetchGradableItemUserOption,fetchGradableItemUserOptionCount:r.actions.gradableItemUserOption.fetchGradableItemUserOptionCount,fetchGradableItemUserOptionExceptions:r.actions.gradableItemUserOption.fetchGradableItemUserOptionExceptions},e)))(this);this.$rootScope.$on("$destroy",e)}updateGradableItemUserOption(e,t){return this.$q.when(this.persistGradableItemUserOption(e,t)).then((e=>e.item))}removeGradableItemUserOption(e){return this.$q.when(this.deleteGradableItemUserOption(e)).then((e=>e))}getGradableItemUserOption(e,t,s){const n={courseId:e,columnId:t},i={membershipIds:s};return this.$q.resolve(this.fetchGradableItemUserOption(n,i))}getGradableItemUserOptionExceptions(e,t,s){const n={courseId:e,membershipId:t},i={columnId:s};return this.$q.resolve(this.fetchGradableItemUserOptionExceptions(n,i))}getGradableItemUserOptionCount(e,t){const s={courseId:e,columnId:t};return this.$q.resolve(this.fetchGradableItemUserOptionCount(s,{}))}getGradableItemUserOptionByMembershipId(e,t){return r.select.gradableItemUserOption.getGradableItemUserOptionByColumnAndMembershipId(this.$ngRedux.getState(),e,t)}getGradableItemUserOptionByUserId(e,t,s){var n;const i=null===(n=r.select.courseMembership.getCourseMembershipsByUserIds(this.$ngRedux.getState(),t,[s])[0])||void 0===n?void 0:n.id;return r.select.gradableItemUserOption.getGradableItemUserOptionByColumnAndMembershipId(this.$ngRedux.getState(),e,i)}};u=Object(n.__decorate)([Object(n.__param)(0,Object(a.b)("$rootScope")),Object(n.__param)(1,Object(a.b)("$q")),Object(n.__param)(2,Object(a.b)("$ngRedux"))],u);i.module(l,[o.N]).service(d,u)},"2o5C":function(e,t,s){"use strict";s.d(t,"e",(function(){return I})),s.d(t,"d",(function(){return D})),s.d(t,"c",(function(){return k})),s.d(t,"b",(function(){return _})),s.d(t,"a",(function(){return j}));var n=s("D57K"),i=s("Llzl"),o=s("aHpC"),a=s("8W6D"),r=s("Sa5G"),c=s("tka7"),l=s("oi1r"),d=s("P2dS"),u=s("+4Px"),p=s("0JpG"),m=s("lEL+"),h=s("TnpK"),b=s("JNtI"),g=s("MoIS"),v=s("jhBu"),f=s("X/qj"),w=s("Fvsw"),S=s("r6lH"),C=s("o5Lu"),y=s("nmzr"),O=s("cR84"),A=s("zGdY");const I="ultra.features.course.grades.gradesSettings.controller",D="update-telemetry-settings",k="bb-update-grade-settings-overall-grade",_="refresh-after-update-settings";let j=class e{constructor(e,t,s,n,o,c,l,d,u,p,m,h,b,g,v,f){this.$scope=e,this.$rootScope=t,this.$q=s,this.course=n,this.$modal=o,this.localizeService=c,this.timeout=l,this.GradeNotationModel=d,this.ultraState=u,this.schemaService=p,this.categoryService=m,this.gradebookPermissionService=h,this.entitlementService=b,this.context=g,this.telemetry=v,this.grade=f,this.isShowSettingPage=!0,this.isSchemaTitleEditable=!1,this.notations=[],this.isCodeValidate=!0,this.hasTelemetryData=!1,this.showAddNewCategory=!1,this.newCategoryName="",this.isInputBluredByCancelAdd=!1,this.isInputBlurredByCancelButton=!1,this.currentEditedCategory=null,this.focusNotationEventName="add-notation-button-focus",this.isPastZeroAssigned=!0,e.gradesSettings=this,this.courseId=this.ultraState.nextParams.courseId,this.hasGradebookModifyAccess=this.gradebookPermissionService.canModify(),this.hasContentDeleteAccess=this.entitlementService.isEntitled(r.e.DeleteContent,this.courseId),this.hasContentModifyAccess=this.entitlementService.isEntitled(r.e.ModifyContent,this.courseId),this.hasContentCreateAccess=this.entitlementService.isEntitled(r.e.CreateContent,this.courseId),this.canViewTelemetrySettingsUI=this.hasContentDeleteAccess&&this.hasContentModifyAccess&&this.hasContentCreateAccess,n&&(p.loadSchemas(n).then((e=>{e.forEach((e=>{e.localizableTitle&&(e.ui.displayTitle=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.$scope),key:e.ui.displayTitleKey}))})),this.schemas=e.filter((e=>e.scaleType===A.SchemaScaleType.Tabular))})),n.gradebook.settings.$resolve().$then((e=>{this.gradebookSettings=e,this.isPastZeroAssigned=e.countUnsubmittedWorkAsZero,this.isPastZeroCompleted=this.course.isComplete()})),this.categoryService.getOrLoadCategoriesForCourse(n.id,!0).then((e=>{this.categories=e})),n.gradebook.performancecodes.$refresh().$then((e=>{e.forEach((e=>{const t={model:e,id:this.generateNotationId(),isEditing:!1,code:e.code,description:e.description};this.notations.push(t)})),this.notations.permissions=e.permissions})),this.loadOverallGradeColumn(f),this.loadTelemetrySettings(n),this.$scope.$on(D,((e,t)=>{this.studentFailingThreshold=t.studentFailingThreshold,this.studentAbsentThreshold=t.studentAbsentThreshold,this.studentAlertsEnabled=t.studentAlertsEnabled})),this.$scope.$on(k,((e,t,s)=>{this.hasOverallGradeColumn=s,this.overallGradeColumnId=t}))),this.validationManager={isEmpty:e=>!e,isNotationNumberOnly:e=>!Number.isNaN(Number(e)),isNotationExist:e=>this.notations.some((t=>t!==e&&t.code===e.code)),isNotationSchemaDuplicate:e=>this.schemas[0].symbols.some((t=>t.symbol===e.code)),isCategoryDuplicate:(e,t)=>this.categories.some((s=>{if(s===t)return!1;let n=s.localizableTitle.languageKey;return s.isUserDefined||(n=n.substr(0,n.indexOf("."))),n.toLocaleLowerCase()===e.toLocaleLowerCase()})),execute:(e,...t)=>{const s=this.validationManager;return s[e]&&s[e].apply(s,[].slice.call(t,0))}},this.validationManager.execute(),this.entitlementService.hasCourseEntitlement(r.k.CreateRubrics,this.courseId).then((t=>{e.hasRubricCreateAccess=t})),this.context.getSystemInfo().$asPromise().then((e=>{e.telemetryEnabled&&(this.hasTelemetryData=!0)})),e.$on("$stateChangeStart",((t,s,n,i,o)=>{if(i.name.endsWith(y.GradeRoutes.GRADE_SETTING)&&!s.name.endsWith(y.GradeRoutes.GRADE_SETTING)&&e.gradesSettings.saveTelemetrySettings(),i.name===s.name||e.gradeSchemasPanelForm&&(!e.gradeSchemasPanelForm||e.gradeSchemasPanelForm.$dirty)){if(s.name.indexOf("rubric.mode")>1&&a.a.COPY.isEqualTo(a.a.parse(n.mode)))return!0;t.preventDefault()}else this.leaveEditMode(this.activeNotation,"confirm")})),e.$watch("gradeSchemasPanelForm.$dirty",(()=>{this.isShowSettingPage||(e.gradeSchemasPanelForm&&e.gradeSchemasPanelForm.$dirty?(i.element(".bb-offcanvas-panel.peek .bb-close").hide(),i.element(".bb-offcanvas-panel.peek .panel-wrap").addClass("has-footer")):(i.element(".bb-offcanvas-panel.peek .bb-close").show(),i.element(".bb-offcanvas-panel.peek .panel-wrap").removeClass("has-footer")))}))}loadOverallGradeColumn(e){e.loadColumns(this.courseId,!0).then((e=>{const t=e.find((e=>e.externalGrade));t&&!this.overallGradeColumnId?(this.hasOverallGradeColumn=!0,this.overallGradeColumnId=t.id):this.hasOverallGradeColumn=!1}))}loadTelemetrySettings(t){t.preferences.getPreference(e.INITIAL_FAILING_PREF_ARGS).then((e=>{this.studentFailingThreshold=e.value&&!Number.isNaN(Number(e.value))?Number(e.value):void 0})),t.preferences.getPreference(e.INITIAL_ABSENT_PREF_ARGS).then((t=>{null==t.value?this.studentAbsentThreshold=e.STUDENT_ABSENT_DEFAULT:0===Number(t.value)||Number.isNaN(Number(t.value))?this.studentAbsentThreshold=void 0:this.studentAbsentThreshold=Number(t.value)})),t.preferences.getPreference(e.INITIAL_ENABLE_PREF_ARGS).then((e=>{this.studentAlertsEnabled=e.value}))}set postOption(e){this.gradebookSettings.promptUserToPostWhenDone="true"===e}get postOption(){return this.gradebookSettings&&this.gradebookSettings.promptUserToPostWhenDone?"true":"false"}switchView(e,t){this.isShowSettingPage=e,t&&(this.currentViewSchema=t,this.originCurrentViewSchema=i.copy(this.currentViewSchema))}goToTelemetryView(){this.ultraState.goPeekState(y.TelemetryRoutes.INSTRUCTOR_CLASS)}toggleSchemaTitleEditable(){this.course.isComplete()||(!this.isSchemaTitleEditable||this.currentViewSchema.title&&this.currentViewSchema.title.length>0)&&(this.isSchemaTitleEditable?this.currentViewSchema.ui.displayTitle=this.currentViewSchema.title:this.currentViewSchema.localizableTitle?this.currentViewSchema.title=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.$scope),key:this.originCurrentViewSchema.ui.displayTitleKey}):this.currentViewSchema.title=this.originCurrentViewSchema.ui.displayTitle,this.isSchemaTitleEditable=!this.isSchemaTitleEditable)}adjustLowerBound(e,t){if(t<this.currentViewSchema.symbols.length-1){const s=this.currentViewSchema.symbols[t+1];s.upperBound=e.lowerBound,s.absoluteTranslation=(s.lowerBound+s.upperBound)/2}e.absoluteTranslation=(e.lowerBound+e.upperBound)/2}isValidSymbolStr(e){let t=0;for(let s=0;s<this.currentViewSchema.symbols.length;s++)this.currentViewSchema.symbols[s].symbol===e.symbol&&t++;return 1===t}addSymbol(e,t){if(!(t<this.currentViewSchema.symbols.length-1))throw new Error("Can not add a symbol to the last symbol in the array.");{const s=this.currentViewSchema.symbols[t+1],n=(s.lowerBound+s.upperBound)/2;this.currentViewSchema.symbols.splice(t+1,0,{schemaId:e.schemaId,lowerBound:n,upperBound:s.upperBound,absoluteTranslation:(n+s.upperBound)/2,symbol:void 0}),s.upperBound=n,s.absoluteTranslation=(s.lowerBound+s.upperBound)/2,this.currentViewSchema.symbols[t+2]=s,this.timeout((()=>{this.$scope.$broadcast("bb-grades-schema-symbol-change",{action:"add",index:t+1})}),this.$scope)}}deleteSymbol(e,t){if(!(t!==this.currentViewSchema.symbols.length-1&&this.currentViewSchema.symbols.length>2))throw new Error("Can not delete the two last symbols in the array.");{const s=this.currentViewSchema.symbols[t+1];s.upperBound=e.upperBound,s.absoluteTranslation=(s.lowerBound+s.upperBound)/2,this.currentViewSchema.symbols.splice(t,1),this.timeout((()=>{this.$scope.$broadcast("bb-grades-schema-symbol-change",{action:"delete",index:t})}),this.$scope)}}validate(){var e;return null===(e=this.$scope.gradeSchemasPanelForm)||void 0===e?void 0:e.$valid}cancel(){i.copy(this.originCurrentViewSchema.symbols,this.currentViewSchema.symbols),this.currentViewSchema.title=this.originCurrentViewSchema.title,this.currentViewSchema.localizableTitle?this.currentViewSchema.ui.displayTitle=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.$scope),key:this.originCurrentViewSchema.ui.displayTitleKey}):this.currentViewSchema.ui.displayTitle=this.originCurrentViewSchema.ui.displayTitle,this.$scope.gradeSchemasPanelForm.$setPristine()}save(){this.currentViewSchema.$patch().$then((e=>{this.$rootScope.$broadcast("bb-grades-schema-save",e),this.originCurrentViewSchema=i.copy(this.currentViewSchema),this.originCurrentViewSchema.title=this.currentViewSchema.title,this.$scope.gradeSchemasPanelForm.$setPristine()}))}validateTelemetrySettings(){var e;return null===(e=this.$scope.telemetrySettingsForm)||void 0===e?void 0:e.$valid}saveTelemetrySettings(){if(!this.course||!this.canViewTelemetrySettingsUI)return this.$q.when(!0);const t={key:e.STUDENT_FAILING_PREFERENCE_KEY,value:this.studentFailingThreshold,visibleToStudents:!0},s={key:e.STUDENT_ABSENT_PREFERENCE_KEY,value:this.studentAbsentThreshold?this.studentAbsentThreshold:e.DISABLE_ABSENT_NOTICES,visibleToStudents:!0},n={key:e.STUDENT_ALERTS_ENABLED,value:this.studentAlertsEnabled,visibleToStudents:!0};return null!=this.studentFailingThreshold?this.$q.all([this.course.preferences.setPreference(t),this.course.preferences.setPreference(s),this.course.preferences.setPreference(n)]):this.$q.all([this.course.preferences.deletePreference(e.STUDENT_FAILING_PREFERENCE_KEY),this.course.preferences.setPreference(s),this.course.preferences.setPreference(n)])}getCourseColor(){return this.$scope.course.courseColorClass}addNewCategory(){this.currentEditedCategory&&this.cancelEditCategory(this.currentEditedCategory),this.isInputBluredByCancelAdd=!1,this.showAddNewCategory=!0,this.timeout((()=>{i.element("#add-new-category-input").on("keydown",(e=>{e.keyCode!==u.u||e.shiftKey||(this.isInputBluredByCancelAdd=!0)}));const e=i.element("#cancel-add-category-button");e.on("mousedown",(()=>{this.isInputBluredByCancelAdd=!0})),e.on("keydown",(e=>{e.keyCode===u.u&&e.shiftKey?this.isInputBluredByCancelAdd=!1:e.keyCode===u.u&&(this.isInputBluredByCancelAdd=!1,this.validateAndAddCategory())}))}),this.$scope,0,!1)}cancelAddNewCategory(){this.newCategoryName="",this.showAddNewCategory=!1,this.clearValidationForAddCategory()}editCategory(e){this.showAddNewCategory&&this.cancelAddNewCategory(),this.currentEditedCategory&&this.cancelEditCategory(this.currentEditedCategory),this.switchEditMode(e,!0),e.isUserDefined&&this.timeout((()=>{i.element("#cancel-update-category-button-"+e.id).on("mousedown",(()=>{this.isInputBlurredByCancelButton=!0}))}),this.$scope)}cancelEditCategory(e){this.switchEditMode(e,!1),this.clearValidationForUpdateCategory(e)}switchEditMode(e,t){this.timeout((()=>{this.isInputBlurredByCancelButton=!t,this.currentEditedCategory=t?e:null,this.newCategoryName=t?e.localizableTitle.languageKey:"",e.ui.isEditMode=t}),this.$scope),t&&this.timeout((()=>{this.addEventHandlerForEditCategory(e)}),this.$scope)}validateCategory(e,t){const s=this.validationManager,n=s.execute("isEmpty",this.newCategoryName),i=!n&&s.execute("isCategoryDuplicate",this.newCategoryName,t),o=t?t.ui.form[e+t.id]:this.$scope.addCategoryForm[e];return o&&(n||i)&&(o.$setValidity("required",!n),o.$setValidity("nameDuplicate",!i),o.$setDirty()),!n&&!i}createCategory(){this.isInputBluredByCancelAdd||this.course.gradebook.categories.$create({title:this.newCategoryName}).$then((e=>{const t=this.categories.length;if(t>0){this.categoryService.reorderCategories(this.categories,t-1),this.cancelAddNewCategory();const s=this.$scope.addCategoryForm["add-new-category-input"];s&&s.$setPristine(),this.categoryService.updateCategoriesForCourse(this.course.id,e),e.permissions={delete:!0,edit:!0},this.timeout((()=>{this.addEventHandlerForEditCategory(e)}),this.$scope)}}))}addEventHandlerForEditCategory(e){i.element("#update-category-input-"+e.id).on("keydown",(e=>{e.keyCode!==u.u||e.shiftKey||(this.isInputBlurredByCancelButton=!0)}));const t=i.element("#cancel-update-category-button-"+e.id);t.on("mousedown",(e=>{this.isInputBlurredByCancelButton=!0})),t.on("keydown",(t=>{t.keyCode===u.u&&t.shiftKey?this.isInputBlurredByCancelButton=!1:t.keyCode===u.u&&(this.isInputBlurredByCancelButton=!1,this.validateAndUpdateCategory(e))}))}deleteCategory(e){const t=this.categories[e];this.categories[e].$destroy().$allow(["400"]).$asPromise().then((e=>{e&&e.$response&&e.$response.data&&400===e.$response.data.status?this.$modal.open({template:O,scope:this.$scope,resolve:{translations:[p.serviceName,e=>e.loadBundle("features/course/grades/course-grades")]}}):this.categoryService.deleteCategoriesForCourse(this.course.id,t)}))}updateCategory(e){this.isInputBlurredByCancelButton||(e.localizableTitle.languageKey=this.newCategoryName,e.title=e.localizableTitle.languageKey,e.$save(["title"]).$then((()=>{this.switchEditMode(e,!1),this.categoryService.updateCategoriesForCourse(this.course.id,e)})))}getCategoryIcon(e){return this.categoryService.getCategoryIcon(e)}validateAndAddCategory(){this.validateCategory("add-new-category-input")&&this.createCategory()}validateAndUpdateCategory(e){this.validateCategory("update-category-input-",e)&&this.updateCategory(e)}getCategoryMaxLength(){return 64}getCategoryMaxLengthDiff(){const e=this.$scope.addCategoryForm["add-new-category-input"].$error;return e&&e.maxlength?e.maxlength.diff:0}getCategoryMaxLengthDiffUpdate(e){const t=e.ui.form["update-category-input-"+e.id].$error;return t&&t.maxlength?t.maxlength.diff:0}showOptionsForCategory(e){return e.title!==A.KnownGradebookCategoryTitle.Attendance&&(!e.permissions||(e.permissions.delete||e.permissions.edit))}getCategoryOverflowMenu(e){const t=[];return e.permissions&&e.permissions.edit&&t.push({icon:"draw",onClick:()=>{this.editCategory(e)},labelKey:"global.edit"}),e.permissions&&e.permissions.delete&&t.push({icon:"trash",onClick:()=>{this.deleteCategory(this.categories.indexOf(e))},confirmationOptions:{lazyLoadTitleKeyAndInstructionsKey:()=>this.$q.when(b.a("x-bb-category-delete"))},labelKey:"global.delete"}),t}clearValidationForAddCategory(){const e=this.$scope.addCategoryForm["add-new-category-input"];e&&(e.$setValidity("required",!0),e.$setValidity("nameDuplicate",!0),e.$setPristine())}clearValidationForUpdateCategory(e){const t=e.ui.form["update-category-input-"+e.id];t&&(t.$setValidity("required",!0),t.$setValidity("nameDuplicate",!0),t.$setPristine())}getCodeOverflowMenu(e){const t=[];return e.model.permissions&&e.model.permissions.update&&t.push({icon:"draw",onClick:this.updateNotation.bind(this,e),labelKey:"global.edit"}),e.model.permissions&&e.model.permissions.delete&&t.push({icon:"trash",onClick:this.deleteNotation.bind(this,e),confirmationOptions:{lazyLoadTitleKeyAndInstructionsKey:()=>this.$q.when(b.a("x-bb-grade-notation"))},labelKey:"global.delete"}),t}get isNotationEditing(){return this.notations.some((e=>e.isEditing))}get activeNotation(){return this.notations.filter((e=>e.isEditing))[0]}showOptionsForNotation(e){const t=e.model.permissions;return!t||(t.delete||t.update)}createNotation(e){this.isNotationEditing||(e.stopPropagation(),this.buildNewNotation())}updateNotation(e){e.model.permissions.update&&!this.isNotationEditing&&(e.code=e.model.code,e.description=e.model.description,this.timeout((()=>{e.isEditing=!0}),this.$scope))}leaveEditMode(e,t){this.isNotationEditing&&("cancel"===t?this.cancelEdit(e):(this.validateNotation(e),this.confirmEdit(e)),this.$scope.$broadcast("focus",this.focusNotationEventName))}confirmEdit(e){const t=this.isCodeValidate;let s=!1;if(e.model.code===e.code&&e.model.description===e.description||(s=!0),t)e.isEditing=!1,e.model.code=e.code,e.model.description=e.description,e.model.id?s&&e.model.$save().$then((e=>{this.$scope.$emit("grade-notation-update",this.course.id),this.$rootScope.$broadcast("bb-reload-grid-view")})):this.course.gradebook.performancecodes.$create(e.model).$then((t=>{e.model=t,this.$scope.$emit("grade-notation-update",this.course.id),this.$rootScope.$broadcast("bb-reload-grid-view")}));else{const t=e.form["title-"+e.id],s=e.form["detail-"+e.id];t.$setTouched(),s.$setTouched()}}cancelEdit(e){e.isEditing=!1,""!==e.model.code&&""!==e.model.description||this.deleteNotation(e)}validateNotation(e){const t=e.form["title-"+e.id],s=e.form["detail-"+e.id],n=this.validationManager,i=n.execute("isEmpty",e.code),o=n.execute("isNotationNumberOnly",e.code),a=n.execute("isEmpty",e.description),r=n.execute("isNotationExist",e),c=n.execute("isNotationSchemaDuplicate",e),l=e=>{t.$setValidity("required","isNotationEmpty"!==e),t.$setValidity("notationNumberOnly","isNotationNumberOnly"!==e),t.$setValidity("notationExist","isNotationExist"!==e),t.$setValidity("notationSchemaDuplicate","isNotationSchemaDuplicate"!==e),s.$setValidity("required","descriptionEmpty"!==e)};i?l("isNotationEmpty"):o?l("isNotationNumberOnly"):r?l("isNotationExist"):c?l("isNotationSchemaDuplicate"):a?l("descriptionEmpty"):l(),t.$setDirty(),s.$setDirty(),this.isCodeValidate=!(i||o||a||r||c)}deleteNotation(e){const t=this.notations.indexOf(e);e.model.$destroy().$allow(["400"]).$asPromise().then((e=>{this.$scope.$emit("grade-notation-update",this.course.id),this.notations.splice(t,1),this.$rootScope.$broadcast("bb-reload-grid-view")}))}buildNewNotation(){const e={id:this.generateNotationId(),code:"",description:"",model:this.GradeNotationModel.$build({code:"",description:"",permissions:{delete:!0,update:!0}}),isEditing:!0};return this.notations.push(e),e}generateNotationId(){return"grade_notation_"+e.uid++}pastDueCheckboxEvent(){this.$scope.$broadcast(g.b,this.isPastZeroAssigned)}automaticZeroConfirm(e){let t;this.isPastZeroAssigned?(t={countUnsubmittedWorkAsZero:!0},delete this.gradebookSettings.retainAutoZero):(c.a.Retain.isEqualTo(e.choice)&&(t={countUnsubmittedWorkAsZero:!1,retainAutoZero:!0}),c.a.Delete.isEqualTo(e.choice)&&(t={countUnsubmittedWorkAsZero:!1,retainAutoZero:!1})),this.updatePastDueZero(t)}automaticZeroCancel(){this.isPastZeroAssigned=!this.isPastZeroAssigned}updatePastDueZero(e){Object.assign(this.gradebookSettings,e),this.gradebookSettings.$patch().$then((()=>{this.$rootScope.$broadcast(_)}))}};j.STUDENT_FAILING_PREFERENCE_KEY="telem.threshold.failing.grade",j.STUDENT_ABSENT_PREFERENCE_KEY="telem.threshold.days.absent",j.STUDENT_ALERTS_ENABLED="telem.student.alerts.enabled",j.STUDENT_ABSENT_DEFAULT=5,j.DISABLE_ABSENT_NOTICES=0,j.INITIAL_FAILING_PREF_ARGS={key:j.STUDENT_FAILING_PREFERENCE_KEY},j.INITIAL_ABSENT_PREF_ARGS={key:j.STUDENT_ABSENT_PREFERENCE_KEY},j.INITIAL_ENABLE_PREF_ARGS={key:j.STUDENT_ALERTS_ENABLED,defaultValue:"true"},j.uid=0,j=Object(n.__decorate)([Object(n.__param)(0,Object(o.b)("$scope")),Object(n.__param)(1,Object(o.b)("$rootScope")),Object(n.__param)(2,Object(o.b)("$q")),Object(n.__param)(3,Object(o.b)("currentCourse")),Object(n.__param)(4,Object(o.b)("$modal")),Object(n.__param)(5,Object(o.b)(p.serviceName)),Object(n.__param)(6,Object(o.b)(m.b)),Object(n.__param)(7,Object(o.b)("GradeNotationModel")),Object(n.__param)(8,Object(o.b)(h.d)),Object(n.__param)(9,Object(o.b)(l.b)),Object(n.__param)(10,Object(o.b)(d.c)),Object(n.__param)(11,Object(o.b)(f.b)),Object(n.__param)(12,Object(o.b)(v.b)),Object(n.__param)(13,Object(o.b)(w.b)),Object(n.__param)(14,Object(o.b)(S.b)),Object(n.__param)(15,Object(o.b)(C.k))],j)},"2szi":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-forward-arrow",use:"icon-medium-forward-arrow-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-forward-arrow"><path d="M13 1l10 11-10 11M23 12H1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"2tKw":function(e,t){e.exports='<div class="rubric-list" bb-load-bundle="components/directives/rubric/rubric-list">\n  <div class="association-header" ng-if="::$ctrl.enableRubricAssociation">\n    <div class="header-title-container row">\n      <div class="header-title" bb-translate>\n        components.directives.rubric.list.heading\n      </div>\n    </div>\n    <div class="header-first-description" bb-translate>\n      components.directives.rubric.list.firstParagraphDescription\n    </div>\n    <div class="header-second-description-holder" ng-if="$ctrl.showCompleteDescription">\n      <div class="header-second-description" bb-translate>\n        components.directives.rubric.list.secondParagraphDescription\n      </div>\n      <a bb-translate-attrs="{\'href\': \'components.directives.rubric.list.linkHref\'}"\n         target="_blank"\n         rel="help"\n         analytics-id="components.directives.rubric.list.learnMoreLink"\n         bb-translate>\n         components.directives.rubric.list.learnMoreLink\n      </a>\n    </div>\n    <div class="toggleDescription">\n      <button class="button--text"\n              type="button"\n              ng-if="!$ctrl.showCompleteDescription"\n              aria-labelledby="rubric-list-show-description"\n              ng-click="$ctrl.toggleDescription()"\n              analytics-id="components.directives.rubric.list.showDescription.button">\n        <span id="rubric-list-show-description" bb-translate>components.directives.rubric.list.showMore</span>\n      </button>\n      <button class="button--text"\n              type="button"\n              ng-if="$ctrl.showCompleteDescription"\n              aria-labelledby="rubric-list-hide-description"\n              ng-click="$ctrl.toggleDescription()"\n              analytics-id="components.directives.rubric.list.hideDescription.button">\n        <span id="rubric-list-hide-description" bb-translate>components.directives.rubric.list.showLess</span>\n      </button>\n    </div>\n  </div>\n  <div class="row collapse js-rubric-create-button-wrapper hide-for-small-only" ng-if="$ctrl.editable">\n    <div class="columns medium-12 large-12">\n      <button class="button button--dashed -full-width rubric-create-button"\n              aria-labelledby="rubric-create-rubric-button"\n              bb-peek-sref="rubric.mode({mode: \'create\'})"\n              type="button"\n              bb-translate\n              analytics-id="components.directives.rubric.list.create.button"\n              ng-class="::$ctrl.enableRubricAssociation ? \'rubric-create-button-association\' : \'rubric-create-button-gradebook\'">\n        <span id="rubric-create-rubric-button" bb-translate>components.directives.rubric.list.create</span>\n      </button>\n    </div>\n  </div>\n\n  <div class="rubric-create-disabled-message" ng-show="!$ctrl.rubrics.length" bb-translate>\n    components.directives.rubric.list.createDisabled\n  </div>\n\n  <div class="rubric-view-message" ng-if="!$ctrl.hasViewAccess" bb-translate>\n    components.directives.rubric.settings.unavailable.view\n  </div>\n\n  <div ng-show="$ctrl.rubrics.length > 0">\n    <div ng-if="::!$ctrl.enableRubricAssociation" class="rubric-list-heading row" bb-translate>\n      components.directives.rubric.list.heading\n    </div>\n\n    <div class="list-container">\n      \x3c!-- Rubric Association --\x3e\n      <div ng-if="::$ctrl.enableRubricAssociation" ng-repeat="rubric in $ctrl.rubrics"\n           class="row element-list-row js-rubric-id-{{rubric.id}} association-enabled">\n        <div class="rubric-list-association-item">\n          <div class="item-left-side">\n            <div ng-if="$ctrl._rubricService.isPointsOrPointsRangeRubric(rubric)">\n              <span class="item-rubric-title"\n                    id="name-rubric-{{::rubric.id}}"\n                    title="{{ rubric.title }}"\n                    aria-hidden="true">\n                {{ rubric.title }}\n              </span>\n              <span class="item-rubric-type"\n                    id="possible-points-{{::rubric.id}}"\n                    aria-hidden="true"\n                    translate-values="{ points: {{$ctrl.getPointsRubricMaxScore(rubric)}} }"\n                    bb-translate>\n                    components.directives.rubric.list.pointsType\n              </span>\n              <div class="item-rubric-checkbox">\n                <input type="checkbox"\n                       id="rubric-list-checkbox-{{::rubric.id}}"\n                       name="rubric-list-checkbox-{{::rubric.id}}"\n                       aria-labelledby="name-rubric-{{::rubric.id}}"\n                       aria-describedby="possible-points-{{::rubric.id}} use-rubric-{{::rubric.id}}"\n                       ng-change="$ctrl.pointsCheckboxTrigger(rubric.id, checked)"\n                       ng-model="checked"\n                       analytics-id="components.directives.rubric.list.input.checkbox"/>\n                <label class="inline-form-label"\n                       id="use-rubric-{{::rubric.id}}"\n                       aria-hidden="true"\n                       for="rubric-list-checkbox-{{::rubric.id}}">\n                  <bb-translate>components.directives.rubric.list.pointsCheckbox</bb-translate>\n                </label>\n              </div>\n            </div>\n            <div ng-if="$ctrl._rubricService.isPercentageOrPercentageRangeRubric(rubric)">\n              <span class="item-rubric-title" title="{{ rubric.title }}" aria-hidden="true">\n                {{ rubric.title }}\n              </span>\n              <span class="item-rubric-type"\n                    aria-hidden="true"\n                    bb-translate>\n                    components.directives.rubric.list.percentageType\n              </span>\n            </div>\n          </div>\n          <div class="item-right-side">\n            <button class="button rubric-item-view-button button--text"\n                    bb-peek-sref="rubric.mode({rubricId: rubric.id, mode: \'edit\'})"\n                    type="button"\n                    aria-labelledby="rubric-add-button-{{rubric.id}}"\n                    analytics-id="components.directives.rubric.list.useRubric.button">\n              <span bb-translate>global.view</span>\n              <span class="sr-only"\n                    id="rubric-add-button-{{rubric.id}}"\n                    bb-translate\n                    translate-values="{title: rubric.title}">\n                    components.directives.rubric.list.viewRubric\n              </span>\n            </button>\n            <button class="button rubric-item-add-button button--text"\n                    type="button"\n                    ng-click="$ctrl.associateRubric(rubric)"\n                    aria-labelledby="rubric-view-button-{{rubric.id}}"\n                    analytics-id="components.directives.rubric.list.viewRubric.button">\n              <span bb-translate>components.directives.rubric.list.add</span>\n              <span class="sr-only"\n                    id="rubric-view-button-{{rubric.id}}"\n                    bb-translate\n                    translate-values="{title: rubric.title}">\n                    components.directives.rubric.list.useRubric\n              </span>\n            </button>\n          </div>\n        </div>\n      </div>\n\n      \x3c!-- Gradebook Settings --\x3e\n      <div ng-if="::!$ctrl.enableRubricAssociation" ng-repeat="rubric in $ctrl.rubrics"\n           class="rubric-list-item row element-list-row js-rubric-id-{{rubric.id}}">\n\n        <button class="rubric-info-button button-anchor super-clear" bb-peek-sref="rubric.mode({rubricId: rubric.id, mode: \'edit\'})"\n                type="button" aria-labelledby="rubric-title-button-{{rubric.id}}" analytics-id="components.directives.rubric.list.viewRubric.button">\n          <div class="rubric-info">\n            <span class="rubric-icon" aria-hidden="true"\n                  bb-translate-attrs="{\'title\': \'components.directives.rubric.list.tooltip.edit\'}">\n              <bb-ui-icon-large-rubric color="primary"></bb-ui-icon-large-rubric>\n            </span>\n            <span class="rubric-title ellipsis" title="{{ rubric.title }}" aria-hidden="true">\n              {{ rubric.title }}\n            </span>\n            <span class="sr-only" id="rubric-title-button-{{rubric.id}}" bb-translate translate-values="{title: rubric.title}">components.directives.rubric.list.viewRubric</span>\n          </div>\n        </button>\n\n        <div bb-foundation-defer>\n          <bb-overflow-menu element-id="{{\'rubric-overflow-\' + rubric.id}}"\n                            menu-items="$ctrl.getOverflowMenuItems(rubric)"\n                            delete-options="$ctrl.getDeleteMenuOption(rubric)"\n                            ng-if="!$ctrl.course.isComplete()"\n                            analytics-id-tag-prefix="components.directives.rubric.list.overflowMenu">\n          </bb-overflow-menu>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},"367g":function(e,t,s){},"3Jgm":function(e,t,s){"use strict";var n=s("Llzl"),i=s("pjml"),o=s("Qbdf"),a=s("k9iv"),r=s("0JpG"),c=s("TnpK"),l=s("Sa5G"),d=s("FBBZ"),u=s("71td");var p=s("Q/M7");s.d(t,"a",(function(){return m})),s.d(t,"b",(function(){return h}));const m="ultra.components.services.partner",h="partner";class b{constructor(e,t,s,n,i,o,a,r,c,l,d,u){this.$q=e,this.$rootScope=t,this.$stateParams=s,this.$window=n,this.cacheFactory=i,this.contextCourse=o,this.errorModalService=a,this.localizeService=r,this.ultraStateService=c,this.PartnerCourseModel=l,this.PartnerModel=d,this.PartnerStatusModel=u,this.shortMaxAge=5e3,this.partnerStatusCache=i.createCache("PartnerStatusCache",{deleteOnExpire:"passive",maxAge:this.shortMaxAge}),this.partnersCache=i.createCache("PartnersCache",{deleteOnExpire:"passive",maxAge:this.shortMaxAge}),this.partnerLinkedCoursesCache=i.createCache("PartnerLinkedCoursesCache",{deleteOnExpire:"passive",maxAge:this.shortMaxAge})}getPartnerCloudStatus(e,t=!1){if(u("body").hasClass("bb-within-uia-test"))return this.$q.when({enabled:!1,userCloudProvisioned:!1});if(t)return this.PartnerStatusModel.getStatus(e);let s=this.partnerStatusCache.get("status");return s||(s={promise:this.PartnerStatusModel.getStatus(e)},this.partnerStatusCache.put("status",s)),s.promise}resetPartnerCloudStatus(){this.partnerStatusCache.removeAll()}getPartners(e,t=!1){if(t)return this.PartnerModel.getPartnersByType(e);let s=this.partnersCache.get(e);return s||(s={promise:this.PartnerModel.getPartnersByType(e)},this.partnersCache.put(e,s)),s.promise}getLinkedPartners(e,t=!1){if(t)return this.PartnerCourseModel.$new(e).partnerLinkedCourses.$search().$allow(["400-599"]).$asPromise();let s=this.partnerLinkedCoursesCache.get(e);return s||(s={promise:this.PartnerCourseModel.$new(e).partnerLinkedCourses.$search().$allow(["400-599"]).$asPromise()},this.partnerLinkedCoursesCache.put(e,s)),s.promise}launchPartner(e,t){e.toolProvider.available?d.o(e)?this._launchBrowseLink(e.browseContentLink):this._checkProvisioningAndLaunch(e,t):e.toolProvider.compatible?this.errorModalService.handleError(this.localizeService.translateSync({locale:this.localizeService.getLocale(this.$rootScope),key:"course.partnerList.errorProviderNotConfigured"})):this.errorModalService.handleError(this.localizeService.translateSync({locale:this.localizeService.getLocale(this.$rootScope),key:"course.partnerList.errorProviderIncompatible"}))}_checkProvisioningAndLaunch(e,t){this._getProvisioningCheckResult(e.providerId,t).then((t=>{let s;t.status?(s={partnerId:e.providerId,toolType:"browse",partnerTitle:d.h(e)},l.o.Inline.isEqualTo(this.$stateParams.mode)?s.mode=this.$stateParams.mode:(s.partnerParentId=this.$stateParams.parentId,s.position=this.$stateParams.position)):(s={partnerId:e.providerId,toolType:"partnerProvisioning",partnerTitle:this.localizeService.translateSync({locale:this.localizeService.getLocale(this.$rootScope),key:"course.partnerList.partnerProvisioning"}),partnerParentId:this.$stateParams.parentId},this.ultraStateService.current.name.indexOf("peek.books-and-tools")>=0&&(s.returnState="base.courses.peek.course.outline.peek.books-and-tools")),this.ultraStateService.goPeekState("partner-tool.tool",s)}))}_getProvisioningCheckResult(e,t){return n.isDefined(t)?this.$q.when({status:t}):this.PartnerCourseModel.$new(this.contextCourse.courseId).updateProvisioning(e)}_launchBrowseLink(e){let t=p.c(e.url);switch(this.$stateParams.parentId&&(t=p.a(t,"content_id",this.$stateParams.parentId)),e.target){case"_self":this._windowLocationAssign(t);break;case"_blank":this.$window.open(t)}}_windowLocationAssign(e){this.$window.location.assign(e)}}b.$inject=["$q","$rootScope","$stateParams","$window","DSCacheFactory",o.e,a.d,r.serviceName,c.d,i.T.serviceName,i.R.serviceName,i.V.serviceName];n.module(m,[o.b,a.c,r.moduleName,c.b,i.N]).service(h,b)},"3LmG":function(e,t){e.exports='<bb-modal id="continue-working-modal" class="notification success hide-x-button"\n          modal-title-key="course.content.assessment.test.modal.continueWorking.title"\n          bb-focus="true"\n          analytics-id-tag-prefix="course.content.assessment.test.modal.continueWorking">\n  <div name="modal-contents">\n\n    <p ng-if="::(assessmentAttempt.hasUnlimitedExtraTime && !assessmentAttempt.hasUploadsInProgress)" bb-translate>\n      course.content.assessment.test.modal.continueWorking.body.unlimited\n    </p>\n    <p ng-if="::(assessmentAttempt.hasUnlimitedExtraTime && assessmentAttempt.hasUploadsInProgress)" bb-translate>\n      course.content.assessment.test.modal.continueWorking.cancelUploads.unlimited\n    </p>\n\n    <p ng-if="::(assessmentAttempt.hasLimitedExtraTime && !assessmentAttempt.hasUploadsInProgress)"\n       bb-translate translate-values="{extraMinutes: assessmentAttempt.currentRemainingMinutes}">\n      course.content.assessment.test.modal.continueWorking.body.limited.plural\n    </p>\n    <p ng-if="::(assessmentAttempt.hasLimitedExtraTime && assessmentAttempt.hasUploadsInProgress)"\n       bb-translate translate-values="{extraMinutes: assessmentAttempt.currentRemainingMinutes}">\n      course.content.assessment.test.modal.continueWorking.cancelUploads.limited.plural\n    </p>\n  </div>\n  <button name="modal-footer-button-primary" class="button confirm-ok js-primary-button" ng-click="$parent.$close()" bb-translate analytics-id="course.content.assessment.test.modal.continueWorking.submit">\n    course.content.assessment.test.modal.continueWorking.submit\n  </button>\n  <button name="modal-footer-button-secondary" class="button button--secondary confirm-cancel js-secondary-button" ng-click="$parent.$dismiss()" bb-translate analytics-id="course.content.assessment.test.modal.continueWorking.continue">\n    course.content.assessment.test.modal.continueWorking.continue\n  </button>\n</bb-modal>\n'},"3Lzw":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-upload",use:"icon-medium-upload-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-upload"><path d="M12 1v14M1 7v16h22V7h-4M1 7h4-4zM8 5l4-4 4 4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"3Nzc":function(e,t,s){"use strict";var n=s("D57K"),i=(s("KXuk"),s("nbDY")),o=s.n(i),a=s("VdDF"),r=s("seHs"),c=s("nsO7"),l=s("Llzl"),d=s("Fvsw"),u=s("Qbdf"),p=s("g7Mf"),m=s("jhBu"),h=s("XGja"),b=s("o5Lu"),g=s("X/qj"),v=s("0JpG"),f=s("pjml"),w=s("R4kC"),S=s("2lxm"),C=s("lEL+"),y=s("0Vbm"),O=s("TnpK"),A=s("5uPl"),I=s("u3gM"),D=s("XH1I"),k=s("gkef"),_=s("+brj"),j=s("9hUw"),T=s("1ZbL");const $="ultra.components.directives.grade.submissionList.filters",R={Class:s("ZQFV").SubmissionListDropdownFilters,attributes:["analyticsId"],bindingNames:["scoreProviderHandler","studentFilterSelected","gradingFilterSelected","isDelegated","isUserReconciler"],renderLocalized:!0};l.module($,[]).component("bbSubmissionListDropdownFilters",Object(T.a)(R));var E=s("Sa5G"),x=s("+O05"),P=s("7cYF"),L=s("zGdY"),G=s("RWbl"),M=s("aHpC");s.d(t,"c",(function(){return N})),s.d(t,"a",(function(){return F})),s.d(t,"b",(function(){return B})),s.d(t,"e",(function(){return q})),s.d(t,"d",(function(){return z}));const N="instructor-submission-list-view-refresh",F="instructor-scheduled-regrading-task-finish-event",B="instructor-submission-list-attempt-deleted-event",q="ultra.components.directives.grade.submissionList",z="SUBMISSION_LIST_SELECTED_PAGE_SIZE";class U extends o.a{}U.Individual=new U("Individual"),U.Group=new U("Group"),U.Discussion=new U("Discussion");let V=class{constructor(e,t,s,n,i,o,a,d,u,p,m,h,g,v,f,w,S,C,y,O){var A;this.scope=e,this.$q=t,this.windowSize=s,this.element=n,this.attrs=i,this.context=o,this.entitlementService=a,this.CourseModel=d,this.grade=u,this.gradebookPermissionService=p,this.localizeService=m,this.gradableItemUserOptionService=h,this.submissionListService=g,this.timeout=v,this.discussion=f,this.contextCourse=w,this.ultraState=S,this.originalityReportService=C,this.browserStorage=y,this.peerService=O,this.allMembershipsRetrievedFromServer=!1,this.cannotViewGroupsMsg="",this.canViewException=!1,this.canViewGroups=!1,this.currentlyLoading=!1,this.editing=!1,this.formId="",this.numberOfSubmissions=0,this.currentFocusInputNum=0,this.currentPage=0,this.assessmentExceptionNodeStyle=null,this.showControls=!1,this.pageSizeOptions=r.c,this.userCourseAvailableMap={},this.onInstructorSubmissionListViewRefresh=(e,t,s)=>{t.isGroupContent&&this.rows&&this.rows.length>0&&this.rows[0].group&&(this.rowsExpandStatus={},this.rows.forEach((e=>{this.rowsExpandStatus[e.group.id]=e.groupDetailsShown}))),this.rows=null,this.scope.$root.$broadcast("refresh-participants-count");const n=t.getDeployedAssessment();n&&n.gradingColumn.dueDate&&(this.column.dueDate=new Date(n.gradingColumn.dueDate)),this.column.summary.$fetch({groupId:this.scope.groupId}),this.studentFilterSelected||this.gradingFilterSelected||!this.memberships?(this.memberships=[],this.loadSubmissions()):this.loadRows(t,s)},this.onGradeInputBlur=(e,t)=>{this.currentFocusId&&this.currentFocusId===t&&(this.currentFocusId=null,this.currentFocusInputNum--),this.timeout((()=>{this.editing=this.currentFocusInputNum>0}),this.scope,400,!0)},this.onGradeInputInFocus=(e,t)=>{this.currentFocusId&&this.currentFocusId===t||(this.currentFocusId=t,this.currentFocusInputNum++),this.editing=this.currentFocusInputNum>0},this.onGradeStatusChange=(e,t)=>{const s=!!this.column.ui.content&&this.column.ui.content.isSafeAssignEnabled();if(t.groupId)this.updateGroupRows(t.groupId,s);else{if(this.studentFilterSelected||this.gradingFilterSelected)return this.memberships=[],void this.loadSubmissions();this.updateRows(t.gradeId,s)}},this.onDueDateUpdate=e=>{this.loadSubmissions()},this.onSubmissionListColumnChange=(e,t)=>{this.column=t,this.unsubscribeOnRowsUpdated&&this.unsubscribeOnRowsUpdated(),this.unsubscribeOnRowsUpdated=this.submissionListService.addOnRowsUpdated(this.column.courseId,this.column.id,this.onSubmissionListRowsUpdated),this.memberships=[],this.loadSubmissions()},this.onAttemptDeleted=()=>{this.memberships=[],this.loadSubmissions()},this.processUpdatedRows=e=>{e.forEach((e=>{const t=c.findIndex(this.allRows,(t=>{var s,n;return(null===(s=t.user)||void 0===s?void 0:s.id)===(null===(n=e.user)||void 0===n?void 0:n.id)}));t>=0&&(this.allRows[t]=e)})),this.filterLoadedBulkViewRows(this.searchText)},this.onSubmissionListRowsUpdated=()=>{this.isGroup?this.processUpdatedGroupRows(this.submissionListService.submissionList.rows):this.processUpdatedRows(this.submissionListService.submissionList.rows)},this.onGroupChange=(e,t)=>{this.scope.groupId=t,this.memberships=[],this.loadSubmissions()},this.processUpdatedGroupRows=e=>{e.forEach((e=>{const t=c.findIndex(this.rows,(t=>t.group.id===e.group.id));this.scope.$root.$broadcast("click-to-invoke-child-directive-init"),this.rows[t]=e}))},this.onFinishRender=l.noop,this.onChangePageFunction=e=>{this.scope.$apply((()=>{this.currentPage=e,this.onChangePage()}))},this.onPageSizeChange=e=>{this.browserStorage.saveToStorage(z,e.toString(10),_.a.LocalStorage),this.pageSize=e,this.pageSizeChange(),this.validateCurrentPageIndex()},this.studentFilterSelected=e=>{this.selectedStudentFilter=e,this.currentPage=0,this.loadSubmissions()},this.gradingFilterSelected=e=>{this.selectedGradingFilter=e,this.currentPage=0,this.loadSubmissions()},this.column=e.getColumn(),this.dueDateExceptionMap=new Map,this.canViewGroups=this.entitlementService.areAllEntitled([E.n.ViewGroups,E.e.ViewAsDesigner],this.contextCourse.courseId),this.canViewException=this.entitlementService.isEntitled(E.b.ViewException,this.contextCourse.courseId),this.peerService.getOrCreatePeerContentFromColumn(this.column).then((e=>this.peerReviewContentObject=e)),this.localizeService.translate({locale:this.localizeService.getLocale(this.scope),key:"components.directives.grade.submission-list.cannotViewGroupsMsg"}).then((e=>{this.cannotViewGroupsMsg=e})),e.getForumId&&(this.formId=e.getForumId()),this.isExternalSubmission=x.a.isExternalSubmissionsAssessment(this.column.ui.content),this.loadData(),(null===(A=this.column)||void 0===A?void 0:A.anonymousGrading)&&this.initializeAnonymousGradingFilter(),e.$on("submission-list-column-change",this.onSubmissionListColumnChange),e.$on("group-change",this.onGroupChange),e.$on(b.b,this.onGradeStatusChange),e.$on("due-date-exception-updated",this.onDueDateUpdate),e.$on(N,this.onInstructorSubmissionListViewRefresh),e.$on("grade-input-in-focus",this.onGradeInputInFocus),e.$on("grade-input-blur",this.onGradeInputBlur),e.$on(F,(()=>{this.column&&this.loadRows(this.column.ui.content,(()=>{this.scope.$root.$broadcast(P.e)}))})),this.unsubscribeOnRowsUpdated=this.submissionListService.addOnRowsUpdated(this.column.courseId,this.column.id,this.onSubmissionListRowsUpdated),e.$on("$destroy",(()=>{this.assessmentExceptionNodeStyle&&this.assessmentExceptionNodeStyle.remove(),this.unsubscribeOnRowsUpdated()})),e.$on(B,this.onAttemptDeleted),this.originalityReportService.setCourseContent(this.column.ui.content,!0),this.originalityReportService.fetchIsOriginalityEnabled().then((e=>{this.shouldShowOriginality=e})),y.getFromStorage(z,_.a.LocalStorage).then((e=>{this.initialPageSize=Number(e)||this.pageSizeOptions[0],this.pageSize=this.initialPageSize})).catch((()=>{this.initialPageSize=this.pageSizeOptions[0],this.pageSize=this.initialPageSize})).finally((()=>{this.loadSubmissions()}))}initializeAnonymousGradingFilter(){this.anonymousAvailableFilters=[{index:0,name:this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.grade.submission-list.filter.showAllStudents"}),nature:L.GradingStatusFilterKeyOptionsEnum.allStatuses,value:L.GradingStatusFilterKeyOptionsEnum.allStatuses},{index:1,name:this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.grade.submission-list.filter.showNeedsGradingStudents"}),nature:L.GradingStatusFilterKeyOptionsEnum.needsGrading,value:L.GradingStatusFilterKeyOptionsEnum.needsGrading}],this.anonymousSelectedGradingFilter=this.anonymousAvailableFilters[0]}getSearchBoxPlaceholderKey(){const e="components.directives.grade.submission-list.search";if(U.Group.isEqualTo(this.mode))return`${e}GroupPlaceholder`;return`${e}${this.contextCourse.course.isOrganization?"Participant":"Student"}Placeholder`}loadData(){this.loadSubmissions()}isPeerGrading(){return this.column.peerGrading}hasAttemptBeenPostedOrCompleted(e){const t=this.rows[e];return t.isStatusComplete()&&!t.overrideToPost()&&!t.grade.isPastDueZero()}get peerReviewsPerStudent(){var e;return null!==(e=this.column.ui.content.getDeployedAssessment().peerSettings.peerReviewsPerStudent)&&void 0!==e?e:-1}hasCompletedAllPeerReviews(e){const t=this.rows[e];return this.peerReviewsPerStudent===t.numOfPeerReviewsCompleted}getNothingToGradeOrReconcileKey(e){return this.rows[e].isCurrentUserReconciler()?"nothingToReconcile":"nothingToGrade"}getAttemptsPeerStatus(e){return this.currentDate=a.a.parseStringToDate(this.context.getServerTime()),this.submissionDueDate=a.a.parseStringToDate(this.column.dueDate),this.peerReviewDueDate=a.a.parseStringToDate(this.rows[0].Column.ui.content.getDeployedAssessment().peerSettings.peerReviewDueDate),this.hasCompletedAllPeerReviews(e)||this.isAfterPeerReviewWindow?(this.status="status-needs-grading","needsGrading"):this.isInPeerSubmissionWindow?(this.status="status-submitted","submitted"):(this.status="status-in-peer-review","inPeerReview")}getPostedOrCompletedKey(){return this.isPeerGrading()?(this.status="status-is-posted","posted"):(this.status="status-is-complete","complete")}get isInPeerSubmissionWindow(){var e;return!(null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.isAfterPeerSubmissionDueDate())}get isAfterPeerReviewWindow(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.isAfterPeerReviewDueDate()}filterLoadedBulkViewRows(e){this.filterRows(e)}filterRows(e){if(this.searchText=e,e){const t=e.split(/\s+/).map((e=>new RegExp(e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"i")));this.rows=this.allRows.filter((e=>this.isGroup?t.some((t=>t.test(e.group.title))):t.some((t=>t.test(e.user.givenName)))||t.some((t=>t.test(e.user.familyName))))),this.currentPage=0}else this.rows=this.allRows;this.setSubmissionListInGradeService(this.rows)}updateRows(e,t){var s;let n;const i={groupId:this.scope.groupId};if(e?(n=[this.getMembershipByGradeId(e)].filter((e=>e)),i.userIds=null===(s=n[0])||void 0===s?void 0:s.userId):(n=this.getMembershipsAll(),i.roleBucket=L.CourseRoleBucket.Taking),this.column.anonymousGrading)return this.loadAnonymousStudentRows().then(this.processUpdatedRows);if(n.length<=0)return Promise.resolve();return this.grade.loadCustomizedBulkViewRows(n,this.column,this.formId,i,t,!0).then(this.processUpdatedRows)}loadAnonymousStudentRows(){return this.anonymousSelectedGradingFilter.value===L.GradingStatusFilterKeyOptionsEnum.needsGrading?this.grade.loadAnonymousStudentRowsNeedsGrading(this.column):this.grade.loadAnonymousStudentRows(this.column)}updateGroupRows(e,t){const s=c.find(this.rows,(t=>t.group.id===e)),n=this.getMembershipsFromRow(s),i=c.find(this.column.ui.content.assignedGroups,(e=>e.groupId===s.group.id));this.canViewGroups?this.grade.loadGroupRows(this.course,[i],n,this.column,t).then(this.processUpdatedGroupRows):this.processUpdatedGroupRows([])}getMembershipsAll(){const e=[];return this.rows.forEach((t=>{if(t.group)t.group.memberships.forEach((t=>{const s=c.find(this.memberships,(e=>e.user.id===t.userId));e.push(s)}));else{const s=c.find(this.memberships,(e=>e.user.id===t.user.id));e.push(s)}})),e}getMembershipsFromRow(e){return e.group.memberships.map((e=>{const t=c.findIndex(this.memberships,(t=>e.userId===t.userId));return this.memberships[t]}))}getMembershipByGradeId(e){const t=c.findIndex(this.rows,(t=>t.grade&&t.grade.id===e));if(t>-1){const e=this.rows[t],s=c.findIndex(this.memberships,(t=>e.user.id===t.userId));return this.memberships[s]}return null}hasNonDefaultFilterSelected(){const e=this.selectedGradingFilter!==L.GradingStatusFilterKeyOptionsEnum.allStatuses&&!!this.selectedGradingFilter,t=this.selectedStudentFilter!==L.StudentStatusFilterKeyOptionsEnum.allStatuses&&!!this.selectedStudentFilter;return e||t}getBulkViewQueryParameters(e){const t={groupId:this.scope.groupId,roleBucket:L.CourseRoleBucket.Taking};if(this.isDiscussion&&this.hasNonDefaultFilterSelected()){const s=e.map((e=>e.userId)).join("-");t.userIds=s}return t}loadSubmissions(){this.CourseModel.$find(this.column.courseId).$then((e=>{var t;this.course=e,(null===(t=this.column)||void 0===t?void 0:t.anonymousGrading)?this.fetchGrades(this.column.id).then((e=>{this.gradesData=e,this.column&&this.loadRows(this.column.ui.content)})):this.fetchMemberships().then((e=>{this.memberships=e;const t=this.memberships.map((e=>e.id));return e.forEach((e=>{var t;e.dueDateExceptionType===L.DueDateException.Unlimited&&this.dueDateExceptionMap.set(this.scope.groupId,!0),this.userCourseAvailableMap[e.userId]=null!==(t=e.isAvailable)&&void 0!==t&&t})),this.column&&this.loadRows(this.column.ui.content),this.gradableItemUserOptionService.getGradableItemUserOption(this.column.courseId,this.column.id,t)}))}))}fetchGrades(e){let t={offset:this.currentPage*this.pageSize,limit:this.pageSize,includeCount:!0};return this.anonymousSelectedGradingFilter.value===L.GradingStatusFilterKeyOptionsEnum.needsGrading&&(t={...t,onlyNeedsGrading:!0,columnId:this.column.id}),this.course.gradebook.columns.$find(e).grades.$fetch(t).$asPromise().then((e=>(this.totalItems=e.paging.count,e)))}loadRows(e,t){e&&e.isGroupContent&&!e.isDiscussion()?this.loadAllGroupRows(e.assignedGroups,t):this.loadBulkViewRows(t)}loadBulkViewRows(e){var t,s;if(!((null===(t=this.memberships)||void 0===t?void 0:t.length)>0||(null===(s=this.gradesData)||void 0===s?void 0:s.length))||this.scope.groupId&&!this.canViewGroups)this.rows=[],this.finishLoadingBulkViewRows(e),this.validateItemsOnList();else{let t;if(this.column.anonymousGrading){const e="attempts";t=this.grade.loadAnonymousBulkViewRows(this.gradesData,this.column,null,{expand:e})}else{const e=this.getBulkViewQueryParameters(this.memberships),s=!!this.column.ui.content&&this.column.ui.content.isSafeAssignEnabled(),n=!0;t=this.grade.loadCustomizedBulkViewRows(this.memberships,this.column,this.formId,e,s,n)}this.scope.$emit("bb-gradebook-item-show-spinner-child",!0),t.then((e=>{this.processLoadedBulkViewRows(e)})).finally((()=>{this.finishLoadingBulkViewRows(e),this.validateItemsOnList()}))}}processLoadedBulkViewRows(e){this.allRows=e,this.sortSubmissionList(this.allRows),this.setSubmissionListInGradeService(this.allRows),this.filterLoadedBulkViewRows(this.searchText)}finishLoadingBulkViewRows(e){this.scope.$emit("bb-gradebook-item-show-spinner-child",!1),this.currentlyLoading=!1,this.scope.$root.$broadcast("submission-list-loaded"),e&&e(),this.showControls=!0,this.canViewException&&!this.column.anonymousGrading&&x.a.initAssessmentExceptionsIndicators(this.course,this.column.ui.content).then((e=>{this.assessmentExceptionNodeStyle=e}))}loadAllGroupRows(e,t){this.scope.$emit("bb-gradebook-item-show-spinner-child",!0),this.canViewGroups?this.grade.loadGroupRows(this.course,e,this.memberships,this.column,this.column.ui.content&&this.column.ui.content.isSafeAssignEnabled()).then((e=>{this.processLoadedAllGroupRows(e)})).finally((()=>{this.finishLoadingBulkViewRows(t),this.validateItemsOnList()})):(this.processLoadedAllGroupRows([]),this.finishLoadingBulkViewRows(t),this.validateItemsOnList())}processLoadedAllGroupRows(e){this.allRows=e,this.rows=e,this.submissionListService.sortSubmissionList(this.rows),this.setSubmissionListInGradeService(this.rows),this.rowsExpandStatus&&(this.rows.forEach((e=>{e.groupDetailsShown=!!this.rowsExpandStatus[e.group.id]})),this.rowsExpandStatus=null)}fetchMemberships(){let e={fields:"courseCardColorIndex,id,isAvailable,dueDateExceptionType,timeLimitExceptionType,role,courseRole,user.id,user.userName,user.avatar,user.familyName,user.givenName,user.lastModifiedAt,userHasHidden,userId,isPreviewStudent,user.otherName,user.preferredDisplayName,",roleBucket:"taking",offset:this.currentPage*this.pageSize};const t=this.getFilterString();t&&!this.column.anonymousGrading&&(e={...e,filter:t,columnId:this.column.id});const s=this.course.memberships.$fetch(e).$asPromise();return this.scope.groupId&&this.canViewGroups?this.$q.all([s,this.course.groups.$new(this.scope.groupId).$fetch({expand:"memberships"}).$asPromise()]).then((e=>{const[t,s]=e,n=new Set(c.map(s.memberships,"userId")),i=t.filter((e=>n.has(e.userId)));return i.paging=t.paging,i.paging.count=i.length,i.permissions=t.permissions,i})):s}get isIndividual(){return this.mode===U.Individual}get isDiscussion(){return this.mode===U.Discussion}get isGroup(){return this.mode===U.Group}get totalItems(){return this.rows?this.rows.length:0}set totalItems(e){}get totalItemsOnList(){return this.rows?this.numberOfSubmissions:0}isGroupDiscussion(){return this.isDiscussion&&this.discussion.hasGroups()}showNoGroupViewMessage(){return this.isGroup&&!this.canViewGroups}isOverdue(){return this.column&&this.column.dueDate&&this.column.dueDate.getTime()-this.context.getServerTime().getTime()<0}includeDueDateException(){return this.dueDateExceptionMap}setSubmissionListInGradeService(e){this.submissionListService.setSubmissionList(this.course.id,this.column.id,this.memberships,e),this.submissionListService.loadRowsListeners()}pageSizeChange(){l.noop()}pageChange(){l.noop()}changeFilter(e){l.noop()}onChangePage(){const{scrollContainer:e,pageSizeSelector:t}=this.getContainerElementAndCurrentElement();e.animate({scrollTop:0},100,(()=>{c.delay((()=>h.b(e,t)),300)}))}getContainerElementAndCurrentElement(){const e=this.windowSize.isSmallBreakpoint()?"#gradebook-item-panel-content":".student-submission-list",t=l.element(e),s=t.find("bb-page-size-selector button");return{scrollContainer:t,pageSizeSelector:s}}sortSubmissionList(e){this.submissionListService.sortSubmissionList(e)}validateCurrentPageIndex(){const e=this.numberOfPages-1;e<0?this.currentPage=0:this.currentPage>e&&(this.currentPage=e)}validateItemsOnList(){this.rows&&(this.numberOfSubmissions=this.rows.length)}get showPagination(){return this.totalItems>this.pageSize}get numberOfPages(){return Math.ceil(this.totalItems/this.pageSize)}get isSmallBreakpoint(){return this.windowSize.isSmallBreakpoint()}get initPageSize(){return this.initialPageSize.toString()}shouldShowSubmissionFilters(){var e,t;const s=this.isGroup&&!this.isDiscussion;return!!(null===(e=this.column)||void 0===e?void 0:e.scoreProviderHandle)&&!(null===(t=this.column)||void 0===t?void 0:t.anonymousGrading)&&!s}shouldShowAnonymousSubmissionFilters(){var e,t;const s=this.isGroup&&!this.isDiscussion;return!!(null===(e=this.column)||void 0===e?void 0:e.scoreProviderHandle)&&(null===(t=this.column)||void 0===t?void 0:t.anonymousGrading)&&!s}isDelegated(){return this.column.delegatedGrading}isUserReconciler(){var e,t;if(this.isDiscussion||this.isGroup)return!1;const s=this.context.getCurrentUserId();return!!(null===(t=null===(e=this.column)||void 0===e?void 0:e.delegatedGraders)||void 0===t?void 0:t.some((e=>e.canReconcile&&e.userId===s)))}getFilterString(){const e=[];return this.selectedStudentFilter&&this.selectedStudentFilter!==L.StudentStatusFilterKeyOptionsEnum.allStatuses&&e.push(this.selectedStudentFilter),this.selectedGradingFilter&&this.selectedGradingFilter!==L.GradingStatusFilterKeyOptionsEnum.allStatuses&&e.push(this.selectedGradingFilter),e.join()}};V=Object(n.__decorate)([Object(n.__param)(0,Object(M.b)("scope")),Object(n.__param)(1,Object(M.b)("$q")),Object(n.__param)(2,Object(M.b)(k.b)),Object(n.__param)(3,Object(M.b)("element")),Object(n.__param)(4,Object(M.b)("attrs")),Object(n.__param)(5,Object(M.b)(d.b)),Object(n.__param)(6,Object(M.b)(m.b)),Object(n.__param)(7,Object(M.b)(f.m.serviceName)),Object(n.__param)(8,Object(M.b)(b.k)),Object(n.__param)(9,Object(M.b)(g.b)),Object(n.__param)(10,Object(M.b)(v.serviceName)),Object(n.__param)(11,Object(M.b)(S.b)),Object(n.__param)(12,Object(M.b)(w.b)),Object(n.__param)(13,Object(M.b)(C.b)),Object(n.__param)(14,Object(M.b)(p.c)),Object(n.__param)(15,Object(M.b)(u.e)),Object(n.__param)(16,Object(M.b)(O.d)),Object(n.__param)(17,Object(M.b)(A.b)),Object(n.__param)(18,Object(M.b)(_.c)),Object(n.__param)(19,Object(M.b)(j.b))],V);class H extends V{constructor(){super(...arguments),this._totalItems=0}get mode(){return U.Individual}loadData(){l.noop()}filterLoadedBulkViewRows(e){this.searchText=e,this.rows=this.allRows}filterRows(e){this.searchText=e,this.currentPage=0,this.loadSubmissions()}fetchMemberships(){let e={fields:"courseCardColorIndex,id,isAvailable,dueDateExceptionType,timeLimitExceptionType,role,courseRole,user.id,user.userName,user.avatar,user.familyName,user.givenName,user.otherName,user.preferredDisplayName,user.lastModifiedAt,userHasHidden,userId,isPreviewStudent",roleBucket:"taking",sort:["isPreviewStudent(asc)","user.familyName(asc)","user.givenName(asc)"].join(),offset:this.currentPage*this.pageSize,limit:this.pageSize,includeCount:!0,q:this.searchText};const t=this.getFilterString();return t&&(e={...e,filter:t,columnId:this.column.id}),this.course.memberships.$fetch(e).$asPromise().then((e=>(this._totalItems=e.paging.count||0,e)))}pageSizeChange(){this.loadSubmissions()}pageChange(){this.loadSubmissions()}sortSubmissionList(e){l.noop()}set totalItems(e){this._totalItems=e}get totalItems(){return this._totalItems}onChangePage(){const{scrollContainer:e,pageSizeSelector:t}=this.getContainerElementAndCurrentElement();e.animate({scrollTop:0},100,(()=>{this.onFinishRender=()=>{c.delay((()=>{h.b(e,t),this.onFinishRender=l.noop}),500)},this.pageChange()}))}canDownloadAll(){return this.gradebookPermissionService.canViewBulkDownload()&&this.column&&!this.column.anonymousGrading}getDownloadOverflowMenu(){return[{icon:"download",onClick:()=>{this.gradesBulkDownload()},labelKey:"components.directives.grade.submission-list.downloadAll"}]}gradesBulkDownload(){this.ultraState.goPeekState("grades-bulk-download",{columnId:this.column.id})}overflowMenuLabel(){return this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.grade.submission-list.submissionListMenuLabel"})}changeFilter(e){this.anonymousSelectedGradingFilter!==e&&(this.anonymousSelectedGradingFilter=e,this.currentPage=0,this.loadSubmissions())}}class Q extends V{get mode(){return U.Group}}class K extends V{get mode(){return U.Discussion}}class W{constructor(e){this.$injector=e,this.restrict="E",this.template=G,this.scope={getColumn:"&column",getForumId:"&?forumId",groupId:"=?"},this.link=(e,t,s)=>{const n=e.getColumn();let i;i=n.isDiscussion()?K:n.ui.content&&n.ui.content.isGroupContent?Q:H,e.submissionList=this.$injector.instantiate(i,{scope:e,element:t,attrs:s})}}}W.$inject=["$injector"];class J{constructor(e,t){this.timeout=e,this.$parse=t,this.restrict="A",this.link=(e,t,s)=>{e.$last&&this.timeout((()=>{const t=s[J.DIRECTIVE_NAME];t&&this.$parse(t)(e)}),e)}}}J.DIRECTIVE_NAME="bbOnFinishRender",J.$inject=[C.b,"$parse"],l.module(q,[d.a,u.b,b.j,v.moduleName,S.a,w.a,p.b,y.a,I.a,D.a,k.a,_.b,j.a,$]).directive("bbSubmissionList",["$injector",e=>e.instantiate(W)]).directive(J.DIRECTIVE_NAME,["$injector",e=>e.instantiate(J)])},"3Uvi":function(e,t){e.exports='<div>\n  <div ng-if="::questionAnswerStatus.shouldShowText() || wasLate()"\n       class="question-answer-status"\n       ng-class="::questionAnswerStatus.getBackgroundClass()">\n    <div ng-if="::questionAnswerStatus.shouldShowText()" class="question-answer-status--correct-text">\n      <div bb-translate\n           class="question-answer-status__correctness-label">\n        {{::questionAnswerStatus.getCorrectnessTextKey()}}\n      </div>\n      <ng-transclude/>\n    </div>\n    <div ng-if="wasLate()"\n        class="question-answer-status__time-limit"\n        ng-class="::{\'question-answer-status__text-with-attention\': questionAnswerStatus.shouldShowText()}">\n      <bb-svg-icon size="small"\n        icon="attention"\n        class="question-answer-status__after-time-attention">\n      </bb-svg-icon>\n      <div bb-translate class="question-answer-status__after-time-text">\n        components.directives.assessment-question.status.attention\n      </div>\n    </div>\n  </div>\n</div>\n'},"3l3z":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return r}));var n=s("Llzl"),i=s("nsO7"),o=s("lEL+"),a=s("5HCE");const r="ultra.components.directives.gradeGridMessageReborn";class c{constructor(e,t,s,n,o){this.window=e,this.scope=t,this.element=s,this.attrs=n,this.timeout=o,o((()=>{i.isUndefined(t.adjustPosition)||t.adjustPosition(s)}),t)}mousedown(){e(this.window).trigger("click")}}c.$inject=["$window","scope","element","attrs",o.b];class l{constructor(e){this.$injector=e,this.restrict="A",this.template=a,this.link=(e,t,s)=>{e.gradeGridMessageReborn=this.$injector.instantiate(c,{scope:e,element:t,attrs:s})}}}l.$inject=["$injector"],n.module(r,[]).directive("bbGradeGridMessageReborn",["$injector",e=>e.instantiate(l)])}).call(this,s("71td"))},"3mUc":function(e,t){e.exports="<div\n  ng-class=\"{'validation-error' : showError()}\"\n  ng-transclude>\n</div>\n"},4:function(e,t){},"4J8k":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("dmkk");const o="ultra.components.directives.bbUiIcon.large.AvatarMultiple";Object(n.a)(i.a,o,"bbUiIconLargeAvatarMultiple")},"4VOk":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-privacy-policy",use:"icon-medium-privacy-policy-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-privacy-policy"><path d="M21 8V1H3v22h6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M13 16h9v7h-9zM7 5h8M7 9h10" /><path opacity=".9" d="M7 13h5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M7 17h3M15 16v-4h5v4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"4uUs":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("RrOo");const o="ultra.components.directives.bbUiIcon.large.Test";Object(n.a)(i.Test,o,"bbUiIconLargeTest")},5:function(e,t){},"59Vg":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("wnlu");const o="ultra.components.directives.bbUiIcon.large.Textbook";Object(n.a)(i.Textbook,o,"bbUiIconLargeTextbook")},"5HCE":function(e,t){e.exports='<div role="alertdialog" aria-live="assertive">\n  <div class="validation-message-wrapper" tabindex="0">\n    <span bb-ax-alert="2000" class="validation-message" id="sr-message" bb-translate >components.directives.grade.validation.default</span>\n  </div>\n</div>'},"5O3l":function(e,t){e.exports='<div class="calculated-formula-question-container calculated-formula-attempt-authoring guidance-wrapper">\n  <bb-rich-text-editor\n    ng-model="assessmentQuestion.viewHelper.questionTextWithVariableValues"\n    plugin-options="{\'attachment\': true, \'math\': true, \'contentMarket\': true}"\n    supports-inline-document-render="true"\n    is-read-only="true">\n  </bb-rich-text-editor>\n  <div\n    class="formula-details"\n    ng-if="::questionAttempt.question.displayFormulaToStudent"\n  >\n    <div class="formula-image">\n      <span class="formula-image-label" bb-translate>\n        components.directives.assessment-question.calculated-formula.answerFormula\n      </span>\n      <div>\n        <img\n          ng-src="{{::assessmentQuestion.imageSource}}"\n          alt="{{::assessmentQuestion.imageAltText}}"\n        />\n      </div>\n    </div>\n    <ul class="variable-value-list">\n      <li class="variable-value-list-item" ng-repeat="(variable, value) in ::questionAttempt.question.variableValues">\n        <span translate-values="{variableName: variable, variableValue: value}" bb-translate>\n          components.directives.assessment-question.calculated-formula.variableValue\n        </span>\n      </li>\n    </ul>\n  </div>\n  <div\n    ng-if="::questionAttempt.question.correctAnswerPrecision"\n    bb-translate="{{::assessmentQuestion.viewHelper.getRoundingInstructionsKey()}}"\n    translate-values="{scale: questionAttempt.question.answerScale}"\n    class="rounding-instructions"\n  ></div>\n</div>\n\n<div bb-first-time-container class="guidance-wrapper question-answer-container">\n  <div bb-guidance-target component-key="components.directives.assessment-question.ftue.calculated-formula-attempt-authoring">\n    <input\n      id="{{::assessmentQuestion.elementId}}"\n      name="{{::assessmentQuestion.elementId}}"\n      type="text"\n      ng-model="assessmentQuestion.givenAnswer"\n      bb-translate-attrs="{placeholder: \'components.directives.assessment-question.calculated-formula.placeholder.attempt\', \'aria-label\': \'components.directives.assessment-question.placeholder.question\'}"\n      translate-attrs-values="{questionIdentifier: questionAttempt.visibleQuestionNumber}"\n      analytics-id="components.directives.assessment-question.calculated-formula.attempt-authoring.input-placeholder.input.text"\n    />\n  </div>\n\n  <bb-guidance component-key="components.directives.assessment-question.ftue.calculated-formula-attempt-authoring"\n               class="guidance-element-overlay stacked push-bottom" ng-if="::questionAttempt.question.ui.questionTypePosition === 0">\n    <span bb-translate>components.directives.assessment-question.ftue.calculated-formula-attempt-authoring</span>\n  </bb-guidance>\n</div>\n'},"5Tom":function(e,t,s){"use strict";var n=s("D57K"),i=s("nYZ0"),o=s("fYJU"),a=s("0JpG"),r=s("TnpK"),c=s("0/Nk"),l=s("M2M2"),d=s("yC9S"),u=s("aHpC");s.d(t,"b",(function(){return p})),s.d(t,"a",(function(){return m}));const p="ultra.directives.group.group-student-enrollment";let m=class{constructor(e,t,s,n,i){this.scope=e,this.contentService=t,this.currentUserService=s,this.localize=n,this.ultraState=i,this.isSelfEnrollment=!1}$onInit(){this.render()}async render(){if(this.content.selfEnrollmentGroups&&this.content.selfEnrollmentGroups.length>0){const{locale:e,babelfishFormatter:t}=this.localize.getReactBabelfishParams(this.scope),s=this.content.selfEnrollmentGroups.filter((e=>e.group)).map((e=>e.group));this.selfEnrollGroupInfo=await l.getSelfEnrollmentGroupInfo(s,e,t),this.isSelfEnrollment=this.selfEnrollGroupInfo.isSelfEnrollment}else this.isSelfEnrollment=!1}async openContentEnrollPanel(){this.fromView?this.ultraState.current.name.endsWith("discussion.view.with-grading.peek.discussion-details")?(await this.ultraState.leavePeekState(),await this.ultraState.leavePeekState(),await this.ultraState.goPeekState("content-group-enroll",{courseId:this.content.courseId,contentId:this.content.id,fromView:this.fromView})):(await this.ultraState.leavePeekState(),await this.ultraState.goPeekState("content-group-enroll",{courseId:this.content.courseId,contentId:this.content.id,fromView:this.fromView})):await this.ultraState.goPeekState("content-group-enroll",{courseId:this.content.courseId,contentId:this.content.id})}isBeforeEnrollment(){return this.selfEnrollGroupInfo&&"Before"===this.selfEnrollGroupInfo.enrollmentDateState}isOpenEnrollment(){return this.selfEnrollGroupInfo&&"Open"===this.selfEnrollGroupInfo.enrollmentDateState}isOpenEnrollmentWithEnding(){return this.selfEnrollGroupInfo&&"Open"===this.selfEnrollGroupInfo.enrollmentDateState&&null!=this.selfEnrollGroupInfo.relativeDate}isAfterEnrollment(){return this.selfEnrollGroupInfo&&"After"===this.selfEnrollGroupInfo.enrollmentDateState}};m=Object(n.__decorate)([Object(d.a)({moduleName:p,componentName:"bbGroupStudentEnrollment",template:c,bindings:{content:"<",fromView:"@"},requireModules:[i.d,o.a,a.moduleName,r.b]}),Object(n.__param)(0,Object(u.b)("$scope")),Object(n.__param)(1,Object(u.b)(i.f)),Object(n.__param)(2,Object(u.b)(o.b)),Object(n.__param)(3,Object(u.b)(a.serviceName)),Object(n.__param)(4,Object(u.b)(r.d))],m)},"5XZZ":function(e,t){e.exports='<div class="assessment-question">\n  <fieldset>\n    <div class="question-header question-header-review"\n         ng-class="{\'has-question-title\': assessmentQuestion.questionConfig.hasQuestionCountTitle, \'is-read-only\': !isPrivileged() || readOnly()}"\n         ng-if="assessmentQuestion.questionConfig.hasPoints || assessmentQuestion.questionConfig.hasQuestionCountTitle">\n      <div>\n          <bb-svg-icon ng-if="assessmentQuestion.canShowQuestionScoreRelatedDetail()"\n                       class="question-indicator {{::assessmentQuestion.getCorrectnessColor()}}"\n                       aria-label="{{::assessmentQuestion.getCorrectnessName()}}"\n                       size="medium"\n                       icon="{{::assessmentQuestion.getCorrectnessIcon()}}"></bb-svg-icon>\n          <legend class="question-label" ng-if="assessmentQuestion.questionConfig.hasQuestionCountTitle" bb-translate="components.directives.assessment-question.question-title" translate-values="{index: assessmentQuestion.questionAttempt.visibleQuestionNumber}"></legend>\n          \x3c!--Question goal --\x3e\n          <a ng-if="assessmentQuestion.questionConfig.hasQuestionCountTitle && assessmentQuestion.hasGoals()" href="javascript:void(0);"\n            ng-click="assessmentQuestion.openQuestionGoals()"\n            class="question-goal"\n            bb-translate-attrs="{\'aria-label\':\'components.directives.assessment-question.view-goal\', \'title\':\'components.directives.assessment-question.view-goal\'}"\n            analytics-id="components.directives.assessmentQuestion.viewGoal.link">\n            <bb-svg-icon size="medium" icon="goal"></bb-svg-icon>\n          </a>\n          <span class="question-full-credit-label"\n                bb-translate\n                ng-if="assessmentQuestion.questionAttempt.question.fullCredit && gradedQuestionAttempt.points && !isSmallBreakpoint">\n                components.directives.attempt-canvas.freeform-response.grade.question.full-credit-given\n          </span>\n          <bb-question-grade graded-question-attempt="gradedQuestionAttempt"\n                            hide-grade="!assessmentQuestion.canViewGrades"\n                            input-id="{{::assessmentQuestion.elementId}}"\n                            is-privileged="false"\n                            ng-if="assessmentQuestion.questionConfig.hasPoints && assessmentQuestion.questionAttempt.isScoreVisible">\n          </bb-question-grade>\n      </div>\n      <div ng-if="isSmallBreakpoint" class="question-grade-group">\n        <span class="question-full-credit-label"\n              bb-translate\n              ng-if="assessmentQuestion.questionAttempt.question.fullCredit && gradedQuestionAttempt.points">components.directives.attempt-canvas.freeform-response.grade.question.full-credit-given</span>\n      </div>\n    </div>\n    <div class="question-content" ng-show="assessmentQuestion.questionSpecificTemplateReady"></div>\n  </fieldset>\n</div>\n'},"5Yfa":function(e,t,s){"use strict";s.d(t,"a",(function(){return n})),s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return o})),s.d(t,"d",(function(){return a}));const n="bb-goal-selection-changed",i="bb-goal-alignment-saved",o="bb-goal-alignment-legacy-picker-saved";function a(e){return n+":"+e.getContentIdForGoalAlignment()}},"5dtR":function(e,t){e.exports='<div class="question-container">\n  <bb-rich-text-editor\n    ng-model="questionAttempt.question.questionText.rawText"\n    plugin-options="{\'attachment\': true, \'math\': true, \'contentMarket\': true}"\n    supports-inline-document-render="true"\n    is-read-only="true">\n  </bb-rich-text-editor>\n</div>\n\n<div bb-first-time-container class="guidance-wrapper question-answer-container">\n  <div bb-guidance-target component-key="components.directives.assessment-question.ftue.essay-attempt-authoring">\n    <bb-rich-text-editor\n      name="{{::assessmentQuestion.elementId}}"\n      ng-model="assessmentQuestion.givenAnswer.rawText"\n      is-read-only="assessmentQuestion.readOnly"\n      is-disabled="assessmentQuestion.isDisabled"\n      on-focus="assessmentQuestion.onEditorFocus()"\n      on-blur="assessmentQuestion.onEditorBlur()"\n      on-new-attachment-save-pressed="assessmentQuestion.onNewAttachmentSaving()"\n      on-change="assessmentQuestion.onBbRichTextEditorChange"\n      is-toolbar-hidden="!assessmentQuestion.isEditorActive"\n      plugin-options="assessmentQuestion.pluginOptions"\n      file-location="questionAttempt.givenAnswer.fileLocation"\n      web-location="questionAttempt.givenAnswer.webLocation"\n      editor-placeholder-key="components.directives.assessment-question.essay.placeholder.attempt"\n      sr-label="quattachmentestionAttempt.question.questionText.rawText"\n      supports-inline-document-render="false"\n      show-word-count="true">\n    </bb-rich-text-editor>\n  </div>\n\n  <bb-guidance component-key="components.directives.assessment-question.ftue.essay-attempt-authoring"\n               class="guidance-element-overlay stacked push-bottom" ng-if="questionAttempt.question.ui.questionTypePosition === 0">\n    <span bb-translate>components.directives.assessment-question.ftue.essay-attempt-authoring</span>\n  </bb-guidance>\n</div>\n'},"5m/6":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-filter-options",use:"icon-small-filter-options-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-filter-options"><path d="M1 1h8M1 5h8M1 9h8M1 13h5M13 1v14M11 13l2 2 2-2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"5uNO":function(e,t,s){},"5vTq":function(e,t){e.exports='<div class="grade-grid-cell grade-grid-body-cell student-column">\n  <div class="student-info">\n    <bb-user-avatar class="avatar"\n      user="user"\n      ng-click="gradeGridColumnStudentReborn.viewIndividualGrades(user.id, membershipId)"\n      analytics-id="components.directives.grade.grid.studentAvatar.link"\n    >\n    </bb-user-avatar>\n    <div class="name-and-groups">\n      <a class="username-link"\n        bb-peek-sref="view-individual-grades({ userId: user.id, membershipId: membershipId })"\n        bb-prevent-routing-click="div.bb-audio-player"\n        analytics-id="components.directives.grade.grid.studentUsername.link"\n      >\n        <bb-username class="ellipse username" user="user" auto-update="true" format-sync="true" show-pronouns="true" show-pronunciation="true" ng-class="{ inactive: !isUserCourseAvailable }"></bb-username>\n      </a>\n      <bb-filtered-users-groups\n        class="group-names"\n        user-id="user.id">\n      </bb-filtered-users-groups>\n    </div>\n  </div>\n</div>\n'},6:function(e,t){},"66CI":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-lock-circle",use:"icon-small-lock-circle-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-lock-circle"><g stroke-width="2"><circle cx="8" cy="8" r="7" transform="rotate(-90 8 8)" stroke-linecap="round" stroke-linejoin="round" /><path d="M5 8h6v3H5V8z" stroke-linecap="round" stroke-linejoin="round" /><path d="M6 9h4v1H6z" /><path d="M6 8V5.7143C6 4.857 6.6667 4 8 4m0 0c.3333 0-.3333 0 0 0zm0 0c1.3333 0 2 .8571 2 1.7143V8" stroke-linecap="round" stroke-linejoin="round" /></g></symbol>'});i.add(o);e.exports=o},"66CP":function(e,t){e.exports='<div class="content-item-icon" bb-load-bundle="components/directives/element-image/element-image-accessibility">\n  <bb-ui-content-icon icon="contentItemIcon.iconName" color="{{contentItemIcon.iconColor}}" not-decorative="true" ng-if="!contentItemIcon.customLtiIcon"></bb-ui-content-icon>\n  <div class="image-wrapper" ng-if="contentItemIcon.customLtiIcon">\n    <img bb-translate-attrs="{\'alt\': \'components.directives.element-image.element-image-accessibility.img-icon-\' + contentItemIcon.iconName }" ng-src="{{ ::contentItemIcon.customLtiIcon }}" />\n  </div>\n</div>\n'},"6CeR":function(e,t){e.exports='<div id="grade-grid-container" class="grade-grid-container">\n  <div class="spinner bb-secondary-color-2" ng-if="!gg.initialized" aria-hidden="true"></div>\n  <div class="overall-grade-setup grade-search-filter-panel student-column" ng-if="gg.showFilterCriteria">\n      <bb-grade-grid-search-filter-reborn merged-courses="::gg.mergedCourses"></bb-grade-grid-search-filter-reborn>\n  </div>\n\n  <div id="grade-grid" bb-grid-reborn="gg.gridOptions"></div>\n  <div class="overall-grade-setup text-center" ng-if="gg.isOverallPanelShown && gg.canViewOverallPanel">\n    <bb-setup-overall-grade show-fixed-view="gg.canViewOverallPanel" course-id="course().id" setup-overall-grade-hide-message-callback="gg.setupOverallGradeHideMessageCallback()"></bb-setup-overall-grade>\n  </div>\n</div>\n'},"6Fqm":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-search",use:"icon-small-search-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-search"><circle cx="6.5" cy="6.5" r="5.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M15 15l-4.5-4.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"6PP7":function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu">\n  <ul class="f-dropdown f-dropdown-overflow-menu reborn-dropdown" role="menu">\n    <li ng-if="col.isScorm()" role="presentation">\n      <a role="menuitem"\n         ng-click="col.previewScorm()"\n         href="javascript:void(0);"\n         analytics-id="components.directives.grade.grid.viewScorm">\n        <bb-svg-icon size="small" icon="visible"></bb-svg-icon>\n        <bb-translate class="ellipse">components.directives.grade.grid.viewScorm</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.canView() && !col.canEdit() && !col.isScorm()" role="presentation">\n      <a role="menuitem"\n          ng-click="col.viewOrEdit()"\n          href="javascript:void(0);"\n          analytics-id="components.directives.grade.grid.viewItem">\n        <bb-svg-icon size="small" icon="visible"></bb-svg-icon>\n        <bb-translate class="ellipse">components.directives.grade.grid.viewItem</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.canEdit()" role="presentation">\n      <a  role="menuitem"\n          class="js-edit-column"\n          ng-click="col.viewOrEdit()"\n          href="javascript:void(0);"\n          analytics-id="components.directives.grade.grid.edit">\n        <bb-svg-icon size="small" icon="draw"></bb-svg-icon>\n        <bb-translate class="ellipse">components.directives.grade.grid.edit</bb-translate>\n      </a>\n    </li>\n    <li ng-if="canPostGrades" role="presentation">\n      <a  role="menuitem"\n          class="js-post-column"\n          ng-click="col.postGrades()"\n          href="javascript:void(0);"\n          bb-confirmation-needed="{{grade.getPostAllGradeConfirmationNeededStringsKey(col.data)}}"\n          modal-aria-type="alertdialog"\n          show-type="always"\n          analytics-id="components.directives.grade.grid.post">\n        <bb-svg-icon size="small" icon="post"></bb-svg-icon>\n        <bb-translate class="ellipse">components.directives.grade.grid.post</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.data.isQuestionAnalysisAvailable() && col.canViewQuestionAnalysis()"\n        remove-from-dom="true"\n        role="presentation">\n      <a  role="menuitem"\n          class="js-open-question-analysis"\n          ng-click="col.openQuestionAnalysisOverview()"\n          href="javascript:void(0);"\n          analytics-id="components.directives.grade.grid.openQuestionAnalysis">\n        <bb-svg-icon size="small" icon="question-analysis"></bb-svg-icon>\n        <bb-translate class="ellipse">components.directives.grade.grid.openQuestionAnalysis</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.showDownloadResults()" role="presentation">\n      <a role="menuitem"\n          class="js-download-results"\n          ng-click="col.openDownloadTestResultsPanel()"\n          href="javascript:void(0)"\n          analytics-id="components.directives.grade.grid.downloadResults">\n        <bb-ui-icon-small-download></bb-ui-icon-small-download>\n        <bb-translate class="ellipse">components.directives.grade.grader-column.downloadResults.overflowMenuLabel</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.hasDownloads() && col.canDownloadAll()" role="presentation">\n      <a role="menuitem"\n          class="js-download-all"\n          ng-click="col.openDownloadAll()"\n          href="javascript:void(0)"\n          analytics-id="components.directives.grade.grid.downloadAll">\n        <bb-ui-icon-small-download-file></bb-ui-icon-small-download-file>\n        <bb-translate class="ellipse">components.directives.grade.grid.downloadSubmissions</bb-translate>\n      </a>\n    </li>\n    <li ng-if="col.canDelete()" role="presentation">\n      <a class="js-delete-column"\n         href="javascript:void(0);"\n         ng-click="col.triggerDelete($event)"\n         ng-switch="!!col.data.contentId"\n         analytics-id="components.directives.grade.grid.deleteColumn.link"\n         role="button">\n        \x3c!-- Content column --\x3e\n        <bb-delete callback-function="col.deleteColumn()"\n                   class="ellipse"\n                   content-id="col.data.contentId"\n                   course-id="col.data.courseId"\n                   display-mode="controls"\n                   ng-switch-when="true"\n                   role="menuitem">\n        </bb-delete>\n        \x3c!-- Grading column --\x3e\n        <bb-delete class="ellipse"\n                   confirmation-handler="{{col.getConfirmationMessage()}}"\n                   delete-function="col.deleteColumn()"\n                   display-mode="controls"\n                   ng-switch-when="false"\n                   role="menuitem">\n        </bb-delete>\n      </a>\n    </li>\n  </ul>\n</div>\n'},"6ZXc":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-download",use:"icon-medium-download-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-download"><path d="M12 15V1M8 11l4 4 4-4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M1 7v16h22V7h-4M1 7h4-4z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"6mvz":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("Llzl"),i=s("06dA"),o=s("1ZbL"),a=s("0JpG");const r="ultra.components.directives.rubric.rubricView",c={Class:i.RubricView,bindingNames:["analyticsId","criteria","decimalsLength","rubricType","maxScore"],renderLocalized:!0};n.module(r,[a.moduleName]).component("bbRubricView",Object(o.a)(c))},"6sUD":function(e,t){e.exports='<div>\n  \x3c!-- Display a loading spinner if page is rendering --\x3e\n  <div class="telemetry-loading-anim" ng-if="telemetryPanelHeader.showSpinner">\n    <div class="spinner bb-secondary-color-2"/>\n  </div>\n  <header class="panel-header simple-header">\n    <div class="panel-titles-container">\n      <div class="panel-sub-title">{{ ::course().name }}</div>\n      <div class="black-header-contents">\n        <button class="left-off-canvas-toggle menu-toggle standard-button dark-background"\n                type="button"\n                analytics-id="components.directives.telemetry.panel.menu.button">\n          <bb-svg-icon size="small" icon="main-menu"></bb-svg-icon>\n          <span class="sr-only" bb-translate>components.directives.telemetry.panel.menu</span>\n        </button>\n        <h1 class="panel-title" ng-if="::titleKey" bb-translate>{{::titleKey}}</h1>\n        <h1 class="panel-title" ng-if="title">{{::title}}</h1>\n        \x3c!-- BUTTON 2 (displayed to the left of Button 1) --\x3e\n        <button ng-if="buttonTwoIcon" id="button-two"\n                aria-haspopup="true"\n                class="standard-button dark-background hide-for-large-up"\n                bb-translate-attrs="{\'aria-label\': buttonTwoAriaLabel,\'title\': buttonTwoTitle}"\n                ng-click="buttonTwoCallback()"\n                ng-class="{ \'active\': mobileStudentListVisible }"\n                analytics-id="components.directives.telemetry.panel.buttonwTwo.button">\n          <i class="{{ ::buttonTwoIcon }}"></i>\n          <span class="sr-only" bb-translate>buttonTwoTitle</span>\n        </button>\n        \x3c!-- BUTTON 1 (displayed on the far right) --\x3e\n        <button ng-if="buttonOneIcon"\n                id="button-one"\n                class="standard-button dark-background hide-for-large-up"\n                bb-translate-attrs="{\'aria-label\': buttonOneAriaLabel,\'title\': buttonOneTitle}"\n                ng-click="buttonOneCallback()"\n                analytics-id="components.directives.telemetry.panel.buttonOne.button">\n          <i class="{{ ::buttonOneIcon }}"></i>\n          <span class="sr-only" bb-translate>buttonOneTitle</span>\n        </button>\n      </div>\n    </div>\n  </header>\n</div>\n'},"6xt4":function(e,t){e.exports='<div id="{{::addContentButton.getButtonWrapperId()}}" tabindex="-1">\n  <button\n    id="{{::addContentButton.getTargetId()}}"\n    class="button-add-content js-show-add-options"\n    data-show-add-options\n    ng-click="addContentButton.toggleOverflowMenu()"\n    ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n    aria-expanded="{{addContentButton.isMenuVisible}}"\n    aria-haspopup="true"\n    aria-controls="{{::\'add-content-menu-\' + addMenuId}}"\n    aria-label="{{addContentButton.addButtonAriaLabel}}"\n    ng-focus="addContentButton.showButton()"\n    ng-blur="addContentButton.hideButton()"\n    analytics-id="components.directives.add-content-button.course-outline.addContentMenu.button">\n  </button>\n</div>\n<bb-ui-contextual-menu\n  items="addContentButton.items"\n  target-id="::addContentButton.getTargetId()"\n  show="addContentButton.isMenuVisible && !addContentButton.isEmptyFolder()"\n  directional-hint="::addContentButton.getDirectionalHint()"\n  dismiss="addContentButton.hideAddContentMenu"\n  aria-labelledby="{{::addContentButton.getTargetId()}}"\n  analytics-id="components.directives.add-content-button.contextualMenu">\n</bb-ui-contextual-menu>\n<ul class="element-list-add-menu angular-animate small-block-grid-2 medium-block-grid-2"\n    ng-class="\'large-block-grid-3\'"\n    ng-attr-id="{{::\'add-content-menu-\' + addMenuId}}"\n    ng-show="addContentButton.isEmptyFolder()">\n  <li ng-if="addContentButton.isEmptyFolder()">\n    <a class="js-create"\n       bb-peek-sref="content-manage.create(addContentButton.getInsertLocationData())"\n       analytics-id="components.directives.add-content-button.course-outline.link">\n      <div>\n        <bb-svg-icon size="small" icon="add"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.create</span>\n      </div>\n    </a>\n  </li>\n  <li ng-if="addContentButton.currentCourse.canCopy() && addContentButton.isEmptyFolder()">\n    <a class="content-import-button"\n       bb-peek-sref="content-manage.copy(addContentButton.getInsertLocationData())"\n       analytics-id="components.directives.add-content-button.course-outline.import.link">\n      <div>\n        <bb-svg-icon size="small" icon="duplicate"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.copy</span>\n      </div>\n    </a>\n  </li>\n  <li>\n    <bb-file-upload\n      url="/v1/files"\n      data="{}"\n      monitor-leave="true"\n      allow-multiple="true"\n      hide-transclude-during-upload="false"\n      is-content="true"\n      primary-key="fileListViewLocalId"\n      skip-zip-file-check="true"\n      class="js-file-upload"\n      depth="depth()">\n      <button ng-if="addContentButton.isEmptyFolder()"\n              class="file-upload-button"\n              analytics-id="components.directives.add-content-button.course-outline.upload.button">\n        <div>\n          <bb-svg-icon size="small" icon="upload"></bb-svg-icon>\n          <span bb-translate>components.directives.add-content-button.upload</span>\n        </div>\n      </button>\n    </bb-file-upload>\n  </li>\n  <li ng-if="addContentButton.isCloudServiceAvailable">\n    <bb-file-upload\n      allow-multiple="true"\n      monitor-leave="true"\n      is-third-party-upload="true"\n      hide-transclude-during-upload="false"\n      click-enabled="false"\n      cloud-upload-selected-content-id="addContentButton.positionForFiles.positionAfter"\n      primary-key="fileListViewId"\n      skip-zip-file-check="true"\n      third-party-download-handler="addContentButton.downloadFile"\n      target-div="{{\'#\' + fileListViewId}}"\n      disable-drag="true"\n      ignored-states="[\'content-manage.import\']">\n      <button\n        class="doc-add-media clear ng-scope"\n        bb-cloud-storage-integration\n        primary-key="fileListViewId"\n        attach-handler="addContentButton.defaultAttachHandler"\n        web-location="{{webLocation}}"\n        file-location="{{fileLocation}}"\n        allow-multiple="true"\n        on-files-selected="addContentButton.onFilesSelectedHandler"\n        analytics-id="components.directives.add-content-button.course-outline.importContentFromCloudStorage.button">\n        <bb-svg-icon size="small" icon="upload-cloud"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.importContentFromCloudStorage.title</span>\n      </button>\n    </bb-file-upload>\n  </li>\n  <li ng-if="addContentButton.isEmptyFolder()">\n    <a class="js-content-market"\n       href="javascript:void(0);"\n       ng-click="addContentButton.openContentMarket()"\n       analytics-id="components.directives.add-content-button.course-outline.openContentMarket.link">\n      <div>\n        <bb-ui-icon-small-content-market class="bb-ui-icon-folder"></bb-ui-icon-small-content-market>\n        <span bb-translate>components.directives.add-content-button.contentMarket</span>\n      </div>\n    </a>\n  </li>\n  <li ng-if="addContentButton.isEmptyFolder()">\n    <a class="js-content-collection"\n       bb-peek-sref="content-collection(addContentButton.getInsertLocationData())"\n       analytics-id="components.directives.add-content-button.course-outline.contentCollection.link">\n      <div>\n        <bb-svg-icon size="small" icon="content-collection"></bb-svg-icon>\n        <span bb-translate>components.directives.add-content-button.contentCollection</span>\n      </div>\n    </a>\n  </li>\n</ul>\n'},"70Xn":function(e,t){e.exports='<bb-modal class="notification automatic-zero-confirmation" \n          modal-translate-options="modalTranslateOptions"\n          modal-aria-type="alertdialog"\n          analytics-id-tag-prefix="components.directives.pastDueZero">\n  <div name="modal-contents">\n    \x3c!-- Instructions --\x3e\n    <p bb-translate>{{ modalTranslateOptions.instructions.key }}</p>\n  </div>\n  <button name="modal-footer-button-primary" \n          type="button" \n          class="button confirm-ok js-primary-button" \n          ng-click="okAction()" \n          analytics-id="course.grades.pastDue.confirmationNeeded.confirm"\n          bb-translate>\n          course.grades.pastDue.confirmationNeeded.confirm\n  </button>\n  <button name="modal-footer-button-secondary" \n          type="button" \n          class="button button--secondary confirm-cancel js-secondary-button" \n          ng-click="cancelAction()" \n          analytics-id="course.grades.pastDue.confirmationNeeded.cancel"\n          bb-translate>\n          course.grades.pastDue.confirmationNeeded.cancel\n  </button>\n</bb-modal>'},"7OC/":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return g}));var n=s("Llzl"),i=s("d8yC"),o=s("LN5R"),a=s("o5Lu"),r=s("lEL+"),c=s("TmUJ"),l=s("dF44"),d=s("+4Px"),u=s("qH3X"),p=s("8NsT"),m=s("6PP7"),h=s("LTOG"),b=s("zGdY");const g="ultra.components.directives.gradeGridColumnHeaderOverallReborn";class v extends h.a{constructor(t,s,n,i,o,a,r,c){super(s,c),this.rootScope=t,this.element=n,this.attrs=i,this.$compile=o,this.gradeGridRebornController=a,this.grade=r,this.canPostGrades=!1,this.initializeEventHandler(),this.menuScope=s.$new(!0),s.$watch("col",(e=>{s.columnMetadata=e.data,this.col=e,this.highlight(this.col),this.canPostGrades=this.grade.canPostGrades(e.gridData.course,e.data)})),s.$on(l.b.CELL_FOCUSED,(()=>{n.find(".content").focus()})),n.find(".content").on("keydown",(t=>{if(t.keyCode===d.g)this.scope.$emit(l.b.LEAVE_GRID);else{if(!d.y(t))return;e(t.target).click()}t.preventDefault(),t.stopPropagation()})),n.find(".content").on("keyup",(e=>{d.y(e)&&(e.preventDefault(),e.stopPropagation())})),s.$on(u.a.FOCUSIN_CELL,((e,t)=>{t.columnId===this.col.id&&(this.gradeGridRebornController.getElement().find(".is-active").removeClass("is-active"),this.element.find(".content").addClass("is-active"))})),s.$on(u.a.FOCUSOUT_CELL,((e,t)=>{t.columnId===this.col.id&&this.element.find(".content").removeClass("is-active")}))}initializeEventHandler(){this.element.find(".content-header-bg").focusin((()=>{this.focusin()})).focusout((()=>{this.focusout()}))}focusin(){this.rootScope.$broadcast(u.a.FOCUSIN_CELL,{columnId:this.col.id})}focusout(){this.rootScope.$broadcast(u.a.FOCUSOUT_CELL,{columnId:this.col.id})}get possible(){const e=this.gradeGridRebornController.getGridData().getSchema()[this.scope.columnMetadata.gradingSchemaId];return(null==e?void 0:e.scaleType)===b.SchemaScaleType.Score?i.b(this.scope.columnMetadata.possible,2):100}popupMenu(t){const s=`grade-grid-column-header-menu-reborn-${this.col.id}`;if(!this.gradeGridRebornController.isMenuExisting(s)){const n=e(t.target).closest(".grade-grid-header-cell").offset();n.top+=87,this.menuScope.col=this.col,this.menuScope.grade=this.grade,this.menuScope.autoDestroy=!1,this.menuScope.adjustPosition=e=>{const t=n.left+e.width(),s=this.gradeGridRebornController.getGradeGridContainerElementRight();t>s&&(n.left-=t-s+Object(c.a)()),e.offset(n)},this.gradeGridRebornController.popupMenu(s,m,this.menuScope),this.timeout((()=>{const e=this.gradeGridRebornController.getPopupMenu();e.on("keydown",(t=>{t.keyCode===d.g||t.keyCode===d.u?(e.data("destroy")(),this.scope.$emit(l.b.CELL_FOCUSED),t.preventDefault(),t.stopPropagation()):d.y(t)&&this.scope.$emit(l.b.CELL_FOCUSED)})),this.gradeGridRebornController.getMenuitems().first().focus()}),this.menuScope,0,!1),t.preventDefault(),t.stopPropagation()}}}v.$inject=["$rootScope","scope","element","attrs","$compile","gradeGridRebornController",a.k,r.b];class f{constructor(e){this.$injector=e,this.restrict="E",this.template=p,this.scope=!0,this.require=`^${o.a}`,this.link=(e,t,s,n)=>{e.gradeGridColumnHeaderOverallReborn=this.$injector.instantiate(v,{scope:e,element:t,attrs:s,gradeGridRebornController:n})}}}f.$inject=["$injector"],n.module(g,[]).directive("bbGradeGridColumnHeaderOverallReborn",["$injector",e=>e.instantiate(f)])}).call(this,s("71td"))},"7TUR":function(e,t){e.exports='<div class="fimb-question-container fimb-attempt-review">\n  <div class="fimb-question">\n    <bb-rich-text-editor\n      ng-model="assessmentQuestion.viewHelper.questionText"\n      plugin-options="editorPluginOptions"\n      supports-inline-document-render="true"\n      is-read-only="true">\n    </bb-rich-text-editor>\n  </div>\n  <bb-question-answer-status correctness="::assessmentQuestion.getAnswerResult()"\n                             hide-correctness-text="::!assessmentQuestion.canShowCorrectAnswerRelatedDetail()"\n                             was-late="::assessmentQuestion.wasAnsweredLate()"\n                             align-icon-to-top="assessmentQuestion.viewHelper.alignIconTop()"\n                             class="fimb-question-answer">\n    <div class="acceptable-answer" ng-if="assessmentQuestion.canShowCorrectAnswerRelatedDetail()" ng-repeat="identifier in assessmentQuestion.viewHelper.orderedIdentifiers">\n      <div ng-switch on="assessmentQuestion.viewHelper.answersMap[identifier].evaluationType">\n        <span ng-switch-when="CONTAINS" bb-translate\n              translate-values="{identifier: identifier, numberOfValues: assessmentQuestion.viewHelper.answersMap[identifier].values.length, values: assessmentQuestion.viewHelper.answersMap[identifier].values}">\n          components.directives.assessment-question.fimb.review.acceptable-answers.contains.plural\n        </span>\n        <span ng-switch-when="EXACT" bb-translate\n              translate-values="{identifier: identifier, numberOfValues: assessmentQuestion.viewHelper.answersMap[identifier].values.length, values: assessmentQuestion.viewHelper.answersMap[identifier].values}">\n          components.directives.assessment-question.fimb.review.acceptable-answers.exact.plural\n        </span>\n        <span ng-switch-when="MATCHES" bb-translate\n              translate-values="{identifier: identifier, pattern: assessmentQuestion.viewHelper.answersMap[identifier].values[0]}">\n          components.directives.assessment-question.fimb.review.acceptable-answers.matches\n        </span>\n      </div>\n      <div class="acceptable-answer-details" ng-if="::assessmentQuestion.viewHelper.showDetailsForAnswer(identifier)"\n           ng-switch on="::assessmentQuestion.viewHelper.answersMap[identifier].evaluationType">\n        <span ng-switch-when="CONTAINS" ng-switch on="assessmentQuestion.viewHelper.answersMap[identifier].caseSensitive">\n          <span ng-switch-when="true" bb-translate>components.directives.assessment-question.fimb.review.answer-details.contains.case-sensitive</span>\n          <span ng-switch-when="false" bb-translate>components.directives.assessment-question.fimb.review.answer-details.contains.not-case-sensitive</span>\n        </span>\n        <span ng-switch-when="EXACT" ng-switch on="assessmentQuestion.viewHelper.answersMap[identifier].caseSensitive">\n          <span ng-switch-when="true" bb-translate>components.directives.assessment-question.fimb.review.answer-details.exact.case-sensitive</span>\n          <span ng-switch-when="false" bb-translate>components.directives.assessment-question.fimb.review.answer-details.exact.not-case-sensitive</span>\n        </span>\n      </div>\n    </div>\n  </bb-question-answer-status>\n  <bb-automated-question-feedback\n    feedback="assessmentQuestion.getAutomatedQuestionFeedback()"\n    is-collapsible="assessmentQuestion.allowCollapsingOfAutomatedFeedbackIfShown()"\n    editor-plugins-options="automatedFeedbackEditorPluginOptions"\n  />\n</div>\n'},"7UH7":function(e,t){e.exports='<div class="text-editor" tabindex="-1" bb-load-bundle="components/directives/text-editor" bb-cache-compilation="basic-text-editor">\n  <label ng-if="inputLabelKey" class="text-editor-label" for="{{::elementId}}" bb-translate>{{::inputLabelKey}}</label>\n  <textarea id="{{::elementId}}"\n         class="read-mode editor-element"\n         name="{{::elementId}}"\n         tabindex="0"\n         type="text"\n         bb-validate-maxlength="{{::getInputMaxLength()}}"\n         ng-model="ngModel"\n         maxlength="{{::(getInputMaxLength() || \'\')}}"\n         ng-model-options="{ getterSetter: true }"\n         ng-disabled="readonly()"\n         fng-blur="textEditor.onBlur()"\n         fng-focus="textEditor.onFocus()"\n         fng-keyup="textEditor.onChange($event)"\n         fng-keydown="textEditor.onKeydown($event)"\n         bb-translate-attrs="{ \'placeholder\': \'{{placeholderKey}}\' }"\n         aria-label="{{textEditor.getContentLabel()}}"\n         translate-attrs-values="{{::placeholderAttrsValues}}"\n         bb-focus-on="{{::focusOn}}"\n         ng-required="::fieldRequired()"\n         analytics-id="components.textEditor.basicEditor.textarea"></textarea>\n  <div bb-validation-messages\n       ng-if="::!noValidationMessage()"\n       for="{{::elementId}}" immediate="true">\n    <span ng-message="maxlengthImmediate">\n      <span bb-translate translate-values="{ diff: element.$errorImmediate.maxlengthImmediate.diff }">\n        components.directives.validation.messages.errors.maxlength.plural\n      </span>\n    </span>\n  </div>\n</div>\n'},"7XaY":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-export",use:"icon-small-export-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-export"><path d="M7 9l8-8M12 1h3v3M15 9.091V15H1V1h5.909" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"7b1Y":function(e,t){e.exports='<div class="question-answer-container">\n  <bb-question-answer-status was-late="::assessmentQuestion.wasAnsweredLate()"\n                             hide-correctness-text="true"\n                             class="essay-attention">\n  </bb-question-answer-status>\n  <bb-rich-text-editor\n    plugin-options="{\'attachment\': true, \'math\': true, \'contentMarket\': true}"\n    ng-model="assessmentQuestion.questionAttempt.question.questionText.rawText"\n    supports-inline-document-render="true"\n    is-read-only="true">\n  </bb-rich-text-editor>\n  <div class="panel">\n    <span class="answer-panel-heading" bb-translate>components.directives.assessment-question.essay.review.your-answer</span>\n    <bb-rich-text-editor\n      ng-model="assessmentQuestion.questionAttempt.givenAnswer.rawText"\n      plugin-options="{\'attachment\': true, \'math\': true}"\n      supports-inline-document-render="false"\n      is-read-only="true">\n    </bb-rich-text-editor>\n  </div>\n</div>\n'},"7cYF":function(e,t,s){"use strict";s.d(t,"e",(function(){return j})),s.d(t,"c",(function(){return T})),s.d(t,"b",(function(){return $})),s.d(t,"a",(function(){return R})),s.d(t,"d",(function(){return E}));s("aSyE"),s("VcPJ");var n=s("nsO7"),i=s("Llzl"),o=s("+O05"),a=s("k9iv"),r=s("o5Lu"),c=s("X/qj"),l=s("0JpG"),d=s("5RJJ"),u=s("pjml"),p=s("5uPl"),m=s("IjED"),h=s("lEL+"),b=s("TnpK"),g=s("Ed3w"),v=s("DYK3"),f=s("3Nzc"),w=s("yC9S"),S=s("p7NW"),C=s("nmzr"),y=s("R4kC"),O=s("fGDP"),A=s("cpZm"),I=s("15AK"),D=s("wtKk"),k=s("zGdY"),_=s("e0uO");const j="trigger_question_regrading-task",T="open-assessment-feedback-editor",$="getSubmissionGradingBlockingStatus";class R{constructor(e,t,s,n,i,a,r,c,l,d,u,p,m,h,b,y,k){this.$rootScope=e,this.$scope=t,this.course=s,this.column=n,this.content=i,this.errorModalService=a,this._gradeService=r,this.gradebookPermissionService=c,this.bbLocalize=l,this.membershipService=d,this.timeout=u,this.ultraState=p,this.UserModel=m,this.originalityReportService=h,this.slideoutPanelService=b,this.scheduleTask=y,this.submissionListService=k,this.AssessmentCanvasMode=_.a,this.namesCarousel=Object.create(null),this.contentCarousel=Object.create(null),this.isFeedbackDirty=!1,this.isFeedbackEmpty=!0,this.attemptsWereDeleted=!1,this.isLoading=!0,this.isExternalSubmissions=!1,this.saveAsOverride=!0,this.isAnyQuestionEditing=!1,this.isQuestionRegradingBlocked=!1,this.confirmedClose=!1,this.showBanner=!1,this.gradedQuestionAttemptsByAttemptId=Object.create(null),this.hideBanner=()=>{this.$scope.$apply((()=>{this.showBanner=!1}))},this.regradingNotifier=e=>{e||this.$rootScope.$broadcast(f.a)},this.doSlide=()=>{this.$scope.$emit(D.b),this.isFeedbackDirty=!1,this.namesCarousel.slide(this.slideOffset)},this.overrideSlideClick=e=>{const t=e-this.carouselHelper.currentSlideIndex;this.transitionTo(t)},this.canViewGrades=this.gradebookPermissionService.canViewGrades(),this.canViewAttempts=this.gradebookPermissionService.canViewAttempts(),this.originalityReportService.setCourseContent(i,!0),this.isExternalSubmissions=o.a.isExternalSubmissionsAssessment(i),this.isAnyQuestionEditing=s.isComplete(),this.submissionGradingNavigationBlocker={navigationPromise:null};const T=p.params;this.isOpenFromGridView=T.gradebookView===O.b.Grid,this.isOpenFromStudentList=T.gradebookView===O.b.List&&T.listViewType===A.b.id,this.membershipId=T.membershipId,this.$scope.$on("bb-update-question-grade",((e,t)=>{this._onUpdateQuestionGrade(t)})),this.column.hasRubricAssociation()&&w.b.OnRootScope(this.$scope,S.e,(()=>this.reloadGrade())),this.shouldQueryRegradingTask(s,i)&&(this.scheduleTask.scheduleTask({courseId:s.id,taskName:g.a.QuestionRegrading,scope:t,delay:1e4,notifier:this.regradingNotifier}),this.isRefFromAssessment?t.$on(j,(()=>{this.isAnyQuestionEditing?this.isQuestionRegradingBlocked=!0:this.reloadGrade(!0)})):t.$on(f.a,(()=>{this.isAnyQuestionEditing?this.isQuestionRegradingBlocked=!0:this.reloadGrade(!0)})),t.$on(v.c,((e,s)=>{t.$broadcast(v.b,s),this.isAnyQuestionEditing=!0})),t.$on(v.i,((e,s)=>{this.isAnyQuestionEditing=!1,this.isQuestionRegradingBlocked&&(s!==v.d.CANCEL&&s!==v.d.SAVE_WITHOUT_REGRADING||this.reloadGrade(!0),this.isQuestionRegradingBlocked=!1),t.$applyAsync()}))),t.$on("$stateChangeStart",((e,t)=>{t.name.indexOf(C.GradeRoutes.SUBMISSION_GRADING)<0&&(this.attemptsWereDeleted&&this.$scope.$root.$broadcast("refresh-attempt-count"),!this.isAnyQuestionEditing||this.course.isComplete()||this.confirmedClose||(e.preventDefault(),this.$scope.$broadcast("show-confirmation","submission-question-regrading")))})),t.$on("$stateChangeSuccess",((e,t)=>{this.slideoutPanelService.setSlideoutPanelState()})),this.unsubscribeOnRowsUpdated=this.submissionListService.addOnRowsUpdated(s.id,this.column.id,this.onSubmissionListRowsUpdated),t.$on("$destroy",(()=>{this.unsubscribeOnRowsUpdated(),this.originalityReportService.clearReport()})),t.namesCarouselInitialized=()=>!!this.namesCarousel.id||void 0,t.$watch("::namesCarouselInitialized()",(()=>{t.namesCarouselInitialized()&&this.onNamesCarouselInit()})),t.$on(I.ASSESSMENT_FEEDBACK_CHANGED,((e,t,s)=>{this.isFeedbackDirty=t,this.isFeedbackEmpty=s})),t.$on(I.ASSESSMENT_FEEDBACK_SAVED,(()=>this.isFeedbackDirty=!1)),this.$scope.$on("QUESTION-GRADE-PILL-EDITED",((e,t,s)=>{var n,i;(null===(n=this.carouselHelper)||void 0===n?void 0:n.currentRow.grade.isOverrideGrade())&&!(null===(i=this.carouselHelper)||void 0===i?void 0:i.currentRow.grade.isPastDueZero())&&t===this.column.id&&(this.showBanner=!0)})),this.$scope.$on("OVERRIDE-UNDONE",((e,t)=>{t.columnId===this.column.id&&(this.showBanner=!1)}))}get bannerMessage(){return this.getLocalizedTextByKey("components.directives.grade.grading-bar.banner-message")}getLocalizedTextByKey(e){return this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:e,noWrap:!0})}showNextPeerVisibilityFTUE(){return!1}onFeedbackIconClick(){this.$scope.$broadcast(T)}onNamesCarouselInit(){this.namesCarousel.registerSlideStatusUpdater({className:{whenTrue:"as-prev",whenFalse:""},scopeVarName:"asPrevButton",predicate:e=>e.slideIndex>=0&&e.slideIndex===e.currentSlide-1}),this.namesCarousel.registerSlideStatusUpdater({className:{whenTrue:"as-next",whenFalse:""},scopeVarName:"asNextButton",predicate:e=>e.slideIndex===e.currentSlide+1&&e.slideIndex<e.totalSlides})}shouldQueryRegradingTask(e,t){return!e.isComplete()&&!t.isScorm()}get isRefFromAssessment(){return this.ultraState.current.name.indexOf(".peek.gradebook-item.assessment")>0}isSlidePanelOpen(){return this.slideoutPanelService.isOpen()}getAttemptDetail(e=this.carouselHelper.currentRow){return this.getAttempt(e)?this.getAttempt(e).getToolAttemptDetailItem(this.column.scoreProviderHandle):null}showAttemptCanvas(){const e=this.getAttempt(this.carouselHelper.currentRow);return!(!(null==e?void 0:e.toolAttemptDetail)||(null==e?void 0:e.isInProgress()))}hasContent(e){if(!e)return!1;const t=e.getToolAttemptDetailItem(this.column.scoreProviderHandle);return t&&t.assessment&&t.assessment.questionCount>0}canRenderSubmission(){return!(!(this.carouselHelper&&this.carouselHelper.ready&&this.carouselHelper.currentRow)||!this.isAttemptSet())}loadGradedQuestionAttempts(e){return this.course.gradebook.attempts.$buildRaw(e).assessment.gradedQuestionAttempts.$refresh({expand:"questionAttempt.question,questionAttempt.question.usageCount,questionAttempt.question.sourceInfo,questionAttempt.answerCorrectness"}).$then((t=>{t.setPostStatusAndGroupAttemptId(e),this.gradedQuestionAttemptsByAttemptId[e.id]=t}))}setSaveAsOverride(){if(this.column&&this.column.isScorm())return void(this.saveAsOverride=!1);if(this.column&&this.column.hasRubricAssociation())return void(this.saveAsOverride=!0);const e=this.getAttemptDetail();e&&(this.saveAsOverride=e.assessment.hasAnswerableQuestions)}getQuestionsForAttempt(){const e=this.getAttempt(this.carouselHelper.currentRow);if(!i.isUndefined(e))return o.a.getQuestionsForAttempt(e,this.column.scoreProviderHandle)}_onUpdateQuestionGrade(e){let t=0;const s=this.gradedQuestionAttempts,i=Object(n.findIndex)(s,(t=>t.questionAttempt.id===e.questionAttempt.id));if(-1===i)return;s[i]=e;const o=this.getAttemptDetail();s.forEach((e=>{e.questionAttempt.attemptStatus===k.AttemptStatus.Completed&&t++})),t!==s.length&&o.status!==k.AttemptStatus.Completed||this.reloadGrade()}closeWithoutSaving(){this.confirmedClose=!0,this.ultraState.leavePeekState(this.ultraState.current.name)}showOverflowMenu(){return this.gradebookPermissionService.canDelegatedEnterAttemptFeedback(this.column,this.getAttempt(this.carouselHelper.currentRow))&&!this.isSlidePanelOpen()}isPeerGradingAndAnonymousUser(e){return!1}transitionTo(e){0!==e&&(this.showBanner=!1,this.slideOffset=e,this.submissionGradingNavigationBlocker={navigationPromise:null},this.$scope.$broadcast($,this.submissionGradingNavigationBlocker),this.submissionGradingNavigationBlocker.navigationPromise?this.submissionGradingNavigationBlocker.navigationPromise.then((()=>{this.doSlide()})):this.doSlide())}get hasRubricAssociation(){return this.column.hasRubricAssociation()}get isPeerReviewer(){return!1}}R.$inject=["$rootScope","$scope","currentCourse","currentColumn","currentContent",a.d,r.k,c.b,l.serviceName,d.b,h.b,b.d,u.Jb.serviceName,p.b,m.b,g.c,y.b];class E{constructor(e,t){this.ready=!1,this.submissionGradingController=e,this.mergeRows(t)}mergeRows(e){const t=e.filter((e=>null!=e.grade&&e.attemptCount>0)),s=this.rows?this.rows.reduce(((e,t)=>(e[t.membership&&t.membership.id]=t,e)),{}):{};t.forEach(((e,n)=>{const i=e.membership&&e.membership.id;i in s&&(t[n]=s[i])})),this.rows=t,this.currentSlideIndex=Object(n.findIndex)(this.rows,(e=>this.submissionGradingController.findIndex(e))),this.currentSlideIndex<=0&&(this.currentSlideIndex=0)}updateRows(e){const t=e.filter((e=>null!=e.grade)),s=Object(n.findIndex)(t,(e=>this.submissionGradingController.findIndex(e))),i=Object(n.findIndex)(this.rows,(e=>this.submissionGradingController.findIndex(e)));-1!==s&&-1!==i&&(this.rows[i].grade=t[s].grade,this.rows[i].attemptCount=t[s].attemptCount,this.rows[i].grade.ui.groupAttempt=t[s].grade.groupAttempts[t[s].grade.groupAttempts.length-1]),this.currentSlideIndex=Object(n.findIndex)(this.rows,(e=>this.submissionGradingController.findIndex(e))),this.currentSlideIndex<=0&&(this.currentSlideIndex=0)}disableSliderNavigation(){return this.submissionGradingController.isSlidePanelOpen()}showPrevArrow(){return this.currentSlideIndex>0&&!this.disableSliderNavigation()}showNextArrow(){return this.currentSlideIndex<this.rows.length-1&&!this.disableSliderNavigation()}isPrevious(e){return e>=0&&e===this.currentSlideIndex-1}isCurrent(e){return e===this.currentSlideIndex}isNext(e){return e===this.currentSlideIndex+1&&e<this.rows.length}updateSlide(e){this.submissionGradingController.isAnyQuestionEditing=!1,e>=0&&e<this.rows.length&&this.currentSlideIndex!==e&&(this.currentRow.hasBeenViewed=!0,this.currentSlideIndex=e,this.submissionGradingController.onSlideUpdate())}findRowByGradeId(e){return this.rows.find((t=>t.grade.id===e))}findRowIndexByGrade(e){return this.rows.findIndex((t=>t.grade.id===e.id))}updateRowGradeByGrade(e){const t=this.findRowIndexByGrade(e);this.rows[t].grade=e}get initialSlide(){return this.currentSlideIndex}get currentRow(){return this.rows[this.currentSlideIndex]}wasDeleted(){return this.rows&&0===this.rows.length||!this.currentRow||this.currentRow&&this.currentRow.hasNoSubmissions()||this.currentRow.grade.groupAssociationId&&-1===this.getNextAttemptIndex()}getNextAttemptIndex(){var e,t;const s=null===(t=null===(e=this.currentRow)||void 0===e?void 0:e.grade)||void 0===t?void 0:t.groupAttempts;for(let e=s.length-1;e>=0;e--)if(!s[e].isInProgress())return e;return-1}}},"7eG8":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("VLO0");const o="ultra.components.directives.bbUiIcon.medium.NoTimeLimit";Object(n.a)(i.a,o,"bbUiIconMediumNoTimeLimit")},"7kzC":function(e,t){e.exports='<bb-modal id="dialog-override-warning-modal" class="notification dialog-override-warning-modal"\n         modal-title-key="components.directives.grade.grade-input.overrideDialogWarning.title"\n         analytics-id-tag-prefix="components.directives.grade.grade-input.overrideDialogWarning"\n         >\n  <div name="modal-contents">\n    <p class="warning-message" bb-translate="components.directives.grade.grade-input.overrideDialogWarning.message" translate-values="{grade}">\n    </p>\n  </div>\n  <button name="modal-footer-button-secondary" class="button button--secondary js-secondary-button js-cancel" ng-click="closeModal(false)" analytics-id="components.directives.grade.grade-input.overrideDialogWarning.secondaryButtonText">\n      <bb-translate>components.directives.grade.grade-input.overrideDialogWarning.secondaryButtonText</bb-translate>\n  </button>\n  <button name="modal-footer-button-primary" class="button js-primary-button" ng-click="closeModal(true)" analytics-id="components.directives.grade.grade-input.overrideDialogWarning.primaryButtonText">\n      <bb-translate>components.directives.grade.grade-input.overrideDialogWarning.primaryButtonText</bb-translate>\n  </button>\n</bb-modal>\n'},"7zkF":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("MTZf");const o="ultra.components.directives.bbUiIcon.large.Scormengine";Object(n.a)(i.Scormengine,o,"bbUiIconLargeScormengine")},"8+lX":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-replies",use:"icon-small-replies-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-replies"><path d="M1 5h14v10H1v-4" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" /><path d="M3 3L1 5l2 2" stroke-width="2" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"810X":function(e,t,s){"use strict";var n=s("D57K"),i=s("Llzl"),o=s("LN5R"),a=s("pjml"),r=s("0JpG"),c=s("dF44"),l=s("5vTq"),d=(s("kkz3"),s("1ZbL"));const u="ultra.components.directives.group.filteredUsersGroups",p={Class:s("ZQFV").FilteredUsersGroups,withProvider:!0,renderLocalized:!0,bindingNames:["userId"]};i.module(u,[r.moduleName]).component("bbFilteredUsersGroups",Object(d.a)(p));var m=s("TnpK"),h=s("nmzr"),b=s("aHpC");s.d(t,"a",(function(){return g}));const g="ultra.components.directives.gradeGridColumnStudentReborn";let v=class{constructor(e,t,s,n,i,o){this.scope=e,this.element=t,this.attrs=s,this.gradeGridRebornController=n,this.bbLocalize=i,this.ultraState=o,e.$watch("row",(t=>{const s=n.getGridData().getRowById(t.id).metadata;e.user=s.user,e.membershipId=s.id,e.fullName=this.bbLocalize.formatUsernameSync(e.user,r.ILocaleUsernameFormat.Short,e,{noWrap:!0}),e.isUserCourseAvailable=s.isAvailable,e.courseRole=this.getLocalizedRoleNameByCourseRole(s.courseRole)})),this.isRtl=this.bbLocalize.isRTL(),e.$on(c.b.ENTER_CELL,((e,t)=>{t.find("bb-username").click()}))}getLocalizedRoleNameByCourseRole(e){return e.identifier&&e.identifier.toString()in a.w.toBeLocalizedRoleLabels?this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:a.w.toBeLocalizedRoleLabels[e.identifier.toString()]}):e.courseName.rawValue}viewIndividualGrades(e,t){this.ultraState.goPeekState(h.Routes.Course.COURSE_GRADES_VIEW_INDIVIDUAL_GRADES,{userId:e,membershipId:t})}};v=Object(n.__decorate)([Object(n.__param)(0,Object(b.b)("scope")),Object(n.__param)(1,Object(b.b)("element")),Object(n.__param)(2,Object(b.b)("attrs")),Object(n.__param)(3,Object(b.b)("gradeGridRebornController")),Object(n.__param)(4,Object(b.b)(r.serviceName)),Object(n.__param)(5,Object(b.b)(m.d))],v);class f{constructor(e){this.$injector=e,this.restrict="E",this.template=l,this.scope=!0,this.require=`^${o.a}`,this.link=(e,t,s,n)=>{e.gradeGridColumnStudentReborn=this.$injector.instantiate(v,{scope:e,element:t,attrs:s,gradeGridRebornController:n})}}}f.$inject=["$injector"],i.module(g,[u,m.b]).directive("bbGradeGridColumnStudentReborn",["$injector",e=>e.instantiate(f)])},"85nY":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-conversation",use:"icon-small-conversation-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-conversation"><path d="M15 4.5C15 6.433 13.433 8 11.5 8c-.4457 0-.872-.0833-1.264-.2352L8 8l.25-2.1985A3.4905 3.4905 0 018 4.5C8 2.567 9.567 1 11.5 1S15 2.567 15 4.5zM7 15c0-2-2-4-4-4M3 11c1.1046 0 2-.8954 2-2s-.8954-2-2-2-2 .8954-2 2 .8954 2 2 2z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"884J":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("+1SJ");const o="ultra.components.directives.bbUiIcon.small.Upload";Object(n.a)(i.a,o,"bbUiIconSmallUpload")},"8NsT":function(e,t){e.exports='<div class="grade-grid-cell grade-grid-header-cell">\n  <div class="content content-header-bg"\n       ng-click="gradeGridColumnHeaderOverallReborn.popupMenu($event)"\n       tabindex="0"\n       role="columnheader"\n       aria-describedby="summary-points-{{::columnMetadata.id}}"\n       analytics-id="components.directives.grade.grid.gradeGridColumnHeaderOverallReborn.popupMenu"\n  >\n    <div bb-content-item-icon content-column="columnMetadata" class="element-image" role="presentation"></div>\n    <div class="grade-grid-header-title grade-name">\n      <bb-svg-icon class="visibility-icon"\n                   ng-if="!columnMetadata.visible"\n                   size="small"\n                   icon="invisible"\n                   role="img"\n                   bb-translate-attrs="{\'aria-label\': \'components.directives.grade.grader-column.aria-label.gradeNotVisible\'}"\n      ></bb-svg-icon>\n      <span class="ellipse" title="{{::columnMetadata.columnName}}">{{::columnMetadata.columnName}}</span>\n    </div>\n  </div>\n  <div class="grade-grid-header-summary" tabindex="1" id="summary-points-{{columnMetadata.id}}">\n    <span class="sr-only">{{columnMetadata.columnName}}</span>\n    <span class="ellipse points"\n          bb-translate-attrs="{\'title\': \'components.directives.grade.grid.points.plural\'}" translate-attrs-values="{count: gradeGridColumnHeaderOverallReborn.possible}"\n          bb-translate translate-values="{count: gradeGridColumnHeaderOverallReborn.possible}">components.directives.grade.grid.points.plural</span>\n    <span class="sr-only"\n          bb-translate translate-values="{count: columnMetadata.itemsCount}">components.directives.grade.grid.items.plural</span>\n  </div>\n\n  <div class="grade-grid-header-summary" tabindex="1" ng-if="columnMetadata.isCalculated()" id="summary-info-{{columnMetadata.id}}">\n    <span class="sr-only">{{columnMetadata.columnName}}</span>\n    <span class="ellipse items-count"\n          bb-translate-attrs="{\'title\': \'components.directives.grade.grid.itemsTip\'}" translate-attrs-values="{count: columnMetadata.itemsCount}"\n          bb-translate translate-values="{count: columnMetadata.itemsCount}">components.directives.grade.grid.items.plural</span>\n  </div>\n</div>\n'},"94SL":function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("o5Lu"),i=s("pjml"),o=s("zGdY");class a{constructor(e,t,s,n,i,a){this.contentData=e,this.gradableItemUserOptionService=t,this.context=s,this.grade=n,this.schemaService=i,this.contextCourseMembership=a,this.currentAttempt=e.groupAttempt||e.attempt,this.highestPossibleScore=e.gradingColumn.possible,this.dueDate=e.gradingColumn.dueDate,this.gradableItemUserOptionService.getGradableItemUserOption(e.courseContent.courseId,e.gradingColumn.id,[a.courseMembership.id]).then((e=>{var t;this.studentHasDueDateException=!!e.byCourseMembershipId[a.courseMembership.id],this.studentHasDueDateException&&(this.dueDateException=e.byCourseMembershipId[a.courseMembership.id],this.studentHasNoDueDateAsException=(null===(t=this.dueDateException)||void 0===t?void 0:t.dueDateExceptionType)===o.LearnFetchGradableItemUserOptionTypes.Unlimited)}))}init(){this.dueDateException=this.gradableItemUserOptionService.getGradableItemUserOptionByMembershipId(this.contentData.gradingColumn.id,this.contextCourseMembership.courseMembership.id),this.studentHasDueDateException=!!this.dueDateException,this.setAttemptCountsAndDate()}get unsubmittedAttemptsLeft(){var e;if(!this.contentData.gradeDetail)return this.contentData.gradingColumn.multipleAttempts;let t=this.contentData.gradeDetail.attemptsLeft;return this.contentData.attempt&&(null===(e=this.currentAttempt)||void 0===e?void 0:e.isInProgress())&&t++,t}isUnlimitedAttempts(){return this.contentData.gradingColumn.isUnlimitedAttempts()}get isDueDateEnforced(){var e,t;return(null===(t=null===(e=this.contentData.courseContent.getDeployedAssessment())||void 0===e?void 0:e.deploymentSettings)||void 0===t?void 0:t.isDueDateEnforced)&&!this.contentData.courseContent.hasDueDateException()}get isLateAttemptCreationDisallowed(){var e;return(null===(e=this.contentData.courseContent.getDeployedAssessment())||void 0===e?void 0:e.deploymentSettings.isLateAttemptCreationDisallowed)&&!this.contentData.courseContent.hasDueDateException()}get isOverdue(){var e;const t=this.isDueDateEnforced&&(null===(e=this.currentAttempt)||void 0===e?void 0:e.isInProgress()),s=this.studentHasDueDateException?this.dueDateException.effectiveDueDate:this.dueDate;return s&&s.getTime()-this.context.getServerTime().getTime()<0&&!this.contentData.courseContent.hasDueDateException()&&!t}get noNewAttemptsAreAllowed(){const e=this.studentHasDueDateException?this.dueDateException.effectiveDueDate:this.dueDate;return e&&e.getTime()-this.context.getServerTime().getTime()<0&&this.isLateAttemptCreationDisallowed}get willDueDateOverrideTimeLimit(){var e;return!(!this.isDueDateEnforced||!this.timedTestAttemptDetail.hasTimeLimit)&&((null===(e=this.currentAttempt)||void 0===e?void 0:e.isInProgress())?this.timedTestAttemptDetail.withinDueDatelimit&&(this.dueDate.getTime()-this.currentAttempt.creationDate.getTime())/1e3<this.timedTestAttemptDetail.adaptedTime.softlimitSeconds:this.timedTestAttemptDetail.dueDateIsSoonerThanSoftTimeLimit)}isRubricAssociated(){return this.contentData.gradingColumn.hasRubricAssociation()}get rubric(){return this.contentData.gradingColumn.getAssociatedRubric()}isRubricScoreOverridden(){return this.contentData.gradeDetail&&this.contentData.gradeDetail.isOverrideGrade()}get rubricViewIsVisible(){return this.isRubricAssociated()&&!this.rubricEvaluationIsVisible}get rubricEvaluationIsVisible(){return this.isRubricAssociated()&&!this.isRubricScoreOverridden()&&angular.isDefined(this.currentAttempt)&&this.currentAttempt.isCompleted()&&angular.isDefined(this.currentAttempt.rubricEvaluation)}setAttemptCountsAndDate(){this.contentData.gradeDetail?this.contentData.gradingColumn.grades.$buildRaw(this.contentData.gradeDetail).attempts.$refresh({fields:"id,status,attemptDate"}).$then((e=>{this.attemptCount=e.length,this.attemptCountSubmitted=e.getNumAttemptsSubmitted(),this.attemptCountSubmittedLate=e.getNumAttemptsSubmittedLate(this.studentHasDueDateException?this.dueDateException.effectiveDueDate:this.dueDate),this.areAllAttemptsCompleted=e.isAllGradedAndPosted(),this.isAtLeastOneAttemptCompleted=e.isAtLeastOneGradedAndPosted();const t=i.C.parseAttemptAggregationModel(this.contentData.gradingColumn&&this.contentData.gradingColumn.aggregationModel),s=n.d.getDefaultAttemptIdToLoad(t,this.contentData.gradeDetail),o=e.find((e=>e.id===s));this.aggregationModelRelevantAttemptDate=o&&o.attemptDate,this.onAttemptCountComplete()})):this.attemptCount=0}get attemptsSubmittedDescriptionKey(){return"course.content.assessment.overview.attemptsSubmitted.status."+(this.isOverdue?"late":"onTime")}get attemptsRemainingDescriptionKey(){return"course.content.assessment.overview.attemptsRemaining."+(this.isUnlimitedAttempts()?"unlimited":"plural")}showAttemptDescription(){return this.contentData.gradingColumn&&angular.isDefined(this.attemptCount)}showAttemptsSubmittedDescription(){return this.contentData.gradingColumn&&this.contentData.gradingColumn.isMultipleAttempts()&&(this.currentAttempt&&this.currentAttempt.isSubmitted()||this.attemptCount>1)}}},"9Fiv":function(e,t,s){"use strict";var n=s("D57K"),i=s("71td"),o=s("nsO7"),a=s("0JpG"),r=s("lEL+"),c=s("X/qj"),l=s("+4Px"),d=s("5Dl8"),u=s("aHpC"),p=s("yC9S"),m=s("gK/k"),h=s("dF44"),b=s("s52B"),g=s("7/CN");s.d(t,"c",(function(){return v})),s.d(t,"a",(function(){return f})),s.d(t,"b",(function(){return C}));const v="rbGridContainer";let f=class{constructor(e,t,s,n,i,o,a){this.$q=e,this.position=t,this.columns=s,this.grid=n,this.timeout=i,this.bbLocalize=o,this.gradebookPermissionService=a,this.renderedRows=[],this.nextRenderedRows=[],this.renderedColumns=[],this.nextRenderedColumns=[],this.scrollTop=0,this.scrollLeft=0,this.id=n.id+"-container-"+t,this.rows=n.options.memberships,this.totalWidth=this.initColumnsPosition(s,!1),this.totalHeight=n.options.rowHeight*n.options.memberships.length,this.isMain="center"===t,this.headerBorder=n.options.headerBorder,this.rowBorder=n.options.rowBorder,this.callbacks=n.options.callbacks,this.isRtl=this.bbLocalize.isRTL(),this.deferedInit=this.$q.defer(),this.initialized=this.deferedInit.promise}initColumnsPosition(e=this.columns,t=!0){const s=[];let n=0;for(let i=0;i<e.length;i++){const o=e[i];o.accumulativeWidth=n,t&&s.push(`.rb-column-position-${o.id} {${this.isRtl?"right":"left"}: ${Object(d.b)(n)};}`),n+=o.columnWidth}if(t){i(`style#${this.id}`).remove();const e=i(`<style scoped id="${this.id}"></style>`);e.text(s.join("\n")),this.grid.$element.prepend(e)}return n}getCssPosition(){return this.isRtl&&"center"!==this.position?"left"===this.position?"right":"left":this.position}getContainerStyle(){const e=this.grid.containers.left,t=this.grid.containers.right;return this.isMain?{[this.isRtl?"right":"left"]:Object(d.b)(e&&e.totalWidth),[this.isRtl?"left":"right"]:Object(d.b)(t&&t.totalWidth+this.grid.scrollbarWidth)}:{[this.getCssPosition()]:"0"}}getHeaderCanvasStyle(){return{width:Object(d.b)(this.totalWidth),height:Object(d.b)(this.grid.options.headerHeight)}}getBodyCanvasStyle(){return{width:Object(d.b)(this.totalWidth),height:Object(d.b)(this.totalHeight)}}getBodyStyle(){return{"overflow-x":this.hasHScrollbar?"scroll":"hidden","overflow-y":this.hasVScrollbar?"scroll":"hidden"}}init(e,t){if(this.element=t,this.scope=e,this.element.addClass(this.id),this.header=this.element.find(".rb-grid-header"),this.body=this.element.find(".rb-grid-body"),this.canAddColumn()){const e=this.scope.$watch("container",(t=>{null!=t&&t.canAddColumn()&&(this.columnAdder=new w(this.element.find(".rb-add-column"),this),e(),this.deferedInit.resolve(this))}))}return this.adjustRows(),this.adjustColumns(),this.addEventListeners(),this.canAddColumn()||this.deferedInit.resolve(this),this.initialized}toggleFirstAddColumnPlaceholder(e){this.element.find(".rb-add-column-placeholder.first")[e?"show":"hide"]()}resetColumns(e){this.columns=[...e],this.columns.sort(((e,t)=>e.order-t.order)),this.totalWidth=this.initColumnsPosition(e,!1),this.adjustColumns()}resetRows(e){this.initialized.then((()=>{this.rows=e,this.totalHeight=this.grid.options.rowHeight*this.rows.length,this.adjustRows()}))}addEventListeners(){this.element.on("wheel",this.handleWheel.bind(this)),this.body.on("scroll",this.handleScroll.bind(this))}handleScroll(){const e=(t=this.body.scrollLeft(),s=this.isRtl,n=this.getMaxScrollLeft(),s&&Object(g.e)()!==g.a.Negative?n-t:Math.abs(t));var t,s,n;const i=this.body.scrollTop();this.grid.scrollContainers({scrollLeft:e!==this.scrollLeft?e:null,scrollTop:i!==this.scrollTop?i:-1})}handleWheel(e){if(this.body[0].scrollWidth===this.body[0].clientWidth&&this.body[0].scrollHeight===this.body[0].clientHeight)return;const t=e.originalEvent;let s=this.isRtl?-t.deltaX:t.deltaX,n=t.deltaY;if(1===t.deltaMode){const e=parseInt(this.element.css("font-size"),10);s*=e,n*=e}if(this.atTop()&&n<0||this.atBottom()&&n>0||this.atLeft()&&s<0||this.atRight()&&s>0)return;if(0===s&&0===n)return;e.preventDefault(),e.stopPropagation();let i=-1,o=null;0!==n&&(i=Math.max(0,Math.min(this.scrollTop+n,this.getMaxScrollTop()))),0!==s&&(o=Math.max(0,Math.min(this.scrollLeft+s,this.getMaxScrollLeft()))),this.grid.scrollContainers({scrollTop:i,scrollLeft:o})}scrollHorizontally(e){const t=(s=e,n=this.isRtl,i=this.getMaxScrollLeft(),n?Object(g.e)()===g.a.Negative?-s:i-s:s);var s,n,i;this.body.scrollLeft(t),this.header.scrollLeft(t),this.scrollLeft=e,this.adjustColumns()}scrollVertically(e){this.body.scrollTop(e),this.scrollTop=e,this.adjustRows()}canAddColumn(){return this.isMain&&this.grid.canAddColumn()&&this.gradebookPermissionService.canModify()}getVisibleColRange(){const e=this.scrollLeft;let t=0,s=this.columns.length;for(let s=0,n=0;s<this.columns.length;s++)if(n+=this.columns[s].columnWidth,n>=e){t=s;break}for(let t=0,n=0;t<this.columns.length;t++)if(n+=this.columns[t].columnWidth,n>=e+this.body[0].clientWidth){s=t;break}return{start:t,end:s}}calculateNextRenderedColumns(){const{start:e,end:t}=this.getVisibleColRange();this.nextRenderedColumns=this.columns.slice(e,t+h.a+1)}adjustColumns(){this.calculateNextRenderedColumns(),this.grid.debounceRefresh()}getVisibleRowRange(){const e=Math.ceil(this.body[0].clientHeight/this.grid.options.rowHeight),t=Math.floor(this.scrollTop/this.grid.options.rowHeight);return{start:t,end:t+e}}calculateNextRenderedRows(){const{start:e,end:t}=this.getVisibleRowRange();this.nextRenderedRows=this.rows.slice(e,t+h.e)}isRowOutOfBound(e){const{start:t,end:s}=this.getVisibleRowRange();return{top:e<=t,bottom:e>=s}}isColOutOfBound(e){const{start:t,end:s}=this.getVisibleColRange();return{left:e<=t,right:e>=s}}adjustRows(){this.calculateNextRenderedRows(),this.grid.debounceRefresh()}applyData(){this.renderedRows=this.nextRenderedRows,this.renderedColumns=this.nextRenderedColumns}getMaxScrollTop(){return this.totalHeight-this.body[0].clientHeight}getMaxScrollLeft(){return this.totalWidth-this.body[0].clientWidth}getTopRowScrollTop(e){return this.grid.options.rowHeight*e}getBottomRowScrollTop(e){return Math.max(0,this.grid.options.rowHeight*(e+1)-this.body[0].clientHeight)}getLeftColScrollLeft(e){return e.accumulativeWidth}getRightColScrollLeft(e){return Math.max(0,e.accumulativeWidth+e.columnWidth-this.body[0].clientWidth)}atTop(){return 0===this.scrollTop}atBottom(){return this.scrollTop===this.getMaxScrollTop()}atLeft(){return!this.isMain||0===this.scrollLeft}atRight(){return!this.isMain||this.scrollLeft===this.getMaxScrollLeft()}};f=Object(n.__decorate)([Object(n.__param)(0,Object(u.b)("$q")),Object(n.__param)(1,Object(u.b)("position")),Object(n.__param)(2,Object(u.b)("columns")),Object(n.__param)(3,Object(u.b)("grid")),Object(n.__param)(4,Object(u.b)(r.b)),Object(n.__param)(5,Object(u.b)(a.serviceName)),Object(n.__param)(6,Object(u.b)(c.b))],f);class w{constructor(e,t){this.element=e,this.container=t,this.grid=t.grid,this.scope=t.scope,this.bbLocalize=t.bbLocalize,e.css("height",`calc(100% - ${Object(d.b)(this.grid.scrollbarWidth)}`),this.button=e.find(".button"),this.firstPlaceholder=this.container.element.find(".rb-add-column-placeholder.first"),this.button.on("keydown",(e=>{let t;this.grid.previousCell.tabPressed=!1;let s=this.container.currentColumn;if(l.z(e)||e.keyCode===l.j||e.keyCode===l.g){const e=s||this.grid.containers.left.columns.slice(-1)[0],n=this.container.columns.indexOf(e);n>=0&&this.container.isColOutOfBound(n).left?this.grid.scroll({scrollLeft:this.container.getLeftColScrollLeft(e)},(()=>{this.grid.$scope.$broadcast(h.b.FOCUS_CELL,t,e)})):this.grid.$scope.$broadcast(h.b.FOCUS_CELL,t,e)}else{if(!l.A(e)&&e.keyCode!==l.s)return;{const e=this.grid.getFocusableColumns();let n=NaN,i=NaN;s?(s=e[(e.indexOf(s)+1)%e.length],s===e[0]&&(t=this.container.rows[0],i=0)):s=this.container.columns[0];const a=this.container.columns.indexOf(s);this.container.isColOutOfBound(a).right&&(n=this.container.getRightColScrollLeft(s)),Object(o.isNaN)(n)&&Object(o.isNaN)(i)?this.grid.$scope.$broadcast(h.b.FOCUS_CELL,t,s):this.grid.scroll({scrollTop:i,scrollLeft:n},(()=>this.grid.$scope.$broadcast(h.b.FOCUS_CELL,t,s)))}}this.hide(),e.preventDefault(),e.stopPropagation()})),p.b.OnWindow("click",(e=>{i(e.target).closest(this.button).length||(this.button.removeClass("active"),this.hide())}),this.container.scope),this.container.scope.$on(h.b.SCROLL_H,(()=>{this.hide()})),this.container.scope.$on(h.b.SCROLL_V,(()=>{this.button.hasClass("active")&&this.hide()}))}enter(e,t){this.button.hasClass("active")||this.show(i(e.target),t)}leave(){this.button.hasClass("active")||this.hide()}show(e=this.firstPlaceholder,t){this.element.show(),this.element.offset(e.offset()),this.element.css("opacity","1"),this.container.currentColumn=t||this.grid.containers.left.columns.slice(-1)[0],this.addAriaLabel()}hide(){this.element.hide(),this.element.css("opacity","0")}onClick(e){this.button.toggleClass("active"),this.button.hasClass("active")&&this.container.callbacks.column(e,this.container.currentColumn)}addAriaLabel(){const e=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grid.lastAddButtonAriaLabel",params:{columnName:this.container.currentColumn.data.columnName},noWrap:!0,noEscape:!0});this.button.attr("aria-label",e)}}class S{}class C{constructor(){this.replace=!0,this.restrict="A",this.require=[`^${m.a}`,v],this.template=b,this.controller=S,this.scope=!0,this.link=(e,t,s,n)=>{const[i,o]=n;i.initializedWithOptions.then((()=>{const n=i.containers[s[v]];e.container=n,e.grid=i,n.init(e,t),o.container=n}))}}}},"9G/E":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-profile-user",use:"icon-medium-profile-user-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-profile-user"><path d="M12 13c3.3137 0 6-2.6863 6-6s-2.6863-6-6-6-6 2.6863-6 6 2.6863 6 6 6zM23 23c-.5-5-4.5-10-11-10S1.5 18 1 23" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"9KIl":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return I}));var n=s("D57K"),i=s("Llzl"),o=s("nsO7"),a=s("d8yC"),r=s("X/qj"),c=s("LN5R"),l=s("o5Lu"),d=s("pjml"),u=s("lEL+"),p=s("0JpG"),m=s("12mu"),h=s("aHpC"),b=s("T1pL"),g=s("dF44"),v=s("qH3X"),f=s("TmUJ"),w=s("+4Px"),S=s("wJOA"),C=s("zGdY"),y=s("AVdi"),O=s("mWXo"),A=s("ZQFV");const I="ultra.components.directives.gradeGridColumnOverallReborn";let D=class t{constructor(e,t,s,n,i,a,r,c,l,d,u,p,m,h){this.rootScope=e,this.window=t,this.$q=s,this.CourseModel=n,this.gradeService=i,this.gradebookPermissionService=a,this.$compile=r,this.scope=c,this.element=l,this.attrs=d,this.gradeGridRebornController=u,this.timeout=p,this.bbLocalize=m,this.$modal=h,this.closeModal=e=>{e?this.modalInstance.close():this.modalInstance.dismiss()},this.initializeEventHandler(),this.gridData=this.gradeGridRebornController.getGridData(),c.$watchGroup(["row","col"],(e=>{this.changeRecord(e)})),c.$on(v.a.REFRESH,((e,t)=>{const s=t.rowId,n=t.columnIds;o.forEach(n,(e=>{this.scope.row.id===s&&this.cell.column.id===e&&(this.initializeCell(s,e),this.initializeUI(),this.initializeGradeDetail(this.cell.data),this.scope.$broadcast(v.a.REFRESH_OVERALL_EDITOR))}))})),c.$on(g.b.ENTER_CELL,((e,t)=>t.find(".grade-grid-cell").click())),c.$on("$destroy",(()=>{})),this.overrideDialogScope=c.$new()}changeRecord(e){const[t,s]=e;this.initializeCell(t.id,s.id),this.initializeState(),this.initializeUI(),this.initializeGradeDetail(this.cell.data)}initializeEventHandler(){this.element.parents(".rb-cell").focusin((()=>{this.focusin()})).focusout((()=>{this.focusout()})),this.element.children(".grade-grid-cell").mousedown((()=>this.mousedown()))}focusin(){this.rootScope.$broadcast(v.a.FOCUSIN_CELL,{rowId:this.scope.row.id,columnId:this.cell.column.id})}focusout(){this.rootScope.$broadcast(v.a.FOCUSOUT_CELL,{rowId:this.scope.row.id,columnId:this.cell.column.id})}initializeUI(){const e=this.element.children(".grade-grid-cell");this.isLoading||this.isEditing?e.children(".score").hide():e.children(".overall-display-grade").show()}initializeGradeDetail(e){const t=this.gridData.getSchema()[this.cell.column.data.gradingSchemaId];o.isUndefined(null==e?void 0:e.grade)||o.isNull(null==e?void 0:e.grade)?this._gradeDetail=void 0:t.scaleType===C.SchemaScaleType.Score?this._gradeDetail=this.gradeService.toFixedGradeDetail(e.grade):this._gradeDetail=e.grade.displayGrade.isOverride?this.gradeService.truncateGradeDetail(e.grade):this.gradeService.gradeDetailToPercentage(e.grade);const s=this.extractGradeFromGradeDetail(this.gradeDetail);this.setUpScreenReader(this.cell,s)}extractGradeFromGradeDetail(e){return e&&e.displayGrade&&e.displayGrade.perfCode&&e.displayGrade.perfCode.code||e&&e.getScore()}get disabledEditor(){return!this.canBeEdited&&o.isEmpty(this.extractGradeFromGradeDetail(this.gradeDetail))}initializeState(){this._isEditing=!1}initializeCell(e,t){this.cell=this.gridData.getCell(e,t),this._oldScore=this._score=void 0}get isReady(){return!o.isUndefined(this.cell)}get isLoading(){return!this.isReady||!this.cell.isLoaded}get score(){if(this.isReady){if(o.isUndefined(this._score)){let e=this.gradeDetail&&this.gradeDetail.getScore();e=e?this.bbLocalize.formatNumberSync(Math.round(100*parseFloat(e))/100,this.scope,{maximumFractionDigits:l.d.DEFAULT_GRADEBOOK_SETTINGS_AFTER_DECIMAL}):e,o.isEmpty(e)&&this.gradeDetail&&!o.isUndefined(this.gradeDetail.displayGrade.perfCode)&&(e=this.gradeDetail.displayGrade.perfCode.code),this._oldScore=this._score=e}return this._score}}set score(e){this._score=e}get isReadonly(){if(this.isReady)return!1}get isEditing(){return this._isEditing}get gradeDetail(){return this._gradeDetail}get pointsPossible(){var e;if(this.gridData.getSchema()[this.cell.column.data.gradingSchemaId].scaleType===C.SchemaScaleType.Score){const t=null!=(null===(e=this._gradeDetail)||void 0===e?void 0:e.manualGrade)?this._gradeDetail.pointsPossible:this.cell.column.data.possible;return a.b(null!=t?t:this.cell.column.data.possible,2)}return 100}get pointsPossibleToDisplay(){return null==this.pointsPossible?null:this.bbLocalize.formatNumberSync(this.pointsPossible,this.scope,{maximumFractionDigits:l.d.DEFAULT_GRADEBOOK_SETTINGS_AFTER_DECIMAL})}insertCellEditor(){this.editorScope=this.scope.$new(!1,this.scope),this.$compile(t.OVERALL_EDITOR_TEMPLATE)(this.editorScope,(e=>this.element.children(".grade-grid-body-cell").append(e))),this.timeout((()=>{this.addInputKeyEventListeners();const e=this.scope.$on(g.b.SCROLL_H,(()=>{this.closeEditor(),e(),t(),this.scope.$apply()})),t=this.scope.$on(g.b.SCROLL_V,(()=>{this.closeEditor(),t(),e(),this.scope.$apply()}))}),this.scope,200)}removeCellEditor(){this.element.find("#bb-grade-grid-overall-editor-reborn").remove()}gotoNextCell(){this.nextDeferred=this.$q.defer(),this.nextDeferred.promise.then((()=>{this.scope.$emit(g.b.ENTER_NEXT_CELL)}))}mousedown(){e(this.window).trigger("click")}isConfirmDialogExisting(){return!!e(".grade-grid-group-confirm-dialog").length}get canBeEdited(){return!this.gridData.course.isComplete()&&!o.isUndefined(this.cell)&&this.gradebookPermissionService.canOverrideGrades()}enterEditor(e){this.isConfirmDialogExisting()||!this.canBeEdited||this.isLoading||this._isEditing||(this._isEditing=!0,this.element.find(".overall-display-grade").hide(),this.insertCellEditor(),this.popupMenu(e))}popupMenu(t){const s=`grade-grid-notation-menu-reborn-${this.scope.row.id}-${this.scope.col.id}`;if((this.scope.col.gradeNotations.length||this.gradeDetail&&this.gradeDetail.displayGrade&&this.gradeDetail.displayGrade.isOverride)&&!this.gradeGridRebornController.isMenuExisting(s)){const n=e(t.target).closest(".grade-grid-cell").offset();n.top+=60;const i=this.scope.$new(!1);i.adjustPosition=e=>{const t=n.left+e.width(),s=n.top+e.height(),i=this.gradeGridRebornController.getGradeGridContainerElementRight(),o=this.gradeGridRebornController.getGradeGridContainerElementBottom();t>i&&(n.left-=t-i+Object(f.a)()),s>o&&(n.top-=e.height()+40),e.offset(n)},this.gradeGridRebornController.popupMenu(s,O,i),this.addMenuKeyEventListeners(),t.preventDefault(),t.stopPropagation()}}openOverrideDialog(e){this.overrideDialogScope.closeModal=this.closeModal,this.overrideDialogScope.grade=e,this.modalInstance=this.$modal.open({template:y.b,scope:this.overrideDialogScope,resolve:{translations:[p.serviceName,e=>e.loadBundle("components/directives/grade/grade-input")]}})}addInputKeyEventListeners(){this.element.find("#bb-grade-grid-overall-editor-reborn input").on("keydown",(e=>{const t=this.gradeGridRebornController.getMenuitems();if(w.A(e))t.first().focus();else{if(!w.z(e))return;t.last().focus()}e.preventDefault(),e.stopPropagation()}))}addMenuKeyEventListeners(){this.timeout((()=>{const t=this.gradeGridRebornController.getPopupMenu();t.on("keydown",(s=>{const n=this.gradeGridRebornController.getMenuitems();if(w.A(s)){const t=n.index(e(s.target))+1;t<n.length?n.eq(t).focus():this.element.find(".grade-grid-cell").trigger("click",!0)}else if(w.z(s)){const t=n.index(e(s.target))-1;t>=0?n.eq(t).focus():this.element.find(".grade-grid-cell").trigger("click",!0)}else if(w.y(s))this.scope.$emit(g.b.LEAVE_CELL);else{if(s.keyCode!==w.g)return;t.data("destroy")(),this.scope.$emit(g.b.LEAVE_CELL)}s.preventDefault(),s.stopPropagation()}))}),this.scope,0,!1)}areGradesComplete(){const e=this.cell.column.data.calculatedFormula,t=e.aliases,{items:s,formula:n}=Object(A.unpackFormulaGradeItems)(e,this.gridData.getColumnMetadatas()),i=n?Object(A.switchFormula)(n,{advanced:()=>this.findIncludedColumnIdsForAliases(t),sumSelected:()=>this.findIncludedColumnIdsForFormulaItems(s),weighted:()=>this.findIncludedColumnIdsForFormulaItems(s)}):this.findIncludedColumnIdsForAliases(t);return this.gridData.getColumnMetadatas().filter((e=>i[e.id])).every((e=>{var t;return null===(t=this.gridData.getCell(this.cell.row.metadata.id,e.id).getGrade())||void 0===t?void 0:t.isGraded()}))}findIncludedColumnIdsForAliases(e){const t=Object.entries(e).filter((([e])=>e.startsWith("c"))).reduce(((e,[,t])=>({...e,[t]:!0})),{}),s=Object.entries(e).filter((([e])=>e.startsWith("i"))).reduce(((e,[,t])=>({...e,[t]:!0})),{});return this.gridData.getColumnMetadatas().filter((e=>s[e.id]||t[e.gradebookCategoryId])).reduce(((e,t)=>({...e,[t.id]:!0})),{})}findIncludedColumnIdsForFormulaItems(e){return e.reduce(((e,t)=>{var s;return t.isCategory&&t.el&&!t.isExempted?{...e,...this.findIncludedColumnIdsForFormulaItems(null!==(s=t.childGradeItems)&&void 0!==s?s:[])}:t.isCalculation&&t.el&&!t.isExempted?{...e,[t.id]:!0}:t.isCategory||t.isCalculation||t.isExempted?e:{...e,[t.id]:!0}}),{})}onInputBlur(e,t){var s,n;if(!this.isLoading&&this._isEditing&&(this.closeEditor(),e)){const e=this.gridData.getSchema()[this.cell.column.data.gradingSchemaId],i=this.score;this.score=t;const r=this.gradeService.parseGrade(t,e,this.scope),c=this.createGradeSubmission(e,r);if(this.score){const e=o.find(this.cell.column.gradeNotations,(e=>e.code===this.score));e&&(c.perfCodeId=e.id)}if(this.score&&e.scaleType===C.SchemaScaleType.Score&&!o.isNaN(Number(r))&&this.isDirty())if(c.pointsPossible=this.pointsPossible,(null===(s=this.modalInstance)||void 0===s?void 0:s.opened)||this.areGradesComplete())(null===(n=this.modalInstance)||void 0===n?void 0:n.opened)||this.saveGrade(c);else{const e=this.gradeService.pointToPercentage(Number(r),this.pointsPossible);this.element.find(".grade-grid-cell").eq(0).focus(),this.openOverrideDialog(a.b(e,2)),this.modalInstance.opened.then((()=>{this.modalInstance.result.then((()=>{this.saveGrade(c)}),(()=>{this.score=i}))})).finally((()=>{this.modalInstance.opened=null}))}else this.saveGrade(c)}}closeEditor(){!this.isLoading&&this._isEditing&&(this._isEditing=!1,this.removeCellEditor(),this.editorScope.$destroy(),this.element.find(".overall-display-grade").show())}isDirty(){if(o.isUndefined(this._oldScore)&&!o.isEmpty(this.score))return!0;if(!o.isUndefined(this._oldScore)){const e=this.bbLocalize.parseNumberSync(this._oldScore,this.scope),t=this.bbLocalize.parseNumberSync(this.score,this.scope);return o.isNaN(e)||o.isNaN(t)?this._oldScore!==this.score:e!==t}return!1}createGradeSubmission(e,t){const s=this.gradeService.createGradeSubmission(this.cell.column.data,t,e);return s.clearGrade=this.gradeService.wasGradeCleared(this._oldScore,this.score),s}saveGrade(e){if(this.isDirty()){if(o.isUndefined(e)){const t=this.gridData.getSchema()[this.cell.column.data.gradingSchemaId];e=this.createGradeSubmission(t,this.gradeService.parseGrade(this.score,t,this.scope))}this.gradeService.saveGrade(e,this.cell.data&&this.cell.data.grade,void 0,{userId:this.cell.row.metadata.user.id}).then((e=>this.cell.column.data.summary.$fetch())).then((()=>{this.gridData.refreshDataCell(this.cell.row,this.cell.column),this.rootScope.$broadcast(g.b.DATA_UPDATE),this.nextDeferred&&this.areGradesComplete()&&(this.nextDeferred.resolve(),this.nextDeferred=void 0)}))}else this.nextDeferred&&(this.nextDeferred.resolve(),this.nextDeferred=void 0)}undoOverride(){this.score="",this.saveGrade()}selectNotation(e){this.score=e.code;const t=this.gridData.getSchema()[this.cell.column.data.gradingSchemaId],s=this.createGradeSubmission(t,this.score);s.perfCodeId=e.id,this.saveGrade(s)}setUpScreenReader(e,t){const s=e&&e.row&&e.row.metadata.user,n=s&&s.givenName.concat(s&&s.familyName),i=e&&e.column.data.columnName,o=!this.gridData.course.isComplete();if(t){const s=this.gradeService.getGradeToDisplay(e.data.grade.displayGrade,this.scope,this.gridData.getSchema()[e.column.data.gradingSchemaId].scaleType);this.ariaLabelContent=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:o?"components.directives.grade.grid.tableCellAriaLabel":"components.directives.grade.grid.tableCellAriaLabelReadOnly",params:{userName:n,assignmentName:i,grade:s||t},noWrap:!0,noEscape:!0})}else this.ariaLabelContent=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:o?"components.directives.grade.grid.tableCellAriaLabelEmpty":"components.directives.grade.grid.tableCellAriaLabelEmptyReadOnly",params:{userName:n,assignmentName:i},noWrap:!0,noEscape:!0})}};D.OVERALL_EDITOR_TEMPLATE='<div bb-grade-grid-overall-editor-reborn id="bb-grade-grid-overall-editor-reborn" class="editor"></div>',D=Object(n.__decorate)([Object(n.__param)(0,Object(h.b)("$rootScope")),Object(n.__param)(1,Object(h.b)("$window")),Object(n.__param)(2,Object(h.b)("$q")),Object(n.__param)(3,Object(h.b)(d.m.serviceName)),Object(n.__param)(4,Object(h.b)(l.k)),Object(n.__param)(5,Object(h.b)(r.b)),Object(n.__param)(6,Object(h.b)("$compile")),Object(n.__param)(7,Object(h.b)("scope")),Object(n.__param)(8,Object(h.b)("element")),Object(n.__param)(9,Object(h.b)("attrs")),Object(n.__param)(10,Object(h.b)("gradeGridRebornController")),Object(n.__param)(11,Object(h.b)(u.b)),Object(n.__param)(12,Object(h.b)(p.serviceName)),Object(n.__param)(13,Object(h.b)(m.b))],D);class k{constructor(e){this.$injector=e,this.restrict="E",this.template=S,this.scope=!0,this.require=`^${c.a}`,this.link=(e,t,s,n)=>{e.gradeGridColumnOverallReborn=this.$injector.instantiate(D,{scope:e,element:t,attrs:s,gradeGridRebornController:n})}}}k.$inject=["$injector"],i.module(I,[b.a]).directive("bbGradeGridColumnOverallReborn",["$injector",e=>e.instantiate(k)])}).call(this,s("71td"))},"9Ss5":function(e,t){e.exports='<div class="element-image avatar no-select" aria-hidden="true"\n     ng-class="avatarsClasses"\n     bb-load-bundle="components/directives/avatar" bb-cache-compilation="avatar">\n  <div class="avatar-inner" ng-if="isAvatarRender && (!autoUpdate || !autoUpdate())">\n    <div ng-if="::(!first && !second)" class="first avatar-single">\n      \x3c!-- If no user is set --\x3e\n      <div class="initials">\n        <bb-translate>components.directives.avatar.notAssignedInitials</bb-translate>\n      </div>\n    </div>\n\n    <div ng-if="::(first && first.avatarUrl)" class="first avatar-single image-avatar">\n      <img ng-src="{{::first.avatarUrl}}" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n      \x3c!-- If first user is set and has avatar image --\x3e\n    </div>\n\n    <div ng-if="::(first && !first.avatarUrl && first.userInitials)"\n         class="first avatar-single {{::first.avatarBg}}">\n      \x3c!-- If first user is set, but does not have avatar image, but has non-CJK name Will still render default--\x3e\n      <img ng-src="{{::first.avatarUrl}}" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n    </div>\n\n    <div ng-if="::(first && !first.avatarUrl && !first.userInitials)"\n         class="first avatar-single avatar-placeholder">\n      \x3c!-- If first user is set, but does not have avatar image and name contains CJK characters --\x3e\n      \x3c!-- Show default avatar image --\x3e\n      <img ng-if="::(!first.isAllMembers)" src="./static/images/avatar-placeholder.svg" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n      <div class="all-members" ng-if="::(first.isAllMembers)">\n        <bb-ui-icon-large-users></bb-ui-icon-large-users>\n      </div>\n    </div>\n\n    <div ng-if="::(second && second.avatarUrl && participants == 2)" class="second avatar-single image-avatar">\n      <img ng-src="{{second.avatarUrl}}" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n      \x3c!-- If second user is set and has avatar image --\x3e\n    </div>\n\n    <div ng-if="::(second && !second.avatarUrl && participants == 2 && second.userInitials)"\n         class="second avatar-single {{::second.avatarBg}}">\n      \x3c!-- If second user is set, but does not have avatar image, but has non-CJK name. Will still render default --\x3e\n      <img ng-src="{{second.avatarUrl}}" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.secondAvatarImg : null">\n    </div>\n\n    <div ng-if="::(second && !second.avatarUrl && participants == 2 && !second.userInitials)"\n         class="second avatar-single avatar-placeholder">\n      \x3c!-- If second user is set, but does not have avatar image and name contains CJK characters --\x3e\n      \x3c!-- Show default avatar image --\x3e\n      <img ng-if="::(!second.isAllMembers)" src="./static/images/avatar-placeholder.svg" bb-image-grayscale="{{::isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.secondAvatarImg : null">\n      <div class="all-members" ng-if="::(second.isAllMembers)">\n        <bb-ui-icon-large-avatar-multiple></bb-ui-icon-large-avatar-multiple>\n      </div>\n    </div>\n\n    <div ng-if="participants > 2" class="second avatar-single">\n      \x3c!-- If more than 2 participants involved, show `+3` type of avatar for right side --\x3e\n      \x3c!-- htmlhint:analytics-id:disable --\x3e\n      <div class="initials" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.twoPlusAvatar">\n        <bb-translate translate-values=\'{num: participants - 1}\' aria-hidden="true">components.directives.avatar.twoPlusInitials</bb-translate>\n      </div>\n      \x3c!-- htmlhint:analytics-id:enable --\x3e\n    </div>\n  </div>\n\n  <div class="avatar-inner" ng-if="isAvatarRender && autoUpdate && autoUpdate()">\n\n    <div ng-if="!first && !second" class="first avatar-single">\n      \x3c!-- If no user is set --\x3e\n      \x3c!-- htmlhint:analytics-id:disable --\x3e\n      <div class="initials" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n        <bb-translate>components.directives.avatar.notAssignedInitials</bb-translate>\n      </div>\n      \x3c!-- htmlhint:analytics-id:enable --\x3e\n    </div>\n\n    <div ng-if="first && first.avatarUrl" class="first avatar-single image-avatar">\n      <img ng-src="{{first.avatarUrl}}" bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n      \x3c!-- If first user is set and has avatar image --\x3e\n    </div>\n\n    <div ng-if="first && !first.avatarUrl && first.userInitials"\n         class="first avatar-single {{first.avatarBg}}">\n      \x3c!-- If first user is set, but does not have avatar image, but has non-CJK name --\x3e\n      \x3c!-- Show default image --\x3e\n      <img src="./static/images/avatar-placeholder.svg" bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n    </div>\n\n    <div ng-if="first && !first.avatarUrl && !first.userInitials"\n         class="first avatar-single avatar-placeholder">\n      \x3c!-- If first user is set, but does not have avatar image and name contains CJK characters --\x3e\n      \x3c!-- Show default avatar image --\x3e\n      <img ng-if="!first.isAllMembers" src="./static/images/avatar-placeholder.svg" bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.firstAvatarImg : null">\n      <div class="all-members" ng-if="first.isAllMembers">\n        <bb-ui-icon-large-avatar-multiple></bb-ui-icon-large-avatar-multiple>\n      </div>\n    </div>\n\n    <div ng-if="second && second.avatarUrl && participants == 2" class="second avatar-single image-avatar">\n      <img ng-src="{{second.avatarUrl}}" bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.secondAvatarImg : null">\n      \x3c!-- If second user is set and has avatar image --\x3e\n    </div>\n\n    <div ng-if="second && !second.avatarUrl && participants == 2 && second.userInitials"\n         class="second avatar-single {{second.avatarBg}}">\n      \x3c!-- If second user is set, but does not have avatar image, but has non-CJK name --\x3e\n      \x3c!-- Show default image --\x3e\n      <img src="./static/images/avatar-placeholder.svg" bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.secondAvatarImg : null">\n    </div>\n\n    <div ng-if="second && !second.avatarUrl && participants == 2 && !second.userInitials"\n         class="second avatar-single avatar-placeholder">\n      \x3c!-- If second user is set, but does not have avatar image and name contains CJK characters --\x3e\n      \x3c!-- Show default avatar image --\x3e\n      <img ng-if="!second.isAllMembers" src="./static/images/avatar-placeholder.svg"  bb-image-grayscale="{{isGray()}}" alt="" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.secondAvatarImg : null">\n      <div class="all-members" ng-if="second.isAllMembers">\n        <bb-ui-icon-large-avatar-multiple></bb-ui-icon-large-avatar-multiple>\n      </div>\n    </div>\n\n    <div ng-if="participants > 2" class="second avatar-single">\n      \x3c!-- If more than 2 participants involved, show `+3` type of avatar for right side --\x3e\n      \x3c!-- htmlhint:analytics-id:disable --\x3e\n      <div class="initials" analytics-id="analyticsIdTagPrefix ? {{::analyticsIdTagPrefix}}.twoPlusAvatar : null">\n        <bb-translate translate-values=\'{num: participants - 1}\' aria-hidden="true">components.directives.avatar.twoPlusInitials</bb-translate>\n      </div>\n      \x3c!-- htmlhint:analytics-id:enable --\x3e\n    </div>\n  </div>\n</div>\n'},"9V5A":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("3yh1");const o="ultra.components.directives.bbUiIcon.large.LearningModule";Object(n.a)(i.LearningModule,o,"bbUiIconLargeLearningModule")},"9Zs+":function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu">\n  <ul class="f-dropdown f-dropdown-overflow-menu reborn-dropdown" role="menu">\n    <li role="presentation">\n      <a role="menuitem"\n         class="js-add-calculation"\n         bb-peek-sref="gradebook-item.calculation({positionAfter: positionAfter})"\n         analytics-id="components.directives.grade.grid.addCalculation">\n        <bb-svg-icon size="small" icon="calculation"></bb-svg-icon>\n        <bb-translate>components.directives.grade.grid.addCalculation</bb-translate>\n      </a>\n    </li>\n\n    <li role="presentation">\n      <a role="menuitem"\n         class="js-add-item"\n         bb-peek-sref="grade-item.create({positionAfter: positionAfter})"\n         analytics-id="components.directives.grade.grid.addItem">\n        <bb-svg-icon size="small" icon="add"></bb-svg-icon>\n        <bb-translate>components.directives.grade.grid.addItem</bb-translate>\n      </a>\n    </li>\n\n    <li role="presentation" ng-if="!attendanceColumnExists && attendanceIsAvailable">\n      <a role="menuitem"\n         bb-peek-sref="attendance"\n         analytics-id="components.directives.grade.grid.addAttendance">\n        <bb-svg-icon size="small" icon="attendance" ></bb-svg-icon>\n        <bb-translate>components.directives.grade.grid.addAttendance</bb-translate>\n      </a>\n    </li>\n  </ul>\n</div>'},"9ah5":function(e,t){e.exports='<div class="tests assessment-overview" ng-class="{\'late-attempt\': assessmentOverview.shouldHaveLateAttemptClass}" bb-group-attempt-activities-peek="assessmentOverview.currentAttempt">\n  <div class="panel-wrap panel-wrap-flex"\n       ng-class="{\n         \'over-close-button\': assessmentOverview.hideOverview,\n         \'has-footer\': assessmentOverview.hasFooter,\n         \'has-extended-footer\': assessmentOverview.startPeerReviewsButtonVisible,\n         \'has-footer-password\': assessmentOverview.isAssessmentPasswordProtected && !assessmentOverview.shouldShowProctoringErrorMessage && !assessmentOverview.showAfterAttemptedFooter,\n         \'has-footer-password-error\': assessmentOverview.passwordErrorMessageKey,\n         \'has-footer-proctoring-error\': assessmentOverview.shouldShowProctoringErrorMessage\n        }">\n    <header class="black-panel-header" ng-show="!assessmentOverview.hideOverview">\n      <div class="black-header-contents">\n        <button class="left-off-canvas-toggle menu-toggle standard-button dark-background" type="button" analytics-id="course.content.assessment.overview.menu.button">\n          <bb-svg-icon class="assessment-overview-item__icon" size="small" icon="main-menu"></bb-svg-icon>\n          <span class="sr-only" bb-translate>course.content.assessment.overview.menu</span>\n        </button>\n        <h1 class="panel-title" bb-translate translate-values="{\'title\': assessmentOverview.customCategory}">{{::assessmentOverview.panelTitle}}</h1>\n        <a class="standard-button dark-background" ui-sref-active="active"\n           ng-if="assessmentOverview.content.ui.hasConversationAttached && assessmentOverview.content.attachedForumLink"\n           bb-peek-sref="conversations({courseId: assessmentOverview.content.courseId, contentId: assessmentOverview.content.id})"\n           bb-translate-attrs="{\'aria-label\':\'components.directives.header.openAria\'}" analytics-id="assessmentOverview.content.id.link">\n          <bb-svg-icon size="small" icon="conversation" ng-class="{\'has-indicator\': assessmentOverview.hasClassIndicator}"></bb-svg-icon>\n        </a>\n      </div>\n    </header>\n    <header class="row panel-header show-for-small-only">\n      <div class="goal-small-panel" ng-if="assessmentOverview.showGoalDetails">\n        <button class="button super-clear icon" ng-click="assessmentOverview.hideGoals()" analytics-id="assessmentOverview.hideGoals.button">\n          <bb-svg-icon class="assessment-overview-item__icon" size="small" icon="arrow-left"></bb-svg-icon>\n          <span class="sr-only" bb-translate>course.goal-alignment.goal.sr-only.closeGoals</span>\n        </button>\n        <div class="goal-head">\n          <span class="goal-title" bb-translate>course.goal-alignment.goal.header</span>\n        </div>\n      </div>\n      <div class="js-rubric-small-header slide-menu-small-panel" ng-if="assessmentOverview.showRubricDetails">\n        <div class="slide-menu-header">\n          <button class="button super-clear icon"  ng-click="assessmentOverview.hideRubricPanel()" analytics-id="assessmentOverview.hideRubricPanel.button">\n            <bb-svg-icon size="small" icon="arrow-left"></bb-svg-icon>\n            <span class="sr-only" bb-translate>global.close</span>\n          </button>\n          <span class="slide-menu-title" bb-translate>course.content.assessment.overview.rubricPanelHeader</span>\n        </div>\n      </div>\n    </header>\n    <div class="spinner bb-secondary-color-2" ng-if="assessmentOverview.isLoading" aria-hidden="true"></div>\n    <section class="panel-content has-slide-up-section" ng-class="{\'section-slide\': assessmentOverview.hideOverview}" bb-first-time-container>\n      <bb-panel-header\n        ng-class="{\'hide-header-small\': assessmentOverview.hideOverview, \'has-indicator\': assessmentOverview.hasClassIndicator}"\n        class="bb-panel-header"\n        show-course="true"\n        show-conversations="true"\n        content="assessmentOverview.content"\n        panel-title="assessmentOverview.content.title"\n        can-edit="false">\n      </bb-panel-header>\n      <bb-peer-review-has-been-deleted-banner\n        ng-if="assessmentOverview.showPeerReviewHasBeenDeletedBanner()"\n        assign-and-navigate-to-peer-review="assessmentOverview.assignAndNavigateToPeerReview"\n        dismiss-banner="assessmentOverview.dismissPeerReviewsDeletedBanner"\n        has-enough-submissions-for-peer-assessment="assessmentOverview.hasEnoughSubmissionsForPeerAssessment()"\n        can-retrieve-new-peer-review="assessmentOverview.canRetrieveNewPeerReview()"\n      ></bb-peer-review-has-been-deleted-banner>\n      <bb-time-limit-overridden-by-due-date-banner ng-if="assessmentOverview.showDueDateWarnings"></bb-time-limit-overridden-by-due-date-banner>\n      <bb-content-navigator content="assessmentOverview.content"></bb-content-navigator>\n      \x3c!--View class conversation FTUE--\x3e\n      <div ng-if="assessmentOverview.content.ui.hasConversationAttached && assessmentOverview.content.attachedForumLink" class="guidance-wrapper class-conversation-ftue">\n        <bb-guidance component-key="components.features.course.content.assessment.ftue.class-conversation" class="guidance-element-overlay">\n          <span bb-translate="{{::assessmentOverview.classConversationFtueKey}}" translate-values="{title: assessmentOverview.customCategory}"></span>\n        </bb-guidance>\n      </div>\n      <div class="panel-content-flex panel-content-inner assessment-overview-panel">\n        <div class="panel-content-info assessment-summary" ng-show="!assessmentOverview.hideOverview">\n          <bb-group-student-enrollment-asmt-banner  ng-if="assessmentOverview.content.userNeedsToSelfEnrollInGroup()"\n                                                    content="assessmentOverview.content"\n                                                    from-view="assessment.overview"></bb-group-student-enrollment-asmt-banner>\n          <div class="row collapse">\n            <div class="small-10 columns">\n              <h2 bb-translate>course.content.assessment.overview.detailsHeader</h2>\n            </div>\n          </div>\n          <ul class="row assessment-features" tabindex="-1" ng-show="!assessmentOverview.isLoading">\n            \x3c!--Due date--\x3e\n            <li class="js-due-date">\n              <bb-svg-icon class="assessment-overview-item__icon" size="medium" aria-hidden="true" icon="calendar" ng-class="{\'alert\': assessmentOverview.showPastDueForDueDate()}"></bb-svg-icon>\n              <div ng-switch="assessmentOverview.dueDate != null">\n                <span class="settings-label" bb-translate>course.content.assessment.overview.dueDate</span>\n                <span class="settings-link" ng-switch-when="true">\n                  <div class="alert vertical-bar" ng-if="assessmentOverview.showPastDueForDueDate()">\n                    <span class="alert-text" bb-translate ng-if="!assessmentOverview.isAssessmentSubmissionComplete">course.content.assessment.overview.pastDue</span>\n                    <span class="alert-text" bb-translate ng-if="assessmentOverview.isAssessmentSubmissionComplete">course.content.assessment.overview.late</span>\n                  </div>\n                  <bb-datetime ng-if="!assessmentOverview.studentHasDueDateException" value="::assessmentOverview.dueDate" format="Short"></bb-datetime>\n                  <bb-datetime ng-if="assessmentOverview.studentHasDueDateException" value="assessmentOverview.dueDateException.effectiveDueDate" format="Short"></bb-datetime>\n                  <span class="settings-link" ng-if="::assessmentOverview.studentHasNoDueDateAsException" bb-translate>course.content.assessment.overview.noDueDate</span>\n                </span>\n                <ul class="due-date-options" ng-switch-when="true">\n                  <li ng-if="::assessmentOverview.isDueDateEnforced">\n                    <span bb-translate="course.content.assessment.overview.enforceDueDate"></span>\n                  </li>\n                  <li ng-if="::assessmentOverview.isLateAttemptCreationDisallowed">\n                    <span bb-translate="course.content.assessment.overview.lateAttemptCreationDisallowed"></span>\n                  </li>\n                </ul>\n                <span class="settings-link" ng-switch-default bb-translate>course.content.assessment.overview.noDueDate</span>\n              </div>\n            </li>\n            \x3c!--Time Limit --\x3e\n            <li ng-if="assessmentOverview.hasTimeLimit" class="js-time-limit-type">\n              <bb-ui-icon-medium-no-time-limit ng-if="assessmentOverview.showDueDateWarnings" class="assessment-overview-item__icon time-limit-overridden grayed-out"></bb-ui-icon-medium-no-time-limit>\n              <bb-ui-icon-medium-time-limit ng-if="!assessmentOverview.showDueDateWarnings" class="assessment-overview-item__icon"></bb-ui-icon-medium-time-limit>\n              <div>\n                <span ng-class="{\'time-limit-overridden grayed-out\' : assessmentOverview.showDueDateWarnings }"\n                      class="settings-label"\n                      bb-translate>course.content.assessment.test.settings.timeLimit.label</span>\n                <span class="settings-link js-time-limit-auto-submission">\n                  <span ng-class="{\'time-limit-overridden grayed-out line-through\' : assessmentOverview.showDueDateWarnings }"\n                        class="js-time-limit-numerical"\n                        ng-bind-html="assessmentOverview.displayedTimeLimitSeconds | timeSpan: \'m\': this"></span>\n                  <span class="time-limit-description"\n                        ng-if="!assessmentOverview.canContinue"\n                        bb-translate>course.content.assessment.test.settings.timeLimit.autoSubmission</span>\n                </span>\n                <div ng-if="assessmentOverview.showRemainingTime">\n                  <span class="settings-label settings-link"\n                        bb-translate>course.content.assessment.test.settings.timeLimit.remainingTimeLabel</span>\n                  <span class="js-time-limit-overridden"\n                        ng-bind-html="assessmentOverview.remainingTimeInMinutesBeforeDueDateOverridesSoftTimeLimit * 60 | timeSpan: \'m\': this"></span>\n                </div>\n              </div>\n            </li>\n            \x3c!--Rubric--\x3e\n            <li class="js-rubric-overview" ng-if="assessmentOverview.rubricEvaluationIsVisible || assessmentOverview.rubricViewIsVisible">\n              <bb-svg-icon class="assessment-overview-item__icon" size="medium" icon="rubric"></bb-svg-icon>\n              <div class="tool-text">\n                <span class="settings-label" bb-translate>course.content.assessment.overview.rubric</span>\n                <span class="settings-link">\n                  <button class="button button--text" ng-click="assessmentOverview.showRubricPanel()" bb-click-focus=".rubric-evaluation-subpanel" bb-translate analytics-id="course.content.assessment.overview.gradedWithRubric">course.content.assessment.overview.gradedWithRubric</button>\n                </span>\n              </div>\n            </li>\n            \x3c!--Goals--\x3e\n            <li class="goal-alignment-li" ng-if="assessmentOverview.alignedGoalsCount">\n              <bb-svg-icon class="assessment-overview-item__icon" size="medium" icon="goal"></bb-svg-icon>\n              <div class="goal-text">\n                <span class="settings-label" bb-translate>course.goal-alignment.goal.header</span>\n                <span class="settings-link">\n                  <a href="javascript:void(0);" role="button" tabindex="{{assessmentOverview.hideOverview ? -1 : 0}}" class="js-view-goals"\n                     ng-click="assessmentOverview.showGoals()" bb-translate\n                     translate-values="{number: assessmentOverview.alignedGoalsCount}" analytics-id="course.goal-alignment.goal.alignedGoals.plural">\n                    course.goal-alignment.goal.alignedGoals.plural\n                  </a>\n                </span>\n              </div>\n            </li>\n            \x3c!--Number of attempts remaining and submitted--\x3e\n            <li>\n              <bb-svg-icon class="assessment-overview-item__icon" size="medium" icon="attempts"></bb-svg-icon>\n              <div ng-if="assessmentOverview.showAttemptDescription()">\n                <span class="settings-label" bb-translate>course.content.assessment.overview.attempts</span>\n                <span class="settings-link">\n                  <span ng-class="{\'vertical-bar\' : assessmentOverview.showAttemptsSubmittedDescription() }"\n                    bb-translate translate-values="{count: assessmentOverview.unsubmittedAttemptsLeft}">\n                    {{::assessmentOverview.attemptsRemainingDescriptionKey}}\n                  </span>\n                  <span ng-if="::assessmentOverview.showAttemptsSubmittedDescription()">\n                    <a ng-if="!assessmentOverview.detailsView" href="javascript:void(0);" ng-click="assessmentOverview.openAttemptReview()"\n                      bb-translate translate-values="{submitted: assessmentOverview.attemptCountSubmitted, late: assessmentOverview.attemptCountSubmittedLate}" analytics-id="{{::assessmentOverview.attemptsSubmittedDescriptionKey}}">\n                      {{::assessmentOverview.attemptsSubmittedDescriptionKey}}\n                    </a>\n                    <span ng-if="assessmentOverview.detailsView" bb-translate translate-values="{submitted: assessmentAttempt.attemptCountSubmitted, late: assessmentAttempt.attemptCountSubmittedLate}">\n                      {{::assessmentAttempt.attemptsSubmittedDescriptionKey}}\n                    </span>\n                  </span>\n                </span>\n              </div>\n            </li>\n            \x3c!--Peer review--\x3e\n            <li class="peer-grading-li" ng-if="assessmentOverview.isPeerGradingConfigured">\n              <bb-svg-icon class="assessment-overview-item__icon" ng-class="{\'alert\': assessmentOverview.isPeerReviewsLate()}" size="medium" icon="peer-review"></bb-svg-icon>\n              <div ng-if="assessmentOverview.showAttemptDescription()">\n                <span class="settings-label" bb-translate>course.content.assessment.test.settings.peerGrading.summary.label</span>\n                <span class="settings-link">\n                  <span class="peer-reviews-left vertical-bar" bb-translate translate-values="{ numOfPeersToReview: assessmentOverview.numOfPeerReviewsLeft }">\n                    course.content.assessment.test.settings.peerGrading.summary.peerReviewsLeft\n                  </span>\n                  <span class="alert" ng-if="assessmentOverview.isPeerReviewsLate()">\n                    <span class="alert-text" ng-if="!assessmentOverview.arePeerReviewsComplete()" bb-translate>course.content.assessment.overview.pastDue</span>\n                    <span class="alert-text" ng-if="assessmentOverview.arePeerReviewsComplete()" bb-translate translate-values="{numReviewsLate: assessmentOverview.numberOfLatePeerReviews()}">course.content.assessment.overview.assignedPeerReviews.numberOfReviewsLate</span>\n                  </span>\n                  <span ng-if="!assessmentOverview.isPeerReviewsLate()" class="peer-review-due-date" bb-translate translate-values="{ datetime: assessmentOverview.peerReviewDueDate }">\n                    course.content.assessment.test.settings.peerGrading.summary.reviewDueDate\n                  </span>\n                </span>\n                <span ng-if="assessmentOverview.isPeerReviewsLate()" class="peer-review-due-date" bb-translate translate-values="{ datetime: assessmentOverview.peerReviewDueDate }">\n                  course.content.assessment.test.settings.peerGrading.summary.reviewDueDate\n                </span>\n              </div>\n            </li>\n            \x3c!--Group information--\x3e\n            <li ng-if="assessmentOverview.content.isGroupContent">\n              <bb-svg-icon class="assessment-overview-item__icon" size="medium" icon="groups"></bb-svg-icon>\n              <div ng-if="assessmentOverview.content.userNeedsToSelfEnrollInGroup()">\n                <span class="settings-label" bb-translate="{{::assessmentOverview.groupAssessmentKey}}" translate-values="{\'title\': assessmentOverview.customCategory}"></span>\n                <bb-group-student-enrollment content="assessmentOverview.content" from-view="assessment.overview"></bb-group-student-enrollment>\n              </div>\n              <div ng-if="!assessmentOverview.content.userNeedsToSelfEnrollInGroup()">\n                <span class="settings-label" bb-translate="{{::assessmentOverview.groupAssessmentKey}}" translate-values="{\'title\': assessmentOverview.customCategory}"></span>\n                <span class="settings-link ellipsis" title="{{assessmentOverview.content.assignedGroups[0].groupTitle}}">{{assessmentOverview.content.assignedGroups[0].groupTitle}}</span>\n              </div>\n            </li>\n            \x3c!--Safe Assign--\x3e\n            <li ng-if="assessmentOverview.originalityReportService.isOriginalityReportEnabled() &&\n                       assessmentOverview.originalityReportService.isSafeAssignActiveOriginalityProvider()">\n              <bb-ui-icon-medium-safe-assign class="assessment-overview-item__icon"></bb-ui-icon-medium-safe-assign>\n              <div>\n                <span class="settings-label" bb-translate>course.content.originalityReport.settings.label</span>\n                <span class="settings-link" ng-if="assessmentOverview.detailsView">\n                  \x3c!-- htmlhint:analytics-id:disable --\x3e\n                  <button class="button button--text"\n                          ng-click="assessmentOverview.openSafeAssign()"\n                          analytics-id="course.content.assessment.test.settings.safeAssign.enabled">\n                            {{assessmentOverview.originalityReportService.getOriginalityReportLinkText(false)}}\n                  </button>\n                  \x3c!-- htmlhint:analytics-id:enable --\x3e\n                </span>\n                <span class="settings-link originality-enabled" ng-if="!assessmentOverview.detailsView && (!assessmentOverview.content.canStudentViewReports() || (!assessmentOverview.showScoreCard && !assessmentOverview.attemptCountSubmitted))">\n                  <span class="js-safeAssign-enabled">\n                    {{assessmentOverview.originalityReportService.getOriginalityReportLinkText(false)}}\n                  </span>\n                </span>\n                <span class="settings-link js-view-originality-report" ng-if="!assessmentOverview.detailsView && assessmentOverview.content.canStudentViewReports() && (assessmentOverview.showScoreCard || assessmentOverview.attemptCountSubmitted)">\n                  <ng-switch on="assessmentOverview.originalityReportAvailable">\n                    <span ng-switch-when="false" class="safe-assign-info" bb-translate="course.content.originalityReport.settings.originalityInProgress"></span>\n                    <span ng-switch-when="true">\n                      <button class="button--text"\n                                ng-click="assessmentOverview.openAttemptReview(true)"\n                                analytics-id="course.content.assessment.test.settings.safeAssign.available"\n                                bb-translate>\n                                course.content.originalityReport.settings.originalityAvailable\n                      </button>\n                    </span>\n                    <span ng-switch-when="null">\n                      {{assessmentOverview.originalityReportService.getOriginalityReportLinkText(false)}}\n                    </span>\n                    <span ng-switch-default class="safe-assign-info" bb-translate="course.content.originalityReport.settings.loadingLabel"></span>\n                  </ng-switch>\n                </span>\n              </div>\n            </li>\n            \x3c!--Originality Integration--\x3e\n            <li ng-if="assessmentOverview.originalityReportService.isOriginalityReportEnabled() &&\n                       assessmentOverview.originalityReportService.isIntegrationActiveOriginalityProvider()">\n              <bb-ui-icon-medium-safe-assign class="assessment-overview-item__icon"></bb-ui-icon-medium-safe-assign>\n              <div>\n                <span class="settings-label" bb-translate>course.content.originalityReport.settings.label</span>\n                <ng-switch on="!!assessmentOverview.attemptCountSubmitted">\n                  <span ng-switch-when="false" class="settings-link">\n                    <span class="js-safeAssign-enabled">\n                      {{assessmentOverview.originalityReportService.getOriginalityReportLinkText(false)}}\n                    </span>\n                  </span>\n                  <span ng-switch-when="true" class="settings-link">\n                    <button class="button--text"\n                          ng-click="assessmentOverview.openAttemptReview(true)"\n                          analytics-id="course.content.assessment.test.settings.integration.available"\n                          bb-translate\n                    >\n                      course.content.originalityReport.settings.originalityAvailable\n                    </button>\n                  </span>\n                </ng-switch>\n              </div>\n            </li>\n            \x3c!--Proctoring--\x3e\n            <ng-switch\n              ng-if="!!assessmentOverview.currentProctoringServiceType"\n              on="assessmentOverview.currentProctoringServiceType">\n              <li class="proctoring-summary" ng-switch-when="Respondus" ng-if="::assessmentOverview.content.isSecureBrowserRequiredToTake()">\n                <bb-ui-icon-medium-proctor-shield class="assessment-overview-item__icon"></bb-ui-icon-medium-proctor-shield>\n                <div class="proctoring-peek-container">\n                  <span class="settings-label" bb-translate>components.services.proctoring.overview.label</span>\n                  <span class="settings-link" ng-if="::assessmentOverview.getProctoringBrowserText()">\n                    <span bb-translate>{{assessmentOverview.getProctoringBrowserText()}}</span>\n                  </span>\n                  <span class="settings-link requirements" ng-if="::assessmentOverview.showBeforeAttemptedFooter && assessmentOverview.getProctoringRequirementsText()" bb-translate>{{assessmentOverview.getProctoringRequirementsText()}}</span>\n                  <span class="settings-link browser-download" ng-if="::assessmentOverview.showBeforeAttemptedFooter &&  assessmentOverview.getProctoringBrowserDownloadText()">\n                    <bb-svg-icon size="medium" icon="download"></bb-svg-icon>\n                    <a target="_blank" href="{{assessmentOverview.content.getProctoringDownloadUrl()}}" bb-translate analytics-id="{{assessmentOverview.getProctoringBrowserDownloadText()}}">{{assessmentOverview.getProctoringBrowserDownloadText()}}</a>\n                  </span>\n                </div>\n              </li>\n              <li class="ims-proctoring-overview-summary" ng-switch-when="IMS">\n                <bb-ui-icon-medium-proctor-shield class="assessment-overview-item__icon"></bb-ui-icon-medium-proctor-shield>\n                <div class="ims-proctoring-overview-summary__content">\n                  <span class="settings-label" bb-translate>course.content.assessment.overview.proctoring.sectionTitle</span>\n                  <span class="ims-proctoring-overview-summary__requirements" bb-translate>course.content.assessment.overview.proctoring.requirements</span>\n                </div>\n              </li>\n            </ng-switch>\n          </ul>\n          \x3c!--Grading section--\x3e\n          <div ng-if="assessmentOverview.isScorm" ng-show="!assessmentOverview.isLoading" class="scorm-overview-grades" ui-view="scorm-grading-section@"></div>\n          <div ng-if="!assessmentOverview.isScorm" class="row">\n            <span class="settings-label" bb-translate>course.content.assessment.overview.gradingHeader</span>\n            <div class="alert grading-notice"\n                 ng-if="assessmentOverview.showPastDueForDueDate() && !assessmentOverview.currentAttempt.isSubmitted() && !assessmentOverview.isLateAttemptCreationDisallowed">\n              <bb-svg-icon class="alert-icon assessment-overview-item__icon" icon="attention" size="small" status="alert"></bb-svg-icon>\n              <span class="notice-text" bb-translate>course.content.assessment.overview.pastDueZero.submitNowToUpdate</span>\n            </div>\n\n            \x3c!--Past-due-zero grade card (ie. "Your grade 0")--\x3e\n            \x3c!-- this shows when past due and no attempt has been made or a draft has been saved (no previous attempts submitted)--\x3e\n            <div class="submission-card" ng-if="!assessmentOverview.showScoreCard && assessmentOverview.showPastDueForDueDate()">\n              <span bb-content-item-icon content-column="assessmentOverview.contentData.gradingColumn" show-alert-icon="true"></span>\n\n              <div class="card-text">\n                <span class="submission-label" bb-translate>course.content.assessment.overview.scoreCard.yourScore</span>\n                <span ng-if="!assessmentOverview.isLateAttemptCreationDisallowed"\n                      class="submission-subtext"\n                      bb-translate>course.content.assessment.overview.pastDueZero.pastDueAndNotSubmitted</span>\n                <span ng-if="assessmentOverview.isLateAttemptCreationDisallowed"\n                      class="submission-subtext"\n                      bb-translate>course.content.assessment.overview.pastDueZero.pastDueAndNoNewAttemptsAllowed</span>\n              </div>\n              <div class="card-grade">\n                <bb-display-grade-pill grade="assessmentOverview.contentData.gradeDetail"\n                                       column="assessmentOverview.contentData.gradingColumn"></bb-display-grade-pill>\n              </div>\n            </div>\n\n            \x3c!--Pre-submission-grade-override grade card (ie. "Your grade 0")--\x3e\n            \x3c!-- this shows only when no attempt has been made or a draft has been saved and grade overridden (no previous attempts submitted)--\x3e\n            <div class="submission-card" ng-if="!assessmentOverview.attemptCountSubmitted && !assessmentOverview.showPastDueForDueDate() && assessmentOverview.contentData.gradeDetail.isPosted()">\n              <span bb-content-item-icon content-column="assessmentOverview.contentData.gradingColumn" show-alert-icon="true"></span>\n\n              <div class="card-text">\n                <span class="submission-label" bb-translate="course.content.assessment.overview.scoreCard.yourScore"></span>\n              </div>\n              <div class="card-grade">\n                <bb-display-grade-pill grade="assessmentOverview.contentData.gradeDetail"\n                                       column="assessmentOverview.contentData.gradingColumn"></bb-display-grade-pill>\n              </div>\n            </div>\n\n            \x3c!--Pre-submission grade card (ie. "Maximum score")--\x3e\n            \x3c!-- this shows only when no attempt has been made or a draft has been saved and grade not overridden (no previous attempts submitted)--\x3e\n            <div class="no-submission-card" ng-if="!assessmentOverview.showScoreCard && !assessmentOverview.attemptCountSubmitted && !assessmentOverview.showPastDueForDueDate() && !assessmentOverview.contentData.gradeDetail.isPosted()">\n              <span class="no-submission-icon" bb-content-item-icon content-column="assessmentOverview.contentData.gradingColumn" show-alert-icon="assessmentOverview.isOverdue"></span>\n              <div class="no-submission-text">\n                <span class="no-submission-label" bb-translate>course.content.assessment.overview.highestPossible</span>\n                <span class="no-submission-subtext" ng-if="assessmentOverview.currentAttempt.isInProgress()"\n                      bb-translate="course.content.assessment.overview.startedAt" translate-values="{ datetime: assessmentOverview.currentAttempt.modifiedDate }"></span>\n                <span class="no-submission-subtext" ng-if="!assessmentOverview.currentAttempt.isInProgress() && assessmentOverview.contentData.gradingColumn.isMultipleAttempts()"\n                      bb-translate="{{assessmentOverview.aggregationModelDescriptionKey}}"></span>\n              </div>\n              <div class="no-submission-value" bb-translate translate-values="{point: assessmentOverview.highestPossibleScore}">course.content.assessment.overview.maxPoint.plural</div>\n            </div>\n            \x3c!--Pre-submission grade card (ie. "Maximum score")--\x3e\n            \x3c!-- this shows when the current attempt is in progress and previous attempts have already been submitted --\x3e\n            <a class="has-link js-attempt-submitted" href="javascript:void(0);"\n               ng-if="!assessmentOverview.showScoreCard && (assessmentOverview.attemptCountSubmitted > 0)"\n               ng-click="assessmentOverview.openAttemptReview()"\n               analytics-id="course.content.assessment.overview.highestPossible.link">\n              <div class="no-submission-card">\n                <span class="no-submission-icon" bb-content-item-icon content-column="assessmentOverview.contentData.gradingColumn" show-alert-icon="assessmentOverview.isSubmittedLate()"></span>\n                <div class="no-submission-text">\n                  <span class="no-submission-label" bb-translate>course.content.assessment.overview.highestPossible</span>\n                  <span class="no-submission-subtext" ng-if="assessmentOverview.currentAttempt.isInProgress()"\n                        bb-translate="course.content.assessment.overview.startedAt" translate-values="{ datetime: assessmentOverview.currentAttempt.modifiedDate }"></span>\n                  <span class="no-submission-subtext" ng-if="!assessmentOverview.currentAttempt.isInProgress() && assessmentOverview.contentData.gradingColumn.isMultipleAttempts()"\n                        bb-translate="{{assessmentOverview.aggregationModelDescriptionKey}}"></span>\n                </div>\n                <div class="no-submission-value" bb-translate translate-values="{point: assessmentOverview.highestPossibleScore}">course.content.assessment.overview.maxPoint.plural</div>\n              </div>\n            </a>\n            \x3c!--Post-submission, pre-graded-and-posted grade card (ie. "Submission"/"Late Submission")--\x3e\n            \x3c!-- this shows only when an attempt has been submitted but not yet graded and posted by the instructor --\x3e\n            <a class="has-link js-attempt-submitted" href="javascript:void(0);" ng-if="assessmentOverview.showScoreCard && !assessmentOverview.contentData.gradeDetail.isPosted()" ng-click="assessmentOverview.openAttemptReview()" analytics-id="course.content.assessment.overview.scoreCard.submitted.link">\n              <div class="submission-card">\n                <span bb-content-item-icon content-column="assessmentOverview.contentData.gradingColumn" show-alert-icon="assessmentOverview.isSubmittedLate()" class="img-wrapper"></span>\n                <div class="card-text">\n                  <ng-switch on="assessmentOverview.isSubmittedLate()">\n                    <span ng-switch-when="true" class="submission-label late-submission" bb-translate="course.content.assessment.overview.scoreCard.lateSubmission"></span>\n                    <span ng-switch-default class="submission-label" bb-translate="course.content.assessment.overview.scoreCard.submission"></span>\n                  </ng-switch>\n                  <div class="card-text-attempt">\n                    <span bb-translate\n                          translate-values="{\'attemptDate\': assessmentOverview.latestAttemptDate}">course.content.assessment.overview.scoreCard.submitted</span>\n                  </div>\n                </div>\n                <div class="card-grade">\n                  <bb-display-grade-pill grade="assessmentOverview.contentData.gradeDetail"\n                                         column="assessmentOverview.contentData.gradingColumn"></bb-display-grade-pill>\n                </div>\n              </div>\n            </a>\n            \x3c!--Post-submission, graded-and-posted grade card (ie. "Your Score")--\x3e\n            \x3c!-- this shows only when an attempt has been submitted and graded then posted by the instructor --\x3e\n            <div class="js-attempt-posted" ng-if="assessmentOverview.showScoreCard && assessmentOverview.contentData.gradeDetail.isPosted()">\n                <div class="submission-card">\n                  <a href="javascript:void(0);" class="has-link sub-submission-card" bb-translate-attrs="{\'aria-label\': \'course.content.assessment.overview.externalSubmissionsFtue\'}" ng-click="assessmentOverview.openAttemptReview()" analytics-id="course.content.assessment.overview.scoreCard.yourScore.link">\n                    <span bb-content-item-icon content-column="assessmentOverview.contentData.gradingColumn" show-alert-icon="assessmentOverview.isSubmittedLate()"\n                          class="img-wrapper"></span>\n                    <div class="card-text">\n                      <span class="submission-label" bb-translate="course.content.assessment.overview.scoreCard.yourScore"></span>\n                      <span class="submission-subtext" ng-if="assessmentOverview.contentData.gradingColumn.isMultipleAttempts()"\n                            bb-translate="{{assessmentOverview.aggregationModelDescriptionKey}}"></span>\n                    </div>\n                    <div class="card-grade">\n                      <bb-display-grade-pill grade="assessmentOverview.contentData.gradeDetail" column="assessmentOverview.contentData.gradingColumn"></bb-display-grade-pill>\n                    </div>\n                  </a>\n                  <a href="javascript:void(0);" class="assessment-feedback-button" bb-translate-attrs="{\'aria-label\': \'course.content.assessment.overview.externalSubmissionsFtue\'}" ng-if="assessmentOverview.hasFeedback()" analytics-id="course.content.assessment.overview.assessmentResults.feedback.link" ng-click="assessmentOverview.openAttemptFeedback()" >\n                    <bb-svg-icon class="assessment-feedback-icon" size="medium" icon="feedback" role="presentation" aria-hidden="true" status="active"></bb-svg-icon>\n                  </a>\n                </div>\n            </div>\n          </div>\n          \x3c!--Assessment Results--\x3e\n          <div class="assessment-result-info" ng-if="assessmentOverview.showAssessmentResults">\n            <div class="row collapse">\n              <div class="small-10 columns assessment-result-info__header">\n                <h2 bb-translate>course.content.assessment.overview.assessmentResults.header</h2>\n                <button\n                  class="center-tooltip js-assessment-results-info-tooltip"\n                  bb-tooltip enhanced-tooltip="true"\n                  bb-translate-attrs="{\'aria-label\': \'course.content.assessment.overview.assessmentResults.info\',\n                                        title: \'course.content.assessment.overview.assessmentResults.info\'}"\n                  analytics-id="course.content.assessment.overview.assessmentResults.information.button">\n                  <bb-svg-icon aria-hidden="true" role="presentation" size="small" icon="information"></bb-svg-icon>\n                </button>\n              </div>\n            </div>\n            <ul class="row assessment-features">\n              <li class="assessment-result-options" ng-repeat="option in ::assessmentOverview.assessmentResultOptions">\n                <ng-switch on="assessmentOverview.isOptionAvailable(option.visible)">\n                  <bb-svg-icon ng-switch-when="true" size="medium" icon="{{::option.icon}}" status="active"></bb-svg-icon>\n                  <bb-svg-icon ng-switch-default size="medium" icon="{{::option.icon}}"></bb-svg-icon>\n                </ng-switch>\n\n                <div>\n                  <span class="settings-label">{{::option.optionLabel}}</span>\n                  <span class="settings-link" ng-bind-html="option.modeLabel"></span>\n                </div>\n\n                <span class="assessment-result-options__warning" aria-hidden="false" ng-if="assessmentOverview.shouldDisplayAssessmentResultsWarning(option) && !option.visible" bb-translate>\n                  course.content.assessment.overview.assessmentResults.availabilityCondition\n                </span>\n              </li>\n            </ul>\n          </div>\n          \x3c!--Assigned Peer Reviews--\x3e\n          <bb-assigned-peer-grading ng-if="assessmentOverview.isPeerGradingConfigured"\n                                    submission-due-date="::assessmentOverview.dueDate"\n                                    peer-review-due-date="::assessmentOverview.peerReviewDueDate"\n                                    peer-reviews-per-student="::assessmentOverview.numOfPeerReviewsToComplete"\n                                    allow-late-peer-reviews="::assessmentOverview.allowLatePeerReviews"\n                                    has-due-date-accommodation="::assessmentOverview.hasDueDateAccommodation"\n                                    is-submission-complete="assessmentOverview.isAssessmentSubmissionComplete"\n                                    is-submission-late="assessmentOverview.isSubmissionLate"\n                                    content="assessmentOverview.content"\n                                    component-updated-callback="assessmentOverview.peerReviewsComponentUpdatedCallback">\n          </bb-assigned-peer-grading>\n          \x3c!--Description--\x3e\n          <div class="row" ng-if="assessmentOverview.content.description">\n            <span class="settings-label" bb-translate>course.content.assessment.overview.descriptionHeader</span>\n            <span class="desc-content">\n              {{assessmentOverview.content.description}}\n            </span>\n          </div>\n          \x3c!--Proctoring Additional Notes --\x3e\n          <div class="proctoring-additional-notes" ng-if="::assessmentOverview.showProctoringAdditionalNotes() && assessmentOverview.content.isSecureBrowserRequiredToTake()">\n            <span class="settings-label" bb-translate>components.services.proctoring.overview.additionalNotes.label</span>\n            <span class="desc-content details-view" ng-if="::assessmentOverview.detailsView" bb-translate>components.services.proctoring.delivery.attempt.additionalNotes.description</span>\n            <span class="desc-content non-details-view" ng-if="::!assessmentOverview.detailsView" bb-translate>components.services.proctoring.overview.additionalNotes.description</span>\n          </div>\n          <div class="row group-assessment-members" ng-if="assessmentOverview.content.isGroupContent && !assessmentOverview.content.userNeedsToSelfEnrollInGroup()">\n            <h2 class="peek-title-h2">\n              <bb-translate translate-values="{number: assessmentOverview.groupUsers.length}">course.content.assessment.test.group.assignmentGroupMembers.plural</bb-translate>\n              <div class="group-buttons" bb-guidance-target component-key="components.features.course.content.assessment.ftue.group-conversation" keep-guidance-when-focusout="true">\n                <button ng-show="assessmentOverview.shouldShowCollabLink" ng-click="assessmentOverview.launchCollabSession()"\n                        bb-translate-attrs="{\'aria-label\':\'course.content.conversation.collaborate\', \'title\': \'course.content.conversation.collaborate\'}"\n                        class="button super-clear icon" aria-describedby="collab-icon-assessment" analytics-id="course.content.conversation.collobrate.button">\n                  <bb-collab-session-icon id="collab-icon-assessment" running-session-flag="assessmentOverview.runningSessionFlag"></bb-collab-session-icon>\n                </button>\n                <button ng-if="assessmentOverview.content.ui.hasConversationAttached && assessmentOverview.content.attachedForumLink"\n                        ng-click="assessmentOverview.gotoConversation(assessmentOverview.content.assignedGroups[0].groupId)"\n                        bb-translate-attrs="{\'aria-label\':\'components.directives.header.openAriaGroup\', \'title\': \'components.directives.header.openAriaGroup\'}"\n                        class="button super-clear icon" analytics-id="components.directives.header.openAriaGroup.button">\n                  <bb-svg-icon ng-class="{\'has-indicator\': assessmentOverview.hasGroupIndicator}" size="medium" icon="group-conversation"></bb-svg-icon>\n                </button>\n              </div>\n              \x3c!--View group conversation FTUE--\x3e\n              <div ng-if="assessmentOverview.content.ui.hasConversationAttached && assessmentOverview.content.attachedForumLink" class="guidance-wrapper group-conversation-ftue">\n                <bb-guidance component-key="components.features.course.content.assessment.ftue.group-conversation" class="guidance-element-overlay">\n                  <span bb-translate="{{::assessmentOverview.groupConversationFtueKey}}" translate-values="{title: assessmentOverview.customCategory}"></span>\n                </bb-guidance>\n              </div>\n            </h2>\n            <div class="member-container">\n              <div class="member js-member-{{::member.id}}" ng-repeat="member in assessmentOverview.groupUsers track by member.id"\n                ng-class="{\'is-owner\': member.id === groupAttemptOwnerId}">\n                <bb-usercard usercard-show="avatar"\n                             user="member" course-id="{{assessmentOverview.course.id}}"\n                             course-role="assessmentOverview.getCourseRole(member)"\n                             can-send-message="assessmentOverview.canSendMessage(member)"\n                             inactive="assessmentOverview.isInactive(member)">\n                </bb-usercard>\n                <bb-username class="member-name" user="member" format="short" has-title-attr="false" show-pronouns="true" show-pronunciation="true"></bb-username>\n                <span ng-if="member.id === groupAttemptOwnerId" bb-tooltip\n                      enhanced-tooltip="true"\n                      tooltip-position="bottom-right"\n                      bb-translate-attrs="{title: \'course.content.assessment.overview.currentEditingLabel\'}"\n                      translate-attrs-values="{user:{givenName: member.givenName, familyName: member.familyName}}">\n                  <bb-svg-icon class="draw" size="small" icon="draw"></bb-svg-icon>\n                </span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="goals-panel slide-small-container slide-animation" ng-class="{slideUp: assessmentOverview.showGoalDetails}">\n        <div ng-show="assessmentOverview.showGoalDetails">\n          <bb-goal-alignment contents="assessmentOverview.goalAlignedContents"\n                             hide-goals="assessmentOverview.hideGoals()"\n                             class="angular-animate content-assessment-goal-peek"\n                             analytics-id="course.content.assessment.goalAlignedContents.goalAlignment">\n          </bb-goal-alignment>\n        </div>\n      </div>\n      <div class="subpanel rubric-evaluation-subpanel slide-small-container slide-animation"\n           ng-class="{slideUp: assessmentOverview.showRubricDetails, slideDown: !assessmentOverview.showRubricDetails, opened: assessmentOverview.showRubricDetails}"\n           bb-translate-attrs="{\'aria-label\': \'course.content.assignmentRubricDetails\'}"\n           tabindex="-1">\n        <div ng-if="assessmentOverview.showRubricDetails">\n          <div class="panel-section-header">\n            <div class="panel-section-header-icon">\n              <bb-svg-icon size="medium" icon="rubric"></bb-svg-icon>\n            </div>\n            <div class="panel-section-header-text">\n              <h2 bb-translate>course.content.assessment.overview.rubricPanelHeader</h2>\n            </div>\n            <button class="button super-clear icon" bb-translate-attrs="{\'aria-label\': \'global.close\'}" ng-click="assessmentOverview.hideRubricPanel()" analytics-id="course.content.assessment.closeRubricPanel.button">\n              <bb-svg-icon size="small" icon="close"></bb-svg-icon>\n            </button>\n          </div>\n          <div class="panel-section-body row">\n            <bb-rubric-view\n              ng-if="assessmentOverview.contentData != null"\n              criteria="assessmentOverview.rubricViewPayload.criteria"\n              analytics-id="assessmentOverview.rubricViewPayload.analyticsId"\n              decimals-length="assessmentOverview.rubricViewPayload.decimalsLength"\n              rubric-type="assessmentOverview.rubricViewPayload.rubricType"\n              max-score="assessmentOverview.rubricViewPayload.maxScore"\n            >\n            </bb-rubric-view>\n          </div>\n        </div>\n      </div>\n    </section>\n  </div>\n  \x3c!-- A footer to display after the user has submitted. Includes a \'start reviews\' button for peer review assessments --\x3e\n  <footer id="after-attempt-footer"\n          class="panel-footer after-attempt-footer"\n          ng-show="!assessmentOverview.isLoading"\n          ng-if="assessmentOverview.showAfterAttemptedFooter && assessmentOverview.isCourseOpen">\n    \x3c!-- Button for peer assessments only for navigating to assigned peer reviews --\x3e\n    <div ng-if="assessmentOverview.startPeerReviewsButtonVisible"\n         class="start-peer-review-button-container">\n      <button class="button button-start-peer-review"\n              ng-click="assessmentOverview.startNextPeerReview()"\n              ng-disabled="!assessmentOverview.startPeerReviewsButtonEnabled"\n              analytics-id="course.content.assessment.overview.peer.start-review.button" bb-translate>\n              {{assessmentOverview.startNextPeerReviewButtonKey}}\n      </button>\n    </div>\n    \x3c!-- Button to view attempt --\x3e\n    <a href="javascript:void(0);"\n       class="button button-attempt"\n       ng-class="{\'button--secondary\': assessmentOverview.startPeerReviewsButtonVisible}"\n       ng-click="assessmentOverview.openAttemptReview()"\n       analytics-id="assessmentOverview.viewSubmittedAttempt.link">\n      <span class="label-button-attempt" bb-translate="{{assessmentOverview.viewAttemptButtonLabelKey}}"></span>\n    </a>\n  </footer>\n  <footer id="start-attempt-footer"\n        class="panel-footer start-attempt-footer"\n        ng-class="{\'has-footer-extension\': assessmentOverview.isAssessmentPasswordProtected || assessmentOverview.shouldShowProctoringErrorMessage}"\n        ng-show="!assessmentOverview.isLoading"\n        ng-if="assessmentOverview.showBeforeAttemptedFooter && assessmentOverview.isCourseOpen">\n    <div class="footer-extension-container" ng-if="assessmentOverview.isAssessmentPasswordProtected && !assessmentOverview.shouldShowProctoringErrorMessage">\n      <div class="attempt-password-header row">\n        <span class="attempt-password-header-text" bb-translate>course.content.assessment.overview.passwordProtected.heading</span>\n        <div\n          bb-tooltip\n          bb-translate-attrs="{\'title\':\'course.content.assessment.overview.passwordProtected.tooltip\'}"\n          enhanced-tooltip="true"\n          tooltip-position="top-center">\n          <div class="info-icon"><bb-svg-icon size="small" icon="information"></bb-svg-icon></div>\n        </div>\n      </div>\n      <input type="text"\n            inputmode="numeric"\n            bb-translate-attrs="{\'placeholder\':\'course.content.assessment.overview.passwordProtected.placeholder\',\n                                \'aria-label\':\'course.content.assessment.overview.passwordProtected.errors.empty\'}"\n            class="attempt-password-entry"\n            ng-class="{\'attempt-password-entry-error\': assessmentOverview.passwordErrorMessageKey}"\n            aria-describedby="{{assessmentOverview.passwordErrorMessageKey ? \'footer-extension-error-message\': null }}"\n            aria-invalid="{{!!assessmentOverview.passwordErrorMessageKey}}"\n            id="assessment-password"\n            ng-model="assessmentOverview.givenPassword"\n            ng-change="assessmentOverview.onPasswordChange()"\n            analytics-id="course.content.assessment.overview.password.input.text"\n            bb-keyboard-enter="assessmentOverview.navigateAttempt()" />\n      <div class="footer-extension-error-message"\n        id="footer-extension-error-message"\n        role="alert"\n        ng-if="assessmentOverview.passwordErrorMessageKey">\n        <span bb-translate ng-if="assessmentOverview.passwordErrorMessageKey">\n          {{assessmentOverview.passwordErrorMessageKey}}\n        </span>\n      </div>\n    </div>\n\n    <div class="footer-extension-container" ng-if="assessmentOverview.shouldShowProctoringErrorMessage">\n      <div class="footer-extension-error-message"\n        id="footer-extension-error-message"\n        role="alert"\n      >\n        <span bb-translate>course.content.assessment.overview.proctoring.viewAssessmentDisabled</span>\n      </div>\n    </div>\n\n    <div\n      class="attempt-button-container"\n      ng-class="{\'has-footer-extension\': assessmentOverview.hasFooterExtension}"\n    >\n      <p ng-if="assessmentOverview.isOverdue" class="late-button-super-text">\n        <span bb-translate="course.content.assessment.overview.markedLateNotice"></span>\n      </p>\n\n      \x3c!-- Disabled view assessment button --\x3e\n      <div\n        ng-if="assessmentOverview.shouldShowProctoringErrorMessage"\n        class="button button-attempt"\n        ng-disabled="true"\n      >\n        <span\n          class="label-button-attempt"\n          bb-translate="{{assessmentOverview.attemptButtonLabelKey}}"\n          translate-values="{count: assessmentOverview.currentAttemptNumber}">\n        </span>\n      </div>\n\n      \x3c!-- Start/continue non-timed attempt--\x3e\n      <a\n        href="javascript:void(0);"\n        ng-if="assessmentOverview.shouldShowNonTimedAttemptStartContinueButton"\n        ng-click="assessmentOverview.navigateAttempt()"\n        ng-disabled="assessmentOverview.content.userNeedsToSelfEnrollInGroup()"\n        ng-class="{\'js-multiple\': assessmentOverview.allowMultipleAttempts, \'js-continue\': assessmentOverview.attemptIsInProgress}"\n        class="button button-attempt"\n        analytics-id="course.content.assessment.overview.allowMultipleAttempts.link"\n      >\n        <span class="label-button-attempt"\n              bb-translate="{{assessmentOverview.attemptButtonLabelKey}}"\n              translate-values="{count: assessmentOverview.currentAttemptNumber}"></span>\n        <span class="label-button-group-control"\n              bb-load-bundle="features/course/content/assessment/group-attempt/activities/group-attempt-activities"\n              bb-translate="features.course.content.assessment.group-attempt.activities.takecontrol"></span>\n      </a>\n\n      \x3c!-- Start timed attempt--\x3e\n      <a href="javascript:void(0);"\n         ng-if="assessmentOverview.shouldShowTimedAttemptStartButton"\n         class="button button-attempt"\n         ng-class="{\'js-multiple\': assessmentOverview.allowMultipleAttempts, \'js-continue\': assessmentOverview.attemptIsInProgress}"\n         ng-click="assessmentOverview.createAttemptWithTimer()"\n         analytics-id="assessmentOverview.navigateAttempt.link">\n        <span class="label-button-attempt"\n              bb-translate="{{assessmentOverview.attemptButtonLabelKey}}"\n              translate-values="{count: assessmentOverview.currentAttemptNumber}"></span>\n      </a>\n\n      \x3c!-- Continue timed attempt--\x3e\n      <a href="javascript:void(0);"\n         ng-if="assessmentOverview.shouldShowTimedAttemptContinueButton"\n         ng-click="assessmentOverview.navigateAttempt()"\n         ng-class="{\'js-multiple\': assessmentOverview.allowMultipleAttempts, \'js-continue\': assessmentOverview.attemptIsInProgress}"\n         class="button button-attempt"\n         analytics-id="assessmentOverview.allowMultipleAttempts.link">\n        <span class="label-button-attempt"\n              bb-translate="{{assessmentOverview.attemptButtonLabelKey}}"\n              translate-values="{count: assessmentOverview.currentAttemptNumber}"></span>\n        <span class="label-button-group-control"\n              bb-load-bundle="features/course/content/assessment/group-attempt/activities/group-attempt-activities"\n              bb-translate="features.course.content.assessment.group-attempt.activities.takecontrol"></span>\n      </a>\n    </div>\n  </footer>\n  <footer id="start-attempt-closed-course-footer" class="panel-footer course-closed-footer" ng-if="assessmentOverview.showBeforeAttemptedFooter && !assessmentOverview.isCourseOpen">\n    <p class="course-closed-text">\n      <span class="js-course-closed-msg" bb-translate="{{::assessmentOverview.completedCourseKey}}" translate-values="{\'title\': assessmentOverview.customCategory}"></span>\n    </p>\n  </footer>\n  <div ui-view="assessment-overview-peek@"></div>\n</div>\n'},"9hUw":function(e,t,s){"use strict";s.d(t,"a",(function(){return y})),s.d(t,"b",(function(){return O}));var n=s("D57K"),i=s("VdDF"),o=s("DN+C"),a=s("Llzl"),r=s("VAMW"),c=s("6fZB"),l=s("IbyE"),d=s("zGdY"),u=s("nsO7"),p=s("9OUN"),m=s("aHpC"),h=s("nmzr"),b=s("TnpK"),g=s("fYJU"),v=s("12mu"),f=s("0JpG"),w=s("Fvsw"),S=s("U50L"),C=s("aPUy");const y="ultra.components.services.assessment.peerReview",O="peerReview";let A=class{constructor(e,t,s,n,i,o,a,r,c,l,d){this.$rootScope=e,this.$ngRedux=t,this.localizeService=s,this.contextUser=n,this.modal=i,this.ultraState=o,this.context=a,this.$q=r,this.courseId=c,this.contentId=l,this.columnId=d,this.reviewableAttemptsOnly=[],this.deletedAttemptsOnly=[],this.hasLoadedReviewableAttempts=!1}initPeerContentObject(){this.subscribeToReduxStore();const{courseId:e,contentId:t,columnId:s}=this,n=[];return this.content||n.push(this.loadContents({courseId:e,contentId:t}).then((()=>this))),this.column||n.push(this.loadGradebookColumn({courseId:e,columnId:s}).then((()=>this))),this.$q.all(n).then((()=>this))}subscribeToReduxStore(){this.unsubscribeFromReduxStore=this.$ngRedux.connect((e=>{var t;const s=this.courseId,n=this.columnId,i=this.contextUser.userId;return{reviewableAttemptsOnly:Object(u.sortBy)(l.select.gradebookAttempt.getReviewableGradebookAttempts(e,s,n,i),["delegatedGraderOrder"]),deletedAttemptsOnly:l.select.gradebookAttempt.getDeletedReviewableGradebookAttempts(e,n),content:l.select.content.getContentById(e,this.contentId),column:l.select.gradebookColumn.getGradebookColumnById(e,n),assessmentHasEnoughSubmissions:null===(t=l.select.assessment.getAssessmentByContentId(e,this.contentId))||void 0===t?void 0:t.hasEnoughPeerSubmissions}}),(e=>Object(p.bindActionCreators)({assignNewAttemptForPeerReview:l.actions.gradebookAttempt.assignNewAttemptForPeerReview,loadGradebookAttemptsByColumnId:l.actions.gradebookAttempt.loadGradebookAttemptsByColumnId,loadGradebookColumn:l.actions.gradebookColumn.loadGradebookColumn,loadContents:l.actions.content.loadContents},e)))(this)}canPeerViewAttempt(e,t){if(!this.peerGrading||!t)return!1;const s=this.reviewableAttempts.some((e=>e.id===t.id)),n=this.contextUser.userId===t.userId;return!!(s||n)}canDelegatedReconcileAttempt(e){return e.delegatedGrading&&e.isUserReconciler(this.contextUser.userId)}canPeerReviewAttempt(e,t){return this.canPeerViewAttempt(e,t)&&t.userId!==this.contextUser.userId&&!this.canDelegatedReconcileAttempt(e)}canPeerAddFeedbackToAttempt(e,t){return this.canPeerReviewAttempt(e,t)&&!t.isReconciled()&&d.AttemptStatus.Completed!==t.status}get completedPeerReviews(){return this.peerGrading?this.reviewableAttempts.filter((e=>d.AttemptStatus.Completed===(null==e?void 0:e.status))).length:0}openNotEnoughStudentSubmissionsModal(){const e=this.$rootScope.$new();e.translateOpts={title:{key:"components.services.peer-review.modal.error-not-enough-submissions.title"}},e.descriptionKey="components.services.peer-review.modal.error-not-enough-submissions.description";const t={scope:e,template:S,resolve:{translations:[f.serviceName,e=>e.loadBundle("components/services/peer-review")]}};this.modal.open(t)}getReviewableAttemptByDelegatedGraderOrder(e){return this.reviewableAttempts.find((t=>t.delegatedGraderOrder===e))}assignNewPeerReview(){if(!this.peerGrading||this.reviewableAttempts.length===this.numOfPeerReviewsToComplete)return this.$q.resolve(null);const e=this.hasDeletedAttempts?this.deletedAttempts[0].delegatedGraderOrder:null;return this.$q.when(this.assignNewAttemptForPeerReview({courseId:this.column.courseId,columnId:this.column.id,userId:this.contextUser.userId})).then((()=>{const t=null!=e?e:this.reviewableAttempts.length-1;return Object(C.a)(this.$rootScope,{listIndex:t,reviewableAttempt:this.reviewableAttempts[t]}),this.reviewableAttempts[t]})).catch((e=>{throw e instanceof l.AssessmentConflictNotEnoughPeerReviews&&this.openNotEnoughStudentSubmissionsModal(),e}))}navigateToPeerReview(e){if(!this.peerGrading)return this.$q.resolve();if(null===this.getReviewableAttemptByDelegatedGraderOrder(e))return this.$q.reject(new Error("Cannot navigate to a row that does not exist"));const t=this.getReviewableAttemptByDelegatedGraderOrder(e),s={courseId:this.column.courseId,columnId:this.column.id,userId:this.contextUser.userId,attemptId:null==t?void 0:t.id,gradeId:null==t?void 0:t.gradeId,initialPeerIndex:e};return this.ultraState.goPeekState(`${h.AssessmentRoutes.ASSESSMENT_PEER_GRADING}`,s)}loadReviewableAttempts(){var e;return!this.peerGrading||this.loadReviewableAttemptsPromise||this.hasLoadedReviewableAttempts?null!==(e=this.loadReviewableAttemptsPromise)&&void 0!==e?e:this.$q.resolve(this):(this.loadReviewableAttemptsPromise=this.$q.when(this.loadGradebookAttemptsByColumnId({courseId:this.column.courseId,columnId:this.column.id,reviewableAttemptsOnly:!0})).then((()=>(this.hasLoadedReviewableAttempts=!0,this))),this.loadReviewableAttemptsPromise)}get reviewableAttempts(){var e;return this.peerGrading&&null!==(e=this.reviewableAttemptsOnly)&&void 0!==e?e:[]}get deletedAttempts(){var e;return this.peerGrading&&null!==(e=this.deletedAttemptsOnly)&&void 0!==e?e:[]}get hasEnoughSubmissionsForPeerAssessment(){var e;return null!==(e=this.assessmentHasEnoughSubmissions)&&void 0!==e&&e}get hasDeletedAttempts(){return this.deletedAttempts.length>0}get numberOfLatePeerReviews(){return this.peerGrading?this.reviewableAttempts.filter((e=>this.isAfterPeerReviewDueDate(e.attemptLastGradedDate)&&d.AttemptStatus.Completed===e.status)).length:null}get numberOfStartedPeerReviews(){if(!this.peerGrading)return null;return this.reviewableAttempts.filter((e=>d.AttemptStatus.NeedsGrading===e.status)).length+this.deletedAttempts.length}get peerGrading(){var e;return!!(null===(e=this.column)||void 0===e?void 0:e.peerGrading)}get numOfPeerReviewsToComplete(){var e;return this.peerGrading?null===(e=this.content.peerSettings)||void 0===e?void 0:e.peerReviewsPerStudent:null}parseCurrentStringToDateAndMemoize(e){return i.a.parseStringToDate(e)}get peerSubmissionDueDate(){return this.peerGrading?this.parseCurrentStringToDateAndMemoize(this.column.dueDate):null}get peerReviewDueDate(){var e;return this.peerGrading?this.parseCurrentStringToDateAndMemoize(null===(e=this.content.peerSettings)||void 0===e?void 0:e.peerReviewDueDate):null}get allowLatePeerReviews(){return!!this.peerGrading&&!!this.content.peerSettings.allowLatePeerReviews}get isPeerGradingConfigured(){return!!this.peerGrading&&(null!=this.numOfPeerReviewsToComplete&&null!=this.peerReviewDueDate)}get isInPeerReviewWindow(){return!this.isAfterPeerReviewDueDate()&&this.isAfterPeerSubmissionDueDate()}get isAfterPeerReviewWindow(){return this.isAfterPeerReviewDueDate()}isAfterPeerReviewDueDate(e){var t;if(!this.peerGrading)return!1;const s=null!==(t=i.a.parseStringToDate(e))&&void 0!==t?t:new Date;return i.a.isWithinDateRange(s,{end:null,start:this.peerReviewDueDate},!1)}isAfterPeerSubmissionDueDate(e){var t;if(!this.peerGrading)return!1;const s=null!==(t=i.a.parseStringToDate(e))&&void 0!==t?t:new Date;return i.a.isWithinDateRange(s,{end:null,start:this.peerSubmissionDueDate},!1)}};Object(n.__decorate)([Object(o.LRUMemoize)()],A.prototype,"parseCurrentStringToDateAndMemoize",null),A=Object(n.__decorate)([Object(n.__param)(0,Object(m.b)("$rootScope")),Object(n.__param)(1,Object(m.b)("$ngRedux")),Object(n.__param)(2,Object(m.b)(f.serviceName)),Object(n.__param)(3,Object(m.b)(g.b)),Object(n.__param)(4,Object(m.b)(v.b)),Object(n.__param)(5,Object(m.b)(b.d)),Object(n.__param)(6,Object(m.b)(w.b)),Object(n.__param)(7,Object(m.b)("$q")),Object(n.__param)(8,Object(m.b)("courseId")),Object(n.__param)(9,Object(m.b)("contentId")),Object(n.__param)(10,Object(m.b)("columnId"))],A);class I{constructor(e){this.service=e,this.key=r.TransitService.PeerReview}getOrCreatePeerContentFromContent(e){return Object(c.a)(this.service.getOrCreatePeerContentFromContent(e))}}let D=class{constructor(e,t,s){this.$injector=e,this.$q=t,this.localizeService=s,this.peerContentMap=new Map,Object(r.registerService)(new I(this))}getPeerContent(e){return this.peerContentMap.get(e)}createPeerContent(e,t,s){const n=this.$injector.instantiate(A,{courseId:e,contentId:t,columnId:s});return this.peerContentMap.set(t,n),n.initPeerContentObject()}getOrCreatePeerContent(e,t,s){const n=this.getPeerContent(t);return n?this.$q.resolve(n):this.createPeerContent(e,t,s)}getDeployedAssessment(e){return(null==e?void 0:e.contentDetail)&&e.getDeployedAssessment()}getOrCreatePeerContentFromContent(e){var t,s;if(!e)return this.$q.resolve(null);const{courseId:n,id:i}=e,o=null===(s=null===(t=this.getDeployedAssessment(e))||void 0===t?void 0:t.gradingColumn)||void 0===s?void 0:s.id;return n&&i&&o?this.getOrCreatePeerContent(n,i,o):this.$q.resolve(null)}getOrCreatePeerContentWithAttemptsFromContent(e){return this.getOrCreatePeerContentFromContent(e).then((e=>null==e?void 0:e.loadReviewableAttempts()))}getOrCreatePeerContentFromColumn(e){if(!e)return this.$q.resolve(null);const{courseId:t,contentId:s,id:n}=e;return t&&s&&n?this.getOrCreatePeerContent(t,s,n):this.$q.resolve(null)}getOrCreatePeerContentWithAttemptsFromColumn(e){return this.getOrCreatePeerContentFromColumn(e).then((e=>null==e?void 0:e.loadReviewableAttempts()))}isPeerEvaluationItem(e){return l.ScoreProviderHandle.PeerEvaluationTest.isEqualTo(e)}wrapPeerEvaluationItemTitle(e,t){return this.localizeService.translateSync({locale:t,key:"components.services.peer-review.peerEvaluationTitleWrapper",params:{itemTitle:e},noWrap:!0,noEscape:!0})}};D=Object(n.__decorate)([Object(n.__param)(0,Object(m.b)("$injector")),Object(n.__param)(1,Object(m.b)("$q")),Object(n.__param)(2,Object(m.b)(f.serviceName))],D);a.module(y,[f.moduleName,g.a,v.a,b.b,w.a]).service(O,D)},"9hVN":function(e,t,s){"use strict";s.d(t,"a",(function(){return u})),s.d(t,"b",(function(){return p}));var n=s("D57K"),i=s("Llzl"),o=s("sgjL"),a=s("TnpK"),r=s("lEL+"),c=s("nmzr"),l=s("g66W"),d=s("aHpC");const u="ultraUi.components.services.contentCollection",p="ContentCollection";let m=class{constructor(e,t,s,n){this.$q=e,this.postMessageDispatcherService=t,this.stateService=s,this.timeoutService=n}handleContentCollectionResponse(e,t=null){this.postMessageDispatcherService.registerEventHandler("classic-picker-cancel",((t,s)=>{this.timeoutService((()=>{l.d(this.stateService.current.name,"peek.content-collection-picker")&&this.stateService.leavePeekState(this.stateService.current.name),window!==s&&s.close()}),e,0)}),e),this.postMessageDispatcherService.registerEventHandler("classic-picker-submit",((s,n)=>{this.timeoutService((()=>{t?e.$emit("bb-bbml-editor-add-from-content-collection",t,s.items):this.getCcFilesDeferred.resolve(s.items),l.d(this.stateService.current.name,"peek.content-collection-picker")&&this.stateService.leavePeekState(this.stateService.current.name),window!==n&&n.close()}),e,0)}),e,!0)}getOpenContentCollectionFunction(e){return t=>{this.handleContentCollectionResponse(e),this.getCcFilesDeferred=this.$q.defer(),this.getCcFilesDeferred.promise.then((e=>{t(e)})),this.stateService.goPeekState(c.ContentCollectionRoutes.CONTENT_COLLECTION_PICKER,{pickerType:"File",multi:"true"})}}};m=Object(n.__decorate)([Object(n.__param)(0,Object(d.b)("$q")),Object(n.__param)(1,Object(d.b)(o.b)),Object(n.__param)(2,Object(d.b)(a.d)),Object(n.__param)(3,Object(d.b)(r.b))],m),i.module(u,[]).service(p,m)},"9hp7":function(e,t){e.exports='<div bb-load-bundle="components/directives/add-content-button">\n  <div class="add-element no-select js-add-content-button {{::contextArea + \'-add-button\'}}"\n       ng-class="{\n         \'force-show-add-button\': addContentButton.isForceShowAddButton && addContentButton.isForceShowAddButton(),\n         \'is-active\': addContentButton.isMenuVisible,\n         \'button-visible\': addContentButton.isButtonVisible,\n         hide: hideDividerLines() && !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)\n       }"\n       ng-keydown="addContentButton.onKeydown($event)">\n    <template></template>\n  </div>\n  <div id="{{::fileListViewId}}">\n    <bb-progress display-results="false" primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId" target-div="{{::\'#\' + fileListViewId}}"></bb-progress>\n  </div>\n</div>'},APyD:function(e,t){e.exports='<div class="question-container">\n  <bb-rich-text-editor\n    ng-model="assessmentQuestion.questionAttempt.question.questionText.rawText"\n    is-read-only="true"\n    supports-inline-document-render="true"\n    plugin-options="editorPluginOptions"\n  >\n  </bb-rich-text-editor>\n</div>\n'},AVdi:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return _}));var n=s("D57K"),i=(s("dY8P"),s("5uNO"),s("w0/N"),s("6BRP"),s("zexu"),s("nsO7")),o=s("Llzl"),a=s("0JpG"),r=s("12mu"),c=s("BJLZ"),l=s("XGja"),d=s("d8yC"),u=s("yMoE"),p=s("o5Lu"),m=s("p7NW"),h=s("dd1C"),b=s("+4Px"),g=s("pjml"),v=s("lEL+"),f=s("t3AZ"),w=s("TnpK"),S=s("m2KQ"),C=s("aHpC"),y=s("zGdY"),O=s("ho2F"),A=s("7kzC");s.d(t,"b",(function(){return A}));var I=s("RjAI"),D=s("IbyE"),k=s("9OUN");const _="ultra.components.directives.grade.gradeInput";let j=class t{constructor(s,n,i,o,a,r,c,l,d,p,m,h,g,v,f,w,S,C){this.$rootScope=s,this.$compile=n,this.$q=i,this.$injector=o,this.$ngRedux=a,this.scope=r,this.element=c,this.attrs=l,this.form=d,this.bbLocalize=p,this.grade=m,this.AttemptModel=h,this.GradeModel=g,this.GroupAttemptModel=v,this.CourseModel=f,this.timeout=w,this.ultraState=S,this.$modal=C,this.alertScreenReaderNewGrade=!1,this.gradeDisplayItem=this.$injector.instantiate(u.a,{gradeDetail:this.scope.gradeDetail,scope:this.scope}),this.id=this.attrs.id,this.isSaving=!1,this.wrapperDiv=this.element.find("."+t.WRAPPER_CLASS),this.inputElement=this.wrapperDiv.find("input"),this.isWrapperDivClickHandled=!1,this.gradeNotationsWrapperSelector=this.scope.gradeNotationsWrapperSelector||"body",this.inputElementBluredByTab=!1,this.isProcessingFocusEvent=!1,this.onDismissCallback=()=>{this.gradeDialog.isVisible=!1,this.form[this.id].$setPristine(),this.inputElement.blur(),this.inputElement.focus(),this.inputElement.select()},this.onSuccessCallback=()=>{this.gradeDialog.isVisible=!1,this.validateAndSave(!0).finally((()=>{this.setFocusOnNextTabbableElement()}))},this.closeModal=e=>{e?this.modalInstance.close():this.modalInstance.dismiss()},this.overrideDialogScope=r.$new(),this.subscribeToRedux(),this.wrapperDiv.on("click",(()=>{this.isRubricEvalMode()||(this.isWrapperDivClickHandled=!0,this.scope.onClick&&!this.isReadOnly()&&this.scope.onClick(),this.wrapperDiv.addClass(t.WRAPPER_FOCUS_CLASS),this.inputElement.is(":focus")||(this.inputElement.focus(),this.inputElement.select()))})),this.inputElement.on("click",(t=>{e("#performanceCodes-"+this.id).hasClass("f-open-dropdown")&&(t.preventDefault(),t.stopPropagation())})),this.inputElement.on("focus",(s=>{if(!this.isProcessingFocusEvent){this.isProcessingFocusEvent=!0;try{s.preventDefault(),s.stopPropagation(),this.wrapperDiv.addClass(t.WRAPPER_FOCUS_CLASS),this.inputElement.select(),this.scope.$emit("grade-input-in-focus",this.id);const n=e("#performanceCodes-"+this.id);this.scope.offsetTop&&this.scope.offsetTop()||n.addClass("show"),this.isWrapperDivClickHandled||this.timeout((()=>{n&&!n.hasClass("f-open-dropdown")&&(this.inputElement.trigger("click.fndtn.dropdown"),this.scope.offsetTop&&this.repositionGradeNotationDropdown(n))}),this.scope,0,!1)}finally{this.isProcessingFocusEvent=!1}}})),this.inputElement.on("keydown",(t=>{const s=e("#performanceCodes-"+this.id);if(s&&s.hasClass("f-open-dropdown")&&t.keyCode===b.u&&!t.shiftKey){this.inputElementBluredByTab=!0;const e=s.find(":tabbable");e&&(e.first().focus(),t.preventDefault(),t.stopPropagation())}else(t.keyCode===b.f||t.keyCode===b.m||t.keyCode===b.u&&!t.shiftKey)&&(t.preventDefault(),this.inputElement.is(":focus")&&this.inputElement.trigger("click.fndtn.dropdown"),this.shouldShowModal()?this.openOverrideDialog():this.$q.when(this.validateAndSave()).finally((()=>{this.gradeDialog.isVisible||this.setFocusOnNextTabbableElement()})))})),this.element.foundation(),this.scope.$watch("::column",(e=>{e&&(this.courseId=e.courseId,this.gradeDisplayItem.init(e).then((()=>{this.attrs.gradeDetail&&this.scope.$watchGroup(["gradeDetail.id","gradeDetail.displayGrade","gradeDetail.ui.attempt.displayGrade","isGroupGradeInProgress()","isGroupGradeMultiple()","column.gradingSchemaId","column.possible"],(e=>{this.isSaving||this.refreshInputBox()}))})),e.externalGrade?this.errorMessageKey="components.directives.grade.grade-input.errorMessage.overallGrade":this.errorMessageKey="components.directives.grade.grade-input.errorMessage.default")})),this.buildGradeDialog()}buildGradeDialog(){this.gradeDialog={isVisible:!1,textContent:{title:this.getStringFromLocale("components.directives.grade.grade-input.clearConfirmationDialog.title"),body:this.getStringFromLocale("components.directives.grade.grade-input.clearConfirmationDialog.body"),secondaryButtonText:this.getStringFromLocale("components.directives.grade.grade-input.clearConfirmationDialog.secondaryButtonText"),primaryButtonText:this.getStringFromLocale("components.directives.grade.grade-input.clearConfirmationDialog.primaryButtonText")},onDismiss:this.onDismissCallback,onSuccess:this.onSuccessCallback}}openOverrideDialog(){var t;if(!(null===(t=this.modalInstance)||void 0===t?void 0:t.opened)){const t=this.scope.gradeDetail?this.scope.gradeDetail.getScore():"",s=this.getTruncatedPointsPossible(),n=this.bbLocalize.parseNumberSync(this.gradeDisplayItem.displayValue),i=d.b(this.grade.pointToPercentage(n,s),2);return this.overrideDialogScope.closeModal=this.closeModal,this.overrideDialogScope.grade=i,this.modalInstance=this.$modal.open({template:A,scope:this.overrideDialogScope,resolve:{translations:[a.serviceName,e=>e.loadBundle("components/directives/grade/grade-input")]}}),this.modalInstance.result.then((()=>(this.timeout((()=>{e("#performanceCodes-"+this.id).remove()}),this.scope,0,!1),this.validateAndSave())),(()=>{this.gradeDisplayItem.displayValue=t,this.onDismissCallback()})).finally((()=>{this.modalInstance.opened=null}))}}shouldShowModal(){var e;return(null===(e=this.scope.column)||void 0===e?void 0:e.externalGrade)&&this.isScoreSchema()&&this.isFormValid()&&this.isFormDirty()&&this.scoreHasChanged()&&""!==this.gradeDisplayItem.displayValue&&!this.isGradesComplete()}getStringFromLocale(e){return this.bbLocalize.translateSync({key:e,locale:this.bbLocalize.getLocale(this.scope)})}isFormDirty(){return this.form[this.id].$dirty}isFormValid(){return this.form[this.id].$valid}repositionGradeNotationDropdown(e){const t=this.inputElement.closest(this.gradeNotationsWrapperSelector).height(),s=e.position()&&e.position().top;let n=s+e.height();if(this.scope.offsetTop&&this.scope.offsetTop()){const t=s+2*this.scope.offsetTop();e.css("top",t),e.addClass("show"),n=t+e.height()}n>t&&this.scope.$root.$broadcast("performance-dropdown-container-height-update",n-t+30)}showGradeNotationDropdown(){e("#performanceCodes-"+this.id).length>0&&e("#performanceCodes-"+this.id).remove();const t=this.$compile(O)(this.scope);this.inputElement.closest(this.gradeNotationsWrapperSelector).append(t),this.scope.offsetTop&&this.isWrapperDivClickHandled&&this.repositionGradeNotationDropdown(t),t.on("keydown",(s=>{if(s.keyCode!==b.u||s.shiftKey)s.keyCode===b.g&&(s.preventDefault(),s.stopPropagation(),this.inputElement.trigger("click.fndtn.dropdown"),this.timeout((()=>{e("#performanceCodes-"+this.id).remove()}),this.scope,0,!1),this.$q.when(this.validateAndSave()).finally((()=>{this.gradeDialog.isVisible||this.setFocusOnNextTabbableElement()})));else{const e=t.find(":tabbable");e.last().is(":focus")&&(s.preventDefault(),e.eq(0).focus())}})),this.element.foundation()}refreshInputBox(){const e=this.scope.gradeDetail&&this.scope.gradeDetail.id,t=this.scope.gradeDetail&&this.scope.gradeDetail.displayGrade,s=this.scope.isGroupGradeInProgress&&this.scope.isGroupGradeInProgress(),n=this.scope.isGroupGradeMultiple&&this.scope.isGroupGradeMultiple(),i=this.scope.column.gradingSchemaId;this.gradeDisplayItem.schema.id!==i&&this.gradeDisplayItem.init(this.scope.column),e&&t?(this.gradeDisplayItem.displayGrade=t,this.updateGradeColor()):s?(this.gradeDisplayItem.displayValue=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.services.grade.in_progress"}),this.gradeDisplayItem.parsedValue="",this.updateGradeColor()):n?(this.gradeDisplayItem.displayValue=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.services.grade.multiple"}),this.gradeDisplayItem.parsedValue="",this.updateGradeColor()):t?(this.gradeDisplayItem.displayGrade=t,this.updateGradeColor()):(this.gradeDisplayItem.displayGrade=null,this.updateGradeColor())}shouldShowTotalPoints(){return(this.gradeDisplayItem.shouldShowTotalPoints()||this.hasFocus()||this.form[this.id]&&this.isFormDirty())&&(!this.isMultipleShown()&&!this.isInProgressShown()||(this.isMultipleShown()||this.isInProgressShown())&&this.hasFocus())&&!this.getPerfCodeFromDisplayValue(this.gradeDisplayItem.displayValue)}getTruncatedPointsPossible(){var e,t,s;return this.isScoreSchema()?d.b((null===(e=this.scope.gradeDetail)||void 0===e?void 0:e.manualGrade)&&this.scope.gradeDetail.pointsPossible||this.scope.column.possible||this.scope.column.isCalculated()&&100||0,2):d.b(null!==(s=null===(t=this.scope.gradeDetail)||void 0===t?void 0:t.pointsPossible)&&void 0!==s?s:this.scope.column.isCalculated()?100:this.scope.column.possible,2)}isScoreSchema(){var e,t;return(null===(t=null===(e=this.gradeDisplayItem)||void 0===e?void 0:e.schema)||void 0===t?void 0:t.scaleType)===y.SchemaScaleType.Score}isReadOnly(){return this.scope.readOnly&&this.scope.readOnly()}hasFocus(){return this.inputElement.is(":focus")||this.wrapperDiv.hasClass(t.WRAPPER_FOCUS_CLASS)}scoreHasChanged(){var e;return((null===(e=this.scope.gradeDetail)||void 0===e?void 0:e.getScore())?this.bbLocalize.parseNumberSync(this.scope.gradeDetail.getScore()):null)!==(this.gradeDisplayItem.displayValue?this.bbLocalize.parseNumberSync(this.gradeDisplayItem.displayValue):null)}validateAndSave(e){if(!this.isGradeErased()||e||this.isGradeErased()&&!this.scope.hasRubricClearConfirmationCallout){if(this.wrapperDiv.removeClass(t.WRAPPER_FOCUS_CLASS),this.scope.$emit("grade-input-blur",this.id),this.shouldShowPastDueZeroIndicator()&&""===this.form[this.id].$viewValue&&(this.gradeDisplayItem.displayValue="0",this.form[this.id].$setPristine()),this.isFormValid())if(this.isFormDirty()&&this.scoreHasChanged()){if(this.scope.forGroup&&this.isReservedWord(this.form[this.id].$viewValue))this.wrapperDiv.removeClass(this.inputColorClass);else if(!this.isSaving){const e=this._save();return this.scope.$emit("grade-input-save-promise",e),e.then((e=>{this.form[this.id]&&this.form[this.id].$setPristine(),this.alertScreenReaderNewGrade=!0,this.scope.$emit("bb-grade-input-save",e,this.scope.column.id,this.scope.forUser&&this.scope.forUser.id),this.reloadGradeDetail(this.courseId,[this.scope.column.id],[this.scope.gradeDetail.memberId],{expand:["grade.instructorFeedback","grade.lastFeedbackAuthor"]}),this.refreshInputBox()})).finally((()=>{this.isSaving=!1})),e}}else this.form[this.id].$setPristine(),this.refreshInputBox()}else this.isSaving||(this.gradeDialog.isVisible=!0)}_validate(){const e=this.grade.createGradeSubmission(this.scope.column,this.gradeDisplayItem.displayValue,this.gradeDisplayItem.schema);e.clearGrade=this.isGradeErased();const t=this.grade.validateGrade(e,this.scope);return this.$q.when(t).then((e=>{this.form[this.id].$setValidity("invalidGrade",e)}))}getPerfCodeFromDisplayValue(e){let t=null;if(e){const s=this.scope.gradeNotations?this.scope.gradeNotations():[];if(s.length>0){const n=i.find(s,(t=>t.code===e));n&&(t=n.id)}}return t}_save(){var e,t,s,n;let o=this.$q.when();const a=null!==(t=null===(e=this.scope.gradeDetail)||void 0===e?void 0:e.ui.groupAttempt)&&void 0!==t?t:null===(s=this.scope.gradeDetail)||void 0===s?void 0:s.ui.attempt;this.isSaving=!0,this.perfCodeId=this.getPerfCodeFromDisplayValue(this.gradeDisplayItem.displayValue);const r=this.perfCodeId?this.gradeDisplayItem.displayValue:this.grade.parseGrade(this.gradeDisplayItem.displayValue,this.gradeDisplayItem.schema,this.scope),c=this.grade.createGradeSubmission(this.scope.column,r,this.gradeDisplayItem.schema);if(this.perfCodeId&&(c.perfCodeId=this.perfCodeId),this.scope.column&&this.scope.column.externalGrade&&this.scope.gradeDetail){const e=this.scope.gradeDetail.manualGrade?this.scope.gradeDetail.pointsPossible:this.scope.column.possible,t=c.gradeValue;if(e&&e>0&&t&&t.isNumeric){const s=parseFloat(t.grade);t.grade=String(this.isScoreSchema()?s:100*s/e)}this.gradeDisplayItem.schema.scaleType===y.SchemaScaleType.Score&&(c.pointsPossible=e)}else if((null===(n=this.scope.column)||void 0===n?void 0:n.externalGrade)&&!this.scope.gradeDetail){const e=this.scope.column.possible;this.gradeDisplayItem.schema.scaleType===y.SchemaScaleType.Score&&(c.pointsPossible=e)}if(this.isGradeErased()&&(c.clearGrade=!0,this.scope.forGroup?c.groupAttemptId=null==a?void 0:a.id:c.attemptId=null==a?void 0:a.id,(this.scope.column.isAssignment()||this.scope.column.isDiscussion())&&(this.scope.forGroup?this.scope.forGroup&&!this.scope.gradeDetail.ui.groupAttempt&&(o=this.scope.column.getContentGroupIdToGroupAttempt({expand:"attempts,toolAttemptDetail,attempts.toolAttemptDetail,lastFeedbackAuthor,attempts.lastFeedbackAuthor"}).then((e=>{i.values(e.lookup).forEach((e=>{e[0].groupId===this.scope.forGroup.id&&(this.scope.gradeDetail.ui.groupAttempt=e[0])}))}))):o=this.$q.when()),this.isRubricAssociated())){const e=null==a?void 0:a.rubricEvaluation;e&&(e.cells=[]),c.setGradeToEmpty=!0,c.rubricEvaluation=e}return o.then((()=>{const e=this.scope.override&&this.scope.override()&&!(this.isGradeErased()&&(this.scope.column.isAssignment()||this.scope.column.isDiscussion()||this.scope.forGroup))?null:a,t=!(!this.scope.gradeDetail||!this.scope.gradeDetail.isPosted()),s=this.isGradeErased(),n=this.scope.gradeDetail;return this.grade.saveGrade(c,n,e,{userId:this.scope.forUser&&this.scope.forUser.id,group:this.scope.forGroup}).then((e=>{if(this.isRubricAssociated()&&this.$rootScope.$emit(m.d,c.gradeValue.grade),this.scope.column.externalGrade&&e.displayGrade&&e.displayGrade.isOverride&&!this.isScoreSchema()&&(e.pointsPossible=100),e instanceof this.AttemptModel)this.scope.gradeDetail.displayGrade=e.displayGrade,s&&(this.scope.gradeDetail.manualStatus=y.ManualGradeStatus.NoOverride),Object.assign(this.scope.gradeDetail.ui.attempt,e);else if(e instanceof this.GroupAttemptModel)this.gradeDisplayItem.displayGrade=e.displayGrade,this.scope.gradeDetail.displayGrade=e.displayGrade;else if(e instanceof this.GradeModel){const t=this.scope.gradeDetail?this.scope.gradeDetail.permissions:null;this.scope.gradeDetail=e,t&&(this.scope.gradeDetail.permissions=t),this.scope.column.externalGrade&&e.displayGrade&&!e.displayGrade.isOverride&&!this.isScoreSchema()&&(this.scope.gradeDetail=this.grade.gradeDetailToPercentage(this.scope.gradeDetail)),this.scope.column.externalGrade&&(this.gradeDisplayItem.gradeDetail=this.scope.gradeDetail)}else e[0]instanceof this.GradeModel&&(this.scope.gradeDetail.displayGrade=e[0].displayGrade);return(this.scope.column.isAssignment()||this.scope.column.isDiscussion())&&!s&&t&&(e.isPosted&&!e.isPosted()||e.isCompleted&&!e.isCompleted()||e[0]&&e[0].isReadyToPost&&e[0].isReadyToPost())?this._postGrade(e):e}))}))}_postGrade(e){return this.scope.forGroup?this.scope.column.postReadyGroupAttempts({groupAssociationId:this.scope.gradeDetail.ui.groupAttempt.groupAssociationId}).then((t=>(this.scope.gradeDetail.manualStatus=y.ManualGradeStatus.IsPosted,e instanceof Array&&e.forEach((e=>{e.manualStatus=y.ManualGradeStatus.IsPosted})),e))):this.scope.gradeDetail.postReadyGrades().then((t=>(this.scope.gradeDetail.manualStatus=y.ManualGradeStatus.IsPosted,e.status=y.AttemptStatus.Completed,e)))}isMultipleShown(){return this.scope.isGroupGradeMultiple&&this.scope.isGroupGradeMultiple()}isInProgressShown(){return this.scope.isGroupGradeInProgress&&this.scope.isGroupGradeInProgress()}gradeValueOnChange(){this.$q.when(this._validate()).then((()=>{this.scope.hasGradeAndIsValid=this.form[this.id].$valid&&!!this.gradeDisplayItem.displayValue}))}onFocus(){this.canOverrideByGradeNotation()&&this.showGradeNotationDropdown(),this.isFormValid()&&!this.isFormDirty()&&(this.gradeDisplayItem.displayValue=this.gradeDisplayItem.parsedValue)}shouldShowOverrideIndicator(){return!(null==this.scope.enableOverrideIndicator||!this.scope.enableOverrideIndicator||!this.scope.gradeDetail)&&(!this.shouldShowPastDueZeroIndicator()&&this.grade.isRubricGradeOverridden(this.scope.gradeDetail,this.scope.gradeDetail.ui.attempt,this.scope.column,this.scope.forGroup))}shouldShowPastDueZeroIndicator(){return this.scope.gradeDetail&&this.scope.gradeDetail.displayGrade&&this.scope.gradeDetail.displayGrade.scoredByAutomaticZero}isRubricAssociated(){return this.scope.column.hasRubricAssociation()}isRubricEvalMode(){return!!this.scope.enableRubricEvalAction&&this.scope.enableRubricEvalAction()&&this.isRubricAssociated()}shouldShowInput(){return!this.isRubricEvalMode()||this.isRubricEvalMode()&&this.scope.enableEditableInputMode}openRubricEvaluation(){var e,t;if(!this.isRubricAssociated()||this.scope.disableRubricEvalClick&&this.scope.disableRubricEvalClick())return;let s;s=(null===(e=this.scope.gradeDetail)||void 0===e?void 0:e.groupAssociationId)?(null===(t=this.scope.forUser)||void 0===t?void 0:t.id)||null:this.scope.gradeDetail.user&&(this.scope.gradeDetail.user.$pk||this.scope.gradeDetail.user.id)||null,this.timeout((()=>{this.ultraState.goPeekState("rubric-evaluation",{userId:s,groupId:this.scope.forGroup?this.scope.forGroup.id:null,columnId:this.scope.column.id})}),this.scope,0,!1)}updateGradeColor(){this.wrapperDiv.removeClass(this.inputColorClass),!this.gradeDisplayItem.displayValue||this.scope.isGroupGradeMultiple&&this.scope.isGroupGradeMultiple()||this.scope.isGroupGradeInProgress&&this.scope.isGroupGradeInProgress()||(this.inputColorClass=this.gradeDisplayItem.getGradeColor(),this.wrapperDiv.addClass(this.inputColorClass))}isGradeErased(){return this.isFormDirty()&&this.gradeDisplayItem.wasValueErased}setFocusOnNextTabbableElement(){this.timeout((()=>{l.b(null,this.inputElement)}),this.scope,0,!1)}isReservedWord(e){const t=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.services.grade.multiple"}).toLocaleLowerCase(),s=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.services.grade.in_progress"}).toLocaleLowerCase(),n=e.toLocaleLowerCase();return n===t||n===s}getGradeInputAriaLabelKey(){if(!this.scope.forUser&&!this.scope.forGroup)return;let e="components.directives.grade.grade-input.aria.",t=this.shouldShowOverrideIndicator()?"overrideScoreInput":"scoreInput";return this.shouldShowPastDueZeroIndicator()&&(t="pastDueZeroScoreInput"),e+=t,this.scope.forGroup&&(e+="Group"),e+=this.gradeDisplayItem.displayValue?"Graded":"Empty",e}canOverrideByGradeNotation(){const e=this.scope.gradeNotations?this.scope.gradeNotations():[];return this.scope.canOverrideByGradeNotation&&this.scope.canOverrideByGradeNotation()&&(e&&e.length>0||this.scope.gradeDetail&&this.scope.gradeDetail.displayGrade&&this.scope.gradeDetail.displayGrade.isOverride)}getAriaDescribeById(){return`invalidGradeAriaDescribeById_${this.scope.forUser.id}`}clickGradeNotation(e,t){t.stopPropagation(),this.gradeDisplayItem.displayValue=e.code,this.perfCodeId=e.id,this.afterClickDropdownListItem()}undoOverride(){this.gradeDisplayItem.displayValue="",this.perfCodeId=null,this.afterClickDropdownListItem()}afterClickDropdownListItem(){this.form[this.id].$setDirty(!0),this.form[this.id].$setValidity("invalidGrade",!0),this.timeout((()=>{e("#performanceCodes-"+this.id).remove()}),this.scope,0,!1),this.$q.when(this.validateAndSave()).finally((()=>{this.setFocusOnNextTabbableElement()}))}isGradesComplete(){return!1}onBlur(t){this.isWrapperDivClickHandled=!1;let s=[];t&&t.relatedTarget&&t.relatedTarget.classList&&(s=t.relatedTarget.classList),this.inputElementBluredByTab||i.includes(s,"performance-code-option")||(this.timeout((()=>{this.inputElementBluredByTab=!1,e("#performanceCodes-"+this.id).remove()}),this.scope,0,!1),this.shouldShowModal()?this.openOverrideDialog():this.validateAndSave())}subscribeToRedux(){const e=this.$ngRedux.connect(null,(e=>Object(k.bindActionCreators)({reloadGradeDetail:D.actions.gradebookGrade.loadBulkView},e)))(this);this.scope.$on("$destroy",e)}};j.WRAPPER_CLASS="wrapping-input-style",j.WRAPPER_FOCUS_CLASS="wrapping-input-style-focus",j=Object(n.__decorate)([Object(n.__param)(0,Object(C.b)("$rootScope")),Object(n.__param)(1,Object(C.b)("$compile")),Object(n.__param)(2,Object(C.b)("$q")),Object(n.__param)(3,Object(C.b)("$injector")),Object(n.__param)(4,Object(C.b)("$ngRedux")),Object(n.__param)(5,Object(C.b)("scope")),Object(n.__param)(6,Object(C.b)("element")),Object(n.__param)(7,Object(C.b)("attrs")),Object(n.__param)(8,Object(C.b)("form")),Object(n.__param)(9,Object(C.b)(a.serviceName)),Object(n.__param)(10,Object(C.b)(p.k)),Object(n.__param)(11,Object(C.b)(g.A.serviceName)),Object(n.__param)(12,Object(C.b)(g.D.serviceName)),Object(n.__param)(13,Object(C.b)(g.E.serviceName)),Object(n.__param)(14,Object(C.b)(g.m.serviceName)),Object(n.__param)(15,Object(C.b)(v.b)),Object(n.__param)(16,Object(C.b)(w.d)),Object(n.__param)(17,Object(C.b)(r.b))],j);class T{constructor(e,t){this.$injector=e,this.bbLocalize=t,this.restrict="E",this.template=S,this.require="^form",this.scope={column:"=",gradeDetail:"=",onClick:"&",onBlur:"&",enableRubricEvalAction:"&?",hasRubricClearConfirmationCallout:"<?",disableRubricEvalClick:"&?",enableEditableInputMode:"&?",forUser:"=?",forGroup:"=?",hasGradeAndIsValid:"=?",isGroupGradeMultiple:"&?",isGroupGradeInProgress:"&?",notAllowEmptyString:"&?",override:"&?",readOnly:"&?",enableOverrideIndicator:"=?",canOverrideByGradeNotation:"&?",gradeNotations:"&?",gradeNotationsWrapperSelector:"@?",offsetTop:"&?"},this.link=(e,t,s,n)=>{if(!s.id&&!s.column)throw new Error("Id and Column are required.");if(!s.gradeDetail)throw new Error("A grade object must be provided");if(s.gradeDetail&&!s.forUser&&!s.forGroup)throw new Error("forUser or forGroup is required.");e.gradeInput=this.$injector.instantiate(j,{scope:e,element:t,attrs:s,form:n})}}}T.$inject=["$injector"],o.module(_,["puElasticInput",c.a,h.a,f.a,w.b,I.a]).directive("bbGradeInput",["$injector",e=>e.instantiate(T)])}).call(this,s("71td"))},"Aw+3":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-feedback",use:"icon-small-feedback-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-feedback"><path d="M1 1h14v12h-4l-3 2-3-2H1V1zM4 4h8M4 7h8M4 10h4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},B5op:function(e,t){e.exports='<bb-modal id="confirm-leaving-modal" class="notification success"\n          modal-title-key="course.content.assessment.test.modal.confirmLeaving.title"\n          bb-focus="true"\n          analytics-id-tag-prefix="course.content.assessment.test.modal.confirmLeaving">\n  <div name="modal-contents">\n    <p ng-if="assessmentAttempt.willAutoSubmit" bb-translate>\n      course.content.assessment.test.modal.confirmLeaving.body.autoSubmit\n    </p>\n    <p ng-if="!assessmentAttempt.willAutoSubmit" bb-translate>\n       course.content.assessment.test.modal.confirmLeaving.body.noAutoSubmit\n    </p>\n  </div>\n  <button name="modal-footer-button-primary" class="button confirm-ok js-primary-button" ng-click="$parent.$close()" bb-translate analytics-id="course.content.assessment.test.modal.confirmLeaving.close">\n    course.content.assessment.test.modal.confirmLeaving.close\n  </button>\n  <button name="modal-footer-button-secondary" class="button button--secondary confirm-cancel js-secondary-button" ng-click="$parent.$dismiss()" bb-translate analytics-id="course.content.assessment.test.modal.confirmLeaving.cancel">\n    course.content.assessment.test.modal.confirmLeaving.cancel\n  </button>\n</bb-modal>\n'},BJLZ:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("71td"),i=s("Llzl"),o=s("e6jQ"),a=s("lEL+");const r="ultra.directives.accessibility.alert";class c{constructor(e,t){this.$injector=e,this.timeout=t,this.restrict="A",this.link=(e,t,s)=>{this.alertContainerId=s.alertId?s.alertId:o.a(),e.$on("$destroy",(()=>{n(`#${this.alertContainerId}`).remove()})),e.$watch((()=>t.html()),(t=>{this.alertArea.html("");const n=Number(s.bbAxAlert)||0;null!=t&&""!==t&&(0===n?this.trigger(t):this.timeout(this.trigger.bind(this,t),e,n,!1))}))},this.trigger=e=>{this.alertArea.append(n(`<div id="${this.alertContainerId}"></div>`).append(e))},this.alertArea=n("body > .ax-alert-area"),0===this.alertArea.length&&(n("body").append('<div class="ax-alert-area" role="alert" aria-atomic="false" aria-live="assertive"></div>'),this.alertArea=n("body > .ax-alert-area"))}}c.$inject=["$injector",a.b],i.module(r,[a.a]).directive("bbAxAlert",["$injector",e=>e.instantiate(c)])},BLb8:function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"a",(function(){return i})),s.d(t,"c",(function(){return o}));const n=(e,t)=>{e.$on("refresh-items",t)},i=(e,t)=>{e.$on("close-scorm-launch-frame",t)},o=(e,t)=>{e.content.$fetch().$asPromise().then((s=>{s===e.content?((e,t)=>{t?e.$broadcast("refresh-items",t):e.$broadcast("refresh-items")})(e,t):e.content=s}))}},BMpZ:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("D57K"),i=s("aHpC"),o=s("yC9S"),a=(s("DlnX"),s("IgL1"));const r="ultra.components.directives.buttonComplexTooltip";let c=class{constructor(e,t){this.$scope=e,this.$rootScope=t}$onInit(){this.$scope.buttonComplexTooltip=this}getToolTipTemplate(){return'<ul class="complex-tooltip-list conditional-release-tooltip"> <li bb-translate>components.directives.grade.grader-column.restrictedInfo</li> </ul>'}};c=Object(n.__decorate)([Object(o.a)({moduleName:r,componentName:"bbButtonComplexTooltip",template:a}),Object(n.__param)(0,Object(i.b)("$scope")),Object(n.__param)(1,Object(i.b)("$rootScope"))],c)},BXQP:function(e,t){e.exports='<div class="timestamp" bb-load-bundle="components/directives/duration" ng-cloak bb-cache-compilation="duration-directive">\n  <div ng-if="!duration.needAgo()">\n    <div class="js-split-datetime" ng-if="duration.separateDatetime()">\n      <span class="date" ng-bind="duration.date"></span>\n      <span class="time" ng-bind="duration.time"></span>\n    </div>\n    <bb-datetime ng-if="!duration.separateDatetime()" ng-class="{\'date\':duration.date}" value="date" format="Short"></bb-datetime>\n  </div>\n  <div ng-if="duration.needAgo()"\n       class="js-duration-ago"\n       bb-translate="components.directives.duration.agoText"\n       translate-values="{durationDate: duration.date, durationTime: duration.time}"></div>\n</div>'},BiyI:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-add-plus",use:"icon-small-add-plus-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-add-plus"><path d="M8 5v6M11 8H5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},C2vp:function(e,t,s){"use strict";s.d(t,"i",(function(){return n})),s.d(t,"l",(function(){return v})),s.d(t,"k",(function(){return f})),s.d(t,"c",(function(){return w})),s.d(t,"g",(function(){return S})),s.d(t,"j",(function(){return C})),s.d(t,"a",(function(){return y})),s.d(t,"e",(function(){return O})),s.d(t,"f",(function(){return A})),s.d(t,"d",(function(){return I})),s.d(t,"h",(function(){return D})),s.d(t,"b",(function(){return k}));var n,i=s("D57K"),o=s("X/qj"),a=s("FBBZ"),r=s("pjml"),c=s("nsO7"),l=s("TnpK"),d=s("yMoE"),u=s("IbyE"),p=s("8jzW"),m=s("vhkR"),h=s("nmzr"),b=s("aHpC");!function(e){e[e.UNLOADED=0]="UNLOADED",e[e.WAITING=1]="WAITING",e[e.LOADING=2]="LOADING",e[e.LOADED=3]="LOADED"}(n||(n={}));let g=class{constructor(e,t,s,i,o,a,r,c,l,d,u=null,p=n.UNLOADED){this.$q=e,this.$injector=t,this.ltiService=s,this.CourseModel=i,this.scoreProviderHelper=o,this.ultraState=a,this.gradebookPermissionService=r,this.gridData=c,this.row=l,this.column=d,this.data=u,this.loadState=p}get isUnloaded(){return this.loadState===n.UNLOADED}get isWaiting(){return this.loadState===n.WAITING}get isLoading(){return this.loadState===n.LOADING}get isLoaded(){return this.loadState===n.LOADED}get isPosted(){return!c.isNull(this.data)&&this.data.grade.isPosted()}get hasNewSubmission(){return!c.isNull(this.data)&&this.data.needsGradingAttemptCount>0}get isPastDueZero(){return!c.isNull(this.data)&&this.data.grade.isPastDueZero()}setLoadState(e){this.loadState=e}getScore(e){const t=this.getGrade();if(null==t)return;const s=t.displayGrade,n=this.column.data,i=this.getGridData().getSchema()[n.gradingSchemaId],o=this.$injector.instantiate(d.a,{scope:e,gradeDetail:t});return o.init(n,i),o.displayGrade=s,o.parsedValue}getGrade(){return c.isNull(this.data)?void 0:this.data.grade}view(){throw new Error("Unsupported operation exception")}post(){return this.data&&this.column.data.grades.$new(this.data.grade.id).postReadyGrades()}get canBeView(){return!1}get isReadyToPost(){return!this.isPosted}canPost(){return this.gradebookPermissionService.canPostGrades(null,this.column.data)}getGridData(){return this.gridData}get isCleanAttemptGrade(){return!1}get isNeedAutoPost(){return!1}get canBeEdited(){return this.column.data.delegatedGrading?this.canPost():!this.isAnonymousGrading}get isAnonymousGrading(){return this.column.data.anonymousGrading}};g=Object(i.__decorate)([Object(i.__param)(0,Object(b.b)("$q")),Object(i.__param)(1,Object(b.b)("$injector")),Object(i.__param)(2,Object(b.b)(m.b)),Object(i.__param)(3,Object(b.b)(r.m.serviceName)),Object(i.__param)(4,Object(b.b)(p.c)),Object(i.__param)(5,Object(b.b)(l.d)),Object(i.__param)(6,Object(b.b)(o.b)),Object(i.__param)(7,Object(b.b)("gridData")),Object(i.__param)(8,Object(b.b)("row")),Object(i.__param)(9,Object(b.b)("column"))],g);let v=class extends g{constructor(e,t,s,i,o,a,r,c,l,d){super(e,t,s,i,o,a,r,c,l,d,null,n.LOADED),this.$q=e,this.$injector=t,this.ltiService=s,this.CourseModel=i,this.scoreProviderHelper=o,this.ultraState=a,this.gradebookPermissionService=r,this.gridData=c,this.row=l,this.column=d}};v.$inject=[],v=Object(i.__decorate)([Object(i.__param)(0,Object(b.b)("$q")),Object(i.__param)(1,Object(b.b)("$injector")),Object(i.__param)(2,Object(b.b)(m.b)),Object(i.__param)(3,Object(b.b)(r.m.serviceName)),Object(i.__param)(4,Object(b.b)(p.c)),Object(i.__param)(5,Object(b.b)(l.d)),Object(i.__param)(6,Object(b.b)(o.b)),Object(i.__param)(7,Object(b.b)("gridData")),Object(i.__param)(8,Object(b.b)("row")),Object(i.__param)(9,Object(b.b)("column"))],v);class f extends g{}class w extends g{canPost(){return!1}get canBeEdited(){return!1}}class S extends g{}class C extends S{get canBeView(){return this.gradebookPermissionService.canViewGrades()}view(){this.ultraState.goPeekState(h.GradeRoutes.GRADE_AND_FEEDBACK,{columnId:this.column.id,userId:this.row.metadata.user.id})}}class y extends S{getGroupId(){}get canBeView(){return this.gradebookPermissionService.canViewAttempts()&&!!this.data&&this.data.attemptCount>0}view(){var e;if(null!=this.column.data.linkId&&(u.ScoreProviderHandle.PartnerCloud.isEqualTo(this.column.data.scoreProviderHandle)||u.ScoreProviderHandle.LTILink.isEqualTo(this.column.data.scoreProviderHandle)))this.CourseModel.$new(this.gridData.course.id).gradebook.columns.$new(this.column.id).grades.$new(this.data.grade.id).attempts.$fetch().$then((e=>{const t=a.d({gradableItemId:this.column.id,courseId:this.gridData.course.id,attemptId:e[0].id,membershipId:this.row.metadata.id,linkId:this.column.data.linkId});this.ltiService.launch(t)}));else{const t={courseId:this.gridData.course.id,columnId:this.column.id,gradeId:this.data.grade.id,contentId:this.column.data.contentId,userId:this.row.metadata.user.id},s=(null===(e=this.data.grade.attempts)||void 0===e?void 0:e.length)>this.column.data.multipleAttempts;if(!(this.column.data.isAttemptBased&&(this.column.data.isMultipleAttempts()||s)))if(this.data.grade.lastAttemptId)t.attemptId=this.data.grade.lastAttemptId;else if(this.data.grade.attempts&&this.data.grade.attempts.length){const e=c.last(this.data.grade.attempts);t.attemptId=e&&e.id}else if(this.data.grade.groupAttempts&&this.data.grade.groupAttempts.length){const e=c.last(this.data.grade.groupAttempts);t.attemptId=e&&e.id}t.groupId=this.getGroupId(),this.scoreProviderHelper.gradingStateRef(this.column.data,this.data.grade,t,p.a.GoToState)}}}class O extends y{constructor(e,t,s,n,i,o,a,r,c,l,d){super(e,t,s,n,i,o,a,r,c,l),this._group=d}getGroupId(){return this.group.groupId}get group(){return this._group}}O.$inject=["$q","$injector",m.b,r.m.serviceName,p.c,l.d,o.b,"gridData","row","column","group"];let A=class extends O{constructor(e,t,s,n,i,o,a,r,c,l,d){super(e,t,s,n,i,o,a,r,c,l,d),this.$q=e,this.$injector=t,this.ltiService=s,this.CourseModel=n,this.scoreProviderHelper=i,this.ultraState=o,this.gradebookPermissionService=a,this.gridData=r,this.row=c,this.column=l}get canBeView(){return!0}view(){this.ultraState.goPeekState("submission-list",{courseId:this.gridData.course.id,columnId:this.column.id,contentId:this.column.data.contentId,participantId:this.row.metadata.user.id,disGroupId:this.getGroupId()})}get isCleanAttemptGrade(){return!0}get isNeedAutoPost(){return!0}};A.$inject=[],A=Object(i.__decorate)([Object(i.__param)(0,Object(b.b)("$q")),Object(i.__param)(1,Object(b.b)("$injector")),Object(i.__param)(2,Object(b.b)(m.b)),Object(i.__param)(3,Object(b.b)(r.m.serviceName)),Object(i.__param)(4,Object(b.b)(p.c)),Object(i.__param)(5,Object(b.b)(l.d)),Object(i.__param)(6,Object(b.b)(o.b)),Object(i.__param)(7,Object(b.b)("gridData")),Object(i.__param)(8,Object(b.b)("row")),Object(i.__param)(9,Object(b.b)("column")),Object(i.__param)(10,Object(b.b)("group"))],A);class I extends y{get canBeView(){return!0}view(){this.ultraState.goPeekState("submission-list",{courseId:this.gridData.course.id,columnId:this.column.id,contentId:this.column.data.contentId,participantId:this.row.metadata.user.id})}get isCleanAttemptGrade(){return!0}get isNeedAutoPost(){return!0}}class D extends y{get canBeView(){return!0}view(){this.ultraState.goPeekState(h.JournalRoutes.JOURNAL_PARTICIPATION_DETAIL,{courseId:this.gridData.course.id,columnId:this.column.id,contentId:this.column.data.contentId,participantId:this.row.metadata.id,gradebookView:"grid"})}get isCleanAttemptGrade(){return!0}get isNeedAutoPost(){return!0}}class k extends S{get isAttendance(){return!0}get canBeView(){return!0}view(){const e=this.row.metadata.user.id,t=this.row.metadata.id;this.ultraState.goPeekState("attendance-student-records",{userId:e,membershipId:t})}}},C36k:function(e,t,s){"use strict";s("67oV");var n=s("Llzl"),i=s("+4Px"),o=s("e6jQ"),a=s("GbAM"),r=s("lEL+"),c=s("0JpG"),l=s("GwhK");s.d(t,"a",(function(){return d}));const d="ultra.components.directives.typeahead-search-box";class u{constructor(e,t,s,n,i){this.scope=e,this.$rootScope=t,this.element=s,this.timeout=n,this.bbLocalize=i,this.showResults=!1,this.searchValue="",this.isFocus=!1,this.srLabel=e.srLabel,this.inputPlaceholder=e.inputPlaceholder||"",this.srEmptyResults=e.srEmptyResults||"",this.srResultsFound=e.srResultsFound,this.srNoResultsFound=e.srNoResultsFound,this.clearAriaLabel=e.clearAriaLabel,this.icon=e.icon,this.randomElementId=this.scope.randomElementId||o.a(),this.srResultsFound&&this.srNoResultsFound&&this.clearAriaLabel||this.bbLocalize.loadBundle("components/directives/typeahead").then((()=>{this.srResultsFound="typeahead.resultsFound",this.srNoResultsFound="typeahead.noResultsFound",this.clearAriaLabel="typeahead.clear"})),e.$on("typeahead-search-box-clear",(function(){e.typeaheadSearchBox.showResults=!1,e.typeaheadSearchBox.searchResults=[],e.typeaheadSearchBox.searchValue=""}))}onSearchValueChange(){this.searchValue.length>0?this.typeAheadSearch(this.searchValue):this.clear()}itemSelected(e){const t=this.scope.itemSelected({item:e});this.showResults=!1,this.searchResults=[],n.isString(t)?this.searchValue=t:this.searchValue="",this.element.find("input").focus()}search(e){if(this.searchValue.length>0){const t=this.scope.search({searchText:e});t&&(this.showResults=!1,this.searchResults=[],n.isString(t)?this.searchValue=t:this.searchValue="")}}typeAheadSearch(e){this.scope.typeAheadSearch({searchText:e}).then((e=>{this.searchResults=e,this.showResults=e.length>0,this.getSearchResultsAlert(this.showResults)}))}getSearchResultsAlert(e){const t=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:e?this.srResultsFound:this.srNoResultsFound,noWrap:!0,noEscape:!0});this.timeout((()=>{this.$rootScope.$broadcast(a.b,t)}),this.scope,1e3)}handleUpAndDownArrow(e){this.showResults||(this.showResults=!0);let t=n.element(e.target);t.hasClass("typeahead-search-entry")?(t=e.keyCode===i.d?t.next():t.prev(),t.focus()):this.element.find(".typeahead-search-entry:first").focus(),e.preventDefault()}onInputBoxKeyDown(e){e.keyCode===i.f?this.search(this.searchValue):e.keyCode===i.d||e.keyCode===i.v?this.handleUpAndDownArrow(e):e.keyCode===i.g&&this.showResults&&(this.showResults=!1,e.stopPropagation(),e.preventDefault())}onFocusInputBox(e){this.searchResults&&this.searchResults.length>0&&(this.showResults=!0)}onFocusClearBtn(e){this.isFocus=!0}onBlurClearBtn(e){document.activeElement!==e.currentTarget&&(this.showResults=!1,this.isFocus=!1)}onClickOutside(){this.showResults=!1}onInputBoxClick(){this.showResults=!0}onResultEntryKeyDown(e,t){e.keyCode===i.f||e.keyCode===i.t?this.itemSelected(t):e.keyCode===i.d||e.keyCode===i.v?this.handleUpAndDownArrow(e):e.keyCode===i.u?this.showResults=!1:e.keyCode===i.g&&(this.showResults=!1,this.element.find("input").focus(),e.stopPropagation(),e.preventDefault())}onResultEntryClick(e,t){this.itemSelected(t)}clear(){const e=this.searchValue;this.showResults=!1,this.searchResults=[],this.searchValue="",this.timeout((()=>{(this.scope.clearSearch||n.noop)({searchText:e})}),this.scope,50)}}u.$inject=["scope","$rootScope","element",r.b,c.serviceName];class p{constructor(e,t){this.$interpolate=e,this.$injector=t,this.restrict="E",this.template=l,this.scope={itemSelected:"&",search:"&",typeAheadSearch:"&",inputPlaceholder:"@?",clearSearch:"&",srEmptyResults:"@",srLabel:"@",srResultsFound:"@?",srNoResultsFound:"@?",clearAriaLabel:"@?",icon:"@?",randomElementId:"@?"},this.transclude=!0,this.replace=!0,this.link=(e,t)=>{e.typeaheadSearchBox=this.$injector.instantiate(u,{scope:e,element:t})}}}p.$inject=["$interpolate","$injector"],n.module(d,[]).directive("bbTypeaheadSearchBox",["$injector",e=>e.instantiate(p)]).directive("typeaheadInject",(()=>({link(e,t,s,n,i){if(i){const s=e.$new();i(s,(function(e){t.empty(),t.append(e),t.on("$destroy",(function(){s.$destroy()}))}))}}})))},CG4K:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-custom-toggle-grid",use:"icon-custom-toggle-grid-usage",viewBox:"0 0 12 12",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="icon-custom-toggle-grid"><path fill="none" stroke-width="2" stroke-miterlimit="10" d="M0 1h12M0 6h12M0 11h12M1 12V0M6 12V0M11 12V0" /></symbol>'});i.add(o);e.exports=o},CME4:function(e,t){e.exports='<div class="assessment-question" ng-class="\'js-question-type-\' + assessmentQuestion.getType()">\n  <form name="questionForm"\n        bb-autosave\n        save-func="assessmentQuestion.persist()"\n        validation-func="assessmentQuestion.validate()"\n        auto-save-context-id="{{::questionAttempt.id}}"\n        auto-save-context-area="{{::assessmentQuestion.autoSaveContextArea}}"\n        delay-autosave="assessmentQuestion.suppressAutosave"\n        use-leading-edge="true"\n        use-save-numbers="true"\n        novalidate>\n    <fieldset role="presentation">\n      <div class="question-header"\n           ng-class="{\'has-question-title\': assessmentQuestion.questionConfig.hasQuestionCountTitle, \'is-read-only\': !isPrivileged() || readOnly()}"\n           ng-if="assessmentQuestion.questionConfig.hasPoints || assessmentQuestion.questionConfig.hasQuestionCountTitle">\n        <legend\n          class="question-label"\n          ng-if="assessmentQuestion.questionConfig.hasQuestionCountTitle"\n          bb-translate="components.directives.assessment-question.question-title"\n          translate-values="{index: questionAttempt.visibleQuestionNumber}"\n          role="presentation"\n        ></legend>\n\n        \x3c!--Question goal --\x3e\n        <a ng-if="assessmentQuestion.questionConfig.hasQuestionCountTitle && assessmentQuestion.hasGoals()" href="javascript:void(0);"\n           ng-click="assessmentQuestion.openQuestionGoals()"\n           class="question-goal"\n           bb-translate-attrs="{\'aria-label\':\'components.directives.assessment-question.view-goal\', \'title\':\'components.directives.assessment-question.view-goal\'}"\n           analytics-id="components.directives.assessment-question.view-goal.link">\n          <bb-svg-icon size="medium" icon="goal"></bb-svg-icon>\n        </a>\n\n        <div class="point-value" ng-if="assessmentQuestion.questionConfig.hasPoints" bb-translate="components.directives.assessment-question.number-of-points.plural" translate-values="{numberOfPoints: questionAttempt.question.points}"></div>\n      </div>\n\n      <div class="question-content"></div>\n    </fieldset>\n  </form>\n</div>\n'},CuGX:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-class-pulse-future",use:"icon-small-class-pulse-future-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-class-pulse-future"><path d="M9 14c0 .5523-.4477 1-1 1s-1-.4477-1-1 .4477-1 1-1 1 .4477 1 1zM11 6.5a.5.5 0 11-1 0 .5.5 0 011 0zM5.5 9.5a.5.5 0 11-1 0 .5.5 0 011 0z" stroke-width="2" /><path d="M15 11l-4.5-4.5-5.5 3-4-2.357" stroke-width="2" /><path d="M9 2c0 .5523-.4477 1-1 1s-1-.4477-1-1 .4477-1 1-1 1 .4477 1 1z" stroke-width="2" /><path d="M15 2H1v12h14V2z" stroke-width="2" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},D1Wg:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-calendar",use:"icon-medium-calendar-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-calendar"><path d="M4 3H1v20h22V3h-3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M4 1h5v4H4zM15 1h5v4h-5z" /><path d="M1 9h22" stroke-width="2" /><path d="M5 14v-1h2v1H5zM11 14v-1h2v1h-2zM17 14v-1h2v1h-2zM5 19v-1h2v1H5zM11 19v-1h2v1h-2zM17 19v-1h2v1h-2zM9 3h6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},D57O:function(e,t){e.exports='<div class="peer-feedback-by-student">\n  <div class="spinner bb-secondary-color-2" ng-if="$ctrl.isLoading" aria-hidden="true"></div>\n  <div ng-if="!$ctrl.isLoading">\n    <bb-feedback-list\n      secondary-graders-feedback="$ctrl.feedbackListPayload.secondaryGradersFeedback"\n      config-props="$ctrl.feedbackListPayload.configProps"\n    />\n  </div>\n</div>\n'},"D8d/":function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return u}));var n=s("Llzl"),i=s("0JpG"),o=s("A+IJ"),a=s("2a+M"),r=s("pjml"),c=s("lEL+"),l=s("GbAM"),d=s("W6wm");const u="ultra.components.directives.bbDropHandler";class p{constructor(e,t,s,n,i,o,r,c){this.scope=e,this.element=t,this.$rootScope=n,this.$q=i,this.timeout=o,this.dragDropService=r,this.bbLocalizeService=c,this.isDraggingOverFolder=!1,this.isEmptyTarget="emptyTarget"in s,this.dropTargetElement=t.closest(this.dragDropService.dragElementSelector),e.$on("bb-drag-move",(()=>{if(this.isEnabledForReordering()&&this.isNotSameDropTarget()&&this.isOnSamePanel()){const e=t.offset(),s=t.height()+e.top,n=t.width()+e.left;this.dragDropService.pointerPosition.left>=e.left&&this.dragDropService.pointerPosition.left<=n&&this.dragDropService.pointerPosition.top>=e.top&&this.dragDropService.pointerPosition.top<=s?this.dragOverFunc(this.dragDropService.pointerPosition.top):this.dragLeaveFunc()}})),e.$on("bb-drag-end",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&this.isOnSamePanel()&&this.dropHandlerFunc()})),t.on("drop",(t=>{t.originalEvent.dataTransfer.files&&t.originalEvent.dataTransfer.files.length>0&&e.onFileDropHandler&&e.onFileDropHandler()(t.originalEvent.dataTransfer.files,e.content())})),e.$on("bb-drag-cancel",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&this.isOnSamePanel()&&(e.content().id===this.dragDropService.currentDragId&&(this.dragDropService.positionBefore=e.content().id),this.dropHandlerFunc())})),e.$on("keyboard-drag-start",(()=>{this.isEnabledForReordering()&&e.content().id===this.dragDropService.currentDragId&&(this.dragPosition=a.b.Self,this.dragDropService.originalElement=t.closest(this.dragDropService.dragElementSelector),this.dragDropService.currentDragElement=this.dragDropService.originalElement.clone(),this.dragDropService.originalElement.addClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.addClass(this.dragDropService.movableElementClass),this.dragDropService.originalElement.addClass(this.dragDropService.dragHoverClass),this.dragDropService.setDropTarget(e.content().id))})),e.$on("keyboard-drag-end",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&this.isOnSamePanel()&&this.timeout((()=>{this.dragDropService.originalElement&&this.dragDropService.originalElement.removeClass(this.dragDropService.originalElementClass),a.b.Folder===this.dragPosition?this.dragDropService.positionAfter=e.content().id:a.b.Top===this.dragPosition?(this.dragDropService.positionBefore=e.content().id,this.dragDropService.positionAfter=null):(this.dragDropService.positionAfter=e.content().id,this.dragDropService.positionBefore=null),this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.currentDragElement&&this.dragDropService.currentDragElement.remove(),this.isDropPreventedByContentDepthRules().then((t=>{if(!this.isDnDPreventedInDiscussionContext()&&!t&&!this._isDroppingInSamePlace()){const t={dragContentId:this.dragDropService.currentDragId,dragElement:this.dragDropService.currentDragElement,parentFolderId:this.scope.content().parentId,positionAfterId:this.dragDropService.positionAfter,positionBeforeId:this.dragDropService.positionBefore,rootScope:this.$rootScope,targetFolderId:this.scope.content().id};e.onMoveHandler()(t)}this._keyboardEndDragAndClearValues()}))}),e)})),e.$on("keyboard-drag-cancel",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&(this._keyboardEndDragAndClearValues(),this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.originalElement.removeClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.remove())})),e.$on("keyboard-drag-up",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&(this._removeKeyboardPlaceholderAndStyling(),this.isEmptyTarget&&(this.dragPosition=a.b.Top),a.b.Self===this.dragPosition||a.b.Top===this.dragPosition?e.previousContentId&&e.previousContentId()?this.keyboardMoveUpToItem(e.previousContentId()):e.content().depth>1?(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-leave-folder",noWrap:!0}),this.keyboardMoveOntoFolder(e.content().parentId)):(this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):a.b.Folder===this.dragPosition?this._keyboardMoveAboveThisItem():a.b.Bottom===this.dragPosition&&this.isDropPreventedByContentDepthRules().then((t=>{this.isAFolder()?!0!==e.isFolderOpen()||!this.isNotSameDropTarget()||this.isDnDPreventedInDiscussionContext()||t?!1!==e.isFolderOpen()||!this.isNotSameDropTarget()||this.isDnDPreventedInDiscussionContext()||t||this.keyboardMoveOntoFolder(this.scope.content().id):(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-enter-folder",noWrap:!0}),this.keyboardMoveIntoFolderAsLastItem()):this._keyboardMoveAboveThisItem()})))})),e.$on("keyboard-drag-down",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&(this._removeKeyboardPlaceholderAndStyling(),this.isEmptyTarget&&(this.dragPosition=a.b.Bottom),a.b.Self===this.dragPosition||a.b.Bottom===this.dragPosition?e.nextContentId&&e.nextContentId()?this.keyboardMoveDownToItem(e.nextContentId()):e.content().depth>1?(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-leave-folder",noWrap:!0}),this.keyboardMoveBelowItem(e.content().parentId)):(this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):a.b.Folder===this.dragPosition?this.isDropPreventedByContentDepthRules().then((t=>{e.isFolderOpen&&!0===e.isFolderOpen()&&this.isNotSameDropTarget()&&!this.isDnDPreventedInDiscussionContext()&&!t?(this.dragDropService.queuedScreenReaderMessages+=" ",this.dragDropService.queuedScreenReaderMessages+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-enter-folder",noWrap:!0}),this.keyboardMoveIntoFolderAsFirstItem()):this._keyboardMoveBelowThisItem()})):a.b.Top===this.dragPosition&&this.isDropPreventedByContentDepthRules().then((e=>{this.isAFolder()&&this.isNotSameDropTarget()&&!this.isDnDPreventedInDiscussionContext()&&!e?this.keyboardMoveOntoFolder(this.scope.content().id):this._keyboardMoveBelowThisItem()})))})),e.$on("keyboard-drag-right",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&a.b.Folder===this.dragPosition&&e.isFolderOpen&&!1===e.isFolderOpen()&&e.$emit("toggle-folder-by-id",e.content().id)})),e.$on("keyboard-drag-left",(()=>{this.isEnabledForReordering()&&this.dragDropService.isCurrentDropTarget(e.content().id)&&a.b.Folder===this.dragPosition&&e.isFolderOpen&&!0===e.isFolderOpen()&&e.$emit("toggle-folder-by-id",e.content().id)})),e.$on("keyboard-move-up-to-item",((t,s)=>{this.isEnabledForReordering()&&e.content().id===s&&(this.dragDropService.setDropTarget(e.content().id),e.content().id===this.dragDropService.currentDragId?(this.dragPosition=a.b.Self,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):this.isAFolder()?this.scope.isFolderOpen&&!0===this.scope.isFolderOpen()?this.keyboardMoveIntoFolderAsLastItem():(this.dragPosition=a.b.Folder,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):this._keyboardMoveAboveThisItem())})),e.$on("keyboard-move-down-to-item",((t,s)=>{this.isEnabledForReordering()&&e.content().id===s&&(this.dragDropService.setDropTarget(e.content().id),e.content().id===this.dragDropService.currentDragId?(this.dragPosition=a.b.Self,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation()):this.isAFolder()?this.keyboardMoveOntoFolder(this.scope.content().id):this._keyboardMoveBelowThisItem())})),e.$on("keyboard-move-above-item",((t,s)=>{this.isEnabledForReordering()&&e.content().id===s&&(this.dragDropService.setDropTarget(e.content().id),this._keyboardMoveAboveThisItem())})),e.$on("keyboard-move-below-item",((t,s)=>{this.isEnabledForReordering()&&e.content().id===s&&(this.dragDropService.setDropTarget(e.content().id),this._keyboardMoveBelowThisItem())})),e.$on("keyboard-move-onto-folder",((t,s)=>{this.isEnabledForReordering()&&e.content().id===s&&(this.dragDropService.setDropTarget(e.content().id),this.dragPosition=a.b.Folder,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation())})),e.$on("remove-placeholder",(()=>{this.isEnabledForReordering()&&this.dragDropService.dropPlaceholderElement&&this.dragDropService.dropPlaceholderElement.remove(),this.isEmptyTarget&&this.element.children("bb-add-content-button").show()}))}_keyboardMoveBelowThisItem(){this.scope.content().id===this.dragDropService.currentDragId?this.keyboardMoveDownToItem(this.scope.content().id):this.scope.nextContentId&&this.scope.nextContentId()===this.dragDropService.currentDragId?this.keyboardMoveDownToItem(this.scope.nextContentId()):(this.dragPosition=a.b.Bottom,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation())}_keyboardMoveAboveThisItem(){this.scope.content().id===this.dragDropService.currentDragId?this.keyboardMoveUpToItem(this.scope.content().id):this.scope.previousContentId&&this.scope.previousContentId()===this.dragDropService.currentDragId?this.keyboardMoveUpToItem(this.scope.previousContentId()):(this.dragPosition=a.b.Top,this._applyKeyboardPlaceholderAndStyling(),this._informScreenReaderOfNewLocation())}_informScreenReaderOfNewLocation(){const e=this.element.find("[bb-drag-handle]").eq(0).attr("drag-item-name");let t="";if(""!==this.dragDropService.queuedScreenReaderMessages&&(t+=this.dragDropService.queuedScreenReaderMessages,t+=" "),-1!==this.dragDropService.currentDropTargetId.indexOf("blank"))return t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-only-item-in-folder",noWrap:!0}),this.$rootScope.$broadcast(l.a,t),void(this.dragDropService.queuedScreenReaderMessages="");this.scope.previousContentId&&this.scope.previousContentId()||a.b.Top!==this.dragPosition&&a.b.Self!==this.dragPosition?this.scope.nextContentId&&this.scope.nextContentId()||a.b.Bottom!==this.dragPosition&&a.b.Self!==this.dragPosition||(t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-end-of-list",noWrap:!0}),t+=" "):(t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-top-of-list",noWrap:!0}),t+=" "),a.b.Self===this.dragPosition?t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-self",noWrap:!0}):a.b.Folder===this.dragPosition?t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-folder",params:{itemName:e},noWrap:!0}):a.b.Top===this.dragPosition?t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-above",params:{itemName:e},noWrap:!0}):a.b.Bottom===this.dragPosition&&(t+=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:"components.services.drag-drop.aria.reorder-moved-below",params:{itemName:e},noWrap:!0})),this.$rootScope.$broadcast(l.a,t),this.dragDropService.queuedScreenReaderMessages=""}_applyKeyboardPlaceholderAndStyling(){let e=this.dropTargetElement;a.b.Self===this.dragPosition?this.dropTargetElement.addClass(this.dragDropService.dragHoverClass):a.b.Folder===this.dragPosition?(this.dropTargetElement.before(this.dragDropService.currentDragElement),this.dragDropService.currentDragElement&&(1===this.scope.content().depth?this.dragDropService.currentDragElement.addClass(this.dragDropService.onFolderClass):2===this.scope.content().depth&&this.dragDropService.currentDragElement.addClass(this.dragDropService.onNestedFolderClass))):a.b.Bottom===this.dragPosition?(e=this.dragDropService.currentDragElement,this.dropTargetElement.after(this.dragDropService.currentDragElement)):a.b.Top===this.dragPosition&&(e=this.dragDropService.currentDragElement,this.dropTargetElement.before(this.dragDropService.currentDragElement)),this._scrollContainer(e)}_removeKeyboardPlaceholderAndStyling(){this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.currentDragElement&&(this.dragDropService.currentDragElement.removeClass(this.dragDropService.onFolderClass),this.dragDropService.currentDragElement.removeClass(this.dragDropService.onNestedFolderClass),this.dragDropService.currentDragElement.remove())}_scrollContainer(e){this.dragDropService.scrollDragDropItemsContainer(e.offset().top,a.a.SCROLLING_CONSTANTS.keyboardInteractionDistanceToScroll)}_keyboardEndDragAndClearValues(){this.timeout((()=>{e('[bb-drag-handle][drag-item-id="'+this.dragDropService.currentDragId+'"]').focus(),this.dragDropService.clearDropTarget(),this.dragDropService.currentDragId=void 0,this.dragDropService.currentDragType=void 0,this.dragDropService.isKeyboardDragging=!1}),this.scope,0,!1)}isDropPreventedByContentDepthRules(){const e=()=>r.p.ContentHandler.Folder.isEqualTo(this.dragDropService.currentDragType);if(void 0!==this.dragDropService.currentDragHasFolderChild)return this.dragDropService.currentDragHasFolderChild.then((t=>e()&&(this.isDraggingOverFolder&&this.scope.content().depth===o.l||this.scope.content().depth>o.l||this.isDraggingOverFolder&&t)));const t=this.$q.defer();return t.resolve(!1),t.promise}isDnDPreventedInDiscussionContext(){return(()=>d.a.Discussions===this.dragDropService.currentDragContext)()&&(()=>r.p.ContentHandler.Folder.isEqualTo(this.dragDropService.currentDragType))()&&(this.isDraggingOverFolder&&this.scope.content().depth===o.k||this.scope.content().depth>o.k)}dragOverFunc(e){if(this.dragDropService.currentDragId&&this.dragDropService.currentDragId!==this.scope.content().id){this.dragDropService.setDropTarget(this.scope.content().id),!this.folderHoverTimeout&&this.scope.isFolderOpen&&!1===this.scope.isFolderOpen()&&(this.dropTargetElement.addClass(this.dragDropService.dragHoverClass),this.folderHoverTimeout=this.timeout((()=>{this.isDropPreventedByContentDepthRules().then((e=>{e||this.isDnDPreventedInDiscussionContext()?(this.dragDropService.isShowingDepthMessage=!0,this.$rootScope.$broadcast("show-override-message",this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(this.scope),key:this.dragDropService.folderDepthMessageKey}),this.scope.content().id)):(this.scope.$emit("toggle-folder-by-id",this.scope.content().id),this.wasFolderOpened=!0)}))}),this.scope,1500)),this.dragDropService.isShowingDepthMessage&&this.dragDropService.isNotSameDropTarget()&&(this.dragDropService.isShowingDepthMessage=!1,this.broadcastShowOverrideMessage());const t=e,s=this.element.offset().top+this.element.height()/2,n=this.dragPosition;this.isAFolder()&&(this.isDraggingOverFolder=!0),this.scope.content().id.indexOf("placeholder")>-1?(this.dragDropService.positionAfter=this.scope.content().parentId,this.dragDropService.positionBefore=void 0,this.dragPosition=a.b.Bottom):t<=s?(this.dragDropService.positionBefore=this.scope.content().id,this.dragDropService.positionAfter=void 0,this.dragPosition=a.b.Top):(this.dragDropService.positionAfter=this.scope.content().id,this.dragDropService.positionBefore=void 0,this.dragPosition=a.b.Bottom),(this.dragDropService.isNotSameDropTarget()||this.dragPosition!==n)&&(this._moveDropPlaceholderElement(),this.isEmptyTarget&&this.element.children().hide())}}_moveDropPlaceholderElement(){if(this.$rootScope.$broadcast("remove-placeholder"),this.dragDropService.currentDragId===this.dragDropService.currentDropTargetId)return;(()=>this.dragDropService.positionBefore&&this.dragDropService.currentDropTargetId!==this.dragDropService.idOfNextItem)()?this.dropTargetElement.before(this.dragDropService.dropPlaceholderElement):(()=>!(this.dragDropService.currentDropTargetId.indexOf("placeholder")>-1&&this.dragDropService.idOfNextItem===this.dragDropService.currentDropTargetId)&&(this.dragDropService.positionAfter&&this.dragDropService.currentDropTargetId!==this.dragDropService.idOfPreviousItem))()&&this.dropTargetElement.after(this.dragDropService.dropPlaceholderElement)}_isDroppingInSamePlace(){if(null!=this.dragDropService.positionAfter&&this.scope.previousContentId&&this.dragDropService.positionAfter===this.scope.previousContentId()||this.dragDropService.positionAfter===this.dragDropService.currentDragId||null!=this.dragDropService.positionBefore&&this.scope.nextContentId&&this.dragDropService.positionBefore===this.scope.nextContentId()||this.dragDropService.positionBefore===this.dragDropService.currentDragId)return!0}dropHandlerFunc(){this.timeout.cancel(this.folderHoverTimeout),this.dropTargetElement.parents("[data-parent-id]").last().removeAttr("style"),this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("remove-placeholder"),this.$rootScope.$broadcast("file-drag-restore"),this.dragDropService.isShowingDepthMessage&&(this.dragDropService.isShowingDepthMessage=!1,this.broadcastShowOverrideMessage());const e={dragContentId:this.dragDropService.currentDragId,originalElement:this.dragDropService.originalElement,parentFolderId:this.scope.content().parentId,positionAfterId:this.dragDropService.positionAfter,positionBeforeId:this.dragDropService.positionBefore,rootScope:this.$rootScope,targetFolderId:this.scope.content().id};this.isDropPreventedByContentDepthRules().then((t=>{this._isDroppingInSamePlace()||this.isDnDPreventedInDiscussionContext()?this.dropCleanupFunc():!t&&this.isDraggingOverFolder?this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?(this.scope.onMoveIntoFolderHandler()(e),this.dropCleanupFunc()):this.scope.$apply((()=>{this.scope.onMoveIntoFolderHandler()(e),this.dropCleanupFunc()})):t?this.dropCleanupFunc():this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?(this.scope.onMoveHandler()(e),this.dropCleanupFunc()):this.scope.$apply((()=>{this.scope.onMoveHandler()(e),this.dropCleanupFunc()})),this.isDraggingOverFolder=!1}))}dropCleanupFunc(){this.wasFolderOpened&&(this.wasFolderOpened=!1,this.scope.$emit("toggle-folder-by-id",this.scope.content().id)),this.dragDropService.currentDragId=void 0,this.dragDropService.currentDragType=void 0,this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.dragDropService.currentDragElement&&this.dragDropService.currentDragElement.remove()}dragLeaveFunc(){this.isDraggingOverFolder=!1,this.dropTargetElement.removeClass(this.dragDropService.dragHoverClass),this.timeout.cancel(this.folderHoverTimeout),this.folderHoverTimeout=void 0,this.isDropPreventedByContentDepthRules().then((e=>{e&&(this.dragDropService.isShowingDepthMessage=!1,this.broadcastShowOverrideMessage())}))}broadcastShowOverrideMessage(){this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?this.$rootScope.$broadcast("show-override-message",void 0,this.scope.content().id):this.scope.$apply((()=>this.$rootScope.$broadcast("show-override-message",void 0,this.scope.content().id)))}keyboardMoveUpToItem(e){this.timeout((()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-up-to-item",e)}),this.scope)}keyboardMoveDownToItem(e){this.timeout((()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-down-to-item",e)}),this.scope)}keyboardMoveBelowItem(e){this.timeout((()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-below-item",e)}),this.scope)}keyboardMoveAboveItem(e){this.timeout((()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-above-item",e)}),this.scope)}keyboardMoveOntoFolder(e){this.timeout((()=>{this.dragDropService.clearDropTarget(),this.$rootScope.$broadcast("keyboard-move-onto-folder",e)}),this.scope)}keyboardMoveIntoFolderAsLastItem(){const e=this.scope.content().children;e.length>0?this.keyboardMoveBelowItem(e[e.length-1].id):this.keyboardMoveBelowItem(this.scope.content().id+"blank")}keyboardMoveIntoFolderAsFirstItem(){const e=this.scope.content().children;e.length>0?this.keyboardMoveAboveItem(e[0].id):this.keyboardMoveAboveItem(this.scope.content().id+"blank")}isNotSameDropTarget(){return this.scope.content().id!==this.dragDropService.currentDragId}isOnSamePanel(){return this.element.closest(".panel-content").is(this.dragDropService.originalElement.closest(".panel-content"))}isEnabledForReordering(){return!(this.scope.disableForReordering&&this.scope.disableForReordering())}isAFolder(){return null!=this.scope.isFolderOpen}}p.$inject=["scope","element","attrs","$rootScope","$q",c.b,a.d,i.serviceName];class m{constructor(e){this.$injector=e,this.scope={onMoveIntoFolderHandler:"&?",onMoveHandler:"&",onFileDropHandler:"&",isFolderOpen:"&?",content:"&",previousContentId:"&?",nextContentId:"&?",disableForReordering:"&?"},this.restrict="A",this.link=(e,t,s)=>{e.dropHandlerDirective=this.$injector.instantiate(p,{scope:e,element:t,attrs:s})}}}m.$inject=["$injector"],n.module(u,[a.c,c.a]).directive("bbDropHandler",["$injector",e=>e.instantiate(m)])}).call(this,s("71td"))},DAbe:function(e,t){e.exports="<div ng-transclude></div>"},DDBr:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("Llzl"),i=s("0JpG"),o=s("kwLz"),a=s("1ZbL");const r="ultra.components.directives.feedback.feedbackList",c={Class:o.FeedbackList,bindingNames:["analyticsId","configProps","secondaryGradersFeedback"],renderLocalized:!0};n.module(r,[i.moduleName]).component("bbFeedbackList",Object(a.a)(c))},DMV0:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="components.directives.cloudStorageIntegration.modal.errorTitle"\n          analytics-id-tag-prefix="components.directives.cloudStorageIntegration">\n  <div name="modal-contents">\n    <p bb-translate>components.directives.cloudStorageIntegration.modal.errorFull</p>\n  </div>\n  <button name="modal-footer-button-primary" class="button dismiss-button js-primary-button" ng-click="$parent.$dismiss()" analytics-id="components.directives.cloudStorageIntegration.modal.cancelUploadText">\n    <bb-translate>components.directives.cloudStorageIntegration.modal.cancelUploadText</bb-translate>\n  </button>\n</bb-modal>\n'},DXZ4:function(e,t,s){},DYK3:function(e,t,s){"use strict";var n=s("D57K"),i=(s("sZYy"),s("ykC+"),s("71td")),o=s("nsO7"),a=s("e0uO"),r=s("+sRu"),c=s("IaSh"),l=s.n(c),d=s("vYaK"),u=s("RNuw"),p=s("X/qj"),m=s("yC9S"),h=s("0JpG"),b=s("e6jQ"),g=s("lEL+"),v=s("TnpK"),f=s("Qbdf"),w=s("Fvsw"),S=s("Ed3w"),C=s("cs5G"),y=s("ohO4"),O=s("jx5I"),A=s("7O4Y"),I=s("5MwF"),D=s("AoSC"),k=s("X8JP"),_=s("vhkR"),j=s("aHpC"),T=s("Q/M7"),$=s("bd9L"),R=s("AuQm"),E=s("IbyE"),x=s("zGdY"),P=s("3Nzc"),L=s("Y/dt"),G=s("CME4"),M=s("y0xW"),N=s("5XZZ"),F=s("+O05");s.d(t,"c",(function(){return B})),s.d(t,"b",(function(){return q})),s.d(t,"i",(function(){return z})),s.d(t,"d",(function(){return U})),s.d(t,"a",(function(){return V})),s.d(t,"h",(function(){return K})),s.d(t,"e",(function(){return W})),s.d(t,"f",(function(){return J})),s.d(t,"g",(function(){return Y}));const B="question-attempt_exit-question-regrading-editing-mode",q="question-attempt_close-other-editing-question",z="question-attempt_save-or-cancel-regrading-question";var U;!function(e){e.CANCEL="cancel",e.SAVE="save",e.SAVE_WITHOUT_REGRADING="save-without-regrading"}(U||(U={}));class V{constructor(e){this.$injector=e}createQuestion(e,t,s){return{title:e,questionText:{},points:10,positionBefore:t.positionBefore,positionAfter:t.positionAfter}}getHandlerByMode(e,t,s){switch(e.mode().toString()){case a.a.QuestionReview.toString():return this.getQuestionReviewHandler(e,t,s);case a.a.AttemptAuthoring.toString():return this.getAttemptAuthoringHandler(e,t,s);case a.a.AttemptGrading.toString():return this.getAttemptGradingHandler(e,t,s);case a.a.AttemptReview.toString():return this.getAttemptReviewHandler(e,t,s);default:throw new Error("Invalid mode provided")}}getQuestionReviewHandler(e,t,s){throw new Error("This is an abstract method. It must be implemented in the subclass!")}getAttemptAuthoringHandler(e,t,s){throw new Error("This is an abstract method. It must be implemented in the subclass!")}getAttemptGradingHandler(e,t,s){throw new Error("This is an abstract method. It must be implemented in the subclass!")}getAttemptReviewHandler(e,t,s){throw new Error("This is an abstract method. It must be implemented in the subclass!")}}V.$inject=["$injector"];let H=class{constructor(e,t,s,n,i,o,a,r,c){var l;this.$compile=e,this.$window=t,this.attrs=s,this.element=n,this.gradebookPermissionService=i,this.scope=o,this.timeout=a,this.localizeService=r,this.settingsDefault=c,this.canEnterGrades=!1,this.canViewGrades=!1,this.elementId="assessment-question_"+b.a(),this.formName=this.elementId+"_form",this.questionConfig={hasPoints:!0,hasQuestionCountTitle:!0,points:10,showQuestionControls:!0},this.questionSpecificTemplateReady=!1,this.canEnterGrades=this.gradebookPermissionService.canEnterGrades(),this.canViewGrades=this.gradebookPermissionService.canViewGrades(),c&&(this.questionConfig=c),this.questionAttempt=null===(l=this.scope.gradedQuestionAttempt)||void 0===l?void 0:l.questionAttempt,m.b.OnWindow("drop.document dragover.document",(e=>{e.preventDefault()}),o)}insertQuestionSpecificTemplate(e){this.timeout((()=>{const t=i(e),s=this.element.find(".question-container");s.length>0?t.insertAfter(s):this.element.find(".question-content").prepend(t),this.$compile(t)(this.scope),this.questionSpecificTemplateReady=!0}),this.scope,0,!1)}};H.$inject=[],H=Object(n.__decorate)([Object(n.__param)(0,Object(j.b)("$compile")),Object(n.__param)(1,Object(j.b)("$window")),Object(n.__param)(2,Object(j.b)("attrs")),Object(n.__param)(3,Object(j.b)("element")),Object(n.__param)(4,Object(j.b)(p.b)),Object(n.__param)(5,Object(j.b)("scope")),Object(n.__param)(6,Object(j.b)(g.b)),Object(n.__param)(7,Object(j.b)(h.serviceName))],H);let Q=class extends H{constructor(e,t,s,n,i,o,a,r,c){var l;super(e,t,s,n,i,o,a,r,c),this.$compile=e,this.$window=t,this.attrs=s,this.element=n,this.gradebookPermissionService=i,this.scope=o,this.timeout=a,this.localizeService=r,this.settingsDefault=c,this.attempt=this.scope.attempt,this.toolAttemptDetailItem=null===(l=this.attempt)||void 0===l?void 0:l.getToolAttemptDetailItemEx(E.ScoreProviderHandle.Test)}getAnswerResult(){return this.isFullCredit()?c.QuestionAnswerResult.FullCredit:this.isCorrect()?c.QuestionAnswerResult.Correct:this.isPartiallyCorrect()?c.QuestionAnswerResult.Partial:c.QuestionAnswerResult.Incorrect}getAnswerStyles(e,t,s){return Object(A.default)({[r.a.IsSelected]:e,[r.a.AnswerNotSelected]:!e&&!t,[r.a.CorrectAnswerSelected]:s&&e&&t,[r.a.CorrectAnswerNotSelected]:s&&!e&&t,[r.a.IncorrectAnswerSelected]:s&&e&&!t})}getAutomatedQuestionFeedback(){var e,t;return null===(t=null===(e=this.questionAttempt)||void 0===e?void 0:e.automatedFeedback)||void 0===t?void 0:t.rawText}getCorrectnessColor(){return this.isCorrect()&&(this.isFullCredit()||this.isCorrectByModifiedGrade())?"correct":this.isPartialCreditbyModifiedGrade()?"partial":"incorrect"}isCorrectByModifiedGrade(){return this.scope.gradedQuestionAttempt.points>=this.questionAttempt.question.points}isPartialCreditbyModifiedGrade(){return this.scope.gradedQuestionAttempt.points>0&&this.scope.gradedQuestionAttempt.points<this.questionAttempt.question.points}getCorrectnessIcon(){return this.isCorrect()&&(this.isFullCredit()||this.isCorrectByModifiedGrade())?"check-circle":this.isPartialCreditbyModifiedGrade()?"partial-credit":"close-circle"}getCorrectnessName(){return this.isCorrect()&&(this.isFullCredit()||this.isCorrectByModifiedGrade())?this.localizeService.translateSync({key:"components.directives.assessment-question.status.correct",locale:this.localizeService.getLocale(this.scope)}):this.isPartialCreditbyModifiedGrade()?this.localizeService.translateSync({key:"components.directives.assessment-question.status.partial",locale:this.localizeService.getLocale(this.scope)}):this.localizeService.translateSync({key:"components.directives.assessment-question.status.incorrect",locale:this.localizeService.getLocale(this.scope)})}isCorrect(){return this.questionAttempt.correct}wasAnsweredLate(){var e;return!(!(null===(e=this.toolAttemptDetailItem)||void 0===e?void 0:e.needAttention())||!this.isAnsweredAfterSoftTimeLimit())}isAnsweredAfterSoftTimeLimit(){return this.toolAttemptDetailItem.isAnsweredAfterSoftTimeLimit(this.questionAttempt)}isFullCredit(){return this.questionAttempt.question.fullCredit}isPartiallyCorrect(){return this.questionAttempt.partiallyCorrect}};Q.$inject=[],Q=Object(n.__decorate)([Object(n.__param)(0,Object(j.b)("$compile")),Object(n.__param)(1,Object(j.b)("$window")),Object(n.__param)(2,Object(j.b)("attrs")),Object(n.__param)(3,Object(j.b)("element")),Object(n.__param)(4,Object(j.b)(p.b)),Object(n.__param)(5,Object(j.b)("scope")),Object(n.__param)(6,Object(j.b)(g.b)),Object(n.__param)(7,Object(j.b)(h.serviceName))],Q);let K=class extends H{constructor(e,t,s,n,i,o,a,r,c,l,d){super(e,s,n,i,o,a,r,c,d),this.$compile=e,this.$sce=t,this.$window=s,this.attrs=n,this.element=i,this.gradebookPermissionService=o,this.scope=a,this.timeout=r,this.localizeService=c,this.ultraState=l,this.settingsDefault=d,this.question=this.scope.question,i.append(e(N)(a))}};K.$inject=[],K=Object(n.__decorate)([Object(n.__param)(0,Object(j.b)("$compile")),Object(n.__param)(1,Object(j.b)("$sce")),Object(n.__param)(2,Object(j.b)("$window")),Object(n.__param)(3,Object(j.b)("attrs")),Object(n.__param)(4,Object(j.b)("element")),Object(n.__param)(5,Object(j.b)(p.b)),Object(n.__param)(6,Object(j.b)("scope")),Object(n.__param)(7,Object(j.b)(g.b)),Object(n.__param)(8,Object(j.b)(h.serviceName)),Object(n.__param)(9,Object(j.b)(v.d))],K);let W=class extends H{constructor(e,t,s,n,i,o,a,r,c,l,d){super(e,t,s,i,o,r,c,a,d),this.$compile=e,this.$window=t,this.attrs=s,this.CourseModel=n,this.element=i,this.gradebookPermissionService=o,this.localizeService=a,this.scope=r,this.timeout=c,this.ultraState=l,this.settingsDefault=d,this.readOnly=!1,this.isRetryPending=!1,this.attemptIsDirty=!1,this.suppressAutosave=!1,this.scope.assessmentAttempt=this.getAssessmentAttemptView(this.scope),i.append(e(G)(r)),r.questionAttempt.question.ui={...r.questionAttempt.question.ui,positionId:this.elementId},r.$emit("bb-register-question-attempt-handlers",(()=>this.attemptIsDirty),(()=>this.scope.questionAttempt),this.prepareGivenAnswer),u.a(this.scope,this.scope.questionForm,(()=>{this.attemptIsDirty=!0})),this.attemptQuestion=this.scope.questionAttempt.question,this.autoSaveCount=0,this.element.attr("autosaved",this.autoSaveCount),r.$on("bb-assessment-attempt-question-readonly",((e,t)=>{this.readOnly=t})),r.$on(L.f,(()=>{this.isRetryPending&&this.scope.$broadcast($.a)})),this.initializeGivenAnswer()}get autoSaveContextArea(){return R.AutoSaveContextArea.Assessments}getAssessmentAttemptView(e){return null===e?null:e.assessmentAttempt?e.assessmentAttempt:this.getAssessmentAttemptView(e.$parent)}prepareGivenAnswer(e){}onPersistFinished(){}persist(){if(this.scope.questionAttempt.questionType!==x.QuestionType.PresentationOnly)return this.prepareGivenAnswer(this.scope.questionAttempt),this.scope.questionAttempt.$patch(["questionType","givenAnswer","givenAnswers"]).$allow([x.HttpStatus.Forbidden]).$asPromise().then((e=>{var t,s,n,i;const o=e.$response;if((null==o?void 0:o.status)!==x.HttpStatus.Forbidden||(null===(t=null==o?void 0:o.data)||void 0===t?void 0:t.code)!==x.AttemptApiErrors.AttemptCompletedOrForceCompletion)return this.isRetryPending=!1,this.incrementAutoSaveCount(),this.setDirtyAndUpdateGivenAnswer(e),null===(i=(n=this.scope.questionAttempt).onAnswerPersisted)||void 0===i||i.call(n,this.scope.questionAttempt),e;null===(s=this.scope.assessmentAttempt)||void 0===s||s.showAlreadySubmittedDialog()}),(e=>{throw-1===e.$response.status&&(this.isRetryPending=!0),e})).finally((()=>{this.onPersistFinished()}))}validate(){return!0}getCurrentForm(){return this.scope.questionForm}getType(){return this.attemptQuestion.questionType}hasGoals(){return this.attemptQuestion&&this.attemptQuestion.alignedGoals&&this.attemptQuestion.alignedGoals.length}incrementAutoSaveCount(){this.element.attr("autosaved",this.autoSaveCount+=1)}openQuestionGoals(){this.ultraState.goPeekState("question-goal-alignment-for-student",{questionId:this.scope.questionAttempt.questionId,questionIndex:this.scope.questionAttempt.visibleQuestionNumber})}};W.$inject=[],W=Object(n.__decorate)([Object(n.__param)(0,Object(j.b)("$compile")),Object(n.__param)(1,Object(j.b)("$window")),Object(n.__param)(2,Object(j.b)("attrs")),Object(n.__param)(3,Object(j.b)(d.serviceName)),Object(n.__param)(4,Object(j.b)("element")),Object(n.__param)(5,Object(j.b)(p.b)),Object(n.__param)(6,Object(j.b)(h.serviceName)),Object(n.__param)(7,Object(j.b)("scope")),Object(n.__param)(8,Object(j.b)(g.b)),Object(n.__param)(9,Object(j.b)(v.d))],W);let J=class extends Q{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v,f){super(e,s,n,i,o,a,r,c,f),this.$compile=e,this.$sce=t,this.$window=s,this.attrs=n,this.element=i,this.gradebookPermissionService=o,this.scope=a,this.timeout=r,this.localizeService=c,this.contextCourse=l,this.$ngRedux=d,this.scheduleTask=u,this.ltiService=p,this.CloudStorageIntegrationModalService=m,this.contextService=h,this.allyService=b,this.featureFlagService=g,this.fileUploadSettingsService=v,this.settingsDefault=f,this.isEditing=!1,this.refreshingAnswers=!1,this.saveRegradingQuestion=async(e,t)=>{Object(D.shouldShowRegradingWarning)(e,t)?this.cancelOrSaveEditingQuestion(U.SAVE):this.cancelOrSaveEditingQuestion(U.SAVE_WITHOUT_REGRADING),this.questionAttempt.question=t,void 0===this.questionAttempt.question.ui&&(this.questionAttempt.question.ui={}),this.questionAttempt.question.ui.prevQuestion=e,this.updateQuestionView(),this.scope.$applyAsync(),this.timeout((()=>{this.refreshingAnswers=!1}),this.scope,0);const s=t.sourceInfo?t.sourceInfo.id:this.scope.assessmentId();return Object(E.persistQuestion)(e,t,{assessmentId:s,courseId:this.contextCourse.courseId}).then((s=>{if(Object(D.shouldShowRegradingWarning)(e,t)){const e=()=>{this.scope.$root.$broadcast(P.a)};this.scheduleTask.scheduleTask({courseId:this.contextCourse.courseId,taskName:S.a.QuestionRegrading,scope:this.scope.$root,notifier:e,delay:1e4},!1)}return s})).catch((()=>{this.questionAttempt.question=e,this.destroyEditingQuestion(),this.scope.$applyAsync()}))},this.questionTitle=this.localizeService.translateSync({key:"components.directives.assessment-question.question-title",params:{index:this.questionAttempt.visibleQuestionNumber},locale:this.localizeService.getLocale(this.scope)}),this.renderQuestionAttempt(),a.$on(q,((e,t)=>{t!==this.scope.index()&&this.isEditing&&this.destroyEditingQuestion()}))}trustAsHtml(e){return this.$sce.trustAsHtml(e)}getQuestionRegradingOverflowMenu(){return[{icon:"draw",labelKey:"components.directives.attempt-canvas.freeform-response.grade.question.regrade",onClick:async()=>{await this.editRespondedQuestion(this.questionAttempt.question)}}]}get isCurrentCourseComplete(){return this.contextCourse.course.isComplete()}updateQuestionView(){this.refreshingAnswers=!0,this.constructViewHelper()}getRegradingContainer(){return this.element.find(".regrading-container")[0]}destroyEditingQuestion(){this.isEditing=!1,l.a.destroyReactControl(this.getRegradingContainer())}cancelOrSaveEditingQuestion(e){this.destroyEditingQuestion(),this.scope.$emit(z,e)}renderQuestionAttempt(){this.element.append(this.$compile(M)(this.scope))}async editRespondedQuestion(e){this.closeOtherEditing(),this.isEditing=!0;const t=await this.buildQuestionProps(e);this.timeout((()=>{l.a.renderQuestion(this.getRegradingContainer(),this.$ngRedux,this.localizeService.getLocale(this.scope),this.localizeService.intl,this.localizeService.frmt,this.localizeService.isRTL(this.scope),t,this.contextCourse.course.isOrganization,(()=>{this.element.find(".grade").find("input").focus()}))}),this.scope,0)}closeOtherEditing(){this.scope.$emit(B,this.scope.index())}async buildPluginsConfig(){const e={};return e.contentMarket={apiBasePath:Object(T.c)(I.a.apiBasePath),babelfishInstance:this.localizeService.intl,babelfishFormatInstance:this.localizeService.frmt,getEmbedSrc:this.ltiService.configureAndInitInlineLaunch.bind(this.ltiService),locale:this.localizeService.getLocale(this.scope),openContentMarket:this.ltiService.getOpenContentMarketConf(this.scope),xsrfToken:this.contextService.xsrfToken},await this.CloudStorageIntegrationModalService.initialize(),this.CloudStorageIntegrationModalService.isCloudServiceAvailable&&(e.insertCloudStorageIntegrationFile={openCloudStorageIntegrationModal:this.CloudStorageIntegrationModalService.getModalCallback(this.scope)}),e.insertYoutubeVideo={babelfishInstance:this.localizeService.intl,babelfishFormatInstance:this.localizeService.frmt,courseId:this.contextCourse.courseId,getEmbedSrc:this.ltiService.configureAndInitInlineLaunch.bind(this.ltiService)},e}async buildQuestionProps(e){const t=Object.assign(e,{assessmentId:this.scope.assessmentId(),permissions:{edit:!0}});return x.QuestionType.Matching===e.questionType&&e.answers.forEach((e=>{e.ui={id:Object(b.b)()}})),{courseId:this.contextCourse.courseId,contentId:this.scope.contentId,persistQuestion:this.saveRegradingQuestion,deleteQuestion:o.noop,openGoals:o.noop,onQuestionMadeDirty:o.noop,question:t,pluginsConfig:await this.buildPluginsConfig(),questionBeingEditedId:e.id,onQuestionEdit:o.noop,isAnyQuestionDirty:!1,hasSubmissions:!0,questionTitle:this.questionTitle,hasQuestionEditPermissions:!0,allyService:this.allyService.getReactService(this.scope),onQuestionEditCancel:()=>{this.cancelOrSaveEditingQuestion(U.CANCEL)},supportsInlineDocumentRender:await this.featureFlagService.createWaiter("feature.course.content.inline-render"),fileUploadSettings:this.fileUploadSettingsService.getSettings()}}allowCollapsingOfAutomatedFeedbackIfShown(){return!0}canShowCorrectAnswerRelatedDetail(){return!this.refreshingAnswers}canShowQuestionScoreRelatedDetail(){return x.AttemptStatus.Completed===this.questionAttempt.attemptStatus}};J.$inject=[],J=Object(n.__decorate)([Object(n.__param)(0,Object(j.b)("$compile")),Object(n.__param)(1,Object(j.b)("$sce")),Object(n.__param)(2,Object(j.b)("$window")),Object(n.__param)(3,Object(j.b)("attrs")),Object(n.__param)(4,Object(j.b)("element")),Object(n.__param)(5,Object(j.b)(p.b)),Object(n.__param)(6,Object(j.b)("scope")),Object(n.__param)(7,Object(j.b)(g.b)),Object(n.__param)(8,Object(j.b)(h.serviceName)),Object(n.__param)(9,Object(j.b)(f.e)),Object(n.__param)(10,Object(j.b)("$ngRedux")),Object(n.__param)(11,Object(j.b)(S.c)),Object(n.__param)(12,Object(j.b)(_.b)),Object(n.__param)(13,Object(j.b)(k.b)),Object(n.__param)(14,Object(j.b)(w.b)),Object(n.__param)(15,Object(j.b)(C.b)),Object(n.__param)(16,Object(j.b)(y.b)),Object(n.__param)(17,Object(j.b)(O.b))],J);let Y=class extends Q{constructor(e,t,s,n,i,o,a,r,c,l,d){super(e,s,n,i,o,a,r,l,d),this.$compile=e,this.$sce=t,this.$window=s,this.attrs=n,this.element=i,this.gradebookPermissionService=o,this.scope=a,this.timeout=r,this.ultraState=c,this.localizeService=l,this.settingsDefault=d,this.attemptQuestion=this.questionAttempt.question,i.append(e(N)(a))}trustAsHtml(e){return this.$sce.trustAsHtml(e)}hasGoals(){return this.attemptQuestion&&this.attemptQuestion.alignedGoals&&this.attemptQuestion.alignedGoals.length}openQuestionGoals(){this.ultraState.goPeekState("question-goal-alignment-for-student",{questionId:this.questionAttempt.questionId,questionIndex:this.questionAttempt.visibleQuestionNumber})}allowCollapsingOfAutomatedFeedbackIfShown(){return!1}canShowCorrectAnswerRelatedDetail(){return F.a.studentCanViewAttemptResults(this.attempt)&&this.questionAttempt.isCorrectAnswersVisible}canShowQuestionScoreRelatedDetail(){return F.a.studentCanViewAttemptResults(this.attempt)&&this.questionAttempt.isScoreVisible}wasAnsweredLate(){return this.canShowQuestionScoreRelatedDetail()&&super.wasAnsweredLate()}};Y.$inject=[],Y=Object(n.__decorate)([Object(n.__param)(0,Object(j.b)("$compile")),Object(n.__param)(1,Object(j.b)("$sce")),Object(n.__param)(2,Object(j.b)("$window")),Object(n.__param)(3,Object(j.b)("attrs")),Object(n.__param)(4,Object(j.b)("element")),Object(n.__param)(5,Object(j.b)(p.b)),Object(n.__param)(6,Object(j.b)("scope")),Object(n.__param)(7,Object(j.b)(g.b)),Object(n.__param)(8,Object(j.b)(v.d)),Object(n.__param)(9,Object(j.b)(h.serviceName))],Y)},DnQR:function(e,t){e.exports='<div bb-load-bundle="components/directives/folder" class="folder" ng-class="{\'is-empty-folder\': content.children.length === 0 && folder.showEmptyMenu, \'learning-module\': content.isLearningModule()}" bb-cache-compilation="content-folder">\n  <div bb-drop-handler on-move-handler="onMoveHandler" on-move-into-folder-handler="onMoveIntoFolderHandler" on-file-drop-handler="onFileDropHandler" content="content" is-folder-open="folder.isOpen" next-content-id="nextContentId" previous-content-id="previousContentId">\n    <div ng-if="::(!content.isLearningModule())"\n         class="row collapse element-list-row folder-row-container js-parent js-course-skip-link-target"\n         can-create="canCreate"\n         bb-content-item-mouseover\n         ng-class="{open: folder.isOpen, \'is-conditional-release\': content.isConditionalReleaseLocked(), \'element-list-row-extra-icon\': folder.isProgressTrackingStateShown(content)}"\n         bb-click-to-invoke-child="button.content-title">\n      <bb-content-item-base contents="contents" content="content" context-area="folder.contextArea" can-move="canMove"></bb-content-item-base>\n      <div class="list-tree-toggle" ng-if="folder.canToggle()">\n        <button class="button super-clear"\n                ng-click="folder.toggleFolder()"\n                aria-controls="{{::\'folder-contents-\' + content.id}}"\n                aria-expanded="{{folder.isOpen}}"\n                bb-translate-attrs="{\'aria-label\':\'components.directives.folder.aria-label.toggle-folder\'}"\n                translate-attrs-values="{folderName: content.title}"\n                analytics-id="course.content.folder.toggle.button">\n          <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon>\n        </button>\n      </div>\n    </div>\n\n    <div ng-if="::(content.isLearningModule())" ng-class="{open: folder.isOpen}">\n      <bb-learning-module-base-item content="content" contents="contents" context-area="folder.contextArea" can-toggle="::folder.canToggle()"\n        toggle-func="folder.toggleFolder()" can-move="canMove" is-open="folder.isOpen">\n      </bb-learning-module-base-item>\n    </div>\n  </div>\n  <div ng-attr-id="{{::(content.isLearningModule() ? \'learning-module-contents-\' : \'folder-contents-\') + content.id}}" class="folder-contents" aria-expanded="{{folder.isOpen}}" ng-class="{\'not-empty\': content.children && content.children.length > 0}">\n    <div ng-if="(content.children.length > 0 || folder.showOutlineOverride) && folder.isOpen">\n      <bb-content-outline hide-add-menu-override="folder.showOutlineOverride" on-file-drop-handler="onFileDropHandler" on-move-handler="onMoveHandler"\n                          on-move-into-folder-handler="onMoveIntoFolderHandler" load-more-children="loadMoreChildren" parent-folder="folder.content"\n                          contents="folder.content.children" can-create="canCreate" can-move="canMove" context-area="folder.contextArea"\n                          can-copy-import="canCopyImport"></bb-content-outline>\n    </div>\n    <div class=\'drag-element\'>\n      <div bb-drop-handler\n        ng-show="content.children.length === 0"\n        on-move-handler="onMoveHandler"\n        on-move-into-folder-handler="onMoveIntoFolderHandler"\n        on-file-drop-handler="onFileDropHandler"\n        content="{id: content.id + \'blank\', parentId: content.id, depth: content.depth + 1}"\n        empty-target\n      >\n        <span class="empty-message" ng-if="content.children.length === 0 && folder.showEmptyMenu && !canCreate"\n          ng-class="{\'foder-in-force-sequence-empty-message\': content.isForcedSequenceItem()}"\n          bb-translate="{{\n              content.isLearningModule() ?\n                \'components.directives.learning-module.empty\' :\n                \'components.directives.folder.empty\'\n          }}">\n        </span>\n        \x3c!-- (|| false) keep showMenuOverride in watch status in add-content-button directive --\x3e\n        \x3c!-- use ng-show instead of ng-if to keep the element when close add buttons, make sure the upload directive handlers will not be lost --\x3e\n        <ng-switch on="::content.isLearningModule()">\n          <bb-add-content-button ng-switch-when="false" show-menu-override="folder.showMenuOverride || false" depth="(content.depth + 1)" content="content"\n                                 root-content="rootContent()" parent-id="content.id" position-before="\'start\'"\n                                 ng-show="canCreate && folder.showEmptyMenu" context-area="folder.contextArea"\n                                 can-copy-import="canCopyImport" folder-nested-button="true"></bb-add-content-button>\n          <bb-add-content-button ng-switch-when="true" show-menu-override="false" depth="(content.depth + 1)" content="content"\n                                 root-content="content" parent-id="content.id" position-before="\'start\'"\n                                 is-render-by-default="true"\n                                 class="empty-lm-add-content-btn"\n                                 ng-show="canCreate && folder.showEmptyMenu" context-area="folder.contextArea"\n                                 can-copy-import="canCopyImport" folder-nested-button="true"></bb-add-content-button>\n        </ng-switch>\n      </div>\n    </div>\n  </div>\n</div>\n'},Dr7i:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("UxPl");const o="ultra.components.directives.bbUiIcon.small.Started";Object(n.a)(i.a,o,"bbUiIconSmallStarted")},E7GM:function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="grade-grid-group-confirm-dialog" aria-haspopup="true" role="dialog">\n  <div class="message-wrapper">\n    <div class="message">\n      <span bb-translate>components.directives.grade.grid.confirmContent</span>\n    </div>\n    <div class="buttons">\n      <button class="button" \n              ng-click="saveGroup()" \n              bb-translate  \n              analytics-id="components.directives.grade.grid.yes">components.directives.grade.grid.yes</button>\n      <button class="button button--secondary" \n              ng-click="saveOne()" \n              ng-disabled="isSaveOneDisabled" \n              analytics-id="components.directives.grade.grid.no"\n              bb-translate>components.directives.grade.grid.no</button>\n    </div>\n  </div>\n</div>'},EGJL:function(e,t){e.exports='<div ng-class="{\'is-restricted\': graderColumn.column.isHidden() && !graderColumn.column.externalGrade, \'grader-column\': true}">\n  <div class="row tabular-row js-row grader-column-item" bb-click-to-invoke-child="a.bb-click-target" aria-describedby="guidance-moment-grade-click">\n    <div ng-class="{\'medium-5\': !graderColumn.isCourseView, \'medium-4\': graderColumn.isCourseView}" class="columns">\n      <div class="element-card">\n        <div bb-content-item-icon show-alert-icon="graderColumn.showAlertIcon()" content-column="graderColumn.column" class="element-image" ng-if="graderColumn.column"></div>\n        <div class="element-details">\n          <div ng-class="{\'gradebook-overall-grade-title\': graderColumn.column.externalGrade}">\n            <bb-svg-icon\n              id="{{graderColumn.column.id + \'grade-not-visible-icon\'}}"\n              size="small"\n              ng-if="graderColumn.column.externalGrade && !graderColumn.column.visible"\n              icon="invisible"\n              class="visibility-icon"\n              role="img"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.grader-column.aria-label.gradeNotVisible\'}"\n            ></bb-svg-icon>\n            <span class="name ellipse" ng-if="graderColumn.itemLinkIsClickable">\n              <a  class="bb-click-target"\n                  ng-click="graderColumn.handleColumnClick()"\n                  href="javascript:void(0);"\n                  bb-key-hide-ftue="grades.grader.base.column.clickItem"\n                  id="{{\'graderColumn_\' + graderColumn.course.courseId}}"\n                  analytics-id="components.directives.grade.graderColumn.name.link"\n                  aria-label="{{graderColumn.attendanceAriaLabel}}"\n                  ng-attr-aria-describedby="{{graderColumn.column.externalGrade && !graderColumn.column.visible ? graderColumn.column.id + \'grade-not-visible-icon\' : undefined}}">\n                  {{graderColumn.column.columnName}}\n              </a>\n            </span>\n          </div>\n          <span class="name ellipsis" ng-if="!graderColumn.itemLinkIsClickable">\n            <span id="{{ \'graderColumn_\' + graderColumn.course.courseId}}">{{graderColumn.column.columnName}}</span>\n          </span>\n          <div class="name-controls" ng-if="::!graderColumn.column.isOffline()">\n            <span class="secondary-text" ng-if="::graderColumn.column.seemsAttemptBased()">\n              <span ng-if="graderColumn.column.dueDate && graderColumn.numMissingStudents">\n                <span class="items-missing" bb-translate translate-values="{missingCount: graderColumn.numMissingStudents}">components.directives.grade.grader-column.studentsMissing.plural</span>\n                <span ng-if="!graderColumn.column.isOffline()">|</span>\n              </span>\n              <span ng-if="graderColumn.column.summary.numStudentSubmissions && graderColumn.column.summary.numEligibleToBeGraded">\n                <bb-translate ng-if="graderColumn.column.isDiscussion()" class="submittedCount" translate-values="{participatedCount: graderColumn.column.summary.numStudentSubmissions(), totalCount: graderColumn.column.summary.numEligibleToBeGraded}">components.directives.grade.grader-column.studentsParticipated.plural</bb-translate>\n                <bb-translate ng-if="!graderColumn.column.isDiscussion()" class="submittedCount" translate-values="{submittedCount: graderColumn.column.summary.numStudentSubmissions(), totalCount: graderColumn.column.summary.numEligibleToBeGraded}">components.directives.grade.grader-column.studentsSubmitted.plural</bb-translate>\n              </span>\n            </span>\n            <span class="secondary-text" ng-if="::graderColumn.column.isAttendance() && graderColumn.column.summary.averageGradeForStudents">\n                <span bb-translate translate-values="{percentage: graderColumn.column.summary.averageGradeForStudents}">components.directives.grade.grader-column.attendance.average</span>\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div ng-if="graderColumn.isCourseView" class="date columns medium-2 large-2 hide-for-small-only">\n      <bb-datetime ng-if="!graderColumn.column.isAttendance()" format="Short" value="graderColumn.column.dueDate">\n      </bb-datetime>\n      <span ng-if="graderColumn.column.isAttendance()" bb-translate>components.directives.grade.grader-column.attendance.ongoing</span>\n    </div>\n\n    <div ng-class="{\'grade-status-container columns medium-7\': !graderColumn.isCourseView, \'columns medium-5 course-only-grade-status-container\': graderColumn.isCourseView}">\n      <div class="grade-progress" ng-class="{\'columns medium-7 course-only-grade-status\': graderColumn.isCourseView}" ng-if="!graderColumn.column.isAttendance()">\n        <div ng-switch="graderColumn.column.isCollectExternalSubmissions()">\n          \x3c!-- External submission statuses are calculated differently from others since the instructor is initiating the attempt\n          when they go to grade the user. Therefore, we want to include people who have no submission as ready to be graded //--\x3e\n          <div ng-switch-when="true">\n            <div ng-switch="graderColumn.column.summary.getStatus().toString()">\n              <div class="grade-count" ng-switch-when="NEEDS_GRADING">\n                <span bb-translate translate-values="{count: graderColumn.getNumberEligibleToBeGradedExternalSubmissions()}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n                <span ng-if="graderColumn.column.summary.totalNumberOfGradesToPost() > 0">|</span>\n                <span class="grade-posted-count-before" ng-if="graderColumn.column.summary.totalNumberOfGradesToPost() > 0"\n                      bb-translate translate-values="{count: graderColumn.column.summary.totalNumberOfGradesToPost()}">\n                  components.directives.grade.grader-column.statuses.numToPost.plural\n                </span>\n              </div>\n              <span ng-switch-when="NEEDS_POSTING">\n                <span bb-translate ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() > 0"\n                      translate-values="{count: graderColumn.getNumberEligibleToBeGradedExternalSubmissions()}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n                <span ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() > 0">|</span>\n                <span bb-translate translate-values="{count: graderColumn.column.summary.totalNumberOfGradesToPost()}">\n                  components.directives.grade.grader-column.statuses.numToPost.plural\n                </span>\n              </span>\n              <span ng-switch-when="ALL_GRADED">\n                <span ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() === 0" bb-translate>\n                  components.directives.grade.grader-column.statuses.allGraded\n                </span>\n                <span ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() > 0" bb-translate\n                      translate-values="{count: graderColumn.getNumberEligibleToBeGradedExternalSubmissions()}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n              </span>\n              <div class="grade-progress-complete" ng-switch-when="ALL_POSTED">\n                <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n                <span bb-translate>components.directives.grade.grader-column.statuses.allPosted</span>\n              </div>\n              <span ng-switch-when="NOTHING_TO_GRADE">\n                <span ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() === 0" bb-translate>\n                  components.directives.grade.grader-column.statuses.nothingToGrade\n                </span>\n                <span ng-if="graderColumn.getNumberEligibleToBeGradedExternalSubmissions() > 0" bb-translate\n                      translate-values="{count: graderColumn.getNumberEligibleToBeGradedExternalSubmissions()}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n              </span>\n              <div class="grade-progress-restricted" ng-switch-when="RESTRICTED">\n                <bb-button-complex-tooltip></bb-button-complex-tooltip>\n                <span bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n              </div>\n            </div>\n          </div>\n          <div ng-switch-default>\n            <div ng-switch="graderColumn.column.summary.getStatus().toString()" ng-if="::!graderColumn.column.isCalculated()">\n              <div class="grade-count js-grade-progress-needs-grading" ng-switch-when="NEEDS_GRADING">\n                <span ng-if="::graderColumn.column.isOffline()"\n                      bb-translate translate-values="{count: graderColumn.column.summary.numStudentsNeedsGrading}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n                <span ng-if="::!graderColumn.column.isOffline()"\n                      bb-translate translate-values="{count: graderColumn.getNumberOfSubmissionsNeedsGrading()}">\n                  components.directives.grade.grader-column.statuses.numToGrade.plural\n                </span>\n                <span ng-if="graderColumn.column.summary.totalNumberOfGradesToPost() > 0">|</span>\n                <span class="grade-posted-count-before" ng-if="graderColumn.column.summary.totalNumberOfGradesToPost() > 0" bb-translate translate-values="{count: graderColumn.column.summary.totalNumberOfGradesToPost()}">components.directives.grade.grader-column.statuses.numToPost.plural</span>\n              </div>\n              <span class="js-grade-progress-needs-posting" ng-switch-when="NEEDS_POSTING" bb-translate translate-values="{count: graderColumn.column.summary.totalNumberOfGradesToPost()}">components.directives.grade.grader-column.statuses.numToPost.plural</span>\n              <span class="js-grade-progress-all-graded" ng-switch-when="ALL_GRADED" bb-translate>components.directives.grade.grader-column.statuses.allGraded</span>\n              <div class="grade-progress-complete" ng-switch-when="ALL_POSTED">\n                <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n                <span bb-translate>components.directives.grade.grader-column.statuses.allPosted</span>\n              </div>\n              <span class="js-grade-progress-nothing-to-show" ng-switch-when="NOTHING_TO_GRADE" bb-translate>components.directives.grade.grader-column.statuses.nothingToGrade</span>\n              <div class="grade-progress-restricted" ng-switch-when="RESTRICTED">\n                <bb-button-complex-tooltip></bb-button-complex-tooltip>\n                <span bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n              </div>\n            </div>\n            <div ng-if="::graderColumn.column.isCalculated()">\x3c!-- Needed for spacing --\x3e</div>\n          </div>\n        </div>\n      </div>\n      <div class="grade-progress" ng-class="{\'columns medium-7 course-only-grade-status\': graderColumn.isCourseView}"\n           ng-if="graderColumn.column.isAttendance()" bb-translate>\n        components.directives.grade.grader-column.attendance.markAttendance\n      </div>\n      <div class="grade-status" ng-class="{\'columns medium-5 course-only-grade-status\': graderColumn.isCourseView}">\n        <div ng-if="::!graderColumn.column.isCalculated()">\n          <div ng-if="!graderColumn.course.isComplete() && graderColumn.column.summary.hasGradesToPost() && graderColumn.canPostGrades" class="post">\n            <button class="button button--secondary send-grade" bb-confirmation-needed="{{graderColumn.grade.getPostAllGradeConfirmationNeededStringsKey(graderColumn.column)}}"\n                    modal-aria-type="alertdialog" show-type="always" ng-click="graderColumn.postGrades()"\n                    bb-translate-attrs="{\'aria-label\': \'components.directives.grade.grader-column.aria-label.postGrades\'}"\n                    translate-attrs-values="{courseName: graderColumn.course.name, columnName: graderColumn.column.columnName}"\n                    bb-translate="{{graderColumn.isCourseView ? \'components.directives.grade.grader-column.actions.postGrades\' : \'components.directives.grade.grader-column.actions.basePostGrades\'}}"\n                    analytics-id="{{graderColumn.isCourseView ? \'components.directives.grade.grader-column.actions.postGrades\' : \'components.directives.grade.grader-column.actions.basePostGrades\'}}" >\n            </button>\n          </div>\n        </div>\n        <div ng-if="::graderColumn.column.isCalculated()">\x3c!-- Needed for spacing --\x3e</div>\n      </div>\n    </div>\n    <div ng-if="(graderColumn.showOverflowMenu || graderColumn.showDragControls) && !graderColumn.isRestrictedGroupContent"\n        class="columns medium-1 large-1 last-row-item item-controls dots" bb-foundation-defer>\n\n      \x3c!-- disable if its a group and has user is not entitled --\x3e\n      <button bb-drag-handle ng-if="graderColumn.showDragControls"\n              drag-item-id="{{::graderColumn.column.id}}"\n              drag-item-name="{{graderColumn.column.columnName}}"\n              class="super-clear small button icon js-drag-handle drag-drop-button"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.grader-column.aria-label.reorder-grader-item\', \'title\': \'components.directives.grade.grader-column.aria-label.move-tip\'}"\n              translate-attrs-values="{columnName: graderColumn.column.columnName}"\n              analytics-id="components.directives.grade.graderColumn.reorderItem.button" >\n        <bb-svg-icon size="small" icon="move-item-up-down"></bb-svg-icon>\n      </button>\n\n      \x3c!-- disable if its a group and has user is not entitled --\x3e\n      <div ng-if="graderColumn.showOverflowMenu" class="overflow-menu-container right">\n        <bb-overflow-menu element-id="{{graderColumn.overflowMenuId}}"\n                          element-name="{{graderColumn.column.columnName}}"\n                          menu-items="graderColumn.getOverflowMenuItems()"\n                          analytics-id-tag-prefix="components.directives.grade.grader-column.overflowMenu">\n        </bb-overflow-menu>\n      </div>\n    </div>\n  </div>\n\n  <div ng-if="graderColumn.showConversionMessage">\n    <bb-course-access-alert course="course"\n                            alert-type="graderColumn.getAlertType()"\n                            confirm-callback="graderColumn.closeConversionTooltip()"\n                            timeout-callback="graderColumn.closeConversionTooltip()">\n    </bb-course-access-alert>\n  </div>\n</div>\n<bb-add-content-button\n                      position-after="graderColumn.column.id" item-name="graderColumn.column.columnName"\n                      context-area="graderColumn.contextArea"\n                      ng-if="graderColumn.isCourseView && !graderColumn.course.isComplete() && graderColumn.canModify"\n                      show-add-attendance="attendanceIsAvailable() && !attendanceColumnExists()">\n</bb-add-content-button>\n'},ELoy:function(e,t,s){"use strict";s("px9Z"),s("GkCm");var n=s("Llzl"),i=s("lEL+"),o=s("6sUD");s.d(t,"a",(function(){return a}));const a="ultra.directives.telemetry.panel.header";class r{constructor(e,t){this.scope=e,this.timeout=t,this.showSpinner=!1,this.spinnerTimeout=this.timeout((()=>{this.showSpinner=!0}),this.scope,r.WAIT_TIME_TO_SHOW_SPINNER),this.scope.$watch("::panelDataLoaded()",(e=>{e&&this.dataLoaded()}))}dataLoaded(){this.timeout.cancel(this.spinnerTimeout),this.showSpinner=!1}}r.$inject=["scope",i.b],r.WAIT_TIME_TO_SHOW_SPINNER=1e3;class c{constructor(e){this.$injector=e,this.restrict="E",this.template=o,this.transclude=!0,this.scope={course:"&",panelDataLoaded:"&",titleKey:"@?",title:"@?",buttonOneIcon:"@",buttonOneCallback:"&",buttonOneAriaLabel:"@",buttonOneTitle:"@",buttonTwoIcon:"@",buttonTwoCallback:"&",buttonTwoAriaLabel:"@",buttonTwoTitle:"@"},this.link=e=>{e.telemetryPanelHeader=this.$injector.instantiate(r,{scope:e})}}}c.$inject=["$injector"],n.module(a,[]).directive("bbTelemetryPanelHeader",["$injector",e=>e.instantiate(c)])},Ed3w:function(e,t,s){"use strict";s.d(t,"b",(function(){return c})),s.d(t,"c",(function(){return l})),s.d(t,"a",(function(){return d}));var n=s("Llzl"),i=s("pjml"),o=s("lEL+"),a=s("nsO7"),r=s("zGdY");const c="ultra.services.schedule-task",l="schedule-task";var d;!function(e){e.QuestionRegrading="regradingTasks"}(d||(d={}));const u=new Map;class p{constructor(e,t){this.timeout=e,this.scheduleTaskModel=t}scheduleTask({courseId:e,taskName:t,scope:s,notifier:i=a.noop,delay:o=2e3},r=!1){let c=u.get(e);if(c&&c.has(t))return;n.isUndefined(c)&&(c=new Set),u.set(e,c.add(t));const l=e=>{i(e),c.delete(t)};s.$on("$destroy",(()=>{c.delete(t)})),r?this.timedTask({courseId:e,taskName:t,scope:s,notifier:l,delay:o}):this.fireInitialRequest(e,t).then((i=>{this.hasInCompleteTasks(i)&&n.isDefined(s)?this.timedTask({courseId:e,taskName:t,scope:s,notifier:l,delay:o}):l(!0)}))}timedTask({courseId:e,taskName:t,scope:s,notifier:n=a.noop,delay:i}){this.timeout((()=>{this.requestTask(e,t).then((o=>{this.hasInCompleteTasks(o)?this.timedTask({courseId:e,taskName:t,scope:s,notifier:n,delay:i}):n(!1)}))}),s,i)}fireInitialRequest(e,t){return this.requestTask(e,t)}requestTask(e,t){return this.scheduleTaskModel.$collection().$fetch({courseId:e,filterBy:t}).$asPromise()}hasInCompleteTasks(e){return e.some((e=>e.taskStatus!==r.QueueTaskStatus.CompleteErrors&&e.taskStatus!==r.QueueTaskStatus.Complete))}}p.$inject=[o.b,i.nb.serviceName];n.module(c,[o.a]).service(l,class extends p{})},"Ee/I":function(e,t){e.exports='<div class="true-false-attempt-authoring true-false">\n  <div class="true-false-question question-container">\n    <bb-rich-text-editor\n      ng-model="questionAttempt.question.questionText.rawText"\n      is-read-only="true"\n      supports-inline-document-render="true"\n      plugin-options="{\'attachment\': true, \'math\': true, \'contentMarket\': true}">\n    </bb-rich-text-editor>\n  </div>\n  <div class="true-false-answers-container">\n    <ol class="true-false-answers" ng-if="questionAttempt.question">\n      <li class="true-false-answer js-true-false-answer-true" ng-class="{\'selected-answer\': assessmentQuestion.givenAnswer !== undefined && assessmentQuestion.givenAnswer}">\n        <input type="radio"\n               id="{{assessmentQuestion.elementId + \'true-false-answer-true\' }}"\n               name="{{assessmentQuestion.elementId + \'true-false-answers-choice\' }}"\n               aria-labelledby="{{assessmentQuestion.elementId + \'true-false-answer-true-label\' }}"\n               ng-model="assessmentQuestion.givenAnswer"\n               ng-value="true"\n               analytics-id="assessment.question.true.false.answer.givenAnswer.input.radio"/>\n        <label id="{{assessmentQuestion.elementId + \'true-false-answer-true-label\' }}"\n               for="{{assessmentQuestion.elementId + \'true-false-answer-true\' }}"\n               ng-mousedown="assessmentQuestion.givenAnswer = true"\n               class="checkbox-label">\n          {{::assessmentQuestion.viewHelper.trueAnswerOptionLabel}}\n        </label>\n      </li>\n      <li class="true-false-answer js-true-false-answer-false" ng-class="{\'selected-answer\': assessmentQuestion.givenAnswer !== undefined && !assessmentQuestion.givenAnswer}">\n        <input type="radio"\n               id="{{assessmentQuestion.elementId + \'true-false-answer-false\' }}"\n               name="{{assessmentQuestion.elementId + \'true-false-answers-choice\' }}"\n               aria-labelledby="{{assessmentQuestion.elementId + \'true-false-answer-false-label\' }}"\n               ng-model="assessmentQuestion.givenAnswer"\n               ng-value="false"\n               analytics-id="assessment.question.true.false.answer.no.givenAnswer.input.radio"/>\n        <label id="{{assessmentQuestion.elementId + \'true-false-answer-false-label\' }}"\n               for="{{assessmentQuestion.elementId + \'true-false-answer-false\' }}"\n               ng-mousedown="assessmentQuestion.givenAnswer = false"\n               class="checkbox-label">\n          {{::assessmentQuestion.viewHelper.falseAnswerOptionLabel}}\n        </label>\n      </li>\n    </ol>\n  </div>\n</div>\n'},Efpj:function(e,t){e.exports='<div class="grades-list instructor-wrapper">\n  <div class="row tabular-list-header course-grades-column-headers" ng-if="courseGradesGraderList.columns.length > 0">\n    <div class="columns small-6 medium-4 large-4 tabular-list-header-offset"><span bb-translate>components.directives.grade.course-grades-grader-list.headers.name</span></div>\n    <div class="columns hide-for-small-only medium-2 large-2"><span bb-translate>components.directives.grade.course-grades-grader-list.headers.dueDate</span></div>\n    <div class="columns hide-for-small-only medium-3 large-3 end course-grades-column-progress-header"><span bb-translate>components.directives.grade.course-grades-grader-list.headers.progress</span></div>\n  </div>\n\n\n  <div bb-mouse-leave-enter="course-gradebook">\n\n    <bb-add-content-button position-before="\'start\'" item-name="courseGradesGraderList.columns[0].columnName"\n                           context-area="courseGradesGraderList.contextArea"\n                           show-menu-override="!courseGradesGraderList.hasColumns"\n                           always-show="isFirst"\n                           show-add-attendance="attendanceIsAvailable() && !courseGradesGraderList.attendanceColumnExists"\n                           ng-if="courseGradesGraderList.contextArea && !course().isComplete() && courseGradesGraderList.canModify" bb-key-hide-ftue="grades.grader.course.column.add"></bb-add-content-button>\n    \x3c!-- set keep-guidance-when-focusout to be true then add bb-key-hide-ftue="grades.grader.course.column.add" on its preceding element --\x3e\n    <div bb-guidance-target component-key="grades.grader.course.column.add" keep-guidance-when-focusout="true" aria-describedby="guidance-moment-grade-add"></div>\n\n    <bb-guidance id="guidance-moment-grade-add" component-key="grades.grader.course.column.add"\n                 class="grades-list-guidance guidance-element-overlay" role="tooltip">\n      <bb-translate>components.directives.grade.course-grades-grader.ftue.add</bb-translate>\n    </bb-guidance>\n\n    <div class="grade-list-columns">\n      <div class="drag-element" ng-class="{\'no-hover\': (course().isComplete() || (column.isAttendance() && !attendanceIsAvailable)), \'last-tabular-row-container\': $last}"\n           ng-repeat="column in courseGradesGraderList.columns track by column.id" bb-content-item-mouseover>\n        <div bb-drop-handler on-move-handler="courseGradesGraderList.onMoveGraderItem" content="column"\n             next-content-id="courseGradesGraderList.columns[$index+1].id"\n             previous-content-id="courseGradesGraderList.columns[$index-1].id">\n\n          <bb-grader-column column="column"\n                            course="course()"\n                            is-course-view="true"\n                            category-map="courseGradesGraderList.categoryMap"\n                            attendance-column-exists="courseGradesGraderList.attendanceColumnExists"\n                            attendance-is-available="attendanceIsAvailable()">\n          </bb-grader-column>\n        </div>\n      </div>\n    </div>\n    <bb-setup-overall-grade ng-if="courseGradesGraderList.showSetupOverallGradeMessage && courseGradesGraderList.canModify"\n                            course-id="courseGradesGraderList.course.id"\n                            setup-overall-grade-hide-message-callback="courseGradesGraderList.setupOverallGradeHideMessageCallback()">\n    </bb-setup-overall-grade>\n  </div>\n</div>\n'},Et3n:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("D57K"),i=s("0JpG"),o=s("yC9S"),a=s("dL5/");const r="ultra.directives.group.group-count";let c=class{$onInit(){}isSelfEnrollment(){return!!(this.content.selfEnrollmentGroups&&this.content.selfEnrollmentGroups.length>0)&&this.content.selfEnrollmentGroups.some((e=>e.group&&!e.group.groupSetId))}};c=Object(n.__decorate)([Object(o.a)({moduleName:r,componentName:"bbGroupCount",template:a,bindings:{content:"<"},requireModules:[i.moduleName]})],c)},F2PN:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("BY8f");const o="ultra.components.directives.bbUiIcon.large.Journal";Object(n.a)(i.Journal,o,"bbUiIconLargeJournal")},F2mp:function(e,t,s){"use strict";s.r(t);var n=s("Llzl"),i=s("mJUP"),o=s("iAHr"),a=s("Xcx3"),r=s("D57K"),c=s("VdDF"),l=s("Fvsw"),d=s("0JpG"),u=s("MoIS"),p=s("+g6d"),m=s("yC9S"),h=s("aHpC"),b=s("9hUw"),g=s("aPUy"),v=s("15AK"),f=s("bzJv"),w=s("zisU"),S=s("H9hP"),C=s("wAfT"),y=s("Dr7i"),O=s("tA/q"),A=s("ERkP"),I=s("1ZbL"),D=s("/n7R"),k=s("0x+l");const _="ultra.components.directives.content.assessment.assignedPeerGrading.tooltip",j={Class:({tooltipTitle:e})=>A.createElement(D.AnalyticsTooltip,{placement:"top",title:e,"aria-label":e,analyticsId:"components.directives.content.assessment.assignedPeerGrading.tooltip"},A.createElement(k.Attention,null)),bindingNames:["tooltipTitle"]};angular.module(_,[]).component("bbUiAssignedPeerGradingTooltip",Object(I.a)(j));var T=s("cghv"),$=s("zGdY");const R="ultra.features.course.content.assessment.assignedPeerGrading";let E=class{constructor(e,t,s,n,i){this.$scope=e,this.$q=t,this.localize=s,this.context=n,this.peerService=i,this.peerReviews=[],e.assignedPeerReviews=this,this.currentDate=this.context.getServerTime(),this.submissionDueDate=e.submissionDueDate&&c.a.parseStringToDate(e.submissionDueDate),this.peerReviewDueDate=e.peerReviewDueDate&&c.a.parseStringToDate(e.peerReviewDueDate)}$onInit(){this.$scope.$on(v.FEEDBACK_UPDATED,(()=>{this.createPeerReviewList()})),Object(g.b)(this.$scope,(()=>this.createPeerReviewList()))}$onChanges(){this.peerService.getOrCreatePeerContentWithAttemptsFromContent(this.content).then((e=>{this.peerReviewContentObject=e,this.createPeerReviewList()}))}createPeerReviewList(){this.peerReviews=new Array(this.peerReviewsPerStudent),this.peerReviews.fill(null),this.populatePeerReviews(this.peerReviewContentObject.reviewableAttempts),this.populatePeerReviews(this.peerReviewContentObject.deletedAttempts),this.callComponentUpdatedCallback()}populatePeerReviews(e){e.forEach((e=>{this.peerReviews[e.delegatedGraderOrder]=e}))}callComponentUpdatedCallback(){this.componentUpdatedCallback&&this.componentUpdatedCallback(this.isSubmissionComplete,this.isPeerReviewPeriodOpen,this.hasPeerReviewsAssigned,this.hasBeenAssignedAllPeerReviews,(()=>this.assignAndGoToNewPeerReview()))}get isPeerReviewPeriodOpen(){return!(!this.isSubmissionComplete||!this.hasEnoughPeerSubmissions())&&(this.isInPeerReviewWindow||this.isAfterPeerReviewWindow&&(this.allowLatePeerReviews||this.hasDueDateAccommodation))}assignAndGoToNewPeerReview(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.assignNewPeerReview().then((e=>this.navigateToPeerReview(e.delegatedGraderOrder)))}navigateToPeerReview(e){var t;const s=null===(t=this.peerReviewContentObject)||void 0===t?void 0:t.getReviewableAttemptByDelegatedGraderOrder(e);return this.isPeerReviewDisabled(s)||this.isInPeerSubmissionWindow?this.$q.resolve():this.peerReviewContentObject.navigateToPeerReview(e).then((()=>this.callComponentUpdatedCallback()))}isPeerReviewComplete(e){return $.AttemptStatus.Completed===(null==e?void 0:e.status)}isPeerReviewStarted(e){return $.AttemptStatus.NeedsGrading===(null==e?void 0:e.status)}isPeerReviewSaved(e){return!!(null==e?void 0:e.attemptLastGradedDate)&&!this.isPeerReviewComplete(e)}isReviewedAttemptDeleted(e){return Boolean(null==e?void 0:e.deletedAttempt)}getPeerReviewStatus(e){return!this.isSubmissionComplete||this.isReviewedAttemptDeleted(e)?f.a.Unavailable:this.isPeerReviewComplete(e)?f.a.Completed:this.isPeerReviewLate(e)?f.a.PastDue:this.isPeerReviewStarted(e)?f.a.Started:this.isPeerReviewPeriodOpen?f.a.NotStarted:f.a.Unavailable}isPeerReviewDisabled(e){const t=this.getPeerReviewStatus(e);return t===f.a.Unavailable||t===f.a.NotStarted||t===f.a.PastDue&&!e}get allPeerReviewsComplete(){return!this.peerReviews.some((e=>!this.isPeerReviewComplete(e)))}get isInPeerSubmissionWindow(){return c.a.isWithinDateRange(this.currentDate,{end:this.submissionDueDate,start:null},!1)}get isInPeerReviewWindow(){return!this.isInPeerSubmissionWindow&&c.a.isWithinDateRange(this.currentDate,{end:this.peerReviewDueDate,start:null},!1)}get isAfterPeerReviewWindow(){return!(this.isInPeerSubmissionWindow||this.isInPeerReviewWindow)}isPeerReviewLate(e){return this.isPeerReviewComplete(e)?!c.a.isWithinDateRange(e.attemptLastGradedDate,{end:this.peerReviewDueDate,start:null},!0)&&!this.hasDueDateAccommodation:this.isAfterPeerReviewWindow&&!this.hasDueDateAccommodation}get hasPeerReviewsAssigned(){var e;return(null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.reviewableAttempts.length)>=1}get hasBeenAssignedAllPeerReviews(){var e,t;return(null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.reviewableAttempts.length)>=(null===(t=this.peerReviewContentObject)||void 0===t?void 0:t.numOfPeerReviewsToComplete)}get deployedAssessment(){var e;return(null===(e=this.content)||void 0===e?void 0:e.contentDetail)&&this.content.getDeployedAssessment()}hasEnoughPeerSubmissions(){var e,t;return null!==(t=null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.hasEnoughSubmissionsForPeerAssessment)&&void 0!==t&&t}getDescriptionTextKey(){return this.allPeerReviewsComplete?"allReviewsCompleted":this.isInPeerSubmissionWindow?"duringSubmissionWindow":this.hasEnoughPeerSubmissions()?this.isSubmissionComplete?this.isInPeerReviewWindow?"duringReviewWindow."+(this.isSubmissionLate?"lateSubmission":"onTimeSubmission"):this.allowLatePeerReviews?"afterReviewWindow.lateReviewsAccepted":"afterReviewWindow.lateReviewsNotAccepted":(this.isInPeerReviewWindow?"duringReviewWindow":"afterReviewWindow")+".noSubmission":"notEnoughSubmissions"}getTooltipText(){return this.localize.translateSync({locale:this.localize.getLocale(this.$scope),key:"course.content.assessment.overview.assignedPeerReviews.peerSubmissionDeletedTooltip"})}};E=Object(r.__decorate)([Object(m.a)({moduleName:R,componentName:"bbAssignedPeerGrading",template:T,bindings:{submissionDueDate:"<",peerReviewDueDate:"<",peerReviewsPerStudent:"<",allowLatePeerReviews:"<",hasDueDateAccommodation:"<",isSubmissionComplete:"<",isSubmissionLate:"<",content:"<",componentUpdatedCallback:"<?"},requireModules:[_,w.a,S.a,C.a,y.a,O.a,l.a,u.c,b.a,p.a]}),Object(r.__param)(0,Object(h.b)("$scope")),Object(r.__param)(1,Object(h.b)("$q")),Object(r.__param)(2,Object(h.b)(d.serviceName)),Object(r.__param)(3,Object(h.b)(l.b)),Object(r.__param)(4,Object(h.b)(b.b))],E);var x=s("ihlU"),P=s("iq5i"),L=s("IiJs"),G=s("ap1t"),M=s("QyCV"),N=s("5Tom"),F=s("nYZ0"),B=s("fYJU"),q=s("TnpK"),z=s("zYa8"),U=s("2QtM");const V="ultra.components.directives.bbUiIcon.large.Attention";Object(z.a)(U.a,V,"bbUiIconLargeAttention");var H=s("Zy5h");const Q="ultra.directives.group.group-student-enrollment-asmt-banner";let K=class extends N.a{constructor(e,t,s,n,i){super(e,t,s,n,i),this.scope=e,this.contentService=t,this.currentUserService=s,this.localize=n,this.ultraState=i,this.showBanner=!1,this.showBanner=!0}async openContentEnrollPanel(){await this.ultraState.leavePeekState(),this.ultraState.goPeekState("content-group-enroll",{courseId:this.content.courseId,contentId:this.content.id,fromView:this.fromView})}};K=Object(r.__decorate)([Object(m.a)({moduleName:Q,componentName:"bbGroupStudentEnrollmentAsmtBanner",template:H,bindings:{content:"<",fromView:"@"},requireModules:[F.d,B.a,d.moduleName,q.b,V]}),Object(r.__param)(0,Object(h.b)("$scope")),Object(r.__param)(1,Object(h.b)(F.f)),Object(r.__param)(2,Object(h.b)(B.b)),Object(r.__param)(3,Object(h.b)(d.serviceName)),Object(r.__param)(4,Object(h.b)(q.d))],K);var W=s("vhkR"),J=s("u4ux"),Y=s("6mvz"),Z=s("p7NW"),X=s("ftvW"),ee=s("YHe3"),te=s("OvxF"),se=s("zjPK"),ne=s("/qpZ"),ie=s("0+Qs"),oe=s("lEL+"),ae=s("vDpp"),re=s("jcim"),ce=s("7eG8"),le=s("IaSh");const de="ultra.features.course.content.banners.bbPeerReviewHasBeenDeletedBanner",ue={Class:le.LocalizedPeerReviewHasBeenDeletedBanner,bindingNames:["assignAndNavigateToPeerReview","dismissBanner","hasEnoughSubmissionsForPeerAssessment","canRetrieveNewPeerReview"],renderLocalized:!0};n.module(de,[]).component("bbPeerReviewHasBeenDeletedBanner",Object(I.a)(ue));const pe="ultra.features.course.content.banners.bbTimeLimitOverriddenByDueDateBanner",me={Class:le.TimeLimitOverriddenByDueDateBanner,renderLocalized:!0};n.module(pe,[]).component("bbTimeLimitOverriddenByDueDateBanner",Object(I.a)(me));var he=s("2lxm");s.d(t,"moduleName",(function(){return be}));const be="ultra.features.course.content.assessmentOverview";n.module(be,[o.a,R,x.a,te.a,P.a,L.a,X.a,G.a,M.a,Q,N.b,W.a,J.b,b.a,ie.a,oe.a,ee.a,Z.f,Y.a,ne.a,se.a,ae.a,re.a,ce.a,de,pe,he.a]).controller(a.controllerName,a.Controller).controller(i.controllerName,i.Controller)},FH9J:function(e,t){e.exports='<div ng-switch="$ctrl.icon">\n  <bb-ui-icon-large-assignments ng-switch-when="assignment" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-assignments>\n  <bb-ui-icon-large-attendance ng-switch-when="attendance" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-attendance>\n  <bb-ui-icon-large-blog ng-switch-when="blog" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-blog>\n  <bb-ui-icon-large-calculation ng-switch-when="calculation" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-calculation>\n  <bb-ui-icon-large-discussion ng-switch-when="discussion" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-discussion>\n  <bb-ui-icon-large-document-blank ng-switch-when="document-blank" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-document-blank>\n  <bb-ui-icon-large-document-cloud ng-switch-when="document-cloud" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-document-cloud>\n  <bb-ui-icon-large-document-text ng-switch-when="document-text" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-document-text>\n  <bb-ui-icon-large-folder ng-switch-when="folder|folder-open" ng-switch-when-separator="|" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-folder>\n  <bb-ui-icon-large-homework ng-switch-when="homework" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-homework>\n  <bb-ui-icon-large-photo ng-switch-when="photo" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-photo>\n  <bb-ui-icon-large-journal ng-switch-when="journal" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-journal>\n  <bb-ui-icon-large-learning-module ng-switch-when="learning-module" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-learning-module>\n  <bb-ui-icon-large-link ng-switch-when="link" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-link>\n  <bb-ui-icon-large-lti ng-switch-when="lti" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-lti>\n  <bb-ui-icon-large-overall-grade ng-switch-when="overall-grade" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-overall-grade>\n  <bb-ui-icon-large-pdf ng-switch-when="pdf" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-pdf>\n  <bb-ui-icon-large-presentation ng-switch-when="presentation" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-presentation>\n  <bb-ui-icon-large-scormengine ng-switch-when="scormengine" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-scormengine>\n  <bb-ui-icon-large-spreadsheet ng-switch-when="spreadsheet" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-spreadsheet>\n  <bb-ui-icon-large-survey ng-switch-when="survey" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-survey>\n  <bb-ui-icon-large-test ng-switch-when="test|quiz|exam" ng-switch-when-separator="|" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-test>\n  <bb-ui-icon-large-textbook ng-switch-when="textbook" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-textbook>\n  <bb-ui-icon-large-video ng-switch-when="video" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-video>\n  <bb-ui-icon-large-audio ng-switch-when="audio" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-audio>\n  <bb-ui-icon-large-zip ng-switch-when="zip" color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-zip>\n  <bb-ui-icon-large-document-blank ng-switch-default color="{{$ctrl.color}}" title-access="{{$ctrl.titleAccess}}"></bb-ui-icon-large-document-blank>\n</div>\n'},FVIt:function(e,t){e.exports='<div class="attempt-review-container"\n  bb-load-bundle="components/directives/assessment/attempt-canvas">\n  <div class="attempt-question-review">\n    <h2 id="attemptGrading_assignmentContent_heading"\n        class="sr-only">\n      <bb-translate>components.directives.attempt-canvas.sections.assignment</bb-translate>\n    </h2>\n    <button class="accordion__button"\n            aria-controls="attemptGrading_assignmentContent_region"\n            ng-attr-aria-expanded="{{attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.AssignmentContent)}}"\n            ng-click="attemptCanvas.toggleAccordionRegions(attemptCanvas.attemptCanvasRegion.AssignmentContent)"\n            analytics-id="course.content.assessment.attempt.grading.section.assignment.button">\n      <span class="accordion__button__heading">\n        <bb-translate>components.directives.attempt-canvas.sections.assignment</bb-translate>\n      </span>\n      <span class="accordion__button__arrow accordion__button__arrow--active"\n            ng-class="{\'accordion__button__arrow--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.AssignmentContent)}">\n        <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon></span>\n    </button>\n    <div class="accordion__region"\n         id="attemptGrading_assignmentContent_region"\n         aria-labelledby="attemptGrading_assignmentContent_heading"\n         role="region"\n         ng-class="{\'accordion__region--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.AssignmentContent)}">\n      <ol class="question-list">\n        <li ng-repeat="gradedQuestionAttempt in (attemptCanvas.gradedQuestionAttempts | filter: { questionAttempt: { questionType: \'!pageBreak\' }}) track by $index">\n          <bb-assessment-question class="js-assessment-question-{{$index}}" attempt="attempt" graded-question-attempt="gradedQuestionAttempt" mode="attemptCanvas.ReviewMode()" index="$index"\n                                  is-small-breakpoint="attemptCanvas.isSmallBreakpoint"\n          >\n          </bb-assessment-question>\n        </li>\n      </ol>\n    </div>\n\n    <h2 id="attemptGrading_submissionContent_heading"\n        ng-if="::!!attemptCanvas.studentSubmission().rawText"\n        class="sr-only">\n      <bb-translate>components.directives.attempt-canvas.sections.submission</bb-translate>\n    </h2>\n    <button class="accordion__button"\n            aria-controls="attemptGrading_submissionContent_region"\n            ng-if="::!!attemptCanvas.studentSubmission().rawText"\n            ng-attr-aria-expanded="{{attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.SubmissionContent)}}"\n            ng-click="attemptCanvas.toggleAccordionRegions(attemptCanvas.attemptCanvasRegion.SubmissionContent)"\n            analytics-id="course.content.assessment.attempt.grading.section.submission.button">\n      <span class="accordion__button__heading">\n        <bb-translate>components.directives.attempt-canvas.sections.submission</bb-translate>\n      </span>\n      <span class="accordion__button__arrow accordion__button__arrow--active"\n            ng-class="{\'accordion__button__arrow--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.SubmissionContent)}">\n        <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon></span>\n    </button>\n    <div class="accordion__region"\n         id="attemptGrading_submissionContent_region"\n         ng-if="::!!attemptCanvas.studentSubmission().rawText"\n         aria-labelledby="attemptGrading_submissionContent_heading"\n         role="region"\n         ng-class="{\'accordion__region--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.SubmissionContent)}">\n      <div class="freeform-response">\n        <bb-freeform-response-editor\n          is-privileged="false"\n          expand-inline-files-on-load="true"\n          bbml="attemptCanvas.studentSubmission()">\n        </bb-freeform-response-editor>\n      </div>\n    </div>\n\n    <h2 id="attemptGrading_peerReviews_heading"\n        ng-if="::attemptCanvas.canShowPeerFeedbackByStudent"\n        class="sr-only">\n      <bb-translate ng-if="::!attemptCanvas.canModifyGradebook">\n        course.content.assessment.attempt.feedback.peerReview.self\n      </bb-translate>\n      <bb-translate ng-if="::attemptCanvas.canModifyGradebook"\n                    course-org-token-resolver>\n        course.content.assessment.attempt.feedback.peerReview.byStudent\n      </bb-translate>\n    </h2>\n    <button class="accordion__button"\n            ng-if="::attemptCanvas.canShowPeerFeedbackByStudent"\n            aria-controls="attemptGrading_peerReviews_region"\n            ng-attr-aria-expanded="{{attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.PeerReviews)}}"\n            ng-click="attemptCanvas.toggleAccordionRegions(attemptCanvas.attemptCanvasRegion.PeerReviews)"\n            analytics-id="course.content.assessment.attempt.grading.section.peerReviews.button">\n      <span class="accordion__button__heading">\n        <bb-translate ng-if="::!attemptCanvas.canModifyGradebook">\n            course.content.assessment.attempt.feedback.peerReview.self\n          </bb-translate>\n          <bb-translate ng-if="::attemptCanvas.canModifyGradebook"\n                        course-org-token-resolver>\n            course.content.assessment.attempt.feedback.peerReview.byStudent\n          </bb-translate>\n      </span>\n      <span class="accordion__button__arrow accordion__button__arrow--active"\n            ng-class="{\'accordion__button__arrow--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.PeerReviews)}">\n        <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon></span>\n    </button>\n    <div class="accordion__region"\n         id="attemptGrading_peerReviews_region"\n         ng-if="::attemptCanvas.canShowPeerFeedbackByStudent"\n         aria-labelledby="attemptGrading_peerReviews_heading"\n         role="region"\n         ng-class="{\'accordion__region--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.PeerReviews)}">\n      <bb-peer-feedback-by-student attempt="attempt"></bb-peer-feedback-by-student>\n    </div>\n  </div>\n</div>\n'},Fv8s:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="{{assessmentOverview.currentProctoringService ?\n            \'components.directives.confirmation-needed.title-x-bb-time-limit-assessment-attempt-proctored\'\n            : \'components.directives.confirmation-needed.title-x-bb-time-limit-assessment-attempt\'}}"\n          bb-focus="true"\n          analytics-id-tag-prefix="components.directives.confirmationNeeded">\n  <div name="modal-contents">\n    <p bb-translate="{{assessmentOverview.canContinue && !assessmentOverview.willDueDateOverrideTimeLimit ?\n                        \'components.directives.confirmation-needed.instructions-x-bb-time-limit-assessment-attempt-can-continue\'\n                        : \'components.directives.confirmation-needed.instructions-x-bb-time-limit-assessment-attempt\'}}"\n       translate-values="{\'totalTimeLimit\': assessmentOverview.startModalTranslateOptions.instructions.params.totalTimeLimit}">\n    </p>\n    <p bb-translate="components.directives.confirmation-needed.instructions-x-bb-time-limit-assessment-attempt-proctored"\n       ng-if="assessmentOverview.currentProctoringService">\n    </p>\n  </div>\n  <button name="modal-footer-button-primary"\n          class="button confirm-ok js-primary-button"\n          ng-click="assessmentOverview.closeModal(true)"\n          analytics-id="primary.button.okAction.button"\n          bb-translate="{{assessmentOverview.currentProctoringService ?\n            \'components.directives.confirmation-needed.ok-x-bb-time-limit-assessment-attempt-proctored\'\n            : \'components.directives.confirmation-needed.ok-x-bb-time-limit-assessment-attempt-can-continue\'}}">\n  </button>\n  <button name="modal-footer-button-secondary"\n          class="button button--secondary confirm-cancel js-secondary-button"\n          ng-click="assessmentOverview.closeModal(false)"\n          analytics-id="secondary.button.cancelAction.button"\n          bb-translate>\n    components.directives.confirmation-needed.cancel-x-bb-time-limit-assessment-attempt-can-continue\n  </button>\n</bb-modal>\n'},GCTi:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"d",(function(){return o})),s.d(t,"a",(function(){return a})),s.d(t,"c",(function(){return r}));var n=s("zGdY");function i(e,t){return e===n.AssessmentFeedbackMode.OnSpecifiedDate&&t===n.AssessmentFeedbackMode.AfterDueDate}function o(e,t){return e===n.AssessmentFeedbackMode.OnSpecifiedDate&&t===n.AssessmentFeedbackMode.AfterDueDate}function a(e,t){return e===n.AssessmentFeedbackMode.AfterDueDate&&t===n.AssessmentFeedbackMode.OnSpecifiedDate}function r(e,t){return o(e,t)||a(e,t)}},GiMb:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("KPeV");const o="ultra.components.directives.bbUiIcon.small.DownloadFile";Object(n.a)(i.a,o,"bbUiIconSmallDownloadFile")},GkCm:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-main-menu",use:"icon-small-main-menu-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-main-menu"><path d="M1 3h14M15 8H1M1 13h14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},GwhK:function(e,t){e.exports='<div class="typeahead-search" bb-click-outside="typeaheadSearchBox.onClickOutside()" is-active="true" bb-load-bundle="components/directives/typeahead">\n  <label for="typeahead-search-box-{{::typeaheadSearchBox.randomElementId}}">\n    <bb-svg-icon ng-if="::typeaheadSearchBox.icon" icon="{{::typeaheadSearchBox.icon}}" size="small" class="magnifying-glass"></bb-svg-icon>\n    <span ng-if="::typeaheadSearchBox.srLabel" class="sr-only" bb-translate="{{::typeaheadSearchBox.srLabel}}"></span>\n  </label>\n  <input aria-describedby="requiredPrompt" type="text" id="typeahead-search-box-{{::typeaheadSearchBox.randomElementId}}"\n         ng-model="typeaheadSearchBox.searchValue"\n         ng-model-options="{ debounce: 250 }"\n         role="combobox"\n         aria-activedescendant="typeahead-result-{{::typeaheadSearchBox.randomElementId}}-0"\n         aria-autocomplete="list"\n         aria-owns="typeahead-search-autocomplete"\n         name="typeaheadSearchBox"\n         autocomplete="off"\n         ng-keydown="typeaheadSearchBox.onInputBoxKeyDown($event)"\n         ng-click="typeaheadSearchBox.onInputBoxClick($event)"\n         ng-change="typeaheadSearchBox.onSearchValueChange()"\n         ng-focus="typeaheadSearchBox.onFocusInputBox($event)"\n         bb-translate-attrs="{\'placeholder\': \'{{typeaheadSearchBox.inputPlaceholder}}\'}"\n         class="truncated"\n         ng-class="{\'not-empty with-clear-btn\': typeaheadSearchBox.searchValue, \'empty\': !typeaheadSearchBox.searchValue,\n                    \'with-icon\': typeaheadSearchBox.icon, \'is-active\': typeaheadSearchBox.isFocus}"\n         analytics-id="components.directives.typeheadSearchBox.input.text"/>\n    <button class="typeahead-clear-button" bb-translate-attrs="{\'aria-label\': \'{{typeaheadSearchBox.clearAriaLabel}}\'}"\n            tabindex="0"\n            ng-show="typeaheadSearchBox.searchValue"\n            ng-click="typeaheadSearchBox.clear()"\n            ng-focus="typeaheadSearchBox.onFocusClearBtn($event)"\n            ng-blur="typeaheadSearchBox.onBlurClearBtn($event)"\n            analytics-id="components.directives.typeheadSearchBox.clearAriaLabel.button">\n      <bb-svg-icon size="small" icon="close"></bb-svg-icon>\n    </button>\n  <span id="requiredPrompt" class="sr-only" bb-translate="{{::typeaheadSearchBox.srEmptyResults}}"></span>\n  <div id="typeahead-search-autocomplete" class="typeahead-search-autocomplete adding"\n       ng-if="typeaheadSearchBox.showResults"\n       role="listbox"\n       tabindex="-1">\n    <div class="typeahead-search-entry" ng-repeat="item in typeaheadSearchBox.searchResults"\n         role="option"\n         tabindex="-1"\n         id="typeahead-result-{{::typeaheadSearchBox.randomElementId}}-{{$index}}"\n         ng-keydown="typeaheadSearchBox.onResultEntryKeyDown($event, item)"\n         ng-click="typeaheadSearchBox.onResultEntryClick($event, item)"\n         analytics-id="components.directives.typeheadSearchBox.onResultEntryClick">\n      <typeahead-inject></typeahead-inject>\n    </div>\n  </div>\n</div>'},"H/8/":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-peer-review",use:"icon-medium-peer-review-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-peer-review"><path d="M1 23c1.096-4.3157 4.5473-7 9-7M10 16c2.7614 0 5-2.2386 5-5s-2.2386-5-5-5-5 2.2386-5 5 2.2386 5 5 5zM18.5 8C20.433 8 22 6.433 22 4.5S20.433 1 18.5 1 15 2.567 15 4.5 16.567 8 18.5 8zM18.5 8c1.3031 0 2.7189.8549 3.6122 2M15 20l3 3 5-8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"H/mg":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("Llzl"),i=s("ERkP"),o=s("1ZbL"),a=s("Dz4E");const r="ultra.components.directives.react-toolkit.contextual-menu";class c extends i.Component{render(){return this.props.show?i.createElement(a.ContextualMenu,{items:this.props.items,directionalHint:this.props.directionalHint,target:document.getElementById(this.props.targetId),onDismiss:this.props.dismiss,labelElementId:this.props.ariaLabelledby,analyticsId:this.props.analyticsId}):null}}const l={Class:c,bindingNames:["items","targetId","show","dismiss","directionalHint"],attributes:["ariaLabelledby","analyticsId"]};n.module(r,[]).component("bbUiContextualMenu",Object(o.a)(l))},H9hP:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("ULah");const o="ultra.components.directives.bbUiIcon.small.Complete";Object(n.a)(i.a,o,"bbUiIconSmallComplete")},HApu:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-rubric",use:"icon-medium-rubric-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-rubric"><path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M19 5h4v4h-4zM11 5h4v4h-4zM19 12h4v4h-4zM11 12h4v4h-4zM19 19h4v4h-4zM11 19h4v4h-4zM19 1h4M11 1h4M1 8h4M1 15h4M1 22h4M1 5h6M1 12h6M1 19h6" /></symbol>'});i.add(o);e.exports=o},HE6t:function(e,t){e.exports='<div ng-if="$ctrl.isInitialized && $ctrl.isPeerGrading" class="content-item-peer-assessment">\n  <div ng-if="$ctrl.isPeerGradingConfigured" class="peer-review-due-date">\n    <bb-svg-icon size="small" icon="peer-review"></bb-svg-icon>\n    <span bb-translate class="content-peer-review-due-date-label"\n          translate-values="{ peerReviewsNumber: $ctrl.peerReviewsPerStudent, datetime: $ctrl.peerReviewDueDate }">\n        components.directives.content-item-base.peer-review-due-date\n      </span>\n    <div ng-if="::$ctrl.contextCourseMembership.isStudentMembership()" class="tooltip-container">\n      <bb-ui-content-item-peer-assessment-tooltip tooltip-title="::$ctrl.getTooltipMessage()">\n      </bb-ui-content-item-peer-assessment-tooltip>\n    </div>\n  </div>\n</div>\n'},HF29:function(e,t){e.exports='<div class="attempt-grading-container"\n  bb-load-bundle="components/directives/assessment/attempt-canvas">\n  <div class="attempt-question-review">\n    <h2 id="attemptGrading_assignmentContent_heading"\n        class="sr-only">\n      <bb-translate>components.directives.attempt-canvas.sections.assignment</bb-translate>\n    </h2>\n    <button class="accordion__button"\n            aria-controls="attemptGrading_assignmentContent_region"\n            ng-attr-aria-expanded="{{attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.AssignmentContent)}}"\n            ng-click="attemptCanvas.toggleAccordionRegions(attemptCanvas.attemptCanvasRegion.AssignmentContent)"\n            analytics-id="course.content.assessment.attempt.grading.section.assignment.button">\n    <span class="accordion__button__heading">\n      <bb-translate>components.directives.attempt-canvas.sections.assignment</bb-translate>\n    </span>\n      <span class="accordion__button__arrow"\n            ng-class="{\'accordion__button__arrow--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.AssignmentContent)}">\n      <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon></span>\n    </button>\n    <div class="accordion__region"\n         id="attemptGrading_assignmentContent_region"\n         aria-labelledby="attemptGrading_assignmentContent_heading"\n         role="region"\n         ng-class="{\'accordion__region--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.AssignmentContent)}">\n      <ol ng-if="::!attemptCanvas.isPeerReviewer"\n          class="question-list js-graded-question-list">\n        <li ng-repeat="gradedQuestionAttempt in (attemptCanvas.gradedQuestionAttempts | filter: { questionAttempt: { questionType: \'!pageBreak\' } }) track by $index">\n          <bb-assessment-question class="js-assessment-question-{{$index}}"\n                                  attempt="attempt"\n                                  graded-question-attempt="gradedQuestionAttempt"\n                                  mode="attemptCanvas.GradingMode()"\n                                  index="$index"\n                                  assessment-id="attemptCanvas.assessmentId"\n                                  content-id="attemptCanvas.content.id"\n                                  is-any-question-editing="isAnyQuestionEditing"\n                                  is-small-breakpoint="attemptCanvas.isSmallBreakpoint"\n          >\n          </bb-assessment-question>\n        </li>\n      </ol>\n      <ol ng-if="::attemptCanvas.isPeerReviewer"\n          class="question-list js-non-graded-question-list">\n        <li ng-repeat="questionAttempt in attemptCanvas.toolAttemptDetail.questionAttempts track by $index">\n          <bb-assessment-question question-attempt="questionAttempt"\n                                  mode="attemptCanvas.AttemptMode()"\n                                  index="$index"\n          >\n          </bb-assessment-question>\n        </li>\n      </ol>\n    </div>\n\n    <h2 id="attemptGrading_submissionContent_heading"\n        ng-if="::!!attemptCanvas.studentSubmission().rawText"\n        class="sr-only">\n      <bb-translate>components.directives.attempt-canvas.sections.submission</bb-translate>\n    </h2>\n    <button class="accordion__button"\n            aria-controls="attemptGrading_submissionContent_region"\n            ng-if="::!!attemptCanvas.studentSubmission().rawText"\n            ng-attr-aria-expanded="{{attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.SubmissionContent)}}"\n            ng-click="attemptCanvas.toggleAccordionRegions(attemptCanvas.attemptCanvasRegion.SubmissionContent)"\n            analytics-id="course.content.assessment.attempt.grading.section.submission.button">\n    <span class="accordion__button__heading">\n      <bb-translate>components.directives.attempt-canvas.sections.submission</bb-translate>\n    </span>\n      <span class="accordion__button__arrow"\n            ng-class="{\'accordion__button__arrow--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.SubmissionContent)}">\n      <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon></span>\n    </button>\n    <div class="accordion__region"\n         id="attemptGrading_submissionContent_region"\n         ng-if="::!!attemptCanvas.studentSubmission().rawText"\n         aria-labelledby="attemptGrading_submissionContent_heading"\n         role="region"\n         ng-class="{\'accordion__region--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.SubmissionContent)}">\n      <div class="freeform-response">\n        <bb-freeform-response-editor\n          is-privileged="false"\n          expand-inline-files-on-load="true"\n          bbml="attemptCanvas.studentSubmission()">\n        </bb-freeform-response-editor>\n      </div>\n    </div>\n\n    <h2 id="attemptGrading_peerReviews_heading"\n        ng-if="::attemptCanvas.canShowPeerFeedbackByStudent"\n        class="sr-only">\n      <bb-translate ng-if="::!attemptCanvas.canModifyGradebook">\n        course.content.assessment.attempt.feedback.peerReview.self\n      </bb-translate>\n      <bb-translate ng-if="::attemptCanvas.canModifyGradebook"\n                    course-org-token-resolver>\n        course.content.assessment.attempt.feedback.peerReview.byStudent\n      </bb-translate>\n    </h2>\n    <button class="accordion__button"\n            ng-if="::attemptCanvas.canShowPeerFeedbackByStudent"\n            aria-controls="attemptGrading_peerReviews_region"\n            ng-attr-aria-expanded="{{attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.PeerReviews)}}"\n            ng-click="attemptCanvas.toggleAccordionRegions(attemptCanvas.attemptCanvasRegion.PeerReviews)"\n            analytics-id="course.content.assessment.attempt.grading.section.peerReviews.button">\n      <span class="accordion__button__heading">\n        <bb-translate ng-if="::!attemptCanvas.canModifyGradebook">\n            course.content.assessment.attempt.feedback.peerReview.self\n          </bb-translate>\n          <bb-translate ng-if="::attemptCanvas.canModifyGradebook"\n                        course-org-token-resolver>\n            course.content.assessment.attempt.feedback.peerReview.byStudent\n          </bb-translate>\n      </span>\n      <span class="accordion__button__arrow accordion__button__arrow--active"\n            ng-class="{\'accordion__button__arrow--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.PeerReviews)}">\n        <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon></span>\n    </button>\n    <div class="accordion__region"\n         id="attemptGrading_peerReviews_region"\n         ng-if="::attemptCanvas.canShowPeerFeedbackByStudent"\n         aria-labelledby="attemptGrading_peerReviews_heading"\n         role="region"\n         ng-class="{\'accordion__region--active\': attemptCanvas.isAccordionRegionActive(attemptCanvas.attemptCanvasRegion.PeerReviews)}">\n      <bb-peer-feedback-by-student attempt="attempt"></bb-peer-feedback-by-student>\n    </div>\n  </div>\n</div>\n'},HjsN:function(e,t,s){"use strict";var n=s("D57K"),i=s("dCrD"),o=s("Oyr+"),a=s("aHpC");s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return c}));const r="allCloudUploadsCompleteEvent";let c=class extends i.a{constructor(e,t,s){super(e,t,s),this.cloudUploadPromises=[],this.onFilesSelectedHandler=e=>{const t=[];e.forEach((e=>{const s={id:e.id,deferred:this.$q.defer()};t.push(s.deferred),this.cloudUploadPromises.push(s)})),this.$q.all(t.map((e=>e.promise))).then((()=>{this.scope.$emit(r)}),(e=>{this.scope.$emit(r,e)}))},this.resolveFileUploadDeferred=(e,t)=>{const s=this.cloudUploadPromises.findIndex((t=>t.id===e));return s>=0&&(t?this.cloudUploadPromises[s].deferred.reject(t):this.cloudUploadPromises[s].deferred.resolve(),this.cloudUploadPromises.splice(s,1),!0)},this.cloudUploadAttachHandler=(e,t,s,n)=>{const i=this.scope.attachHandler||this.defaultAttachHandler,o=this.$q.defer();return i(e,t,s,n).then((()=>{this.resolveFileUploadDeferred(t.ui.fileId)&&o.resolve()})),o.promise},t.$on(o.e,((e,t,s,n,i)=>{n===o.c.Error?this.resolveFileUploadDeferred(t,"failed"):n===o.c.Cancel&&this.resolveFileUploadDeferred(t)}))}};c.$inject=[],c=Object(n.__decorate)([Object(n.__param)(0,Object(a.b)("$injector")),Object(n.__param)(1,Object(a.b)("scope")),Object(n.__param)(2,Object(a.b)("element"))],c)},HwkA:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-custom-toggle-table",use:"icon-custom-toggle-table-usage",viewBox:"0 0 12 12",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" id="icon-custom-toggle-table"><path fill="none" stroke-width="2" stroke-miterlimit="10" d="M0 1h12M0 6h12M0 11h12" /></symbol>'});i.add(o);e.exports=o},I5V3:function(e,t){e.exports='<div class="multiple-answer-attempt-review multiple-answer">\n  <div class="multiple-answer-question">\n    <bb-rich-text-editor\n      plugin-options="editorPluginOptions"\n      ng-model="assessmentQuestion.questionAttempt.question.questionText.rawText"\n      supports-inline-document-render="true"\n      is-read-only="true">\n    </bb-rich-text-editor>\n  </div>\n\n  <bb-question-answer-status\n    correctness="::assessmentQuestion.getAnswerResult()"\n    was-late="::assessmentQuestion.wasAnsweredLate()"\n    hide-correctness-text="!assessmentQuestion.canShowCorrectAnswerRelatedDetail() || !assessmentQuestion.viewHelper.isOnlyPartialCredit()"\n    class="multiple-answer-question-answer {{!assessmentQuestion.canShowQuestionScoreRelatedDetail()?\'multiple-answer-attempt-review__question-correctness\':\'\'}}">\n    <div ng-bind-html="::assessmentQuestion.viewHelper.formattedAnswerString"></div>\n  </bb-question-answer-status>\n  <div class="toggle-answer-options-container" ng-if="assessmentQuestion.canShowQuestionScoreRelatedDetail()">\n    <button class="toggle-answer-options" ng-click="assessmentQuestion.viewHelper.toggleAnswerOptions()" analytics-id="assessment.question.answer.options.toggle.button">\n      <ng-switch on="assessmentQuestion.viewHelper.hideAnswerOptions">\n        <span ng-switch-when="false" bb-translate>components.directives.assessment-question.multiple-answer.review.hide-options</span>\n        <span ng-switch-default bb-translate>components.directives.assessment-question.multiple-answer.review.show-options</span>\n        <bb-svg-icon size="custom" icon="arrow-up" class="hide-options-arrow" ng-class="{\'rotate-arrow\': assessmentQuestion.viewHelper.hideAnswerOptions}"></bb-svg-icon>\n      </ng-switch>\n    </button>\n  </div>\n\n  <div class="multiple-answer-answers-container" ng-show="assessmentQuestion.showAnswerOptions()">\n    <ol class="multiple-answer-answers" ng-class="{\'multiple-answers-graded-review\': assessmentQuestion.canShowCorrectAnswerRelatedDetail()}">\n      <li ng-repeat="answer in assessmentQuestion.questionAttempt.question.answers track by $index"\n          class="js-answer-{{$index}} {{::assessmentQuestion.getAnswerChoiceStyles($index)}}">\n        <input type="checkbox"\n               id="{{assessmentQuestion.elementId}}-answer-{{$index}}"\n               name="{{assessmentQuestion.elementId}}-answer-{{$index}}"\n               ng-model="assessmentQuestion.questionAttempt.givenAnswer[$index]"\n               disabled\n               analytics-id="assessment.question.attempt.givenAnswer.input.checkbox"/>\n        <label for="{{assessmentQuestion.elementId}}-answer-{{$index}}" class="checkbox-label">\n          <span ng-if="assessmentQuestion.viewHelper.showIncorrectIndicator($index)"\n                class="correctness-label" bb-translate>\n            components.directives.assessment-question.multiple-answer.incorrect-label\n          </span>\n          <bb-rich-text-editor\n              plugin-options="{\'attachment\': true, \'math\': true, \'contentMarket\': true}"\n              ng-model="answer.answerText.rawText"\n              is-read-only="true">\n          </bb-rich-text-editor>\n        </label>\n        <span class="correct-answer-text" ng-if="answer.correctAnswer && assessmentQuestion.canShowCorrectAnswerRelatedDetail()" bb-translate>components.directives.assessment-question.multiple-answer.correct-label</span>\n      </li>\n    </ol>\n  </div>\n  <bb-automated-question-feedback\n    feedback="assessmentQuestion.getAutomatedQuestionFeedback()"\n    is-collapsible="assessmentQuestion.allowCollapsingOfAutomatedFeedbackIfShown()"\n    editor-plugins-options="automatedFeedbackEditorPluginOptions"\n  />\n</div>\n'},IHOP:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return a}));var n=s("yC9S");const i="delegated-grader-assigned";function o(e,t){return e.$emit(i,t.delegatedGraders)}function a(e,t){return n.b.OnScope(e,i,t)}},IWgv:function(e,t,s){"use strict";var n=s("Llzl"),i=s("pjml"),o=s("0JpG"),a=s("mCEN"),r=s("bMxM"),c=s("TnpK"),l=s("66CP"),d=s("Q/M7");s.d(t,"a",(function(){return u}));const u="ultra.components.directives.content.contentItemIcon";class p{constructor(e,t,s,n,o,a,r){this.scope=e,this.$q=t,this.element=s,this.bbLocalize=n,this.contentIconService=o,this.ColumnModel=a,this.$state=r,this.iconName="document-blank",this.iconColor="primary",this.iconNameForLocalization="document-blank";let c,l=[];const u=i.p.ContentHandler,p=e.$watch((()=>e.contentColumn),(()=>{var t,s;const n=e.bbContentItemIcon&&e.bbContentItemIcon.contentHandler&&e.bbContentItemIcon.contentHandler.toString();if(n)switch(n){case u.LtiLink.toString():(null===(s=null===(t=this.scope.bbContentItemIcon.contentDetail)||void 0===t?void 0:t["resource/x-bb-blti-link"])||void 0===s?void 0:s.customIconUrl)&&(this.customLtiIcon=d.c(this.scope.bbContentItemIcon.contentDetail["resource/x-bb-blti-link"].customIconUrl)),c="bbContentItemIcon",l=["showAlertIcon"];break;case u.CourseLink.toString():if(e.bbContentItemIcon.contentDetail){const t=this.scope.$watch((()=>e.bbContentItemIcon.id),(s=>{s&&(e.bbContentItemIcon.getLinkContentSource().$then((e=>{this.contentIconService.getIconClass(e).then((e=>{e&&(this.iconColor=this.scope.showAlertIcon?"error":"primary",this.iconName=this.contentIconService.getIconName(e),this.iconNameForLocalization=this.contentIconService.getIconNameForLocalization(this.iconName))}))})),t())}))}else this.iconColor=this.scope.showAlertIcon?"error":"primary",this.iconName=this.contentIconService.getIconName(e.bbContentItemIcon.getContentHandlerByIconUrl().iconClass),this.iconNameForLocalization=this.contentIconService.getIconNameForLocalization(this.iconName);break;case u.RusticiScorm.toString():c="bbContentItemIcon",l=[`${c}.contentDetail['${n}'].gradebookItems[0].gradingColumn.gradebookCategory.id`];break;default:c="bbContentItemIcon",l=[c+".contentHandler",c+".ui.isOpen",c+".contentDetail['"+u.File.toString()+"'].file.mimeType",c+".contentDetail['"+u.TestLink.toString()+"'].test.gradingColumn.gradebookCategory.id",c+".contentDetail['"+u.TestLink.toString()+"'].assignment.gradingColumn.gradebookCategory.id"]}else e.contentColumn&&(c="contentColumn",l=[c+".scoreProviderHandle",c+".calculationType",c+".externalGrade",c+".visible",c+".summary.numStudentsGraded()",c+".summary.numStudentSubmissions()",c+".categoryTitle",c+".dueDate"]);const i=e.$watchGroup(l,(()=>{const t=e[c];if(t){let e;e=t instanceof this.ColumnModel?this.contentIconService.getColumnIconClass(t):this.contentIconService.getIconClass(t),e.then((e=>{e&&(this.iconColor=this.scope.showAlertIcon?"error":"primary",this.iconName=this.contentIconService.getIconName(e),this.iconNameForLocalization=this.contentIconService.getIconNameForLocalization(this.iconName));const s=u.Folder.isEqualTo(t.contentHandler),n=u.Unknown.isEqualTo(t.contentHandler),o=u.File.isEqualTo(t.contentHandler),r=u.LtiLink.isEqualTo(t.contentHandler),c=u.RusticiScorm.isEqualTo(t.contentHandler),l=u.TestLink.isEqualTo(t.contentHandler);s||n||t instanceof a||o||r||c||l||i(),p()}))}}))}))}}p.$inject=["scope","$q","element",o.serviceName,r.b,i.C.serviceName,c.d];class m{constructor(e){this.$injector=e,this.restrict="A",this.template=l,this.scope={bbContentItemIcon:"=",contentColumn:"=",showAlertIcon:"="},this.link=(e,t)=>{e.contentItemIcon=this.$injector.instantiate(p,{scope:e,element:t})}}}m.$inject=["$injector"],n.module(u,[a.a,r.a,c.b]).directive("bbContentItemIcon",["$injector",e=>e.instantiate(m)])},IgL1:function(e,t){e.exports='<button bb-complex-tooltip=""\n  enhanced-tooltip="true"\n  tooltip-position="top-center"\n  tooltip-disable-on-mouse-over="false"\n  tooltip-enable-on-mouse-leave-for-all-breakpoints="true"\n  tooltip-enable-on-mouse-over-for-all-breakpoints="true"\n  tooltip-scope="buttonComplexTooltip.$scope"\n  tooltip-template="{{ buttonComplexTooltip.getToolTipTemplate() }}"\n  tooltip-open-on-activation="true"\n  tooltip-auto-update="true"\n  tooltip-always-underline="false"\n  analytics-id="components.directives.content-item-base.conditionalRelease.date.link"\n  tooltip-center-content="true"\n  title="components.directives.grade.grader-column.statuses.restricted">\n  <bb-svg-icon size="small" icon="information" status="default"></bb-svg-icon>\n</button>\n'},IiJs:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return a}));var n=s("Llzl"),i=s("pjml");const o="ultra.services.collabUltra",a="collabUltra";class r{constructor(e,t,s,n,i,o,a){this.$q=e,this.$compile=t,this.$rootScope=s,this.$timeout=n,this.CourseModel=i,this.CollabUltraModel=o,this.$sce=a}getCollabB2Info(){return this.collabB2InfoPromise=this.collabB2InfoPromise||this.CollabUltraModel.$build().getCollabUltraInfo()}getAllCollabSessions(e){return this.CourseModel.$new(e).collabUltra.getAllCollabSessions()}enableCourseRoom(e,t){return this.CourseModel.$new(e).collabUltra.enableCourseRoom(t)}disableCourseRoom(e,t){return this.CourseModel.$new(e).collabUltra.disableCourseRoom(t)}getLaunchUrl(e,t){return this.CourseModel.$new(e).collabUltra.sessions.$new(t).getLaunchUrl()}getCourseCollab(e){return this.CourseModel.$new(e).collabUltra.getCourseCollabInfo()}launchDiscussionSession(e,t,s){return this.CourseModel.$new(e).collabUltra.launchDiscussionSession(t,s)}getCollabSessionStatus(e,t){return this.getCollabB2Info().then((t=>200===t.$response.status?this.CourseModel.$new(e).collabUltra.sessions.$fetch().$allow([403,500,504]).$asPromise():this.$q.reject())).then((s=>200===s.$response.status?this.CourseModel.$new(e).groups.$new(t).collabSession.$fetch({expand:"sessionInstances"}).$allow(["400-599"]).$asPromise().then((e=>e.filter((e=>e.sessionInstances&&e.sessionInstances.length>0)).length>0)):this.$q.when(null)),(()=>this.$q.when(null)))}}r.$inject=["$q","$compile","$rootScope","$timeout",i.m.serviceName,i.j.serviceName,"$sce"];n.module(o,[i.N]).service(a,r)},IjED:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return a}));var n=s("nsO7"),i=s("TnpK");const o="ultra.services.slideoutPanel",a="slideoutPanel";var r;!function(e){e.RubricEvaluation="rubric-evaluation",e.RubricView="rubric-view",e.AssessmentSubmissionFeedback="assessment-submission-feedback",e.DiscussionFeedback="discussion-feedback"}(r||(r={}));class c{constructor(e){this.ultraState=e,this.slideoutPanelIsOpen=!1,this.getMostRecentPanelState=e=>e.split(".").pop(),this.isPanelClosing=(e,t)=>this._doesStateRequireSlidePanel(this.getMostRecentPanelState(e))&&!this._doesStateRequireSlidePanel(this.getMostRecentPanelState(t)),this.setSlideoutPanelState=()=>{this.slideoutPanelIsOpen=this._doesStateRequireSlidePanel(this.getMostRecentPanelState(this.ultraState.current.name))},this.isOpen=()=>(this.setSlideoutPanelState(),this.slideoutPanelIsOpen),this.setSlideoutPanelState()}isRubricState(){return this.getMostRecentPanelState(this.ultraState.current.name)===r.RubricEvaluation||this.getMostRecentPanelState(this.ultraState.current.name)===r.RubricView}_doesStateRequireSlidePanel(e){return n.some(Object.values(r),(t=>e===t))}}c.$inject=[i.d];angular.module(o,[]).service(a,c)},J3aO:function(e,t,s){"use strict";(function(e){s.d(t,"b",(function(){return a})),s.d(t,"a",(function(){return r}));var n=s("D57K"),i=s("VAMW"),o=s("aHpC");const a="menuCloserService",r="ultra.services.menuCloser";class c{constructor(e){this.service=e,this.key=i.TransitService.AngularMenuCloserService}closeAnyOpenAngularMenus(){this.service.closeAnyOpenAngularMenus()}}let l=class{constructor(e){this.$rootScope=e,Object(i.registerService)(new c(this))}closeAnyOpenAngularMenus(){const t=e(".f-open-dropdown");t.length>0&&window.Foundation.libs.dropdown.close(t),this.$rootScope.$broadcast("foundation-offcanvas-close-panel")}};l=Object(n.__decorate)([Object(n.__param)(0,Object(o.b)("$rootScope"))],l);angular.module(r,[]).service(a,l)}).call(this,s("71td"))},J8YL:function(e,t){e.exports='<div class="discussion-assignment">\n  <button class="button-add-content js-show-add-options" data-show-add-options ng-click="addContentButton.toggleMenu()"\n     ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n     aria-expanded="{{addContentButton.isMenuVisible}}" aria-controls="{{::\'add-content-menu-\' + addMenuId}}"\n     aria-label="{{addContentButton.addButtonAriaLabel}}"\n     ng-focus="addContentButton.showButton()" ng-blur="addContentButton.hideButton()"\n     analytics-id="components.directives.add-content-button.assignment.button">\n  </button>\n  \x3c!-- use ng-show to keep the element when close add buttons, make sure the upload directive handlers will not be lost --\x3e\n  <ul role="menu" class="element-list-add-menu outline-menu angular-animate"\n      aria-expanded="{{addContentButton.isMenuVisible}}"\n      ng-attr-id="{{\'add-content-menu-\' + addMenuId}}"\n      ng-if="::addContentButton.isMenuVisible || undefined"\n      ng-show="addContentButton.isMenuVisible">\n    <li>\n      <bb-file-upload\n        url="/v1/files"\n        data="{}"\n        allow-multiple="true"\n        monitor-leave="true"\n        disable-drag="disableDrag && disableDrag()"\n        target-div="{{\'#\' + fileListViewId}}"\n        hide-transclude-during-upload="false"\n        is-third-party-upload="false"\n        disallow-folder-uploads="true"\n        skip-zip-file-check="true"\n        ignored-states="::ignoredStates()"\n        position="positionBefore ? positionBefore() : positionAfter && positionAfter() + 1">\n        <a href="javascript:void(0);"\n           role="menuitem"\n           bb-translate-attrs="{\'aria-label\':\'course.content.buildContentArea.addFiles\'}"\n           ng-click="addContentButton.toggleMenu()"\n           analytics-id="components.directives.add-content-button.assignment.fileUpload.link" >\n          <bb-svg-icon size="small" icon="upload"></bb-svg-icon><span bb-translate analytics-id="course.content.buildContentArea.addFiles">course.content.buildContentArea.addFiles</span>\n        </a>\n      </bb-file-upload>\n    </li>\n    <li ng-if="!addContentButton.isMobile">\n      \x3c!-- Skip zip file check, assignment does not support unzip file(LRN-101238) --\x3e\n      <bb-file-upload allow-multiple="true" monitor-leave="true" is-third-party-upload="true"  hide-transclude-during-upload="false" skip-zip-file-check="true"\n                      click-enabled="false" primary-key="fileListViewId" disable-drag="disableDrag && disableDrag()"\n                      third-party-download-handler="addContentButton.downloadFile" target-div="{{\'#\' + fileListViewId}}"\n                      position="positionBefore ? positionBefore() : positionAfter && positionAfter() + 1">\n        <a href="javascript:void(0);"\n           role="menuitem"\n           primary-key="fileListViewId"\n           is-flatten="false"\n           attach-handler="attachHandler || addContentButton.defaultAttachHandler"\n           ignored-states="::ignoredStates()"\n           bb-translate-attrs="{\'aria-label\':\'components.directives.add-content-button.aria-label.content.oneDrive\'}"\n           ng-click="addContentButton.toggleMenu()"\n           analytics-id="components.directives.add-content-button.assignment.oneDrive.link">\n          <div>\n            <i class="icon-cloud"></i><span bb-translate>components.directives.add-content-button.oneDrive</span>\n          </div>\n        </a>\n      </bb-file-upload>\n    </li>\n  </ul>\n</div>\n'},JuBR:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));var n=s("mrqE");function i(e){Object(n.a)(1,arguments);var t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new Date(e.getTime()):"number"==typeof e||"[object Number]"===t?new Date(e):("string"!=typeof e&&"[object String]"!==t||"undefined"==typeof console||(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://git.io/fjule"),console.warn((new Error).stack)),new Date(NaN))}},JuVx:function(e,t,s){"use strict";s.d(t,"a",(function(){return S}));var n=s("D57K"),i=s("ZQFV"),o=s("jhBu"),a=s("oi1r"),r=s("nsO7"),c=s("C2vp"),l=s("cbVV"),d=s("qH3X"),u=s("o5Lu"),p=s("yC9S"),m=s("aHpC"),h=s("Sa5G"),b=s("vYaK"),g=s("Qbdf"),v=s("zGdY"),f=s("IbyE");class w{constructor(e,t){this.cells=e,this.metadata=t}isCellExisting(e){return this.isCellExistingByColumnId(e.column.id)}isCellExistingByColumnId(e){return!r.isUndefined(this.cells[e])}insertDataCell(e){this.isCellExisting(e)||(this.cells[e.column.id]=e)}deleteDataCellByColumnId(e){this.isCellExistingByColumnId(e)&&delete this.cells[e]}}let S=class e{constructor(e,t,s,n,i,o,a,r){this.$rootScope=e,this.$injector=t,this.$q=s,this.CourseModel=n,this.entitlementService=i,this.schemaService=o,this.currentCourse=a,this.gradeGridRebornDirectiveScope=r,this._canViewGrades=!1,this.gradeSchemaBySchemaId={},this.dataRowsByMembershipId={},this.columns=[],this.assignedGroupByGradeColumnId={},this.allGroupMemberships=[],this.userIdsByGroupId={},this.requestQueue=[],this.canViewGroups=!1,this.MAX_SUMMARY_REQUEST_SIZE=1e3,p.b.OnRootScope(this.$rootScope,u.a,((e,t)=>{const s=this.getColumnMetadatas().find((e=>e.id===t));s&&this.$rootScope.$broadcast(u.c,s)})),this.deferredInit=this.$q.defer(),this.initialized=this.deferredInit.promise;const c=r.$watchCollection("columnMetadatas",(e=>{e&&(this.initialize(this.currentCourse.course,e),c())}))}get canViewGrades(){return this._canViewGrades}get course(){return this._course}getSchema(){return this.gradeSchemaBySchemaId}getColumnIdGroupsMap(){return this.assignedGroupByGradeColumnId}getAllGroupMemberships(){return this.allGroupMemberships}getGroupIdUserIdMap(){return this.userIdsByGroupId}initializeSchemas(e){this.gradeSchemaBySchemaId={},e.forEach((e=>{this.gradeSchemaBySchemaId[e.id]=e}))}initialize(e,t){this._course=e,this.courseId=e.id,this.columnMetadatas=t;const s=this.entitlementService.hasCourseEntitlement(h.n.ViewGroups,this.courseId).then((e=>(this.canViewGroups=e,this.canViewGroups?this.initializeGroupsMemberships():this.$q.resolve(!1)))),n=this.entitlementService.hasAnyCourseEntitlement([i.GradebookEntitlement.ViewGrades,i.GradebookEntitlement.ViewGrades],e.id).then((e=>(this._canViewGrades=e,e))),o=this.loadSchemas(this.courseId).then((e=>{this.initializeSchemas(e)})),a=this.fetchMemberships({}).then((e=>{this.dataRowsByMembershipId={},this.insertRows(e);let t=!1;this.columns=this.getColumnMetadatas().map((e=>(e.externalGrade&&(t=e.externalGrade),this.insertColumnByMetadata(e))));const s=this.createStudentColumn(t);return this.insertColumn(s,!0),{memberships:e,columns:this.columns}}));return this.$q.all([a,s,o,n]).then((e=>this.deferredInit.resolve(e[0]))).catch((e=>this.deferredInit.reject(e))),this.getOverallColumn(),this.initialized}getAssignedGroupsByColumnId(e){return this.assignedGroupByGradeColumnId[e]}loadSchemas(e){return this.schemaService.loadSchemas(e)}initializeColumnIdGroupsMap(e){this.assignedGroupByGradeColumnId={},r.isEmpty(this.getColumnMetadatas())||this.getColumnMetadatas().forEach((t=>{t.contentId&&!t.isScorm()&&e[t.contentId]&&(this.assignedGroupByGradeColumnId[t.id]=e[t.contentId])}))}initializeGroupsMemberships(){return this.allGroupMemberships=[],this.getGroupsMemberships().then((()=>(this.initializeGroupIdUserIdMap(),!0)))}initializeGroupIdUserIdMap(){this.userIdsByGroupId={};const e={};this.allGroupMemberships.forEach((t=>{this.userIdsByGroupId[t.id]=t.memberships.map((e=>e.userId)),t.assignedContents.forEach((t=>{(e[t.contentId]=e[t.contentId]||[]).push(t)}))})),this.initializeColumnIdGroupsMap(e)}getGroupsMemberships(){return this.course.groups.$refresh({offset:this.allGroupMemberships.length,limit:1e4,fields:"id,memberships,assignedContents"}).$asPromise().then((e=>(this.allGroupMemberships=this.allGroupMemberships.concat(e),e.paging.nextPage?this.getGroupsMemberships():this.allGroupMemberships)))}fetchMemberships(e){return this.fetchMembershipsRecursively([],e,0)}fetchMembershipsRecursively(t,s,n){return this.course.memberships.$refresh({fields:e.MEMBERSHIPS_REQUEST_FIELDS,sort:e.MEMBERSHIPS_SORTING,...i.GRID_MEMBERSHIPS_IMPLICIT_FILTERS,...s,offset:n}).$asPromise().then((e=>{const n=t.concat(e);if(e.paging.nextPage){const t=new URLSearchParams(e.paging.nextPage),i=parseInt(t.get("offset"),10);return this.fetchMembershipsRecursively(n,s,i)}return n}))}getFilteredColumns(e){let t=[];return this.course.gradebook.columns.$refresh({...e}).$asPromise().then((s=>{if(s.filter((e=>!1===e.visibleInBook)).forEach((e=>s.$remove(e))),t=t.concat(s),Object.keys(e).length>0&&this.overallColumn&&t.push(this.overallColumn),s.paging.nextPage)return this.getFilteredColumns(e);if((null==t?void 0:t.length)>0){this.expandColumnSummaries(t);let e=!1;const s=t.map((t=>(t.externalGrade&&(e=t.externalGrade),this.updateColumnByMetadata(t))));this.columns=s;const n=this.createStudentColumn(e);return s.unshift(n),s}return[]}))}getOverallColumn(){this.course.gradebook.columns.$find("finalGrade").$allow([v.HttpStatus.NotFound]).$asPromise().then((e=>{var t;(null===(t=e.$response)||void 0===t?void 0:t.status)!==v.HttpStatus.NotFound&&(this.overallColumn=e)}))}clearOverallColumn(){this.overallColumn=void 0}expandColumnSummaries(e){var t,s;const n=null!==(s=null===(t=e.paging)||void 0===t?void 0:t.count)&&void 0!==s?s:this.MAX_SUMMARY_REQUEST_SIZE,i=this.course.gradebook.summaries.expandingColumns(e);return this.$q.all(r.range(0,n,this.MAX_SUMMARY_REQUEST_SIZE).map((e=>i.$fetch({limit:this.MAX_SUMMARY_REQUEST_SIZE,offset:e,excludeCalculations:!0}).$asPromise()))).then((()=>e))}fetchGradeBulkView(e,t,s){return e.gradebook.bulkView.$fetch({membershipIds:t,columnIds:s,expand:"attempts,lastAttemptId,needsGradingAttemptCount,groupAttempts",timestamp:(new Date).getTime()}).$asPromise()}createColumnByColumnMetadata(e){return e.externalGrade?this.createOverallColumn(e):e.isCalculated()?this.createCalculationColumn(e):e.isOffline()?this.createOfflineItemColumn(e):e.isDiscussion()?r.isEmpty(this.assignedGroupByGradeColumnId[e.id])?this.createDiscussionItemColumn(e):this.createGroupDiscussionGradeColumn(e,this.assignedGroupByGradeColumnId[e.id]):e.isAttendance()?this.createAttendanceItemColumn(e):this.assignedGroupByGradeColumnId[e.id]?this.createGroupTestGradeColumn(e,this.assignedGroupByGradeColumnId[e.id]):e.seemsAttemptBased()&&e.scoreProviderHandle?this.createAttemptBasedItemGradeColumn(e):e.scoreProviderHandle?this.createItemGradeColumn(e):this.createOfflineItemColumn(e)}createStudentColumn(t){return this.$injector.instantiate(l.l,{gridData:this,data:{id:e.COLUMN_STUDENT},headerTemplate:"<bb-grade-grid-column-header-student-reborn></bb-grade-grid-column-header-student-reborn>",cellTemplate:"<bb-grade-grid-column-student-reborn></bb-grade-grid-column-student-reborn>",columnWidth:e.STUDENT_COLUMN_WIDTH,position:"left",border:!t,order:0})}createOverallColumn(t){return this.overallColumn=t,this.$injector.instantiate(l.k,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-overall-reborn></bb-grade-grid-column-header-overall-reborn>",cellTemplate:"<bb-grade-grid-column-overall-reborn></bb-grade-grid-column-overall-reborn>",columnWidth:e.COLUMN_WIDTH,position:"left",border:!0,order:10})}createCalculationColumn(t){return this.$injector.instantiate(l.d,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createItemGradeColumn(t){return this.$injector.instantiate(l.i,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createOfflineItemColumn(t){return this.$injector.instantiate(l.j,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createDiscussionItemColumn(t){return this.$injector.instantiate(l.e,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createAttendanceItemColumn(t){return this.$injector.instantiate(l.b,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createAttemptBasedItemGradeColumn(t){return this.$injector.instantiate(l.a,{gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createGroupTestGradeColumn(t,s){return this.$injector.instantiate(l.h,{groups:s,gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}createGroupDiscussionGradeColumn(t,s){return this.$injector.instantiate(l.f,{groups:s,gridData:this,data:t,headerTemplate:"<bb-grade-grid-column-header-reborn></bb-grade-grid-column-header-reborn>",cellTemplate:"<bb-grade-grid-column-reborn></bb-grade-grid-column-reborn>",columnWidth:e.COLUMN_WIDTH,position:"center",border:!0,order:0})}getColumnMetadata(e){return r.find(this.columnMetadatas,(t=>t.id===e))}getColumnMetadataByContentId(e){return r.find(this.columnMetadatas,(t=>t.contentId===e))}isColumnMetadataExisting(e){return!r.isUndefined(this.getColumnMetadata(e))}getColumnMetadatas(){return this.columnMetadatas}getRowById(e){return this.dataRowsByMembershipId[e]}getRowByUserId(e){return r.find(r.values(this.dataRowsByMembershipId),(t=>t.metadata.user.id===e))}getGroupById(e){return this.allGroupMemberships.find((t=>t.id===e))}getCell(e,t){return this.dataRowsByMembershipId[e].cells[t]}insertRows(e){e.forEach((e=>this.insertRow(e)))}insertRow(e){this.dataRowsByMembershipId[e.id]=new w({},e)}createCell(t,s){if(s.id===e.COLUMN_STUDENT)return this.$injector.instantiate(c.l,{gridData:this,row:t,column:s});const n=s.data;return n.externalGrade?this.$injector.instantiate(c.k,{gridData:this,row:t,column:s}):n.isCalculated()?this.$injector.instantiate(c.c,{gridData:this,row:t,column:s}):n.isOffline()?this.$injector.instantiate(c.j,{gridData:this,row:t,column:s}):n.isDiscussion()?s instanceof l.g&&s.userIdGroupIdMap[t.metadata.user.id]?this.$injector.instantiate(c.f,{gridData:this,row:t,column:s,group:s.getGroupById(s.userIdGroupIdMap[t.metadata.user.id])}):this.$injector.instantiate(c.d,{gridData:this,row:t,column:s}):n.isAttendance()?this.$injector.instantiate(c.b,{gridData:this,row:t,column:s}):s instanceof l.g&&s.userIdGroupIdMap[t.metadata.user.id]?this.$injector.instantiate(c.e,{gridData:this,row:t,column:s,group:s.getGroupById(s.userIdGroupIdMap[t.metadata.user.id])}):n.isJournal()?this.$injector.instantiate(c.h,{gridData:this,row:t,column:s}):n.seemsAttemptBased()?this.$injector.instantiate(c.a,{gridData:this,row:t,column:s}):this.$injector.instantiate(c.g,{gridData:this,row:t,column:s})}insertColumn(e,t=!1){t?this.columns.unshift(e):this.columns.push(e),this.insertDataCells(e)}insertDataCells(e){r.forOwn(this.dataRowsByMembershipId,(t=>t.insertDataCell(this.createCell(t,e))))}insertColumnByMetadata(e){const t=this.createColumnByColumnMetadata(e);return this.insertColumn(t),t}updateColumnByMetadata(e){this.isColumnExisting(e.id)&&this.deleteColumnById(e.id);const t=this.createColumnByColumnMetadata(e);return this.insertColumnAtIndex(t,this.getColumnMetadataIndexInColumnMetadatas(e)+1),this.insertDataCells(t),t}refreshDataCell(e,t){r.isUndefined(e)||(e.deleteDataCellByColumnId(t.id),e.insertDataCell(this.createCell(e,t)))}deleteColumn(e){this.deleteColumnById(e.id)}deleteColumnById(e){let t=r.remove(this.columns,(t=>t.id===e));this.deleteDataCellsByColumnId(e),t&&t[0]&&t[0].data&&t[0].data.contentId&&(t=r.remove(this.columns,(e=>e.data&&e.data.contentId===t[0].data.contentId)),t.forEach((e=>this.deleteDataCellsByColumnId(e.id))))}deleteDataCellsByColumnId(e){r.forOwn(this.dataRowsByMembershipId,(t=>t.deleteDataCellByColumnId(e)))}getColumnMetadataIndexInColumnMetadatas(e){return r.findIndex(this.columnMetadatas,(t=>e.id===t.id))}insertColumnAtIndex(e,t){this.columns.splice(t,0,e)}getColumn(e){return r.find(this.columns,(t=>t.id===e))}getColumns(){return this.columns}isColumnExisting(e){return!r.isUndefined(this.getColumn(e))}getRowCount(){return r.keys(this.dataRowsByMembershipId).length}loadGradeData(t,s){if(r.isEmpty(t)||r.isEmpty(s))return;if(r.isEmpty(s.filter((t=>t.id!==e.COLUMN_STUDENT))))return;const[n,i]=this.filterRowsAndColumns(t.map((e=>e.id)),s.map((e=>e.id)),(e=>e.isUnloaded||e.isWaiting));r.isEmpty(n)||r.isEmpty(i)||this.prepareFetchGrades(n,e.ROW_NUMBER_PER_REQUEST,i,e.COLUMN_NUMBER_PER_REQUEST)}filterRowsAndColumns(e,t,s){const n=this.filterRows(e,t,s);return[n,this.filterColumns(n,t,s)]}filterRows(e,t,s){const n=[];return e.forEach((e=>{const i=this.dataRowsByMembershipId[e];r.find(t,(e=>s(i.cells[e])))&&n.push(e)})),n}filterColumns(e,t,s){const n=[];return t.forEach((t=>{r.find(e,(e=>s(this.dataRowsByMembershipId[e].cells[t])))&&n.push(t)})),n}prepareFetchGrades(e,t,s,n){const i=r.isEmpty(this.requestQueue),o=[];r.chunk(e,t<=0?e.length:t).forEach((e=>{r.chunk(s,n<=0?s.length:n).forEach((t=>{i?this.requestQueue.push([e,t]):o.push([e,t]),this.markWaiting(e,t)}))})),this.requestQueue=o.concat(this.requestQueue),i&&this.fetchGrades()}fetchGrades(){for(let t=0;t<e.REQUEST_WORKER_NUMBER;t++)this.fetchGrade()}fetchGrade(){if(!r.isEmpty(this.requestQueue)){let[e,t]=this.requestQueue.shift();[e,t]=this.filterRowsAndColumns(e,t,(e=>e.isWaiting)),r.isEmpty(e)||r.isEmpty(t)?this.fetchGrade():(this.markLoading(e,t),this.fetchGradeBulkView(this.CourseModel.$new(this.courseId),e,t).then((s=>{this.assignGrade(s),this.markLoaded(e,t),this.fetchGrade()})))}}assignGrade(e){e.bulkViewUsers.forEach((e=>{const t=this.dataRowsByMembershipId[e.courseMembershipId];e.grades.forEach((e=>{const s=t.cells[e.columnId];s.isLoading&&(s.data=e)}))}))}markWaiting(e,t){e.forEach((e=>t.forEach((t=>{const s=this.dataRowsByMembershipId[e].cells[t];s.isUnloaded&&s.setLoadState(c.i.WAITING)}))))}markLoading(e,t){e.forEach((e=>t.forEach((t=>{const s=this.dataRowsByMembershipId[e].cells[t];s.isWaiting&&s.setLoadState(c.i.LOADING)}))))}markLoaded(e,t){e.forEach((e=>t.forEach((t=>{const s=this.dataRowsByMembershipId[e].cells[t];s.isLoading&&s.setLoadState(c.i.LOADED)})))),this.broadcastRefreshEvent(e,t)}broadcastRefreshEvent(e,t){e.forEach((e=>{const s=t.filter((t=>this.dataRowsByMembershipId[e].cells[t].isLoaded));this.gradeGridRebornDirectiveScope.$broadcast(d.a.REFRESH,{rowId:e,columnIds:s})}))}refreshAllColumns(){r.forEach(this.getColumnMetadatas(),(e=>this.updateColumnByMetadata(e)))}addUpdatedColumnFlag(e){r.forEach(e,(e=>{const t=r.find(this.columns,(t=>t.id===e));t&&(t.isUpdated=!0)}))}destroy(){this.requestQueue=[]}};S.COLUMN_WIDTH=142,S.COLUMN_STUDENT="COLUMN_STUDENT",S.STUDENT_COLUMN_WIDTH=220,S.REQUEST_WORKER_NUMBER=5,S.ROW_NUMBER_PER_REQUEST=0,S.COLUMN_NUMBER_PER_REQUEST=0,S.MEMBERSHIPS_REQUEST_FIELDS=["role","courseRole","childCourseId","user","id","isAvailable","dueDateExceptionType"].join(","),S.MEMBERSHIPS_SORTING=Object(f.buildSortParameters)(i.GRID_MEMBERSHIPS_SORT),S=Object(n.__decorate)([Object(n.__param)(0,Object(m.b)("$rootScope")),Object(n.__param)(1,Object(m.b)("$injector")),Object(n.__param)(2,Object(m.b)("$q")),Object(n.__param)(3,Object(m.b)(b.serviceName)),Object(n.__param)(4,Object(m.b)(o.b)),Object(n.__param)(5,Object(m.b)(a.b)),Object(n.__param)(6,Object(m.b)(g.e)),Object(n.__param)(7,Object(m.b)("gradeGridRebornDirectiveScope"))],S)},Jwnl:function(e,t){e.exports='\x3c!-- Center content title when it is only one line of text (without edit capability, description, or date restrictions). --\x3e\n<button ng-if="!contentItemBase.isEngagementOutline()"\n        class="content-title" ng-class="{\'name-middle\': contentItemFolder.shouldAlignMiddle()}"\n        ng-click="contentItemFolder.toggleFolder()"\n        aria-expanded="{{content.ui.isOpen}}"\n        aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n        bb-translate-attrs="{\'aria-label\':\'components.directives.content-item-base.aria-label.toggle-folder\'}"\n        translate-attrs-values="{folderName: content.title}"\n        analytics-id="content.item.folder.toggleFolder.button"\n        aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n        tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}"><span>{{ content.title }}</span></button>\n<button ng-if="contentItemBase.isEngagementOutline()"\n        class="content-title name"\n        ng-click="contentItemFolder.toggleFolder()"\n        aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n        aria-expanded="{{content.ui.isOpen}}"\n        analytics-id="content.item.folder.engagementOutline.toggleFolder.button"><span>{{ content.title }}</span></button>\n'},Jygx:function(e,t){function s(e){this.message=e}s.prototype=new Error,s.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new s("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,i,o=0,a=0,r="";i=t.charAt(a++);~i&&(n=o%4?64*n+i:i,o++%4)?r+=String.fromCharCode(255&n>>(-2*o&6)):0)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(i);return r}},KXuk:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-complete",use:"icon-small-complete-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-complete"><rect x="1" y="1" width="14" height="14" rx="7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M5 8l2 3 4-6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},KeOq:function(e,t){e.exports='<div class="grade-grid-cell grade-grid-header-cell">\n  <div class="content student-content student-column" role="columnheader" tabindex="0">\n    <div class="ellipse left-bold location" course-org-token-resolver bb-translate>components.directives.grade.grid.students</div>\n  </div>\n  <div class="summary student-column"></div>\n  <div class="summary student-column">\n    <span bb-translate course-org-token-resolver translate-values="{count: studentsTotal}">components.directives.grade.grid.studentsSummary.plural</span>\n  </div>\n</div>\n'},KvMR:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("+pNa");const o="ultra.components.directives.bbUiIcon.small.Download";Object(n.a)(i.Download,o,"bbUiIconSmallDownload")},"L+81":function(e,t,s){"use strict";var n=s("D57K"),i=(s("zhNR"),s("XPgl"),s("lx16")),o=s("Llzl"),a=s("kC07"),r=s("D8d/"),c=s("lEL+"),l=s("DnQR"),d=(s("lwNT"),s("vcLy"),s("KXuk"),s("CuGX"),s("9OUN")),u=s("Sa5G"),p=s("0JpG"),m=s("MKP7"),h=s("JNtI"),b=s("Ocaa"),g=s("pIXs"),v=s("aTRN"),f=s("nYZ0"),w=s("Qbdf"),S=s("w9Zy"),C=s("TnpK"),y=s("X455"),O=s("oi1r"),A=s("jhBu"),I=s("1ZbL");const D="ultra.features.course.content.banners.bbForcedSequenceWarningBanner",k={Class:s("AuQm").ForcedSequenceWarningBanner,withThemeProvider:!0,renderLocalized:!0};o.module(D,[]).component("bbForcedSequenceWarningBanner",Object(I.a)(k));var _=s("VUvS"),j=s("aHpC"),T=s("e6jQ"),$=s("BLb8"),R=s("nmzr"),E=s("/5AG"),x=s("Htol"),P=s("Y+9S"),L=s("IbyE"),G=s("m5Qz"),M=s("tBL6"),N=s("ohO4");const F="ultraUi.components.directives.content.learningModule.learningModuleBaseItem";let B=class{constructor(e,t,s,n,i,o,a,r,c,l,d,p,m,h,b,g){var f;this.scope=e,this.$rootScope=t,this.element=s,this.attrs=n,this.localizeService=i,this.$q=o,this.contentService=a,this.offcanvasService=r,this.timeout=c,this.ultraState=l,this.contextCourseMembership=d,this.entitlementService=m,this.$ngRedux=h,this.contextCourse=b,this.featureFlagService=g,this.lmTitlePlaceholder=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.learning-module.base-item.title-placeholder"}),this.description="",this.controlId=Object(T.a)(),this.childrenRefresher=new M.a(this.$q,this.featureFlagService),this.conditionalRelease=p.instantiate(v.a,{scope:e}),e.content.title||(e.content.title=this.lmTitlePlaceholder),e.content.description=null!==(f=e.content.description)&&void 0!==f?f:"",this.scope.$on("refresh-conditional-release-rules",((e,t)=>{this.scope.content.id===t.id&&this.conditionalRelease.getConditions(t)})),this.scope.$on("bb-update-CR-tooltip",((e,t,s,n)=>{t&&(this.rulesCriteria&&this.rulesCriteria.gradeColumnId)===t.id&&this.conditionalRelease.getConditions(this.scope.content,s,n)})),(e.content.isConditionalReleaseLocked()||e.content.isConditionalRelease()||e.content.isForcedSequenceModule())&&this.conditionalRelease.getConditions(e.content),this.entitlementService.hasCourseEntitlement(u.e.ModifyContent,this.scope.content.courseId).then((e=>{this.entitledToModifyContent=e})),this.scope.$on(x.b,((t,s)=>{this.childrenRefresher.refreshChildren(s,e.content,this.contextCourseMembership.isStudentMembership())})),this.courseId=this.scope.content.courseId||this.ultraState.params.courseId,this.subscribeToReduxChanges(),!this.courseProgressConfiguration&&this.retrieveCourseProgressConfiguration&&this.retrieveCourseProgressConfiguration({courseId:this.courseId}),Object($.b)(this.scope,((e,t)=>{this.scope.content.isConditionalReleaseLocked()&&this.scope.content.containsCriteriaWithGradeColumnId(t)&&Object($.c)(this.scope,t)})),Object($.a)(this.scope,(e=>{this.scope.content.isConditionalReleaseLocked()&&Object($.c)(this.scope)}))}deleteContent(){this.scope.$emit("deleteContent",this.scope.content)}getOverflowMenu(){return[{icon:"draw",labelKey:"global.edit",show:()=>this.scope.content.canEdit(),onClick:this.edit.bind(this)},{icon:"class-pulse-future",uniqueId:"content-progress",labelKey:this.contextCourse.course.isOrganization?"components.directives.content-item-base.overflow-menu.content-progress-org":"components.directives.content-item-base.overflow-menu.content-progress",show:()=>this.canViewProgress(),onClick:()=>{this.ultraState.goPeekState(R.ContentRoutes.GENERIC_STUDENT_PROGRES_PEEK_PANEL,{id:this.scope.content.id,courseId:this.courseId})}},{icon:"trash",labelKey:"global.delete",show:()=>this.scope.content.canDelete(),onClick:this.deleteContent.bind(this),confirmationOptions:{lazyLoadTitleKeyAndInstructionsKey:()=>this.getDeleteConfirmationKeyAndShowType().then((e=>{const t=e.confirmationKey.replace(/^resource\//,"");return this.$q.when(h.a(t))}))}}]}edit(){this.ultraState.goPeekState(R.ContentRoutes.EDIT_LEARNING_MODULE_PEEK_PANEL,{id:this.scope.content.id})}getDeleteConfirmationKeyAndShowType(){return this.contentService.generateDeleteConfirmationKey(this.scope.content,this.scope.contextArea).then((e=>({confirmationKey:this.scope.content.ui.deleteConfirmationKey,showType:this.scope.content.ui.modalShowType})))}canViewProgress(){var e;return!!(null===(e=this.courseProgressConfiguration)||void 0===e?void 0:e.progressTrackingEnabled)&&this.entitlementService.isEntitled(E.CourseProgressEntitlements.ViewProgressInformation,this.courseId)}subscribeToReduxChanges(){const e=this.$ngRedux.connect((e=>({courseProgressConfiguration:L.select.courseProgress.getCourseProgressConfiguration(e,this.courseId)})),(e=>Object(d.bindActionCreators)({retrieveCourseProgressConfiguration:L.actions.courseProgress.loadCourseProgressConfiguration},e)))(this);this.scope.$on("$destroy",e)}toggleLM(){var e,t;null===(t=(e=this.scope).toggleFunc)||void 0===t||t.call(e),this.scope.content.ui.isOpen&&this.fetchProgress().then((()=>{const e={type:P.MessageType.LearningModuleOpened,status:P.MessageStatus.Success,contentId:this.scope.content.id};Object(P.sendMessageToMobile)(e)}))}isCourseCompletedAndInInstructorView(){return!this.scope.content.canEdit()&&this.entitledToModifyContent}get canOpenConditionalRelease(){return!!(this.scope.content&&this.scope.content.permissions&&this.scope.content.permissions.adaptiveRelease&&this.scope.content.permissions.adaptiveRelease.view)}openConditionalRelease(){this.ultraState.goPeekState(R.ContentRoutes.CONDITIONAL_RELEASE_PEEK_PANEL,{contentId:this.scope.content.id})}getNeighborReviewState(){return E.NeighborContentReviewState.None}shouldShowReviewStateIcon(){return L.ContentHelper.canHaveReviewState(this.scope.content)&&L.ContentHelper.canViewReviewState(this.scope.content)&&!!this.scope.content.id}onChangeVisibility(){this.scope.content.visibility=this.contentService.determineVisibility(this.scope.content.isAvailable);this.scope.content.withParams({fields:"id"}).$save(["isAvailable","isPartiallyVisible","adaptiveReleaseRules"]).$asPromise().then((()=>{this.$rootScope.$broadcast("content-update",this.scope.content)}))}fetchProgress(){return this.scope.content.$fetch({expand:"hasProgressed"}).$asPromise().then((e=>{this.scope.content=e}))}shouldShowForcedSequenceWarningBanner(){return this.scope.content.canEdit()&&this.scope.content.isForcedSequenceModule()&&this.scope.isOpen&&!this.scope.content.isHiddenFromStudents()&&this.scope.content.hasProgressed}};B=Object(n.__decorate)([Object(n.__param)(0,Object(j.b)("scope")),Object(n.__param)(1,Object(j.b)("$rootScope")),Object(n.__param)(2,Object(j.b)("element")),Object(n.__param)(3,Object(j.b)("attrs")),Object(n.__param)(4,Object(j.b)(p.serviceName)),Object(n.__param)(5,Object(j.b)("$q")),Object(n.__param)(6,Object(j.b)(f.f)),Object(n.__param)(7,Object(j.b)(S.e)),Object(n.__param)(8,Object(j.b)(c.b)),Object(n.__param)(9,Object(j.b)(C.d)),Object(n.__param)(10,Object(j.b)(y.d)),Object(n.__param)(11,Object(j.b)("$injector")),Object(n.__param)(12,Object(j.b)(A.b)),Object(n.__param)(13,Object(j.b)("$ngRedux")),Object(n.__param)(14,Object(j.b)(w.e)),Object(n.__param)(15,Object(j.b)(N.b))],B);class q{constructor(e){this.$injector=e,this.restrict="E",this.template=_,this.scope={content:"=",canToggle:"&",toggleFunc:"&",canMove:"=",contextArea:"=",isOpen:"="},this.link=(e,t,s)=>{e.baseItem=this.$injector.instantiate(B,{scope:e,element:t,attrs:s})}}}q.$inject=["$injector"],o.module(F,[m.a,g.a,f.d,b.a,S.d,c.a,C.b,O.a,A.a,D,G.a]).directive("bbLearningModuleBaseItem",["$injector",e=>e.instantiate(q)]);var z=s("zGdY");s.d(t,"a",(function(){return U}));const U="ultra.directives.folder";let V=class{constructor(e,t,s,n){this.scope=e,this.element=t,this.timeout=s,this.contextCourseMembership=n,this.showEmptyMenu=!0,this.showMenuOverride=!1,this.showOutlineOverride=!1,this.isOpen=!1,this.toggleLabelKey="components.directives.folder.aria-label.open",this.initialChildrenLength=0,this.FOLDER_CONTENTS_SELECTOR=".folder-contents",this.contextArea=e.contextArea,this.loadMoreChildren=e.loadMoreChildren,this.contents=e.contents,this.content.ui?this.content.ui.isOpen=!1:this.content.ui={isOpen:!1},e.$on("toggle-folder",((e,t)=>{this.canToggle()&&t===this.content&&this.toggleFolder()})),e.$on("toggle-folder-by-id",((t,s)=>{this.canToggle()&&s===this.content.id&&(this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?this.toggleFolder():e.$apply((()=>{this.toggleFolder()})))})),e.$on("close-folder-immediately-by-id",((e,t)=>{this.isOpen&&this.canToggle()&&t===this.content.id&&this._closeFolderImmediately()})),e.$on("bb-drag-start",(()=>{this.isOpen&&this.canToggle()&&(null==this.content.children||0===this.content.children.length)&&this._closeFolderImmediately()})),e.$on("close-all-add-menus",((e,t)=>{if(this.isOpen&&(null==this.content.children||0===this.content.children.length)&&this.content.id!==t){if(this.content.isLearningModule())return;this.toggleFolder()}})),e.$on("showContentImportProgress",((t,s,n)=>{this.content.id!==n||0!==this.content.children.length||this.showOutlineOverride||(this.showOutlineOverride=!0,this.timeout((()=>{this.scope.$broadcast("showContentImportProgress",s,n)}),e))})),e.$on("keyboard-drag-move",((e,t)=>{this.content.id+"blank"===t?this.showEmptyMenu=!1:this.showEmptyMenu=!0})),e.$on("keyboard-drag-lost-focus",(()=>{this.showEmptyMenu=!0})),e.$on("keyboard-drag-end",(()=>{this.showEmptyMenu=!0}))}_closeFolderImmediately(){this.scope.$$phase||this.scope.$root&&this.scope.$root.$$phase?(this.element.children(".folder").children(this.FOLDER_CONTENTS_SELECTOR).hide(),this.isOpen=!1,this.content.ui.isOpen=!1):this.scope.$apply((()=>{this.element.children(".folder").children(this.FOLDER_CONTENTS_SELECTOR).hide(),this.isOpen=!1,this.content.ui.isOpen=!1}))}toggleFolder(){this.isOpen||null!=this.content.children&&0!==this.content.children.length||this.loadMoreChildren(this.content).$then((()=>{var e;this.content.children&&0===this.content.children.length&&(null===(e=this.scope.content.permissions)||void 0===e?void 0:e.canHaveReviewState)&&this.scope.content.state!==z.ContentReviewState.Completed&&this.scope.content.updateState(z.ContentReviewState.Completed,!0)})),this.content.children&&(this.isOpen=this.content.ui.isOpen=!this.content.ui.isOpen,this.content.children.$then((()=>{this.initialChildrenLength=this.content.children.length,0===this.content.children.length?(this._calculateDurationAndToggle(),this.showMenuOverride=!0,(this.isOpen||this.isOpen&&this.content.isLearningModule())&&this.scope.$root.$broadcast("close-all-add-menus",this.content.id)):this.timeout((()=>{this._calculateDurationAndToggle(),this.showMenuOverride=!1}),this.scope),this.clearWatcher&&this.clearWatcher(),this.clearWatcher=this.scope.$watch((()=>this.content.children&&this.content.children.length),((e,t)=>{this.showMenuOverride=0===e,0===e&&e!==t&&this.isOpen&&this.scope.$root.$broadcast("close-all-add-menus",this.content.id),null==e&&this.isOpen&&(this._closeFolderImmediately(),this.toggleFolder())}))})),this.toggleLabelKey=this.isOpen?"components.directives.folder.aria-label.close":"components.directives.folder.aria-label.open")}_calculateDurationAndToggle(){const e=this.isOpen?1e3:2e3,t=this.element.children(".folder").children(this.FOLDER_CONTENTS_SELECTOR).outerHeight(),s=Math.round(1.17*t),n=Math.min(e,s);this.element.children(".folder").children(this.FOLDER_CONTENTS_SELECTOR).slideToggle(n)}canToggle(){return this.content.canEdit()||!this.content.isRestricted()}get content(){return this.scope.content}isProgressTrackingStateShown(e){var t;return null===(t=e.permissions)||void 0===t?void 0:t.canViewReviewState}};V=Object(n.__decorate)([Object(n.__param)(0,Object(j.b)("scope")),Object(n.__param)(1,Object(j.b)("element")),Object(n.__param)(2,Object(j.b)(c.b)),Object(n.__param)(3,Object(j.b)(y.d))],V);class H{constructor(e){this.$injector=e,this.restrict="E",this.scope={content:"=",contextArea:"=",canCreate:"=",contents:"=",canMove:"=",loadMoreChildren:"=",nextContentId:"=?",onFileDropHandler:"=?",onMoveHandler:"=",onMoveIntoFolderHandler:"=",previousContentId:"=?",canCopyImport:"=?",rootContent:"&?"},this.compile=e=>({pre:(e,t)=>{e.folder=this.$injector.instantiate(V,{scope:e,element:t})}}),this.template=l}}H.$inject=["$injector"],o.module(U,[a.b,r.a,i.a,c.a,F]).directive("bbFolder",["$injector",e=>e.instantiate(H)])},L2Kv:function(e,t,s){"use strict";(function(e){s.d(t,"b",(function(){return p})),s.d(t,"a",(function(){return g}));var n=s("D57K"),i=s("0JpG"),o=s("lEL+"),a=s("aHpC"),r=s("+4Px"),c=s("gK/k"),l=s("9Fiv"),d=s("dF44"),u=s("kjyA");const p="rbGridCell";class m{}let h=class{constructor(t,s,n,i,o,a,c,l){this.scope=t,this.element=s,this.grid=n,this.container=i,this.$q=o,this.timeout=a,this.localizeService=c,this.debounce=l,this.goPreviousColumnImpl=()=>{this.removeFocus();let{row:e}=this.scope;const{col:t}=this.scope,s=this.container.rows,n=this.grid.getFocusableColumns(),i=n[(n.indexOf(t)-1+n.length)%n.length];if("right"===this.container.position&&this.scope.$first)return void this.grid.scrollToRight((()=>this.notifyFocus(e,i)));if(i===n[n.length-1]){if(e){const t=s.indexOf(e)-1;e=s[t];let n=NaN;this.container.isRowOutOfBound(t).top&&(n=this.container.getTopRowScrollTop(t)),this.grid.scrollToRightWithTop(n,(()=>this.notifyFocus(e,i)))}return}const o=this.container.columns.indexOf(i),a=o>=0;this.container.isColOutOfBound(o).left?this.grid.scroll({scrollLeft:a?this.container.getLeftColScrollLeft(i):0},(()=>this.notifyFocus(e,i))):this.notifyFocus(e,i)},this.goNextColumnImpl=()=>{this.removeFocus();const{row:e,col:t}=this.scope,s=this.container.rows,n=this.grid.getFocusableColumns(),i=n[(n.indexOf(t)+1)%n.length];if("left"===this.container.position&&this.scope.$last)return void this.grid.scrollToLeft((()=>this.notifyFocus(e,i)));if(i===n[0]){let t=-1,n=s[0];if(void 0===e)t=0;else{const i=s.indexOf(e)+1;n=s[i],n&&this.container.isRowOutOfBound(i).bottom&&(t=this.container.getBottomRowScrollTop(i))}return void this.grid.scroll({scrollLeft:0,scrollTop:t},(()=>this.notifyFocus(n,i)))}const o=this.container.columns.indexOf(i);this.container.isColOutOfBound(o).right?this.grid.scroll({scrollLeft:this.container.getRightColScrollLeft(i)},(()=>this.notifyFocus(e,i))):this.notifyFocus(e,i)},this.goUpImpl=(e=!1)=>{this.removeFocus();const{row:t,col:s}=this.scope,n=this.container.rows,i=n.indexOf(t)-1;if(!t)return void this.grid.scrollToBottom((()=>this.notifyFocus(n[n.length-1],s)));const o=n[i];o?this.container.isRowOutOfBound(i).top?this.grid.scroll({scrollTop:this.container.getTopRowScrollTop(i)},(()=>this.notifyFocus(o,s))):this.notifyFocus(o,s):e?this.grid.scrollToBottom((()=>this.notifyFocus(n[n.length-1],s))):this.notifyFocus(void 0,s)},this.goDownImpl=(e=!1)=>{this.removeFocus();const{row:t,col:s}=this.scope,n=this.container.rows,i=n.indexOf(t)+1;let o=n[i];o?void 0!==t?this.container.isRowOutOfBound(i).bottom?this.grid.scroll({scrollTop:this.container.getBottomRowScrollTop(i)},(()=>this.notifyFocus(o,s))):this.notifyFocus(o,s):this.grid.scrollToTop((()=>this.notifyFocus(o,s))):e?(o=n[0],this.grid.scrollToTop((()=>this.notifyFocus(o,s)))):this.notifyFocus(o,s)},this.goPreviousColumn=this.debounce.asDebounced(this.goPreviousColumnImpl,this.scope,d.c),this.goNextColumn=this.debounce.asDebounced(this.goNextColumnImpl,this.scope,d.c),this.goUp=this.debounce.asDebounced(this.goUpImpl,this.scope,d.c),this.goDown=this.debounce.asDebounced(this.goDownImpl,this.scope,d.c),this.setTabindex(),s.on("keydown",(t=>{const s=this.getHandler(t);s&&(this.grid.previousCell=this,this.tabPressed=t.keyCode===r.u,Object(r.x)(t)&&e(document.body).removeClass("hide-focus-outline"),s.call(this),t.preventDefault(),t.stopPropagation())})),t.$on(d.b.FOCUS_CELL,((e,t,s)=>{this.scope.row===t&&this.scope.col===s&&(this.handleFocus(),this.grid.cellFocusDeferred&&this.grid.cellFocusDeferred.resolve(this))})),t.$on(d.b.LEAVE_CELL,(()=>{this.handleFocus()})),t.$on(d.b.ENTER_NEXT_CELL,(()=>{this.grid.cellFocusDeferred=new function(){this.promise=new Promise((e=>this.resolve=e))},this.goForth(),this.grid.cellFocusDeferred.promise.then((e=>{e.handleEnter(),this.grid.cellFocusDeferred=null}))}))}setTabindex(){this.scope.col.focusable&&this.element.attr("tabindex",0)}goLeft(){return this.localizeService.isRTL(this.scope)?this.goNextColumn():this.goPreviousColumn()}goRight(){return this.localizeService.isRTL(this.scope)?this.goPreviousColumn():this.goNextColumn()}goForth(){this.goDown(!0)}goBack(){this.goUp(!0)}removeFocus(){this.container.element.find(".rb-ax-focus-placeholder").focus()}notifyFocus(e,t){this.grid.$scope.$broadcast(d.b.FOCUS_CELL,e,t)}handleFocus(){this.element.focus()}isFirst(){const{row:e,col:t}=this.scope,s=this.grid.getFocusableColumns();return void 0===e&&t===s[0]}isLast(){const{row:e,col:t}=this.scope,s=this.container.rows,n=this.grid.getFocusableColumns();return e===s[s.length-1]&&t===n[n.length-1]}getHandler(e){return Object(r.z)(e)&&!this.isFirst()?this.goBack:Object(r.A)(e)&&!this.isLast()?this.goForth:e.keyCode===r.j?this.goLeft:e.keyCode===r.s?this.goRight:e.keyCode===r.v?this.goUp:e.keyCode===r.d?this.goDown:Object(r.y)(e)?this.handleEnter:e.keyCode===r.g?this.element.is(e.target)?this.handleEscape:this.handleFocus:void 0}handleEnter(){this.scope.$broadcast(d.b.ENTER_CELL,this.element)}handleEscape(){this.scope.$emit(d.b.LEAVE_GRID)}};h=Object(n.__decorate)([Object(n.__param)(0,Object(a.b)("scope")),Object(n.__param)(1,Object(a.b)("element")),Object(n.__param)(2,Object(a.b)("grid")),Object(n.__param)(3,Object(a.b)("container")),Object(n.__param)(4,Object(a.b)("$q")),Object(n.__param)(5,Object(a.b)(o.b)),Object(n.__param)(6,Object(a.b)(i.serviceName)),Object(n.__param)(7,Object(a.b)(u.b))],h);class b extends h{setTabindex(){this.scope.col.focusable&&this.element.attr("tabindex",this.scope.col.headerFocusable?0:-1)}goBack(){this.goLeft()}goForth(){const{row:e,col:t}=this.scope;this.canAddColumn()?this.container.canAddColumn()?this.notifyFocus(e,t):this.grid.scrollToLeft((()=>this.notifyFocus(e,t))):this.goRight()}handleFocus(){const e=this.grid.previousCell,t=this.grid.containers.center.columnAdder;e.tabPressed&&e instanceof b&&e.canAddColumn()&&this.canAddColumn()?(this.container.canAddColumn()?t.show(this.element.find(".rb-add-column-placeholder"),this.scope.col):t.show(),t.button.focus()):this.scope.col.headerFocusable?super.handleFocus():this.scope.$broadcast(d.b.CELL_FOCUSED,this.element)}canAddColumn(){return this.container.canAddColumn()||this.grid.canAddColumn()&&"left"===this.container.position&&this.scope.$last}}let g=class{constructor(e,t){this.$injector=e,this.$compile=t,this.templates=Object.create(null),this.restrict="A",this.require=[`^${c.a}`,`^${l.c}`,p],this.controller=m,this.transclude=!0,this.link=(e,t,s,n,i)=>{const o=e.$eval(s[p]);(this.templates[o]=this.templates[o]||this.$compile(o))(e,(e=>t.append(e))),i((e=>t.append(e)));const[a,r,c]=n;c.cellNavigator=this.$injector.instantiate(e.row?h:b,{scope:e,element:t,grid:a,container:r.container})}}};g=Object(n.__decorate)([Object(n.__param)(0,Object(a.b)("$injector")),Object(n.__param)(1,Object(a.b)("$compile"))],g)}).call(this,s("71td"))},LFd7:function(e,t,s){"use strict";var n=s("D57K"),i=s("X455"),o=s("Sa5G"),a=s("aHpC"),r=s("yC9S"),c=s("9hUw"),l=s("0JpG"),d=s("Llzl"),u=s("ERkP"),p=s("1ZbL"),m=s("/n7R"),h=s("0x+l");const b="ultra.components.directives.content.contentItem.contentItemType.contentItemPeerAssessment.tooltip";class g extends u.Component{render(){return u.createElement(m.AnalyticsTooltip,{placement:"top",title:this.props.tooltipTitle,"aria-label":this.props.tooltipTitle,analyticsId:"components.directives.content-item-base.content-item-peer-assessment.tooltip.button"},u.createElement("button",{className:"peer-review-info-tooltip"},u.createElement(h.Information,null)))}}const v={Class:g,bindingNames:["tooltipTitle"]};d.module(b,[]).component("bbUiContentItemPeerAssessmentTooltip",Object(p.a)(v));var f=s("HE6t");s.d(t,"a",(function(){return w}));const w="ultra.components.directives.content.contentItem.contentItemType.contentItemPeerAssessment";let S=class{constructor(e,t,s,n){this.$scope=e,this.contextCourseMembership=t,this.peerReviewService=s,this.localize=n}$onInit(){var e;this.$scope.contentItemPeerAssessment=this,o.f.TestLink.isEqualTo(null===(e=this.content)||void 0===e?void 0:e.contentHandler)?this.peerReviewService.getOrCreatePeerContentFromContent(this.content).then((e=>{this.peerReviewContentObject=e,this.isInitialized=!0})):this.isInitialized=!0}getTooltipMessage(){return this.localize.translateSync({key:"components.directives.content-item-base.content-item-peer-assessment.peer-review-information-tooltip",locale:this.localize.getLocale(this.$scope)})}get peerReviewsPerStudent(){var e,t;return null!==(t=null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.numOfPeerReviewsToComplete)&&void 0!==t?t:0}get peerReviewDueDate(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.peerReviewDueDate}get isPeerGrading(){var e,t;return null!==(t=null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.peerGrading)&&void 0!==t&&t}get isPeerGradingConfigured(){var e,t;return null!==(t=null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.isPeerGradingConfigured)&&void 0!==t&&t}};S=Object(n.__decorate)([Object(r.a)({moduleName:w,componentName:"bbContentItemPeerAssessment",bindings:{content:"<"},template:f,requireModules:[l.moduleName,c.a,b]}),Object(n.__param)(0,Object(a.b)("$scope")),Object(n.__param)(1,Object(a.b)(i.d)),Object(n.__param)(2,Object(a.b)(c.b)),Object(n.__param)(3,Object(a.b)(l.serviceName))],S)},LN5R:function(e,t,s){"use strict";(function(e){s.d(t,"b",(function(){return H})),s.d(t,"a",(function(){return Q}));var n=s("D57K"),i=(s("wAzH"),s("KXuk"),s("Tt7N"),s("01PJ"),s("Vdys"),s("xoIb"),s("Lrq8"),s("VCKY"),s("6Fqm"),s("JuVx")),o=s("qH3X"),a=s("cbVV"),r=s("Llzl"),c=s("nsO7"),l=s("yC9S"),d=s("nmzr"),u=s("aHpC"),p=s("2bSy"),m=s("810X"),h=s("7OC/"),b=s("9KIl"),g=s("jSqS"),v=s("TnpK"),f=s("kN1T"),w=s("xcel"),S=s("y+vt"),C=s("0JpG"),y=s("gK/k"),O=s("lEL+"),A=s("hkqm"),I=s("X/qj"),D=s("ROik"),k=s("AVdi"),_=s("o5Lu"),j=s("xiEu"),T=s("C36k"),$=s("s+Z7"),R=s("zGdY"),E=s("IbyE"),x=s("+4Px"),P=s("6CeR"),L=s("9Zs+"),G=s("dF44"),M=s("TmUJ"),N=s("2o5C"),F=s("fGDP"),B=s("uFkY"),q=s("vYaK"),z=s("Kpdw"),U=s("ZzR9"),V=s("ZQFV");const H="ultra.components.directives.gradeGridReborn",Q="bbGradeGridReborn";let K=class{constructor(e,t,s,n,i,r,u,p,m,h,b,g,v,f,w,S,C){this.$compile=e,this.$element=t,this.$injector=s,this.$ngRedux=n,this.$q=i,this.$scope=r,this.$location=p,this.ultraState=m,this.gradeService=h,this.gradebookPermissionService=b,this.$attrs=g,this.bbLocalize=v,this.CourseModel=f,this.GradeColumn=w,this.timeout=S,this.toast=C,this.headerHeight=150,this.rowHeight=80,this.showFilterCriteria=!1,this.mergedCourses=[],this.studentsTotal=0,this.onUrlFiltersUpdated=()=>{const e=this.$location.search(),t=this.hasUrlFilters;this.hasUrlFilters=!!(e.memberId||e.gradebookColumnId||e.gradebookCategoryId||e.courseGroupId||e.childCourseId),t!==this.hasUrlFilters&&this.setContainerHeight(),this.updateFilterConditions(e)},this.initialized=!1,l.b.OnWindow("resize",c.debounce(this.setContainerHeight.bind(this),100),r),this.setContainerHeight(),r.$on(U.a.$locationChangeSuccess,(()=>{this.timeout((()=>this.setContainerHeight()),this.$scope,50)})),this.mergedCourses.push(...this.$scope.mergedCourses),r.$on(o.a.FOCUSIN_CELL,((e,t)=>{this.activeColumnId=t.columnId})),r.$on(o.a.FOCUSOUT_CELL,((e,t)=>{this.activeColumnId=void 0})),r.$on(U.b.$stateChangeStart,(()=>this.changingState=!0)),r.$on(U.b.$stateChangeSuccess,(()=>this.changingState=!1)),this.subscribeToReduxChanges(),this.initialize().then((()=>{this.onUrlFiltersUpdated(),this.setupSearchFilterListener(),this.setupColumnChangeListener(),r.$on(U.a.$locationChangeSuccess,this.onUrlFiltersUpdated)})),this.$scope.$on("bb-change-overall-panel-visibility",((e,t,s)=>{var n;this.gridData.course.id!==t&&this.gridData.course.isComplete()||("true"===(null===(n=this.setupOverallGradeMessageIsHiddenPreference)||void 0===n?void 0:n.value)?this.isOverallPanelShown=!1:this.isOverallPanelShown=s)})),this.$scope.$on("grade-notation-cache-update",((e,t)=>{this.updateOverallNotation()})),this.$scope.$on("bb-grades-schema-save",((e,t)=>{this.refreshSchema(t)})),l.b.OnRootScope(this.$scope,"bb-grade-input-save",((e,t,s,n)=>{const i=this.gridData.getColumn(s),o=i.data;o.$fetch().$asPromise().then((()=>o.summary.$fetch().$asPromise())).then((()=>{if(i instanceof a.c)return this.updateAffectedColumns(this.getAffectedColumns(i))})).then((()=>{if(n){const e=this.gridData.getRowByUserId(n);this.refreshDataCell(e,i)}else this.gridData.updateColumnByMetadata(o),this.$scope.$broadcast(G.b.COLUMN)}))})),this.$scope.$on(B.a,((e,t,s,n,i)=>{const o=this.gridData.getRowById(s),a=this.gridData.getColumn(t);this.refreshDataCell(o,a)})),this.$scope.$on("course.grades.gradebook-item.submission.grade-status-change",((e,t)=>{const s=this.gridData.getRowByUserId(t.userId),n=this.gridData.getColumn(t.columnId),i=n.data;i.$fetch().$asPromise().then((()=>i.summary.$fetch().$asPromise())).then((()=>{if(n instanceof a.c)return this.updateAffectedColumns(this.getAffectedColumns(n))})).then((()=>{n instanceof a.h?this.refreshDataCells(this.gridData.getGroupIdUserIdMap()[t.groupId].map((e=>this.gridData.getRowByUserId(e))),[n]):t.updateColumn?(this.gridData.updateColumnByMetadata(i),this.$scope.$broadcast(G.b.COLUMN)):this.refreshDataCell(s,n)}))})),this.$scope.$on("bb-reload-grid-view",(e=>{this.$scope.$emit("grade-notation-update",this.gridData.course.id)})),this.$scope.$on(N.b,(()=>{this.refreshColumns()})),this.$scope.$on(F.a,((e,t)=>{this.refreshColumns((()=>{this.gridData.addUpdatedColumnFlag(t)}))})),this.$scope.$on(U.b.$stateChangeSuccess,((e,t,s,n)=>{n.name.endsWith(d.GradeRoutes.GRADEBOOK_GRID_ADVANCED_FILTERS)&&this.updateFilterConditions(s)})),this.$scope.$on("$destroy",(()=>{this.columnFiltersPresent()&&this.setUnfilteredColumns()})),this.canViewOverallPanel=b.canModify()}updateFilterConditions(e){const t={membershipId:e.memberId,groupId:e.courseGroupId,childCourseId:e.childCourseId},s={columnId:e.gradebookColumnId,gradebookCategoryId:e.gradebookCategoryId};this.changingState||(c.isEqual(t,this.rowFilterParams)||(this.rowFilterParams=t,this.rowFiltersPresent()?this.setAdvancedFilterRows(e):this.setUnfilteredRows()),c.isEqual(s,this.columnFilterParams)||(this.columnFilterParams=s,this.columnFiltersPresent()?this.setAdvancedFilterColumns(e):this.setUnfilteredColumns()))}updateAffectedColumns(e){return this.$q.all(e.map((e=>{const t=e.data;return t.$fetch().$asPromise().then((()=>t.summary.$fetch().$asPromise()))}))).then((()=>{e.forEach((e=>this.gridData.updateColumnByMetadata(e.data)))}))}rowFiltersPresent(){const e=this.ultraState.params;return Object(d.areCourseGradesRowFiltersPresent)(e)}columnFiltersPresent(){const e=this.ultraState.params;return!!e.gradebookCategoryId||!!e.gradebookColumnId}setUnfilteredRows(){this.studentsTotal=this.availableRowSelectedOptions.length,this.$scope.$broadcast(G.b.ROW,this.availableRowSelectedOptions),this.$scope.$emit(o.a.ADVANCED_FILTERS_ROWS,this.availableRowSelectedOptions)}setUnfilteredColumns(){this.gridData.getFilteredColumns({}).then((e=>{this.availableColumnSelectedOptions=e,this.$scope.$broadcast(G.b.COLUMN,e),this.$scope.$emit(o.a.ADVANCED_FILTERS_COLUMNS,this.availableColumnSelectedOptions)}))}setAdvancedFilterRows(e){const t={membershipId:e.memberId,groupId:e.courseGroupId,childCourseId:e.childCourseId};this.gridData.fetchMemberships(t).then((e=>{this.studentsTotal=e.length,this.$scope.$broadcast(G.b.ROW,e),this.$scope.$emit(o.a.ADVANCED_FILTERS_ROWS,e)}))}setAdvancedFilterColumns(e){const t={columnId:e.gradebookColumnId,gradebookCategoryId:e.gradebookCategoryId};this.gridData.getFilteredColumns(t).then((e=>{this.filteredColumns=e,this.$scope.$broadcast(G.b.COLUMN,e),this.$scope.$emit(o.a.ADVANCED_FILTERS_COLUMNS,e)}))}initialize(){return this.$q(((e,t)=>{this.$q.all([this.bbLocalize.loadBundle("components/directives/grade/grade-grid"),this.bbLocalize.loadBundle("components/directives/grade/grade-input")]).then((()=>{this.gridData=this.$injector.instantiate(i.a,{gradeGridRebornDirectiveScope:this.$scope}),this.gridData.initialized.then((s=>{this.availableRowSelectedOptions=s.memberships,this.studentsTotal=s.memberships.length,this.availableColumnSelectedOptions=s.columns,this.$scope.$emit(o.a.ADVANCED_FILTERS_ROWS,this.availableRowSelectedOptions),this.$scope.$emit(o.a.ADVANCED_FILTERS_COLUMNS,this.availableColumnSelectedOptions),this.gridOptions={memberships:s.memberships,columns:s.columns,rowHeight:this.rowHeight,headerHeight:this.headerHeight,headerContentHeight:89,headerBorder:!0,rowBorder:!0,callbacks:{data:(e,t)=>this.gridData.loadGradeData(e,t),column:this.gridData.course.isComplete()?void 0:(e,t)=>this.onClickAddColumnButton(e,t)}},this.initialized=!0,this.handleMergedCourse(),this.gridData.course.isComplete()?(this.isOverallPanelShown=!1,e(!0)):this.gradeService.needsToSetupOverall(this.gridData.getColumnMetadatas(),this.gridData.course.id).then((t=>{t?this.loadSetupOverallGradeMessageIsHiddenPreference&&!this.setupOverallGradeMessageIsHiddenPreference&&this.loadSetupOverallGradeMessageIsHiddenPreference(V.SETUP_OVERALL_GRADE_MESSAGE_COURSE_PREFERENCE.key).then((()=>{var e;const t="true"===(null===(e=this.setupOverallGradeMessageIsHiddenPreference)||void 0===e?void 0:e.value);this.isOverallPanelShown=!t})):this.isOverallPanelShown=t,e(!0)})).catch(t)})).catch((e=>{console.error(e),t(e)}))})).catch((e=>{console.error(e),t(e)}))}))}subscribeToReduxChanges(){const e=this.$ngRedux.connect((e=>({setupOverallGradeMessageIsHiddenPreference:E.select.coursePreference.getCoursePreferenceByKeyAndCourseId(e,V.SETUP_OVERALL_GRADE_MESSAGE_COURSE_PREFERENCE.key,this.$scope.course().id)})),(e=>({loadSetupOverallGradeMessageIsHiddenPreference:t=>e(E.actions.coursePreference.loadCoursePreference({key:t,courseId:this.$scope.course().id}))})))(this);this.$scope.$on("$destroy",e)}refreshSchema(e){this.gridData.getSchema()[e.id]=e,c.forEach(this.gridData.getColumnMetadatas(),(e=>{const t=this.gridData.getSchema()[e.gradingSchemaId];(null==t?void 0:t.scaleType)===R.SchemaScaleType.Tabular&&this.gridData.updateColumnByMetadata(e)})),this.$scope.$broadcast(G.b.COLUMN)}refreshDataCells(e,t){c.forEach(e,(e=>{c.forEach(t,(t=>{this.gridData.refreshDataCell(e,t)}))})),this.$scope.$broadcast(G.b.COLUMN)}refreshDataCell(e,t){this.gridData.refreshDataCell(e,t),this.$scope.$broadcast(G.b.COLUMN)}addStudentColumnBorder(e){e.externalGrade&&!this.gridData.isColumnExisting(e.id)&&this.gridData.getColumn(i.a.COLUMN_STUDENT).deleteBorder()}deleteStudentColumnBorder(e){e.externalGrade&&this.gridData.getColumn(i.a.COLUMN_STUDENT).addBorder()}updateOverallNotation(){const e=c.find(this.gridData.getColumns(),(e=>e instanceof a.k));e&&(e.loadNotation(),this.gridData.updateColumnByMetadata(e.data)&&this.$scope.$broadcast(G.b.COLUMN))}getAffectedColumnsBeforeEdit(e){const t=this.gridData.getColumn(e.id);let s=[];return t instanceof a.i&&(s=t.affectedColumnsBeforeEdit),s}getAffectedColumns(e){const t=e.findAffectedColumns(),s=c.find(this.gridData.getColumns(),(e=>e instanceof a.k));return s&&t.push(s),t}setupSearchFilterListener(){this.$scope.$on(o.a.GRADEBOOK_USER_SELECTED,((e,t)=>{const s=this.availableRowSelectedOptions;t&&t.length>0?this.$scope.$broadcast(G.b.ROW,c.intersectionWith(s,t,((e,t)=>e.userId===t))):s.length!==this.gridOptions.memberships.length&&(this.searchedResult&&"user"===this.searchedResult.type?this.$scope.$broadcast(G.b.ROW,[]):this.$scope.$broadcast(G.b.ROW,s))})),this.$scope.$on(o.a.GRADEBOOK_CLEAR_SEARCHBOX_SELECTION,((e,t)=>{const s=this.getAvailableRowSelectedOptions();this.availableRowSelectedOptions&&this.availableRowSelectedOptions.length!==this.gridOptions.memberships.length&&this.$scope.$broadcast(G.b.ROW,s),this.filteredColumns&&this.filteredColumns.length!==this.availableColumnSelectedOptions.length&&this.$scope.$broadcast(G.b.COLUMN,this.availableColumnSelectedOptions),this.ids&&(this.ids=null),this.handleMergedCourse()})),this.$scope.$on(o.a.GRADEBOOK_COLUMN_SELECTED,((e,t)=>{const s=this.availableColumnSelectedOptions;this.filterColumns(((e,t)=>c.filter(e,(e=>e.filterByColumId(t)))),t,s)})),this.$scope.$on(o.a.GRADEBOOK_CATEGORY_SELECTED,((e,t)=>{const s=this.availableColumnSelectedOptions;this.ids=t,this.filterColumns(((e,t)=>c.filter(e,(e=>e.filterByCategoryId(t)))),t,s)}))}setupColumnChangeListener(){this.$scope.$on(_.c,((e,t,s)=>{t.summary.$fetch().$asPromise().then((()=>{this.addStudentColumnBorder(t),this.updateColumns(t),this.updateFilteredColumns(),this.updateCategoryColumns(),this.filteredColumns&&this.toast.show({messageKey:"components.directives.grade.grid.newItemAdded",icon:"icon-check",toastStatus:"success"})}))})),this.$scope.$on("content-update",((e,t)=>{if(t.isScorm()){const e=t.getScormGradebookItems().map((e=>this.$scope.course().gradebook.columns.$buildRaw(e.gradingColumn)));this.$q.all(e.map((e=>(e.ui={content:t},e.summary.$fetch().$asPromise())))).then((()=>{e.forEach((e=>this.updateColumns(e)))}))}if(t.isDiscussion()){const e=this.gridData.getColumnMetadataByContentId(t.id);c.isUndefined(e)||this.gridData.initializeGroupsMemberships().then((()=>e.summary.$fetch().$asPromise())).then((()=>{this.updateColumns(e)}))}})),this.$scope.$on("bb-delete-column",((e,t)=>{const s=this.gridData.getColumn(t.id);this.deleteStudentColumnBorder(t);let n=this.$q.when();if(s instanceof a.c){const e=this.getAffectedColumns(s);n=this.$q.all(e.map((e=>e.data.$fetch().$asPromise()))).then((()=>{e.forEach((e=>this.gridData.updateColumnByMetadata(e.data)))}))}s instanceof a.k&&this.gridData.clearOverallColumn(),n.then((()=>{this.gridData.deleteColumnById(t.id),c.remove(this.filteredColumns,(e=>e.data.id===t.id)),this.$scope.$broadcast(G.b.COLUMN),this.timeout((()=>{const e=this.$element.find(":focus").parents("bb-grade-grid-column-header-reborn").data("col");c.isUndefined(e)||this.$scope.$broadcast(o.a.FOCUSIN_CELL,{columnId:e.id})}),this.$scope,0,!1)}))})),this.$scope.$on("attempt-base-content-update",((e,t)=>{this.updateAttempBaseContent(t)})),this.$scope.$on("attempt-base-content-update-by-regrading",((e,t)=>{this.updateAttempBaseContent(t)}))}updateAttempBaseContent(e){const t=this.gridData.getColumnMetadataByContentId(e.id);c.isUndefined(t)||t.$fetch().$asPromise().then((()=>{this.gridData.initializeGroupsMemberships().then((()=>t.summary.$fetch().$asPromise())).then((()=>{this.updateColumns(t)}))}))}updateColumns(e){const t=this.getAffectedColumnsBeforeEdit(e),s=this.gridData.updateColumnByMetadata(e);if(s instanceof a.c){let e=s.findAffectedColumns();e=c.unionBy(t,e,"id");const n=c.find(this.gridData.getColumns(),(e=>e instanceof a.k));n&&e.push(n),this.$q.all(e.map((e=>e.data.$fetch().$asPromise()))).then((()=>{e.forEach((e=>this.gridData.updateColumnByMetadata(e.data))),this.$scope.$broadcast(G.b.COLUMN)}))}else this.$scope.$broadcast(G.b.COLUMN)}setContainerHeight(){const t=e(".course-grades-header-buttons-wrapper"),s=t.offset().top+t.outerHeight()+parseFloat(t.css("margin-bottom")),n=window.innerHeight-s;this.$element.find(".grade-grid-container").css("height",n)}getRowCount(){return this.studentsTotal}getGridData(){return this.gridData}getElement(){return this.$element}createMenuScope(e,t){const s=this.$scope.$new(!0);return s.adjustPosition=t=>{const s=e.left+t.width(),n=this.getGradeGridContainerElementRight();s>n&&(e.left-=s-n+Object(M.a)()),t.offset(e)},s.positionAfter=t,s.attendanceColumnExists=this.isAttendanceExisting(),s.attendanceIsAvailable=this.attendanceIsAvailable,s}onClickAddColumnButton(t,s){const n=c.isUndefined(s)||"left"===s.position?"start":s.id,i=`grade-grid-add-column-menu-reborn-${n}`;if(this.isMenuExisting(i))return;const o=e(t.target).offset();o&&(o.top+=30);const a=this.createMenuScope(o,n);this.popupMenu(i,L,a),this.timeout((()=>{const n=this.getPopupMenu();n.on("keydown",(i=>{i.keyCode===x.g||i.keyCode===x.u?(n.data("destroy")(),e(t.target).click(),e(t.target).focus(),i.preventDefault(),i.stopPropagation()):x.y(i)&&this.$scope.$broadcast(G.b.FOCUS_CELL,void 0,s)})),this.getMenuitems().first().focus()}),a,0,!1),t.preventDefault(),t.stopPropagation()}getPopupMenu(){return this.$element.find("[bb-grade-grid-menu-reborn]")}getMenuitems(){return this.getPopupMenu().find("li>:tabbable")}getGradeGridContainerElement(){return this.$element.children("#grade-grid-container")}getGradeGridContainerElementRight(){const e=this.getGradeGridContainerElement();return e.offset().left+e.width()}getGradeGridContainerElementBottom(){const e=this.getGradeGridContainerElement();return e.offset().top+e.height()}popupMenu(e,t,s,n){s.id=e,this.showMenu(t,s,n)}isMenuExisting(e){return!!this.$element.children(`#${e}`).length}showMenu(e,t,s){t.$applyAsync((()=>{this.$compile(e)(t,(e=>{this.$element.append(e),c.isUndefined(s)||e.offset(s)}))}))}isAttendanceExisting(){return!!this.availableColumnSelectedOptions.find((e=>this.gridData.getColumnMetadata(e.id)&&this.gridData.getColumnMetadata(e.id).isAttendance()))}get attendanceIsAvailable(){return this.$scope.attendanceIsAvailable&&this.$scope.attendanceIsAvailable()}setupOverallGradeHideMessageCallback(){this.$scope.$apply((()=>this.isOverallPanelShown=!1))}refreshColumns(e=c.noop){this.gridData.refreshAllColumns(),e(),this.$scope.$broadcast(G.b.COLUMN)}filterColumns(e,t,s){t&&(this.filteredColumns=e(s,t),this.$scope.$broadcast(G.b.COLUMN,this.filteredColumns))}updateFilteredColumns(){const e=c.find(this.filteredColumns,(e=>e instanceof a.k));this.filteredColumns&&!e&&(this.filteredColumns.push(c.find(this.availableColumnSelectedOptions,(e=>e instanceof a.k))),this.$scope.$broadcast(G.b.COLUMN,this.filteredColumns))}updateCategoryColumns(){const e=this.availableColumnSelectedOptions;this.filterColumns(((e,t)=>c.filter(e,(e=>e.filterByCategoryId(t)))),this.ids,e)}handleMergedCourse(){this.mergedCourses.forEach((e=>{if(this.availableRowSelectedOptions){c.find(this.availableRowSelectedOptions,(t=>t.childCourseId===e.id))||(e.ui.hidden=!0)}}))}getCheckedMergeCourseIds(){return c.filter(this.mergedCourses,(e=>e.ui.checked)).map((e=>e.id))}getAvailableRowSelectedOptions(){return this.availableRowSelectedOptions}};K=Object(n.__decorate)([Object(n.__param)(0,Object(u.b)("$compile")),Object(n.__param)(1,Object(u.b)("$element")),Object(n.__param)(2,Object(u.b)("$injector")),Object(n.__param)(3,Object(u.b)("$ngRedux")),Object(n.__param)(4,Object(u.b)("$q")),Object(n.__param)(5,Object(u.b)("$scope")),Object(n.__param)(6,Object(u.b)("$rootScope")),Object(n.__param)(7,Object(u.b)("$location")),Object(n.__param)(8,Object(u.b)(v.d)),Object(n.__param)(9,Object(u.b)(_.k)),Object(n.__param)(10,Object(u.b)(I.b)),Object(n.__param)(11,Object(u.b)("$attrs")),Object(n.__param)(12,Object(u.b)(C.serviceName)),Object(n.__param)(13,Object(u.b)(q.serviceName)),Object(n.__param)(14,Object(u.b)(z.serviceName)),Object(n.__param)(15,Object(u.b)(O.b)),Object(n.__param)(16,Object(u.b)(A.b))],K);class W{constructor(e){this.$injector=e,this.restrict="E",this.template=P,this.controller=K,this.controllerAs="gg",this.scope={course:"&",columnMetadatas:"<columns",attendanceIsAvailable:"&?",mergedCourses:"<"}}}W.$inject=["$injector"],r.module(H,[y.b,p.a,m.a,h.a,b.a,f.a,w.a,S.a,D.a,k.a,T.a,$.a,I.a,A.a,j.a,v.b,g.a]).directive(Q,["$injector",e=>e.instantiate(W)])}).call(this,s("71td"))},LQXi:function(e,t){e.exports='<div class="multiple-answer-attempt-authoring multiple-answer">\n    <div class="multiple-answer-question question-container">\n        <bb-rich-text-editor\n          plugin-options="editorPluginOptions"\n          ng-model="questionAttempt.question.questionText.rawText"\n          supports-inline-document-render="true"\n          is-read-only="true">\n        </bb-rich-text-editor>\n    </div>\n    <div class="multiple-answer-answers-container">\n      <ol class="multiple-answer-answers">\n        <li class="{{\'js-multiple-answer-answer-\' + $index}}" ng-repeat="answer in questionAttempt.question.answers track by $index" ng-class="{\'selected-answer\': assessmentQuestion.givenAnswer[$index]}">\n          <input ng-if="questionAttempt.question.singleCorrectAnswer" type="radio"\n                 id="{{assessmentQuestion.elementId}}-answer-{{$index}}"\n                 name="{{assessmentQuestion.elementId}}-answer-{{$index}}"\n                 ng-checked="assessmentQuestion.givenAnswer[$index]"\n                 ng-click="assessmentQuestion.onSingleAnswerInputChanged($index)"\n                 ng-value="true"\n                 analytics-id="assessment.question.single.correct.answer.input.radio"/>\n          <input ng-if="!questionAttempt.question.singleCorrectAnswer" type="checkbox"\n                 id="{{assessmentQuestion.elementId}}-answer-{{$index}}"\n                 name="{{assessmentQuestion.elementId}}-answer-{{$index}}"\n                 ng-model="assessmentQuestion.givenAnswer[$index]"\n                 analytics-id="assessment.question.single.correct.answer.input.checkbox"/>\n          <label for="{{assessmentQuestion.elementId}}-answer-{{$index}}" class="checkbox-label">\n            <bb-rich-text-editor\n              plugin-options="{\'attachment\': true, \'math\': true, \'contentMarket\': true}"\n              ng-model="answer.answerText.rawText"\n              is-read-only="true">\n            </bb-rich-text-editor>\n          </label>\n        </li>\n      </ol>\n    </div>\n</div>\n'},LRgG:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-partial-credit",use:"icon-medium-partial-credit-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-partial-credit"><circle cx="12" cy="12" r="11" stroke-width="2" /><path d="M12 5v14c-3 0-7-2.5-7-7s4-7 7-7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M10 7.4688v9.0624C8.4059 15.7924 7 14.2105 7 12s1.4059-3.7924 3-4.5312z" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},LTOG:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return n}));class n{constructor(e,t){this.scope=e,this.timeout=t}highlight(t){t.isUpdated?(e(".rb-col-"+t.id).addClass("highlighted"),delete t.isUpdated,this.timeout((()=>{e(".rb-col-"+t.id).removeClass("highlighted")}),this.scope,6e3,!1)):e(".rb-col-"+t.id).removeClass("highlighted")}}}).call(this,s("71td"))},LecS:function(e,t,s){"use strict";var n=s("Llzl"),i=s("pjml"),o=s("/hmo");s.d(t,"a",(function(){return a}));const a="ultra.directives.lti";class r{constructor(e){this.CourseModel=e,this.replace=!0,this.restrict="E",this.scope={content:"=",targetContent:"=?",prefix:"="},this.template=o,this.link=(e,t)=>{const s=e.$watch("targetContent.contentHandler",(t=>{null!=t&&(e.$emit("click-to-invoke-child-directive-init"),s())}));!e.targetContent&&e.content&&e.content.contentDetail&&(e.targetContent=e.content.getLinkContentSource(),e.targetContent.$then((()=>{e.content.description=e.targetContent.description})))}}}r.$inject=[i.m.serviceName],n.module(a,[]).directive("bbLtiLinkItem",["$injector",e=>e.instantiate(r)])},Lrq8:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-add-feedback",use:"icon-medium-add-feedback-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-add-feedback"><path d="M1 1h22v19h-8l-3 3-3-3H1V1zM12 6v10M7 11h10" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},MKP7:function(e,t,s){"use strict";s.d(t,"a",(function(){return m}));var n=s("D57K"),i=s("7UH7"),o=s("Llzl"),a=s("/KQw"),r=s("0JpG"),c=s("TnpK"),l=s("+4Px"),d=s("e6jQ"),u=s("tecA"),p=s("aHpC");const m="ultra.directives.basicTextEditor";let h=class extends u.a{constructor(e,t,s,n,i,o){super(t,s,n,i,o),this.shouldPreventLineBreaking=!0,t.$on(u.b,(()=>{this.updateOriginalValues(),this.isTextTouched=!1})),t.shouldPreventLineBreaking&&(this.shouldPreventLineBreaking=t.shouldPreventLineBreaking())}onKeydown(e){this.shouldPreventLineBreaking&&e.keyCode===l.f&&(e.stopPropagation(),e.preventDefault())}};h.$inject=[],h=Object(n.__decorate)([Object(n.__param)(0,Object(p.b)("$q")),Object(n.__param)(1,Object(p.b)("scope")),Object(n.__param)(2,Object(p.b)("element")),Object(n.__param)(3,Object(p.b)("ctrl")),Object(n.__param)(4,Object(p.b)(r.serviceName)),Object(n.__param)(5,Object(p.b)(c.d))],h);class b{constructor(e){this.$injector=e,this.require=["ngModel"],this.replace=!0,this.restrict="E",this.scope={placeholderKey:"@",placeholderAttrsValues:"@",elementId:"@",readonly:"&",getInputMaxLength:"&?inputMaxLength",onchangeFunc:"&?",onblurFunc:"&?",onFocusFunc:"&",ngModel:"=",fieldRequired:"&?",plainText:"=?",validationMessage:"@?",focusOn:"@?",noValidationMessage:"&?",direction:"&?",shouldPreventLineBreaking:"&?"},this.link=(e,t,s,n)=>{const i=n[0];e.textEditor=this.$injector.instantiate(h,{scope:e,element:t,ctrl:i}),e.elementId||(e.elementId="text-editor-"+d.a())},this.template=i}}b.$inject=["$injector"],o.module(m,[a.a,r.moduleName,c.b]).directive("bbBasicTextEditor",["$injector",e=>e.instantiate(b)])},MYrX:function(e,t){e.exports='<div class="rubric-settings" bb-load-bundle="components/directives/rubric/rubric-settings">\n  <div class="rubric-settings-controls" ng-switch="isDisabled() || !rubricSettings.hasRubricPermissions">\n    <div class="tool-icon">\n      <bb-svg-icon size="medium" icon="rubric"></bb-svg-icon>\n    </div>\n    <div ng-switch-when="true">\n      <div class="tool-text no-active-rubric-container">\n        <span class="settings-label" bb-translate>components.directives.rubric.settings.gradingRubric</span>\n        <div class="text toggle-rubric-list permissions-text">\n          <span bb-translate>components.directives.rubric.settings.unavailable.permission</span>\n        </div>\n      </div>\n    </div>\n    <div ng-switch-default>\n      <div class="tool-text no-active-rubric-container" ng-show="!rubricSettings.rubric">\n        <span class="settings-label" bb-translate>components.directives.rubric.settings.useRubric</span>\n        <button class="button button--text toggle-rubric-list settings-link" ng-click="rubricSettings.toggleRubricList()" ng-if="!contentHasQuestions()"\n                bb-translate-attrs="{\'aria-label\':\'components.directives.rubric.settings.addRubric\'}" bb-translate type="button" analytics-id="components.directives.rubric.settings.addRubric">\n          components.directives.rubric.settings.addRubric\n        </button>\n\n        \x3c!-- tabindex added because field is normally interactive. See LRN-118128 --\x3e\n        <div class="text toggle-rubric-list cant-add-rubric-text"\n             ng-if="contentHasQuestions()"\n             ng-switch="rubricSettings.columnIsAssignmentCategory()">\n          <span ng-switch-when="true">\n            <span bb-translate>components.directives.rubric.settings.unavailable.assignment</span>\n          </span>\n          <span ng-switch-default>\n            <span bb-translate>components.directives.rubric.settings.unavailable.assessment</span>\n          </span>\n        </div>\n      </div>\n      <div class="tool-text rubric-item  js-rubric-id-{{ rubricSettings.rubric.id }} large-12 medium-12 small-10 rubric-item--width" ng-show="rubricSettings.rubric">\n        <span class="settings-label rubric-title" bb-translate>\n          components.directives.rubric.settings.gradingRubric\n        </span>\n        <span class="settings-link rubric-title">\n          <a class="rubric-title__text" bb-peek-sref="rubric.mode({rubricId: rubricSettings.rubric.id, mode: \'edit\'})" analytics-id="components.directives.rubric.settings.tooltip.title.link">{{ rubricSettings.rubric.title }}</a>\n        </span>\n      </div>\n      <div ng-if="rubricSettings.rubric">\n        <button ng-if="rubricSettings.hasRubricEvals"\n                bb-confirmation-needed="x-bb-rubric-delete-association"\n                show-type="always"\n                class="remove-active-rubric super-clear svg-icon-button medium"\n                ng-click="rubricSettings.removeActiveRubric($event)" tabindex="0"\n                bb-translate-attrs="{\'aria-label\':\'components.directives.rubric.settings.removeRubric\', \'title\': \'components.directives.rubric.settings.tooltip.remove\'}"\n                type="button" analytics-id="components.directives.rubric.settings.tooltip.remove.button">\n          <bb-svg-icon size="small" icon="trash"></bb-svg-icon>\n        </button>\n        <button ng-if="!rubricSettings.hasRubricEvals"\n                class="remove-active-rubric super-clear svg-icon-button medium js-remove-evaluation"\n                ng-click="rubricSettings.removeActiveRubric($event)" tabindex="0"\n                bb-translate-attrs="{\'aria-label\':\'components.directives.rubric.settings.removeRubric\', \'title\': \'components.directives.rubric.settings.tooltip.remove\'}"\n                type="button" analytics-id="components.directives.rubric.settings.tooltip.remove.button">\n          <bb-svg-icon size="small" icon="trash"></bb-svg-icon>\n        </button>\n      </div>\n      <span class="rubric-extra-info" ng-if="rubricSettings.getPeerGradingInfo() != null">\n        <span class="restriction" ng-if="rubricSettings.getPeerGradingInfo() === \'peerGrading\'" bb-translate>components.directives.rubric.settings.extraInfo.peerGrading</span>\n      </span>\n    </div>\n  </div>\n</div>\n'},Mak1:function(e,t,s){},Mnbc:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-groups",use:"icon-small-groups-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-groups"><path d="M12 15s-1-2-4-2M4 15s1-2 4-2M8 13c1.6569 0 3-1.3431 3-3S9.6569 7 8 7s-3 1.3431-3 3 1.3431 3 3 3zM12 5c1.1046 0 2-.8954 2-2s-.8954-2-2-2-2 .8954-2 2 .8954 2 2 2zM1 7s1-2 3-2 3 2 3 2M9 7s1-2 3-2 3 2 3 2M4 5c1.1046 0 2-.8954 2-2s-.8954-2-2-2-2 .8954-2 2 .8954 2 2 2z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},MoIS:function(e,t,s){"use strict";var n=s("Llzl"),i=s("0JpG"),o=s("tka7"),a=s("70Xn"),r=s("tmbA");s.d(t,"c",(function(){return c})),s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return d}));const c="ultraUi.components.directives.grade.pastDueZero",l="bb-past-due-zero-confirmation",d="bb-past-due-zero-settings",u="course.grades.pastDue.confirmationNeeded.";class p{constructor(e,t,s,n,i){this.scope=e,this.element=t,this.attrs=s,this.$modal=n,this.bbLocalize=i,this.scope.$on(l,((e,t)=>{this.displayPastDueConfirmation(t)})),this.scope.$on(d,((e,t)=>{this.isPastZeroAssigned=t,this.displayPastDueConfirmation()}))}displayPastDueConfirmation(e){e?this.initModalTranslateOptions(e):this.initModalTranslateOptions();let t=!1;const s=this.scope;this.$modal.open({template:e?a:r,scope:s,resolve:{translations:[i.serviceName,e=>e.loadBundle("course/grades/pastDue/confirmationNeeded")]},controller:["$scope",i.serviceName,function(e,n){e.okAction=()=>{e.$close(),t=!0},e.cancelAction=()=>{e.$close(),t=!1,s.cancelCallback&&s.cancelCallback()}}]}).result.then((()=>{t&&this.scope.confirmCallback&&(this.isPastZeroAssigned?this.scope.confirmCallback():this.scope.confirmCallback({args:{choice:this.scope.modalTranslateOptions.choiceModal}}))}),(()=>{this.scope.dismissCallback&&this.scope.dismissCallback()}))}initModalTranslateOptions(e){if(e)return this.scope.modalTranslateOptions={title:{key:u+"title"},instructions:{key:u+e+".instructions"}};const t=this.isPastZeroAssigned?"assign":"unassign";if(this.scope.modalTranslateOptions={title:{key:u+t+".title"},instructions:{key:u+t+".instructions"},confirm:{key:u+t+".confirm"},cancel:{key:u+t+".cancel"}},!this.isPastZeroAssigned){const e=[{id:"past-due-unassign-retain",name:"pastDueUnassignZero",value:o.a.Retain.toString(),localizedKey:u+"unassign.choices.retain"},{id:"past-due-unassign-delete",name:"pastDueUnassignZero",value:o.a.Delete.toString(),localizedKey:u+"unassign.choices.delete",descriptionKey:u+"unassign.choices.instructions"}];Object.assign(this.scope.modalTranslateOptions,{choices:e,choiceModal:e[0].value})}return this.scope.modalTranslateOptions}}p.$inject=["scope","element","attrs","$modal",i.serviceName];class m{constructor(e){this.$injector=e,this.restrict="E",this.template=a,this.scope={confirmCallback:"&?",cancelCallback:"&?",dismissCallback:"&?"},this.link=(e,t,s)=>{e.pastDueZero=this.$injector.instantiate(p,{scope:e,element:t,attrs:s})}}}m.$inject=["$injector"],n.module(c,[]).directive("bbPastDueZero",["$injector",e=>e.instantiate(m)])},NEyJ:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-move-item-up-down",use:"icon-small-move-item-up-down-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-move-item-up-down"><path d="M5 11V3M7 4L5 2 3 4M11 5v8M9 12l2 2 2-2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},NMEb:function(e,t,s){"use strict";var n=s("Llzl");var i=class{static convertToGrayscale(e){const t=document.createElement("canvas"),s=t.getContext("2d"),n=e.naturalWidth,i=e.naturalHeight;t.width=n,t.height=i,s.drawImage(e,0,0);const o=s.getImageData(0,0,n,i);let a;const r=o.data.length;for(let e=0;e<r;e+=4)a=(o.data[e]+o.data[e+1]+o.data[e+2])/3,o.data[e]=a,o.data[e+1]=a,o.data[e+2]=a;return s.putImageData(o,0,0,0,0,o.width,o.height),t.toDataURL()}};s.d(t,"a",(function(){return o}));const o="ultra.components.directives.imageGrayscale";class a{constructor(e,t,s){this.scope=e,this.element=t,this.attributes=s;"true"===this.attributes.bbImageGrayscale&&c()&&t.one("load",this.onLoadCallback())}onLoadCallback(){return()=>{const e=i.convertToGrayscale(this.element[0]);this.element[0].src=e}}}class r{constructor(){this.restrict="A",this.link=(e,t,s)=>new a(e,t,s)}}function c(){const e=document.documentMode;return 10===e||11===e}const l=n.module(o,[]);c()&&l.directive("bbImageGrayscale",["$injector",e=>e.instantiate(r)])},NZ4S:function(e,t){e.exports='<bb-modal role="alertdialog" class="notification upload-disallowed-file-type upload-failed-button" bb-translate-attrs="{\'aria-label\': \'course.grades.grades-upload-settings.fileTypeError.title\'}" \n          modal-title-key="course.grades.grades-upload-settings.fileTypeError.title" aria-describedby="gradebook-upload-failed"\n          analytics-id-tag-prefix="course.grades.grades-upload-settings">\n  <div name="modal-contents">\n    <p id="gradebook-upload-failed" bb-translate="course.grades.grades-upload-settings.fileTypeError.content"></p>\n  </div>\n  <a name="modal-footer-help-link" \n     href="" \n     bb-translate-attrs="{\'href\': \'course.grades.grades-upload-settings.helpLinkUpload\'}" \n     target="_blank" \n     bb-translate="course.grades.grades-upload-settings.helpButton" \n     rel="noopener noreferrer"\n     analytics-id="course.grades.grades-upload-settings.helpButton">\n  </a>\n  <button name="modal-footer-button-primary" \n          class="button js-discard-changes js-primary-button" \n          ng-click="$dismiss()"\n          analytics-id="course.grades.gradesUploadSettingsError.closeButton.button">\n    <span bb-translate="course.grades.grades-upload-settings.closeButton"></span>\n  </button>\n</bb-modal>'},Ne7M:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-discussion",use:"icon-medium-discussion-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-discussion"><path d="M8 21.4025a10.4446 10.4446 0 01-1.75-.8072L1 22l1.4318-5.2034C1.5217 15.2417 1 13.4318 1 11.5 1 5.701 5.701 1 11.5 1c4.5718 0 8.4611 2.9218 9.9025 7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M9 16c0 3.866 3.134 7 7 7 1.3878 0 2.6812-.3803 3.7692-1.0769L23 23l-1.0769-3.2308C22.6197 18.6812 23 17.3878 23 16c0-3.866-3.134-7-7-7s-7 3.134-7 7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="13" cy="16" r=".5" /><circle cx="16" cy="16" r=".5" /><circle cx="19" cy="16" r=".5" /></symbol>'});i.add(o);e.exports=o},NxQJ:function(e,t,s){"use strict";s.d(t,"c",(function(){return r})),s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return l}));var n=s("Llzl"),i=s("pjml"),o=s("Sa5G"),a=s("fYJU");const r="ultra.components.services.courseContent.conversation";class c{constructor(e,t,s,n,i){this.currentCourse=e,this.coreContent=t,this.$q=s,this.$rootScope=n,this.contextUser=i}checkAndAddAllConversations(){const e=this.$q.defer();return this.coreContent.ui.hasConversationAttached&&!this.coreContent.attachedForumLink?(this.conversationContent=this.coreContent,this.isCourseAvailable=this.coreContent.isAvailable,this.conversationContent.forumAttacherAction=i.p.ForumAttacherAction.ADD.toString().toUpperCase(),this.conversationContent.withParams({fields:"attachedForumLink"}).$patch().$then((t=>{this.currentCourse.contents.$find(t.attachedForumLink["resource/x-bb-courselink"].courseContent).$asPromise().then((e=>this.createNewDiscussion(e))),e.resolve()}))):e.resolve(),e.promise}markAllConversationsForRemoval(){this.coreContent.ui.hasConversationAttached||this.coreContent.allowConversations||!this.coreContent.attachedForumLink||(this.coreContent.attachedForumLink=null,this.coreContent.forumAttacherAction=i.p.ForumAttacherAction.DELETE.toString().toUpperCase())}createNewDiscussion(e){const t=e.contentDetail[o.f.Discussion.handle].id,s=this.currentCourse.forums.$find(t);s.messages.$fetch().$then((n=>{if(n){const e=n.find((e=>!e.groupId));if(e)return e}return s.messages.$build({forumId:t,courseId:e.courseId,parentId:"{unset id}",userId:this.contextUser.userId,postedName:this.contextUser.userModel.userName,body:{rawText:"",displayText:""},isDeleted:!1,isAvailable:!0}).$save().$asPromise()})).$then((()=>this.initializeDiscussionStatus()))}initializeDiscussionStatus(){this.coreContent&&(this.coreContent.ui.hasConversationAttached=!0,this.coreContent.attachedForumLink&&this.currentCourse.contents.$find(this.coreContent.attachedForumLink["resource/x-bb-courselink"].courseContent).$then((e=>{const t=e.contentDetail[o.f.Discussion.handle].id;this.currentCourse.forums.$find(t).$then((e=>{e.messages.$fetch().$then((e=>{const t=e[0];t&&(t.ui.replyText="")}))}))}))),this.conversationContent.isAvailable=this.isCourseAvailable,this.conversationContent.$patch().$then((e=>{this.coreContent=e}))}static showConversations(e){return!(!e||!e.id)&&(void 0===(e.ui&&e.ui.hasConversationAttached)&&(e.ui.hasConversationAttached=null!=e.attachedForumLink),e.ui.hasConversationAttached)}}c.$inject=["currentCourse","coreContent","$q","$rootScope",a.b];class l extends c{}n.module(r,[i.N,a.a]).service("courseContentConversation",c)},Nyb7:function(e,t){e.exports='<div class="complex-statistic-contents"></div>'},Ocaa:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return g}));s("0lMW"),s("gORw");var n=s("Llzl"),i=s("nbDY"),o=s.n(i),a=s("0JpG"),r=s("2a+M"),c=s("+4Px"),l=s("pjml"),d=s("lEL+"),u=s("GbAM"),p=s("Qbdf"),m=s("nYZ0"),h=s("W6wm"),b=s("J3aO");const g="ultra.components.directives.bbDragHandle";class v extends o.a{}v.Vertical=new v("vertical"),v.Horizontal=new v("horizontal"),v.Omnidirectional=new v("omnidirectional");class f{constructor(t,s,n,i,o,a,r){this.$rootScope=t,this.bbLocalizeService=s,this.dragDropService=n,this.timeout=i,this.currentCourseService=o,this.contentService=a,this.menuCloserService=r,this.bbDragMoveTimeoutId=null,this.scope={dragItemId:"@",dragItemName:"@",dragItemType:"@",dragDirection:"@?",dragItemContext:"@?"},this.restrict="A",this.link=(t,s,n)=>{this.dragDirection=v.parse(t.dragDirection)||v.Vertical,this.dragDropService.currentDragContext=t.dragItemContext,e(s).parent().attr("role","application"),s.on("mousedown",(n=>{function i(e){e.stopImmediatePropagation()}n.preventDefault(),document.addEventListener("click",i,!0),this.dragStart(n,s,t),e(document).on("mousemove.reorder",(e=>{this.dragMove(e,t)})),e(document).on("mouseup.reorder",(n=>{this.dragEnd(n,s),e(document).off("mousemove.reorder"),e(document).off("mouseup.reorder"),s.on("$destroy",(()=>{document.removeEventListener("click",i,!0)})),this.timeout((()=>{document.removeEventListener("click",i,!0)}),t,0,!1)}))})),s.on("keydown",(s=>{if(s.stopPropagation(),s.keyCode===c.f||s.keyCode===c.t)if(s.preventDefault(),this.dragDropService.isKeyboardDragging){const s=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(t),key:"components.services.drag-drop.aria.reorder-stopped",noWrap:!0});this.$rootScope.$broadcast(u.a,s),e(document.body).removeClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-end")}else{this.dragDropService.isKeyboardDragging=!0,this.dragDropService.currentDragId=t.dragItemId,this.dragDropService.currentDragType=t.dragItemType,this.contentHasFolderChild(t),this.dragDropService.currentDropTargetId=t.dragItemId,this.dragDropService.positionBefore=t.dragItemId,e(document.body).addClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-start");const s=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(t),key:"components.services.drag-drop.aria.reorder-started",params:{itemName:t.dragItemName},noWrap:!0});this.$rootScope.$broadcast(u.a,s)}else if(s.keyCode===c.v)s.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-up");else if(s.keyCode===c.d)s.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-down");else if(s.keyCode===c.s)s.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-right");else if(s.keyCode===c.j)s.preventDefault(),this.$rootScope.$broadcast("keyboard-drag-left");else if(s.keyCode===c.g&&(s.preventDefault(),this.dragDropService.isKeyboardDragging)){const s=this.bbLocalizeService.translateSync({locale:this.bbLocalizeService.getLocale(t),key:"components.services.drag-drop.aria.reorder-canceled"});this.$rootScope.$broadcast(u.a,s),e(document.body).removeClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-cancel")}})),s.on("blur",(()=>{this.dragDropService.isKeyboardDragging&&(e(document.body).removeClass("bb-is-dragging"),this.$rootScope.$broadcast("keyboard-drag-cancel"))}));const i=e=>{this.dragStart(e,s,t)},o=e=>{this.dragMove(e,t)},a=e=>{this.dragEnd(e,s)},r=()=>{this.dragCancel()};s[0].addEventListener("touchstart",i,!1),s[0].addEventListener("touchmove",o,!1),s[0].addEventListener("touchend",a,!1),s[0].addEventListener("touchcancel",r,!1),t.$on("$destroy",(()=>{s[0].removeEventListener("touchstart",i,!1),s[0].removeEventListener("touchmove",o,!1),s[0].removeEventListener("touchend",a,!1),s[0].removeEventListener("touchcancel",r,!1)}))}}contentHasFolderChild(e){if(l.p.ContentHandler.Folder.isEqualTo(e.dragItemType)&&!(()=>h.a.Discussions===this.dragDropService.currentDragContext)()){const e=l.p.ContentRootNode.ROOT,t=this.currentCourseService.course,s=this.contentService.findRootNode(t,e);this.contentService.getContentInContentTree(s,t.courseId,this.dragDropService.currentDragId).then((e=>{e.content&&(this.dragDropService.currentDragHasFolderChild=e.content.getChildren().$asPromise().then((e=>e.some((e=>e.isUiFolder())))))}))}}dragStart(t,s,n){if(this.dragDropService.currentDragElement){const t=e(".f-open-dropdown");t.length>0&&window.Foundation.libs.dropdown.close(t),this.dragDropService.currentDragElement.remove()}if(this.$rootScope.$broadcast("bb-drag-start"),e(document.body).addClass("bb-is-dragging"),this.dragDropService.originalElement=s.closest(this.dragDropService.dragElementSelector),this.dragDropService.currentDragElement=this.dragDropService.originalElement.clone(),this.dragDropService.idOfPreviousItem=this.dragDropService.originalElement.prev(".drag-element").find("[drag-item-id]").attr("drag-item-id"),this.dragDropService.idOfNextItem=this.dragDropService.originalElement.next(".drag-element").find("[drag-item-id]").attr("drag-item-id"),this.menuCloserService.closeAnyOpenAngularMenus(),l.p.ContentHandler.Folder.isEqualTo(n.dragItemType)){this.$rootScope.$broadcast("close-folder-immediately-by-id",n.dragItemId);this.dragDropService.currentDragElement.find(".img-icon-folder-open").removeClass("img-icon-folder-open").addClass("img-icon-folder")}this.dragDropService.originalElement.addClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.addClass(this.dragDropService.movableElementClass).addClass("mouse-touch-drag"),this.dragDropService.originalElement.after(this.dragDropService.currentDragElement),this.dragDropService.currentDragId=n.dragItemId,this.dragDropService.currentDragType=n.dragItemType,this.contentHasFolderChild(n),this.dragDropService.currentDropTargetId=n.dragItemId,this.dragDropService.positionBefore=n.dragItemId,this.dragDropService.createDropPlaceholderElement(this.dragDropService.currentDragElement),this.dragMove(t,n)}dragEnd(t,s){e(document.body).removeClass("bb-is-dragging"),t.preventDefault(),this.dragDropService.originalElement.removeClass(this.dragDropService.originalElementClass),this.dragDropService.currentDragElement.removeClass(this.dragDropService.movableElementClass),this.dragDropService.currentDragElement.removeAttr("style"),this.$rootScope.$broadcast("bb-drag-end")}dragCancel(){this.$rootScope.$broadcast("bb-drag-cancel"),e(document.body).removeClass("bb-is-dragging")}dragMove(e,t){e.preventDefault();const s=this.dragDropService.currentDragElement.find("[bb-drag-handle]"),n=this.dragDropService.originalElement.find("[bb-drag-handle]").offset(),i=s.offset(),o=this.dragDropService.currentDragElement.offset(),a=i.left-o.left,c=i.top-o.top,l=a+s.width()/2,d=c+s.height()/2,u=v.Horizontal.isEqualTo(this.dragDirection)||v.Omnidirectional.isEqualTo(this.dragDirection),p=v.Vertical.isEqualTo(this.dragDirection)||v.Omnidirectional.isEqualTo(this.dragDirection);let m,h,b,g;e.touches?(m=u?e.touches[0].pageX-l:o.left,h=p?e.touches[0].pageY-d:o.top,b=u?e.touches[0].pageX:n.left,g=p?e.touches[0].pageY:n.top):(m=u?e.pageX-l:o.left,h=p?e.pageY-d:o.top,b=u?e.pageX:n.left,g=p?e.pageY:n.top),this.dragDropService.currentDragElement.offset({left:m,top:h}),this.dragDropService.pointerPosition={left:b,top:g},this.dragDropService.scrollDragDropItemsContainer(this.dragDropService.pointerPosition.top,r.a.SCROLLING_CONSTANTS.mouseInteractionDistanceToScroll),this.timeout.cancel(this.bbDragMoveTimeoutId),this.bbDragMoveTimeoutId=this.timeout((()=>{this.$rootScope.$broadcast("bb-drag-move")}),t,150,!1)}}f.$inject=["$rootScope",a.serviceName,r.d,d.b,p.e,m.f,b.b],n.module(g,[a.moduleName,r.c,d.a,p.b,m.d,b.a]).directive("bbDragHandle",["$injector",e=>e.instantiate(f)])}).call(this,s("71td"))},"P/1j":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("36Bh");const o="ultra.components.directives.bbUiIcon.large.Link";Object(n.a)(i.Link,o,"bbUiIconLargeLink")},Pq3J:function(e,t){e.exports='<bb-guidance-feature-announcement\n  component-key="\'gradebook.advancedFilters\'"\n  button-aria-label="$ctrl.buttonAriaLabel"\n  announcement-title="$ctrl.announcementTitle"\n  content="$ctrl.content"\n  done-button-text="$ctrl.doneButtonText"\n  link-href="$ctrl.linkHref"\n  link-text="$ctrl.linkText"\n  close-label="$ctrl.closeLabel"\n></bb-guidance-feature-announcement>\n'},"QJ+g":function(e,t){e.exports='<div bb-load-bundle="components/directives/freeform-response-editor" class="freeform-response-editor-template"></div>'},QW6a:function(e,t,s){"use strict";s.d(t,"c",(function(){return a})),s.d(t,"b",(function(){return r})),s.d(t,"a",(function(){return l}));s("GkCm");var n=s("Fvsw"),i=s("0JpG"),o=s("TnpK");const a="ultra.features.course.content.assessment.attemptSafeAssignSetting.controller",r="ultra.student.assessment.submitToGRD";class c{constructor(e,t,s,n,i){this.$scope=e,this.contentData=t,this.context=s,this.bbLocalize=n,this.ultraStateService=i,this.submitToGRD=!1,this.addToUserPreference=!1,this.confirmedToClose=!1,e.attemptSafeAssignSetting=this,this.panelTitle=this.contentData.courseContent.title,this.params=this.ultraStateService.params,this.submitToGRD=this.params.submitToGRD,this.submitToGRDEnabled&&(this.originalSelection={submitToGRD:this.submitToGRD,addToUserPreference:this.addToUserPreference},this.context.getPreference(r).then((e=>{e&&"true"===e.value&&(this.submitToGRD=!0,this.addToUserPreference=!0,this.originalSelection.submitToGRD=this.submitToGRD,this.originalSelection.addToUserPreference=this.addToUserPreference)}))),e.$on("$stateChangeStart",((e,t)=>{t.name.indexOf("attempt-safe-assign-setting")<0&&this.submitToGRDEnabled&&!this.confirmedToClose&&this.isDirty&&(e.preventDefault(),this.$scope.$broadcast("show-confirmation","attempt-safe-assign-setting"))})),e.$watch((()=>this.submitToGRD),(e=>{!1===e&&(this.addToUserPreference=!1)}))}get submitToGRDEnabled(){return!!this.contentData.courseContent.canSubmitToGlobalReferenceDatabase()}get isDirty(){return!(!this.originalSelection||this.originalSelection.submitToGRD===this.submitToGRD&&this.originalSelection.addToUserPreference===this.addToUserPreference)}saveClicked(){this.confirmedToClose=!0,this.context.setPreference(r,this.addToUserPreference.toString()),this.$scope.$root.$broadcast("submit-to-global-reference",{submitToGRD:this.submitToGRD}),this.closePanel()}cancelClicked(){this.confirmedToClose=!0,this.ultraStateService.leavePeekState()}closePanel(){this.ultraStateService.leavePeekState()}}c.$inject=["$scope","contentData",n.b,i.serviceName,o.d];class l extends c{}},QhTW:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-group-conversation",use:"icon-medium-group-conversation-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-group-conversation"><g clip-path="url(#icon-medium-group-conversation_clip0)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4.5 20C6.433 20 8 18.433 8 16.5S6.433 13 4.5 13 1 14.567 1 16.5 2.567 20 4.5 20zM19.522 20c-1.933 0-3.5-1.567-3.5-3.5s1.567-3.5 3.5-3.5 3.5 1.567 3.5 3.5-1.567 3.5-3.5 3.5zM15 23c.5-2 2-3 4.522-3M9.022 23c-.5-2-2-3-4.522-3M14 5.5c0 2.4853-2.0147 4.5-4.5 4.5A4.4927 4.4927 0 018 9.744L6 11V8.3287A4.4812 4.4812 0 015 5.5C5 3.0147 7.0147 1 9.5 1S14 3.0147 14 5.5zM14.5 1C16.9853 1 19 3.0147 19 5.5a4.4812 4.4812 0 01-1 2.8287V11l-2-1.256c-.3184.1125-.6533.2177-1 .256" /></g><defs><clipPath id="icon-medium-group-conversation_clip0"><path fill="#fff" d="M0 0h24v24H0z" /></clipPath></defs></symbol>'});i.add(o);e.exports=o},QyCV:function(e,t,s){"use strict";s("q1bP"),s("sZYy"),s("dV61");var n=s("nsO7"),i=s("Llzl"),o=s("Qbdf"),a=s("5Yfa"),r=s("0JpG"),c=s("JNtI"),l=s("TnpK"),d=s("gkef"),u=s("1jPR"),p=s("0wep");s.d(t,"a",(function(){return m}));const m="ultra.components.directives.bbGoalAlignment";class h{constructor(e,t,s,o,r){this.$injector=e,this.contextCourse=t,this.localize=s,this.ultraState=o,this.windowSize=r,this.scope={contents:"=",hideGoals:"&",shouldFocus:"&"},this.restrict="E",this.template=u,this.link=(e,t,s)=>{i.extend(e,{generateControlId:(e,t)=>`x-${e.getContentIdForGoalAlignment()}-${t.goalId}`.replace(/[\.;]/g,"-"),openPeekPanel:!!s.openPeekPanel&&e.$eval(s.openPeekPanel),canAlignGoals:()=>e.primaryContent.isCurrentUserEligibleToAlignGoals(),addGoals:()=>{this.ultraState.goPeekState("goal-picker-legacy",{goalAlignableContent:e.primaryContent})},deleteGoal:(t,s)=>{n.remove(t.alignedGoals,(e=>e===s));const i=s.content||t;n.remove(i.alignedGoals,(e=>e.goalId===s.goalId));const o=n.compact(i.alignedGoals.map((e=>e.goal)));e.$root.$broadcast(a.a,i,o),e.$root.$broadcast(a.d(i),o)},isCourseComplete:()=>this.contextCourse.course&&this.contextCourse.course.isComplete(),isMobile:window.Modernizr.touch&&!this.windowSize.isLargeBreakpoint(),getOverflowMenuItems:(t,s)=>[{icon:"trash",labelKey:"global.delete",ariaLabel:()=>this.localize.translateSync({locale:this.localize.getLocale(e),key:"course.goal-alignment.goal.sr-only.delete",params:{goalName:s.goal.goalTitle},noWrap:!0}),show:()=>s.content&&s.content.isCurrentUserEligibleToAlignGoals&&s.content.isCurrentUserEligibleToAlignGoals()&&!e.isCourseComplete(),onClick:()=>{e.deleteGoal(t,s)},confirmationOptions:c.a("x-bb-delete-goal-alignment")}]});let o=i.noop;const r=function(){const t={title:"",alignedGoals:[],isCurrentUserEligibleToAlignGoals:()=>!1,getContentIdForGoalAlignment:()=>"x"};e.primaryContent=(e.contents||[t])[0]||t,e.primaryContent!==t&&e.$root.$broadcast("EVENT_GOAL_PICKER_RESTORE",e.primaryContent),o(),o=e.$on(a.c,((t,s)=>{const i=e.primaryContent.coreContent||e.primaryContent,o=n.zipObject(i.alignedGoals.map((e=>e.goalId)),i.alignedGoals),r=s.sort(((e,t)=>e.goalTitle.localeCompare(t.goalTitle))).map((e=>Object.prototype.hasOwnProperty.call(o,e.id)?o[e.id]:{goalId:e.id,isVisibleToStudent:!0,goal:e,content:i}));e.primaryContent.alignedGoals=r,e.primaryContent.coreContent&&(e.primaryContent.coreContent.alignedGoals=r),e.$root.$broadcast(a.a,i,s),e.$root.$broadcast(a.d(i),s)}))};e.$watch("contents",r),r()}}}h.$inject=["$injector",o.e,r.serviceName,l.d,d.b],i.module(m,[d.a,"dibari.angular-ellipsis",r.moduleName,c.b,p.a]).directive("bbGoalAlignment",["$injector",e=>e.instantiate(h)])},QzaB:function(e,t){e.exports='<div bb-load-bundle="components/directives/search-box">\n  <bb-svg-icon size="small" icon="search"></bb-svg-icon>\n  <input \n    bb-translate-attrs="{ \'placeholder\': \'{{::$ctrl.placeholderKey}}\', \'aria-label\': \'{{::$ctrl.placeholderKey}}\'}"\n    type="text"\n    ng-model="$ctrl.searchText" \n    ng-model-options="{debounce: 800, getterSetter: true}"\n    analytics-id="{{::$ctrl.analyticsIdTagPrefix}}.input.text"\n  />\n  <button bb-translate-attrs="{\'aria-label\': \'components.directives.search-box.clearSearch\'}"\n    ng-if="$ctrl._searchText"\n    ng-click="$ctrl.clearSearchInput()"\n    analytics-id="{{::$ctrl.analyticsIdTagPrefix}}.clear.button"\n  >\n    <bb-svg-icon size="small" icon="close"></bb-svg-icon>\n  </button>\n</div>\n'},R4kC:function(e,t,s){"use strict";s.d(t,"a",(function(){return p})),s.d(t,"b",(function(){return m}));var n=s("D57K"),i=s("nsO7"),o=s("Llzl"),a=s("pjml"),r=s("aHpC"),c=s("jhBu"),l=s("o5Lu"),d=s("Sa5G"),u=s("IbyE");const p="ultra.services.submissionList",m="submissionList",h=["courseCardColorIndex","id","isAvailable","dueDateExceptionType","timeLimitExceptionType","role","courseRole","user.id","user.userName","user.avatar","user.familyName","user.givenName","user.lastModifiedAt","userHasHidden","userId","isPreviewStudent","user.otherName","user.preferredDisplayName"].join(),b=["isPreviewStudent(asc)","user.familyName(asc)","user.givenName(asc)"].join();let g=class{constructor(e,t,s,n,i,o){this.$rootScope=e,this.$q=t,this.CourseModel=s,this.gradeService=n,this.entitlementService=i,this.$ngRedux=o,this.loadAssignedGroupAndGroupRows=(e,t,s)=>this.CourseModel.$new(e.Column.courseId).contents.$find(e.Column.contentId,{expand:"assignedGroups"}).$asPromise().then((n=>{var i,o,a;const r=null===(i=null==n?void 0:n.assignedGroups)||void 0===i?void 0:i.find((t=>t.groupId===e.group.id));return this.gradeService.loadGroupRows(this.CourseModel.$new(t),[r],s,e.Column,null===(a=null===(o=e.Column.ui)||void 0===o?void 0:o.content)||void 0===a?void 0:a.isSafeAssignEnabled())})),this.listeners=new Map,this.subscribeToRedux()}subscribeToRedux(){this.$ngRedux.connect(null,(e=>({loadMembership:(t,s)=>e(u.actions.courseMembership.loadCourseMembershipByMemberId(t,s))})))(this)}setSubmissionList(e,t,s,n){this.submissionList&&this.submissionList.courseId===e&&this.submissionList.columnId===t||(this.submissionList=Object.create(null)),this.submissionList.courseId=e,this.submissionList.columnId=t,this.submissionList.memberships=s,this.submissionList.rows=n||[],this.submissionList.canViewGroups=this.entitlementService.areAllEntitled([d.n.ViewGroups,d.e.ViewAsDesigner],e)}getListeners(e,t){const s=`${e}|${t}`;return this.listeners.has(s)||this.listeners.set(s,new Set),this.listeners.get(s)}notifyRowsListeners(){if(!this.submissionList)return;this.getListeners(this.submissionList.courseId,this.submissionList.columnId).forEach((e=>{null==e||e()}))}addOnRowsUpdated(e,t,s){return this.getListeners(e,t).add(s),()=>{this.removeOnRowsUpdated(e,t,s)}}loadRowsListeners(){if(!this.submissionList)return;this.getListeners(this.submissionList.courseId,this.submissionList.columnId).forEach((e=>e()))}removeOnRowsUpdated(e,t,s){this.getListeners(e,t).delete(s)}refreshAttempts(e,t,s){var n,i,o,a,r,c,l,d;if(e!==(null===(n=this.submissionList)||void 0===n?void 0:n.courseId)||t!==(null===(i=this.submissionList)||void 0===i?void 0:i.columnId))return this.$q.when();let u;return"attemptId"in s?u=null===(a=null===(o=this.submissionList)||void 0===o?void 0:o.rows)||void 0===a?void 0:a.find((e=>{var t,n;return null===(n=null===(t=e.grade)||void 0===t?void 0:t.attempts)||void 0===n?void 0:n.some((e=>(null==e?void 0:e.id)===s.attemptId))})):"userId"in s?u=null===(c=null===(r=this.submissionList)||void 0===r?void 0:r.rows)||void 0===c?void 0:c.find((e=>{var t;return(null===(t=e.user)||void 0===t?void 0:t.id)===s.userId})):"groupId"in s&&(u=null===(d=null===(l=this.submissionList)||void 0===l?void 0:l.rows)||void 0===d?void 0:d.find((e=>{var t;return(null===(t=e.group)||void 0===t?void 0:t.id)===s.groupId}))),u?this.loadAttempt(e,u).then((e=>{if(1!==(null==e?void 0:e.length))return;const t=e[0];u.grade=t.grade,u.attemptCount=t.attemptCount,u.lastAttemptDate=t.lastAttemptDate,u.attemptsReadyToPost=t.attemptsReadyToPost,this.notifyRowsListeners()})):this.$q.when()}loadAttempt(e,t){var s;return(null===(s=t.group)||void 0===s?void 0:s.id)?this.loadGroupAttempt(e,t):this.loadIndividualAttempt(t)}loadGroupAttempt(e,t){var s,n,i,o,a,r;if(!this.submissionList.canViewGroups)return this.$q.when();const c=null===(i=null===(n=null===(s=t.Column.ui)||void 0===s?void 0:s.content)||void 0===n?void 0:n.assignedGroups)||void 0===i?void 0:i.find((e=>e.groupId===t.group.id)),l=null===(o=t.group)||void 0===o?void 0:o.memberships.map((e=>this.submissionList.memberships.find((t=>t.userId===e.userId)))).filter((e=>!!e));return c?this.gradeService.loadGroupRows(this.CourseModel.$new(e),[c],l,t.Column,null===(r=null===(a=t.Column.ui)||void 0===a?void 0:a.content)||void 0===r?void 0:r.isSafeAssignEnabled()):this.loadAssignedGroupAndGroupRows(t,e,l)}loadIndividualAttempt(e){var t,s;return this.gradeService.loadCustomizedBulkViewRows([e.membership],e.Column,null,null,null===(s=null===(t=e.Column.ui)||void 0===t?void 0:t.content)||void 0===s?void 0:s.isSafeAssignEnabled())}sortSubmissionList(e){e&&e.sort(((e,t)=>this.getBucketNum(e)-this.getBucketNum(t)||(e.group?e.group.title.localeCompare(t.group.title):this.sortByGivenNamesForSimilarFamilyNames(e,t))))}getBucketNum(e){return e.RowStatus.valueOf()}sortByGivenNamesForSimilarFamilyNames(e,t){return e.user.familyName===t.user.familyName?e.user.givenName.localeCompare(t.user.givenName):e.user.familyName.localeCompare(t.user.familyName)}fetchMemberships(e,t){const s=i.merge({fields:h,roleBucket:"taking",sort:b},t);return e.memberships.$refresh(s).$asPromise()}fetchMembership(e,t){return this.$q.resolve(this.loadMembership(e.id,t).then((t=>{const s=e.memberships.$build(t);return this.$rootScope.$emit(`course-${e.id}-memberships-after-fetch`,[s]),s})))}};g=Object(n.__decorate)([Object(n.__param)(0,Object(r.b)("$rootScope")),Object(n.__param)(1,Object(r.b)("$q")),Object(n.__param)(2,Object(r.b)(a.m.serviceName)),Object(n.__param)(3,Object(r.b)(l.k)),Object(n.__param)(4,Object(r.b)(c.b)),Object(n.__param)(5,Object(r.b)("$ngRedux"))],g);o.module(p,[c.a,l.j]).service(m,g)},ROik:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return m}));var n=s("Llzl"),i=s("LN5R"),o=s("nsO7"),a=s("yC9S"),r=s("lEL+"),c=s("dF44"),l=s("+4Px"),d=s("DAbe"),u=s("KvMR"),p=s("GiMb");const m="ultra.components.directives.gradeGridMenuReborn";class h{constructor(t,s,n,i,a){this.scope=t,this.element=s,this.attrs=n,this.gradeGridRebornController=i,this.timeout=a,s.data("destroy",(()=>{if(o.isUndefined(t.onBeforeDestroy)||t.onBeforeDestroy(s),s.remove(),a.cancel(this.timeoutRef),this.scrollHDeregistration&&this.scrollHDeregistration(),this.scrollVDeregistration&&this.scrollVDeregistration(),!1===t.autoDestroy){const s=e(window);s.off(`click.${t.id}`),s.off(`blur.${t.id}`)}else t.$destroy()})),t.keepOthers||e("[bb-grade-grid-menu-reborn]").each(((t,n)=>{n!==s[0]&&e(n).data("destroy")()})),s.mousedown((t=>{e(t.target).closest("button:disabled").length&&t.preventDefault()})),o.isUndefined(t.waiting)?this.listenOnWindow():a((()=>{this.listenOnWindow()}),t,t.waiting,!1),this.timeoutRef=a((()=>{this.scrollHDeregistration=t.$on(c.b.SCROLL_H,(()=>{a((()=>s.data("destroy")()),t,0,!1)})),this.scrollVDeregistration=t.$on(c.b.SCROLL_V,(()=>{a((()=>s.data("destroy")()),t,0,!1)}))}),t,200,!1),a((()=>{o.isUndefined(t.adjustPosition)||t.adjustPosition(s)}),t,0,!1)}listenOnWindow(){const t=(t,s)=>{s||e(t.target).closest("button:disabled").length||this.element.data("destroy")()},s=e=>{this.element.data("destroy")()};if(!1===this.scope.autoDestroy){const s=e(window);s.on(`click.${this.scope.id}`,t),s.on(`blur.${this.scope.id}`,t)}else a.b.OnWindow("click",t,this.scope),a.b.OnWindow("blur",s,this.scope)}}h.$inject=["scope","element","attrs","gradeGridRebornController",r.b];class b{constructor(t,s){this.$injector=t,this.timeout=s,this.restrict="A",this.template=d,this.require=`^${i.a}`,this.transclude=!0,this.link=(t,s,n,i)=>{t.gradeGridMenuReborn=this.$injector.instantiate(h,{scope:t,element:s,attrs:n,gradeGridRebornController:i}),this.timeout((()=>{s.on("keydown",(t=>{const n=s.find("li>:tabbable"),i=e(t.target);if(t.keyCode===l.v)n.eq((n.index(i)-1+n.length)%n.length).focus();else if(t.keyCode===l.d)n.eq((n.index(i)+1)%n.length).focus();else{if(!l.y(t))return;i.click()}t.preventDefault(),t.stopPropagation()}))}),t,0,!1)}}}b.$inject=["$injector",r.b],n.module(m,[u.a,p.a]).directive("bbGradeGridMenuReborn",["$injector",e=>e.instantiate(b)])}).call(this,s("71td"))},RPq7:function(e,t,s){"use strict";s.d(t,"b",(function(){return r})),s.d(t,"a",(function(){return c}));var n=s("Llzl"),i=s("nbDY"),o=s.n(i),a=s("lEL+");const r="ultra.directives.contentItemMouseover";class c extends o.a{}c.Top=new c("TOP"),c.Bottom=new c("BOTTOM"),c.Default=new c("DEFAULT");class l{constructor(e,t,s){this.scope=e,this.element=t,this.timeout=s,this.lastPosition=c.Default,this.lastTime=0,t.mouseover((()=>{this.recalculatePosition()})),t.mousemove((e=>{Date.now()-this.lastTime>1e3?(this.timeout.cancel(this.lastMousemoveTimeout),this.handleMousemove(e)):(this.timeout.cancel(this.lastMousemoveTimeout),this.lastMousemoveTimeout=this.timeout((()=>{this.handleMousemove(e)}),this.scope,100,!1))})),t.mouseleave((()=>{this.timeout.cancel(this.lastMousemoveTimeout),this.lastPosition=c.Default})),e.$on("content-outline-hover-end",(()=>{this.timeout.cancel(this.lastMousemoveTimeout),this.lastPosition=c.Default}))}handleMousemove(e){null!=this.elementOffset&&null!=this.elementHeight||this.recalculatePosition(),this.lastTime=Date.now(),e.pageY-this.elementOffset>this.elementHeight/2?(this.lastPosition.isEqualTo(c.Bottom)||this.broadcastPosition(c.Bottom),this.lastPosition=c.Bottom):(this.lastPosition.isEqualTo(c.Top)||this.broadcastPosition(c.Top),this.lastPosition=c.Top)}broadcastPosition(e){this.scope.$emit("content-item-mouseover",{element:this.element,relativeMousePosition:e})}recalculatePosition(){this.elementHeight=this.element.outerHeight(),this.elementOffset=this.element.offset().top}}l.$inject=["scope","element",a.b];class d{constructor(e){this.$injector=e,this.restrict="A",this.scope={canCreate:"&"},this.link=(e,t)=>{e.canCreate&&e.canCreate()&&(e.contentItemMouseover=this.$injector.instantiate(l,{scope:e,element:t}))}}}d.$inject=["$injector"],n.module(r,[a.a]).directive("bbContentItemMouseover",["$injector",e=>e.instantiate(d)])},RWbl:function(e,t){e.exports='<div bb-load-bundle="components/directives/grade/submission-list">\n  <div class="submission-list-header">\n    <div class="search-filter">\n      <bb-search-box\n        on-search="submissionList.filterRows(searchText)"\n        placeholder-key="{{::submissionList.getSearchBoxPlaceholderKey()}}"\n        analytics-id-tag-prefix="components.directives.grade.submissionList.filter">\n      </bb-search-box>\n      <div class="submission-list-filter" ng-if="submissionList.shouldShowAnonymousSubmissionFilters()">\n        <span bb-translate="components.directives.grade.submission-list.filter.label"></span>\n        <div class="select-wrapper">\n          <div bb-foundation-defer>\n            <button data-dropdown="submission-list-filter"\n              bb-click-focus=".item-selected > a"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.submission-list.filter.label\'}"\n              aria-describedby="filter-name"\n              analytics-id="components.directives.grade.submissionList.filter.button">\n              <div class="select-value">\n                <span id="filter-name">{{submissionList.anonymousSelectedGradingFilter.name}}</span>\n              </div>\n            </button>\n            <bb-dropdown list-id="submission-list-filter"\n              list-kind="filter"\n              item-list="submissionList.anonymousAvailableFilters"\n              selected-item="submissionList.anonymousSelectedGradingFilter"\n              click-function="submissionList.changeFilter(item)"\n              analytics-id-tag-prefix="components.directives.grade.submission-list.changeFilter">\n            </bb-dropdown>\n          </div>\n        </div>\n      </div>\n      <div class="submission-list-filters" ng-if="submissionList.shouldShowSubmissionFilters()">\n        <bb-submission-list-dropdown-filters\n          score-provider-handler="submissionList.column.scoreProviderHandle"\n          analytics-id="course.grades.gradebook-item.submission-view.filters"\n          student-filter-selected="submissionList.studentFilterSelected"\n          grading-filter-selected="submissionList.gradingFilterSelected"\n          is-delegated="submissionList.isDelegated()"\n          is-user-reconciler="submissionList.isUserReconciler()">\n        </bb-submission-list-dropdown-filters>\n      </div>\n    </div>\n    <div\n      class="page-size-selector-wrapper"\n      ng-if="submissionList.initialPageSize">\n      <bb-page-size-selector\n        ng-if="::submissionList"\n        class-name="submission-list-page-size"\n        on-page-size-change="submissionList.onPageSizeChange"\n        page-size-options="submissionList.pageSizeOptions"\n        initial-page-size="submissionList.initPageSize"\n        analytics-id="components.directives.grade.submissionList"\n      ></bb-page-size-selector>\n    </div>\n  </div>\n  <form class="assessment-exception" name="submission-list" bb-intersection-observer ng-switch="::submissionList.mode" ng-class="::{\'is-group-submission\': submissionList.isGroup}">\n    <div class="row tabular-list-header course-grades-column-headers course-grades-instructor">\n      <div class="columns medium-4 tabular-list-header-offset hide-for-small-only"><span bb-translate>course.grades.gradebook-item.headers.student</span></div>\n        <div class="columns medium-6">\n        <div class="row">\n          <div class="columns js-student-status-column hide-for-small-only" ng-class="{\n            \'medium-4\': !submissionList.isPeerGrading() && !submissionList.shouldShowOriginality,\n            \'medium-2\': submissionList.isPeerGrading() && submissionList.shouldShowOriginality,\n            \'medium-3\': (submissionList.isPeerGrading() && !submissionList.shouldShowOriginality) || (!submissionList.isPeerGrading() && submissionList.shouldShowOriginality),\n          }">\n            <span bb-translate>course.grades.gradebook-item.headers.studentProgressStatus</span>\n          </div>\n          <div class="columns js-status-column hide-for-small-only" ng-class="{\n            \'medium-4\': !submissionList.isPeerGrading() && !submissionList.shouldShowOriginality,\n            \'medium-2\': submissionList.isPeerGrading() && submissionList.shouldShowOriginality,\n            \'medium-3\': (submissionList.isPeerGrading() && !submissionList.shouldShowOriginality) || (!submissionList.isPeerGrading() && submissionList.shouldShowOriginality),\n          }">\n            <span bb-translate>course.grades.gradebook-item.headers.gradingStatus</span>\n          </div>\n          <div ng-if="::submissionList.isPeerGrading()" class="columns medium-3 js-peer-column hide-for-small-only">\n            <span bb-translate>course.grades.gradebook-item.headers.peerGrading</span>\n          </div>\n          <div class="columns js-grade-column hide-for-small-only" ng-if="!submissionList.column.anonymousGrading"\n                ng-class="{\n                  \'medium-4\': !submissionList.isPeerGrading() && submissionList.shouldShowOriginality,\n                  \'medium-3\': submissionList.isPeerGrading() || !submissionList.shouldShowOriginality,\n                  \'end\': !submissionList.shouldShowOriginality\n                }"\n          >\n            <span bb-translate>course.grades.gradebook-item.headers.graded</span>\n          </div>\n          <div class="columns medium-2 small-1 hide-for-small-only end">\n            <span class="js-originality-column" ng-if="::submissionList.shouldShowOriginality" bb-translate>course.grades.gradebook-item.headers.originality</span>\n          </div>\n        </div>\n      </div>\n      <div remove-from-dom="true"\n            class="columns medium-2 small-12 overflow-menu-div"\n            ng-if="::submissionList.canDownloadAll()"\n            bb-foundation-defer>\n          <bb-overflow-menu class="overflow-menu"\n                          menu-items="::submissionList.getDownloadOverflowMenu()"\n                          element-id="submission-list-overflow-menu"\n                          element-name="{{::submissionList.overflowMenuLabel()}}"\n                          analytics-id-tag-prefix="course.grades.gradebookItem.headers.submissionList">\n          </bb-overflow-menu>\n        <button class="download-link button-anchor"\n            bb-translate="components.directives.grade.submission-list.downloadAll"\n            href="javascript:void(0);"\n            ng-click="submissionList.gradesBulkDownload()"\n            analytics-id="components.directives.grade.submission-list.downloadAll"/>\n      </div>\n    </div>\n    <div id="cannotViewGroupsMsg" ng-if="submissionList.showNoGroupViewMessage()">{{submissionList.cannotViewGroupsMsg}}</div>\n    <div ng-class="{\'last-tabular-row-container\':$last}"\n         ng-switch-default\n         ng-repeat="row in submissionList.rows track by row.id"\n         bb-on-finish-render="submissionList.onFinishRender()">\n      <div bb-intersection-observable="{debounce:200}" class="js-submission-list-row">\n        <bb-submission-list-row column="::submissionList.column" course="::submissionList.course"\n                                user-course-available-map="submissionList.userCourseAvailableMap"\n                                editing="submissionList.editing" row="row" index="$index"\n                                ng-class="{\'bb-user-avatar-alert\': row.isLate()}"\n                                ng-switch="submissionList.isExternalSubmission">\n          <span class="mobile-submissions-header status-header"\n                bb-translate="{{::!submissionList.isDiscussion ? \'course.grades.gradebook-item.headers.gradingStatus\' : \'course.engagement.grade.headers.participation\'}}"></span>\n          <div ng-switch-when="true">\n            <span class="status-to-grade"\n                  ng-if="!row.isStatusComplete() && !row.isStatusToPost() && !row.overrideToPost() && row.isStatusAttemptsToGrade(submissionList.isExternalSubmission)"\n                  bb-translate translate-values="::{gradeCount: 1}">\n                  components.directives.grade.submission-list.gradingStatus.toGrade.plural</span>\n            <span class="status-to-post"\n                  ng-if="row.isStatusToPost() || row.overrideToPost()"\n                  bb-translate translate-values="::{postCount: 1}">\n                  components.directives.grade.submission-list.gradingStatus.toPost.plural</span>\n            <div class="status-is-complete" ng-if="row.isStatusComplete() && !row.overrideToPost()">\n              <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n              <span bb-translate>components.directives.grade.submission-list.gradingStatus.complete</span>\n            </div>\n          </div>\n          <div ng-switch-default>\n            <div ng-switch="row.grade.attempts && row.grade.attempts.length > 0">\n              <div ng-switch-when="true">\n                <span class="status-nothing-to-grade"\n                      ng-if="row.shouldShowNothingToGradeStatus() && row.isStatusNothingToGrade() && !row.isStatusToPost() && !row.isStatusComplete() && !row.overrideToPost() && !submissionList.isPeerGrading()"\n                      bb-translate>components.directives.grade.submission-list.gradingStatus.{{submissionList.getNothingToGradeOrReconcileKey($index)}}</span>\n                <span class="status-to-reconcile"\n                      ng-if="row.isStatusAttemptsToReconcile() && !submissionList.isPeerGrading()"\n                      bb-translate translate-values="::{gradeCount: row.grade.attempts.getNumAttemptsToReconcile()}">\n                      components.directives.grade.submission-list.gradingStatus.attemptsToReconcile.plural</span>\n                <span class="status-to-grade"\n                      ng-if="row.isStatusAttemptsToGrade() && !submissionList.isPeerGrading()"\n                      bb-translate translate-values="::{gradeCount: row.grade.attempts.getNumAttemptsToGrade()}">\n                      components.directives.grade.submission-list.gradingStatus.attemptsToGrade.plural</span>\n                <span class="{{submissionList.status}}"\n                      ng-if="submissionList.isPeerGrading() && !(row.isMultipleStatus() || row.isStatusToPost() || row.overrideToPost()) && (row.isStatusAttemptsToGrade() || row.isStatusAttemptsToReconcile())"\n                      bb-translate>components.directives.grade.submission-list.gradingStatus.{{submissionList.getAttemptsPeerStatus($index)}}</span>\n                <span class="vertical-bar" ng-if="row.isMultipleStatus() && !submissionList.isPeerGrading()"></span>\n                <span class="status-to-post"\n                      ng-if="row.isMultipleStatus() || row.isStatusToPost() || row.overrideToPost()"\n                      bb-translate translate-values="::{postCount: 1}">\n                      components.directives.grade.submission-list.gradingStatus.toPost.plural</span>\n                <div class="{{submissionList.status}}"\n                      ng-if="submissionList.hasAttemptBeenPostedOrCompleted($index)">\n                      <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n                      <span bb-translate>components.directives.grade.submission-list.gradingStatus.{{submissionList.getPostedOrCompletedKey()}}</span>\n                </div>\n              </div>\n              <div ng-switch-default>\n                <span class="status-nothing-to-grade" ng-if="!row.isOverdue() && !row.isCurrentUserReconciler() && !submissionList.isPeerGrading()"\n                      bb-translate>components.directives.grade.submission-list.gradingStatus.nothingToGrade</span>\n                <span class="status-nothing-to-grade" ng-if="!row.isOverdue() && row.isCurrentUserReconciler()  && !submissionList.isPeerGrading()"\n                      bb-translate>components.directives.grade.submission-list.gradingStatus.nothingToReconcile</span>\n                <span class="status-no-submission" ng-if="row.isOverdue() || (!row.isOverdue() && submissionList.isPeerGrading())"\n                      bb-translate>components.directives.grade.submission-list.gradingStatus.noSubmission</span>\n                <span class="vertical-bar" ng-if="row.overrideToPost()"></span>\n                <span class="status-to-post"\n                      ng-if="row.overrideToPost()"\n                      bb-translate translate-values="::{postCount: 1}">components.directives.grade.submission-list.gradingStatus.toPost.plural</span>\n              </div>\n            </div>\n          </div>\n        </bb-submission-list-row>\n      </div>\n    </div>\n    <div ng-class="{\'last-tabular-row-container\':$last}"\n         ng-switch-when="Group"\n         ng-repeat="row in submissionList.rows | limitTo: submissionList.pageSize: submissionList.currentPage*submissionList.pageSize track by row.id">\n      <div bb-intersection-observable="{debounce:200}">\n        <bb-group-submission-list-row column="::submissionList.column" course="::submissionList.course"\n                                      user-course-available-map="submissionList.userCourseAvailableMap"\n                                      editing="submissionList.editing" row="row" index="$index"\n                                      ng-class="{\'bb-user-avatar-alert\': row.isLate()}"\n                                      ng-switch="submissionList.isExternalSubmission">\n          <span class="mobile-submissions-header status-header"\n                bb-translate="{{::!submissionList.isDiscussion ? \'course.grades.gradebook-item.headers.gradingStatus\' : \'course.engagement.grade.headers.participation\'}}"></span>\n          <div ng-switch-when="true">\n            <span class="status-to-grade" ng-if="!row.isGroupStatusComplete(submissionList.isExternalSubmission) && !row.isGroupStatusToPost()\n            && !row.overrideToPost() && row.isGroupStatusAttemptsToGrade(submissionList.isExternalSubmission)"\n                  bb-translate translate-values="{gradeCount: 1}">components.directives.grade.submission-list.gradingStatus.toGrade.plural</span>\n            <span class="status-to-post" ng-if="row.isGroupStatusToPost() || row.overrideToPost()"\n                  bb-translate translate-values="::{postCount: 1}">components.directives.grade.submission-list.gradingStatus.toPost.plural</span>\n            <div class="status-is-complete" ng-if="row.isGroupStatusComplete(submissionList.isExternalSubmission) && !row.overrideToPost()">\n              <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n              <span bb-translate>components.directives.grade.submission-list.gradingStatus.complete</span>\n            </div>\n          </div>\n          <div ng-switch-default>\n            <div ng-switch="row.hasGroupAttempts()">\n                \x3c!--TODO need to account for multiple attempts as a group; right now only looking at the single group attempt entry in code below--\x3e\n              <div ng-switch-when="true">\n                <span class="status-nothing-to-grade"\n                      ng-if="row.isGroupStatusNothingToGrade() && !row.isGroupStatusToPost() && !row.isGroupStatusComplete() && !row.overrideToPost()"\n                      bb-translate>components.directives.grade.submission-list.gradingStatus.nothingToGrade</span>\n                <span class="status-to-grade"\n                      ng-if="row.isGroupStatusAttemptsToGrade()"\n                      bb-translate translate-values="::{gradeCount: row.grade.groupAttempts.getNumAttemptsToGrade()}">\n                      components.directives.grade.submission-list.gradingStatus.attemptsToGrade.plural</span>\n                <span class="vertical-bar" ng-if="row.isMultipleStatus()"></span>\n                <span class="status-to-post"\n                      ng-if="row.isMultipleStatus() || row.isGroupStatusToPost() || row.overrideToPost()"\n                      bb-translate translate-values="::{postCount: 1}">components.directives.grade.submission-list.gradingStatus.toPost.plural</span>\n                <div class="status-is-complete" ng-if="row.isGroupStatusComplete() && !row.overrideToPost()">\n                  <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n                  <span bb-translate>components.directives.grade.submission-list.gradingStatus.complete</span>\n                </div>\n              </div>\n              <div ng-switch-default>\n                <span class="status-nothing-to-grade"\n                      ng-if="::!row.isOverdue()"\n                      bb-translate>components.directives.grade.submission-list.gradingStatus.nothingToGrade</span>\n                <span class="status-no-submission"\n                      ng-if="::row.isOverdue()"\n                      bb-translate>components.directives.grade.submission-list.gradingStatus.noSubmission</span>\n                <span class="vertical-bar" ng-if="row.overrideToPost()"></span>\n                <span class="status-to-post"\n                      ng-if="row.overrideToPost()"\n                      bb-translate translate-values="::{postCount: 1}">components.directives.grade.submission-list.gradingStatus.toPost.plural</span>\n              </div>\n            </div>\n          </div>\n        </bb-group-submission-list-row>\n      </div>\n    </div>\n    <div ng-class="{\'last-tabular-row-container\':$last}"\n         ng-switch-when="Discussion"\n         ng-repeat="row in submissionList.rows | limitTo: submissionList.pageSize: submissionList.currentPage*submissionList.pageSize track by row.id">\n      <div bb-intersection-observable="{debounce:200}">\n        <bb-submission-list-row column="submissionList.column" course="submissionList.course"\n                                user-course-available-map = "submissionList.userCourseAvailableMap"\n                                include-due-date-exception="submissionList.includeDueDateException()"\n                                is-group-discussion="submissionList.isGroupDiscussion()"\n                                editing="submissionList.editing" row="row" index="$index">\n            <span class="mobile-submissions-header status-header"\n                  bb-translate>course.engagement.grade.headers.participation</span>\n            <span class="status-to-grade"\n                  ng-if="row.isStatusAttemptsToGrade()"\n                  bb-translate translate-values="{gradeCount: 1}">components.directives.grade.submission-list.gradingStatus.toGrade.plural</span>\n            <div class="status-is-complete" ng-if="row.isStatusComplete()">\n              <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n              <span bb-translate>components.directives.grade.submission-list.gradingStatus.complete</span>\n            </div>\n            <span class="status-nothing-to-grade"\n                  ng-if="row.isStatusNothingToGrade() && !row.isOverdue() && !row.isStatusComplete()"\n                  bb-translate>components.directives.grade.submission-list.gradingStatus.nothingToGrade</span>\n            <span class="status-no-participation"\n                  ng-if="row.isStatusNothingToGrade() && row.isOverdue() && !row.isStatusComplete()"\n                  bb-translate>components.directives.grade.submission-list.participation.noParticipation</span>\n            <span class="vertical-bar" ng-if="row.isStatusNothingToGrade() && row.isStatusToPost()"></span>\n            <span class="status-to-post" ng-if="(row.isStatusNothingToGrade() && row.isStatusToPost()) || (row.isStatusToPost())"\n                  bb-translate translate-values="::{postCount: 1}">components.directives.grade.submission-list.gradingStatus.toPost.plural\n            </span>\n        </bb-submission-list-row>\n      </div>\n    </div>\n  </form>\n  <span role="status" class="sr-only" ng-if="(!submissionList.isGroup && !(submissionList.totalItemsOnList==submissionList.totalItems))"\n        bb-translate translate-values="{totalOnList:{{submissionList.totalItemsOnList}},totalStudentsFound: {{submissionList.totalItems}}}">\n    components.directives.grade.submission-list.gradingStatus.totalStudentOnList\n  </span>\n  <span role="status" class="sr-only" ng-if="(!submissionList.isGroup && (submissionList.totalItemsOnList==submissionList.totalItems))"\n        bb-translate translate-values="{totalOnList:{{submissionList.totalItemsOnList}}}">\n    components.directives.grade.submission-list.gradingStatus.studentOnList\n  </span>\n  <span role="status" class="sr-only" ng-if="(submissionList.isGroup && !(submissionList.totalItemsOnList==submissionList.totalItems))"\n        bb-translate translate-values="{totalOnList:{{submissionList.totalItemsOnList}},totalGroupsFound: {{submissionList.totalItems}}}">\n    components.directives.grade.submission-list.gradingStatus.totalGroupsOnList\n  </span>\n  <span role="status" class="sr-only" ng-if="(submissionList.isGroup && (submissionList.totalItemsOnList==submissionList.totalItems))"\n        bb-translate translate-values="{totalOnList:{{submissionList.totalItemsOnList}}}">\n    components.directives.grade.submission-list.gradingStatus.groupsOnList\n  </span>\n  <div ng-if="submissionList.showControls && submissionList.showPagination">\n    <bb-paging-selector\n      page="submissionList.currentPage"\n      number-of-pages="submissionList.numberOfPages"\n      on-page-change="submissionList.onChangePageFunction"\n      compact="submissionList.isSmallBreakpoint"\n      class-name="submission-list-pagination"\n      analytics-id="components.directives.grade.submissionList"\n    />\n  </div>\n</div>\n'},RjAI:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("Llzl"),i=s("0JpG"),o=s("AuQm"),a=s("1ZbL");const r="ultra.components.directives.components.confirmationCalloutDialog",c={Class:o.ConfirmationCalloutDialog,bindingNames:["analyticsId","target","isVisible","textContent","onDismiss","onSuccess"],renderLocalized:!0};n.module(r,[i.moduleName]).component("bbConfirmationCalloutDialog",Object(a.a)(c))},SE1T:function(e,t){e.exports='<button class="button-add-content js-show-add-options"\n        data-show-add-options\n        ng-click="addContentButton.addGroup()"\n        ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n        aria-label="{{addContentButton.addButtonAriaLabel}}"\n        ng-focus="addContentButton.showButton()"\n        ng-blur="addContentButton.hideButton()"\n        analytics-id="components.directives.add-content-button.course-group.button">\n</button>\n'},SHbF:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-attention",use:"icon-medium-attention-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-attention"><circle cx="12" cy="12" r="11" stroke-width="2" /><path d="M12.75 18.5a.75.75 0 11-1.5 0 .75.75 0 011.5 0z" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" /><path d="M12 15l-.5-10h1L12 15z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},SMOU:function(e,t,s){},SSV0:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-accommodation",use:"icon-small-accommodation-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-accommodation"><circle cx="8" cy="8" r="7" stroke-width="2" /><path d="M4 6l1 2 5-3M12 10l-1-2-5 3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},SY8P:function(e,t,s){var n=s("Llzl");n.module("dibari.angular-ellipsis",[]).directive("ellipsis",["$timeout","$window","$sce",function(e,t,s){var i=function(t){var s=null,n=[];this.remove=function(t){-1!==n.indexOf(t)&&(n.splice(n.indexOf(t),1),0===n.length&&(e.cancel(s),s=null))},this.add=function(i){-1===n.indexOf(i)&&n.push(i),s||(s=e((function(){var e=n.slice();s=null,n.length=0,e.forEach((function(e){e()}))}),t))}},o=new i(0),a=new i(75);return{restrict:"A",scope:{ngShow:"=",ngBind:"=",ngBindHtml:"=",ellipsisAppend:"@",ellipsisAppendClick:"&",ellipsisSymbol:"@",ellipsisSeparator:"@",useParent:"@",ellipsisSeparatorReg:"=",ellipsisFallbackFontSize:"@"},compile:function(e,i,r){return function(e,i,r){function c(){var t=e.ngBind||e.ngBindHtml,o=!1;if(s.isEnabled()&&n.isObject(t)&&s.getTrustedHtml(t)&&(o=!0,t=s.getTrustedHtml(t)),t){var a=!e.ngBind&&!!e.ngBindHtml,c=0,d=void 0!==r.ellipsisSymbol?r.ellipsisSymbol:"&hellip;",u=void 0!==e.ellipsisSeparator?r.ellipsisSeparator:" ",p=void 0!==e.ellipsisSeparatorReg&&e.ellipsisSeparatorReg,m=void 0!==e.ellipsisAppend&&""!==e.ellipsisAppend?d+"<span class='angular-ellipsis-append'>"+e.ellipsisAppend+"</span>":d,h=p?t.match(p):t.split(u);if(r.isTruncated=!1,a?i.html(t):i.text(t),void 0!==r.ellipsisFallbackFontSize&&l(i)&&i.css("font-size",r.ellipsisFallbackFontSize),l(i,e.useParent)){var b=h.length,g=e.useParent?function(e){var t=0;return n.forEach(e.parent().children(),(function(s){s!=e[0]&&(t+=s.clientHeight)})),e.parent()[0].clientHeight-t}(i):i[0].clientHeight;for(a?i.html(t+m):i.text(t).html(i.html()+m),i.attr("data-overflowed","true");c<b;c++){var v=h.pop();if(0===h.length&&(h[0]=v.substring(0,Math.min(v.length,5))),a?i.html(h.join(u)+m):i.text(h.join(u)).html(i.html()+m),(e.useParent?i.parent()[0]:i[0]).scrollHeight<g||!1===l(i,e.useParent)){r.isTruncated=!0;break}}d!=m&&void 0!==e.ellipsisAppendClick&&""!==e.ellipsisAppendClick&&i.find("span.angular-ellipsis-append").bind("click",(function(t){e.$apply((function(){e.ellipsisAppendClick.call(e,{event:t})}))})),!o&&s.isEnabled()&&s.trustAsHtml(t)}else i.attr("data-overflowed","false")}}function l(e,t){return(e=t?e.parent():e)[0].scrollHeight>e[0].clientHeight}function d(){r.lastWindowResizeWidth==window.innerWidth&&r.lastWindowResizeHeight==window.innerHeight||c(),r.lastWindowResizeWidth=window.innerWidth,r.lastWindowResizeHeight=window.innerHeight}r.lastWindowResizeTime=0,r.lastWindowResizeWidth=0,r.lastWindowResizeHeight=0,r.lastWindowTimeoutEvent=null,r.isTruncated=!1,e.$watch("ngShow",(function(){o.add(c)})),e.$watch("ngBind",(function(){o.add(c)})),e.$watch("ngBindHtml",(function(){o.add(c)})),e.$watch("ellipsisAppend",(function(){c()})),e.$watch((function(){return 0!=i[0].offsetWidth&&0!=i[0].offsetHeight}),(function(){a.add(c)}));var u=e.$on("dibari:refresh-ellipsis",(function(){o.add(c)}));function p(){a.add(d)}var m=n.element(t);m.bind("resize",p),e.$on("$destroy",(function(){m.unbind("resize",p),o.remove(c),a.remove(d),u&&(u(),u=null)}))}}}}])},Sq3Z:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-activity-indicator",use:"icon-small-activity-indicator-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-activity-indicator"><path d="M15 8c0 3.866-3.134 7-7 7a6.983 6.983 0 01-2.528-.4704L1 15l.5-4.3969C1.1775 9.7984 1 8.9199 1 8c0-3.866 3.134-7 7-7s7 3.134 7 7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="8" cy="8" r="2" stroke-width="4" /></symbol>'});i.add(o);e.exports=o},StAH:function(e,t){e.exports='<div class="hotspot-question-container hotspot-attempt-review">\n  <bb-question-attempt-review\n    ng-if="assessmentQuestion.questionAttempt.question && !assessmentQuestion.isEditing"\n    ally-service="::allyService"\n    content-id="::contentId"\n    attempt="::assessmentQuestion.questionAttempt"\n    automated-feedback-editor-plugin-options="::automatedFeedbackEditorPluginOptions"\n    is-automated-feedback-collapsible="::assessmentQuestion.allowCollapsingOfAutomatedFeedbackIfShown()"\n    is-attempt-grading-view="::assessmentQuestion.isAttemptGradingView"\n    was-answered-late="::assessmentQuestion.wasAnsweredLate()"\n    can-show-correct-answer-related-detail="assessmentQuestion.canShowCorrectAnswerRelatedDetail()"\n  ></bb-question-attempt-review>\n</div>\n'},T1pL:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return h}));var n=s("Llzl"),i=s("nsO7"),o=s("o5Lu"),a=s("3l3z"),r=s("LN5R"),c=s("TmUJ"),l=s("qH3X"),d=s("+4Px"),u=s("lEL+"),p=s("dF44"),m=s("TUWB");const h="ultra.components.directives.gradeGridOverallEditorReborn";class b{constructor(e,t,s,n,i,o,a,r){this.$compile=e,this.window=t,this.scope=s,this.element=n,this.attrs=i,this.gradeGridRebornController=o,this.gradeService=a,this.timeout=r,this.initialize(),s.$on(l.a.REFRESH_OVERALL_EDITOR,(()=>{this.initialize()})),s.$on("$destroy",(()=>{this.removeErrorMessage()}))}initialize(){this.score=this.scope.gradeGridColumnOverallReborn.score,this.element.find("input").focus(),this.element.find(".wrapping-input-style").css({"border-color":"#c36fd3"}),this.timeout((()=>{this.element.find("input").select()}),this.scope,0,!1),this.checkValue(this.score).then((e=>{this.isValidated=e}))}removeErrorMessage(){this.element.removeClass("validation-alert"),i.isUndefined(this.messageElement)||(this.messageElement.remove(),this.messageElement=void 0),i.isUndefined(this.messageScope)||(this.messageScope.$destroy(),this.messageScope=void 0)}createErrorMessage(){if(this.messageElement&&this.removeErrorMessage(),i.isUndefined(this.messageElement)){this.element.addClass("validation-alert");const e=this.element.parent(".grade-grid-cell").offset();e.top+=60,this.messageScope=this.scope.$new(!1,this.scope),this.messageScope.adjustPosition=t=>{const s=e.left+t.width(),n=e.top+t.height(),i=this.gradeGridRebornController.getGradeGridContainerElementRight(),o=this.gradeGridRebornController.getGradeGridContainerElementBottom();s>i&&(e.left-=s-i+Object(c.a)()),n>o&&(e.top-=t.height()+40),this.messageElement.offset(e)},this.$compile(b.CELL_MESSAGE_TEMPLATE)(this.messageScope,(e=>{this.messageElement=e,this.element.parents("bb-grade-grid-reborn").append(this.messageElement)}))}}get isValidated(){return this._isValidated}set isValidated(e){this._isValidated=e,this.isValidated?this.removeErrorMessage():this.createErrorMessage()}stopPropagation(e){e.preventDefault(),e.stopPropagation()}mousedown(){e(this.window).trigger("click")}get isHiddenPointsPossible(){return!(i.isUndefined(this.score)||/^-?\d*(\,\d+)?(\.\d+)?$/.test(this.score))}onChange(){this.checkValue(this.score).then((e=>{this.isValidated=e}))}onInputBlur(){this.scope.gradeGridColumnOverallReborn.onInputBlur(this.isValidated,this.score)}checkValue(e){const t=this.gradeGridRebornController.getGridData().getSchema()[this.scope.col.data.gradingSchemaId],s=this.gradeService.createGradeSubmission(this.scope.col.data,e,t);return this.gradeService.validateGrade(s,this.scope)}onKeydown(t){d.y(t)?(this.scope.gradeGridColumnOverallReborn.gotoNextCell(),e(t.target).blur(),this.mousedown(),t.preventDefault(),t.stopPropagation()):t.keyCode===d.g?(e(t.target).blur(),this.mousedown(),this.scope.$emit(p.b.LEAVE_CELL)):d.x(t)&&(!this.score||t.keyCode!==d.j&&t.keyCode!==d.s?this.mousedown():t.stopPropagation())}}b.$inject=["$compile","$window","scope","element","attrs","gradeGridRebornController",o.k,u.b],b.CELL_MESSAGE_TEMPLATE='<div bb-grade-grid-message-reborn class="grade-grid-reborn-message" ng-mousedown="gradeGridMessageReborn.mousedown()"></div>';class g{constructor(e){this.$injector=e,this.restrict="A",this.template=m,this.require=`^${r.a}`,this.link=(e,t,s,n)=>{e.gradeGridOverallEditorReborn=this.$injector.instantiate(b,{scope:e,element:t,attrs:s,gradeGridRebornController:n})}}}g.$inject=["$injector"],n.module(h,[a.a]).directive("bbGradeGridOverallEditorReborn",["$injector",e=>e.instantiate(g)])}).call(this,s("71td"))},"TLR+":function(e,t){e.exports='<bb-modal id="submission-receipt-modal" class="notification success submission-receipt-modal"\n          modal-title-key="components.directives.submission-receipt.submission-successful"\n          analytics-id-tag-prefix="course.content.assessment.test.modal.confirmSubmitAttemptAlert"\n          modal-dismiss-callback="onClose($close)">\n  <div name="modal-contents" class="content-container">\n    <img class="modal-banner" src="./static/images/submissions/submission-receipt-modal-banner.svg">\n    <div class="submission-date">\n      <span class="date-label" bb-translate="components.directives.submission-receipt.submission-date"></span>\n      <span class="js-submission-date" ng-bind-html="submissionDate"></span>\n    </div>\n\n    <div class="submission-id">\n      <span class="id-label" bb-translate="components.directives.submission-receipt.confirmation-number"></span>\n      <span class="js-submission-id" ng-bind-html="id"></span>\n    </div>\n\n    <span class="email-confirmation" ng-bind-html="emailConfirmation"></span>\n  </div>\n  <div name="modal-footer-button-primary">\n    <button ng-if="!hasProctoringEnabled"\n            class="button js-primary-button js-download-submission-receipt-button" ng-click="downloadClicked()"\n            bb-translate course-org-token-resolver\n            analytics-id="course.content.assessment.test.modal.confirmSubmitAttemptAlert.download">\n            components.directives.submission-receipt.download\n    </button>\n    <button ng-if="hasProctoringEnabled"\n            class="button button--primary js-close-modal" ng-click="$close()"\n            bb-translate course-org-token-resolver\n            analytics-id="course.content.assessment.test.modal.confirmSubmitAttemptAlert.close">\n            global.close\n    </button>\n  </div>\n  <div name="modal-footer-button-secondary">\n    <button ng-if="!hasProctoringEnabled"\n            class="button button--secondary js-close-modal" ng-click="$close()"\n            bb-translate course-org-token-resolver\n            analytics-id="course.content.assessment.test.modal.confirmSubmitAttemptAlert.close">\n            global.close\n    </button>\n  </div>\n\n</bb-modal>\n'},TML7:function(e,t){e.exports='<div class="rb-grid">\n  <style scoped id="rb-grid"></style>\n  <style scoped id="rb-grid-rows-initial-position"></style>\n\n  <div ng-if="grid.containers.left" rb-grid-container="left" id="rb-grid-container-left"></div>\n\n  <div rb-grid-container="center"></div>\n\n  <div ng-if="grid.containers.right" rb-grid-container="right"></div>\n\n  <div ng-transclude></div>\n\n</div>\n'},TOu5:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-question-analysis",use:"icon-small-question-analysis-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-question-analysis"><path d="M11 1H5l1 2v4l-5 8h14l-5-8V3l1-2zM4.125 10h7.75" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},TUWB:function(e,t){e.exports='<div class="wrapping-input-style no-hover">\n  <div>\n    <input autocomplete="off" pu-elastic-input pu-elastic-input-minwidth="10px" pu-elastic-input-maxwidth="180px" pu-elastic-input-width-delta="8"\n           ng-blur="gradeGridOverallEditorReborn.onInputBlur()"\n           placeholder="--" ng-model="gradeGridOverallEditorReborn.score"\n           ng-mousedown="gradeGridOverallEditorReborn.stopPropagation($event)"\n           ng-click="gradeGridOverallEditorReborn.stopPropagation($event)"\n           ng-change="gradeGridOverallEditorReborn.onChange()"\n           ng-keydown="gradeGridOverallEditorReborn.onKeydown($event)" spellcheck="false"\n           analytics-id="components.directives.grade.grid.overAll.input.text"/>\n  </div>\n  <div ng-mousedown="gradeGridOverallEditorReborn.mousedown()" ng-class="{hidden: gradeGridOverallEditorReborn.isHiddenPointsPossible}">\n    <span class="slash"></span><span class="possible" ng-bind="gradeGridColumnOverallReborn.pointsPossibleToDisplay"></span>\n  </div>\n</div>\n'},TmUJ:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("71td");let i;function o(){if(null==i){const e=n('<div style="width:100px; height:100px; overflow:hidden; position:absolute; top:-200px; left:-200px;"><div class="inner" style="height:200px;"></div>'),t=e.find(".inner");n("body").append(e);const s=t.innerWidth();e.css("overflow","auto");const o=t.innerWidth();n(e).remove(),i=s-o}return i}},Tn43:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return A}));s("367g"),s("Aw+3"),s("8+lX"),s("aAQ7"),s("UyCM");var n=s("Llzl"),i=s("nsO7"),o=s("en1n"),a=s("0JpG"),r=s("suMx"),c=s("jciN"),l=s("+e2k"),d=s("+g6d"),u=s("TnpK"),p=s("g7Mf"),m=s("r6lH"),h=s("ELoy"),b=s("pjml"),g=s("f4B+"),v=s("nmzr"),f=s("fvgg"),w=s("yC9S"),S=s("Wqh6"),C=s("Y+9S"),y=s("IbyE"),O=s("50Q+");const A="ultra.components.directives.discussion";class I{constructor(e,t,s,n,o,a,r,c,l,d,u){this.$window=e,this.$sce=t,this.scope=s,this.element=n,this.$stateParams=o,this.$ngRedux=a,this.bbLocalize=r,this.telemetry=c,this.discussion=l,this.ultraState=d,this.courseModel=u,s.isLoaded=!1,s.courseId=s.content().courseId,s.contentId=s.content().id,s.isGroupDiscussion=s.content().isGroupContent,this.subscribeToReduxChanges(),this.loadOtherNameAsDisplayNameSystemPreference({key:O.OTHERNAME_AS_DISPLAY_NAME_OPTION}),this.createDfiReport(s.courseId,s.contentId),w.b.OnWindow("resize",i.debounce((()=>{(this.scope.displayNonParticipants||this.scope.displayNonParticipantGroup)&&(this.updateNonParticipantView(),this.scope.$apply())}),150),s),this.notifyMobileApp()}notifyMobileApp(){var e;const t={type:C.MessageType.DiscussionTelemetryOpened,status:C.MessageStatus.Success,contentId:this.scope.contentId,contentTitle:this.scope.content().title,prevState:Object(C.fetchState)(null===(e=this.ultraState.prev)||void 0===e?void 0:e.name)};Object(C.sendMessageToMobile)(t)}createDfiReport(e,t,s){(s?this.telemetry.loadDiscussionActivityData(e,t,s):this.telemetry.loadDiscussionActivityData(e,t)).then((e=>{this.scope.discussionData=e,this.scope.header=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.header",params:{title:this.scope.content().title},noEscape:!0,noWrap:!0}),this.scope.course=this.courseModel.$find(this.scope.courseId),this.scope.isSingleGroup=!!s,this.scope.groups=this.scope.discussionData.groups,this.scope.isGradable=!!this.scope.discussionData.gradeColumnId,this.scope.gradingColumn=this.scope.discussionData.gradeColumnId,this.scope.viewedOnlyCount=this.scope.discussionData.viewedOnlyCount,this.scope.avgCommentsPerStudent=this.scope.discussionData.avgCommentsPerStudent?this.scope.discussionData.avgCommentsPerStudent:0,this.scope.avgWordCountPerComment=this.scope.discussionData.avgWordCountPerComment?this.scope.discussionData.avgWordCountPerComment:0,this.scope.avgGradeOfDiscussion=this.scope.discussionData.avgGrade?this.scope.discussionData.avgGrade/100:0,this.scope.numberOfCommentsToDisplay=1,this.scope.topComments=[],this.scope.displayTopComments=!1,this.scope.topParticipants=[],this.scope.displayTopParticipants=!1,this.scope.nonParticipants=[],this.scope.showNonparticipant=[],this.scope.showLargeNonparticipantPanel=!0,this.scope.minHeightForTopBoxes="auto",this.scope.nonParticipants=this.getNonParticipants(),this.scope.displayNonParticipants=!!this.scope.nonParticipants.length&&!this.scope.isGroupDiscussion,this.scope.displayNonParticipantGroups=!!this.scope.nonParticipants.length&&this.scope.isGroupDiscussion&&!this.scope.isSingleGroup,this.scope.displayNonParticipantGroup=!!this.scope.nonParticipants.length&&this.scope.isGroupDiscussion&&this.scope.isSingleGroup,this.scope.nonParticipantGroups=this.scope.displayNonParticipantGroups?this.getNonParticipantGroups():[],this.scope.totalNonParticipants=this.scope.nonParticipants.length,this.scope.totalParticipants=this.scope.discussionData.totalParticipants+this.scope.totalNonParticipants,this.scope.displayedNonParticipants=24,this.scope.additionalNonParticipants=this.scope.totalNonParticipants,this.scope.currentPanelWidth=0,this.scope.lastPanelWidth=-1,this.scope.isLoaded=!0;for(let e=0;e<this.scope.displayedNonParticipants;e++)this.scope.showNonparticipant[e]=!0;this.getTopComments(),this.getTopParticipants(),this.getParticipantBarChart(),this.updateNonParticipantView(),this.scope.statisticsConfig=this.getSummaryInsightNumbers(),this.scope.topCommentsColumns=this.scope.displayTopComments&&this.scope.displayTopParticipants?"small-12 medium-8 large-9":"small-12",this.scope.topParticipantColumns=this.scope.displayTopComments&&this.scope.displayTopParticipants?"small-12 medium-4 large-3":"small-12"}))}getSummaryInsightNumbers(){const e=this.bbLocalize.getLocale(this.scope),t=this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.numParticipants"}),s=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.formattedParticipation",params:{count:this.scope.totalParticipants-this.scope.totalNonParticipants,total:this.scope.totalParticipants},noWrap:!0}),n=this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.avgComments"}),i=this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.avgCount"}),o=this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.avgGrade"}),a=this.scope.isGradable&&this.scope.avgGradeOfDiscussion>0?this.bbLocalize.formatPercentageSync(this.scope.avgGradeOfDiscussion,this.scope):this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.na"}),r=[];return r.push({title:t,data:s}),r.push({title:n,data:this.bbLocalize.formatNumberSync(this.scope.avgCommentsPerStudent,this.scope).toString()}),this.scope.avgWordCountPerComment&&this.scope.avgWordCountPerComment>0&&r.push({title:i,data:this.bbLocalize.formatNumberSync(this.scope.avgWordCountPerComment,this.scope).toString()}),this.scope.isGradable&&r.push({title:o,data:a}),r}getParticipantBarChart(){let t=0,s=0,n=100;const i=this.scope.totalParticipants-this.scope.totalNonParticipants;this.scope.totalParticipants>0?(t=Math.floor((this.scope.totalParticipants-this.scope.totalNonParticipants)/this.scope.totalParticipants*100),s=Math.floor(this.scope.viewedOnlyCount/this.scope.totalParticipants*100),n=100-(t+s)):(t=0,s=0,n=100),e(".bar-chart .participated").attr("style","width: "+t+"%"),e(".bar-chart .opened").attr("style","width: "+s+"%"),e(".bar-chart .unopened").attr("style","width: "+n+"%");const o=this.scope.totalNonParticipants-this.scope.viewedOnlyCount;this.scope.barchartNonParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartNonParticipants",params:{count:o},noWrap:!0}),this.scope.barchartOpenedNonParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartOpenedNonParticipants",params:{count:this.scope.viewedOnlyCount},noWrap:!0}),this.scope.barchartParticipants=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.barchartParticipants",params:{count:i},noWrap:!0}),this.scope.percentParticipatedCaption=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.percentParticipated",params:{percent:this.bbLocalize.formatPercentageSync(t/100,this.scope)},noWrap:!0}),this.scope.percentOpenedCaption=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.percentOpened",params:{percent:this.bbLocalize.formatPercentageSync((s+t)/100,this.scope)},noWrap:!0})}getNonParticipantGroups(){const e=[];return this.scope.nonParticipants.length>0&&n.forEach(this.scope.groups,(t=>{const s={id:t.id,name:t.name,nonParticipants:[],total:0,hidden:0};n.forEach(this.scope.nonParticipants,(e=>{(e=this.handlePreferredDisplayName(e)).group.id===t.id&&(e.localizedName=this.bbLocalize.formatUsernameSync(e,a.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),s.nonParticipants.push(e),s.total++)})),s.hidden=s.total>4?s.total-4:0,s.total>0&&e.push(s)})),e}getTopComments(){this.scope.numberOfCommentsToDisplay=o.k()?3:5,this.scope.discussionData.topComments.forEach((e=>{const t={user:this.handlePreferredDisplayName(e.user),message:g.a.text(e.message),messageId:e.messageId,numReplies:e.numReplies};t.user.localizedName=this.bbLocalize.formatUsernameSync(e.user,a.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),t.user.avatarData=e.user,this.scope.topComments.push(t),this.scope.displayTopComments=!0}))}getTopParticipants(){this.scope.discussionData.topParticipants.forEach((e=>{const t={user:this.handlePreferredDisplayName(e.user),numComments:e.numComments,numReplies:e.numReplies};t.user.localizedName=this.bbLocalize.formatUsernameSync(e.user,a.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),t.user.avatarData=e.user,this.scope.topParticipants.push(t),this.scope.displayTopParticipants=!0}))}getNonParticipants(){const e=[];return this.scope.discussionData.nonParticipants.forEach((t=>{t.avatarData=t,t.localizedName=this.bbLocalize.formatUsernameSync(this.handlePreferredDisplayName(t),a.ILocaleUsernameFormat.Short,null,{noWrap:!1,noEscape:!0}),t.localizedNameWithoutWrap=this.bbLocalize.formatUsernameSync(this.handlePreferredDisplayName(t),a.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0}),t.preferredDisplayName===a.PreferredDisplayName.Both&&(t.otherName=this.bbLocalize.formatUsernameSync({...t,preferredDisplayName:a.PreferredDisplayName.Other},a.ILocaleUsernameFormat.Brief,null,{noWrap:!0,noEscape:!0}),t.fullName=this.bbLocalize.formatUsernameSync({...t,preferredDisplayName:a.PreferredDisplayName.Given},a.ILocaleUsernameFormat.Short,null,{noWrap:!0,noEscape:!0})),e.push(t)})),e}toggleIndividualNonParticipantDisplay(){i.defer((()=>{let e=n.element("#discussion-insights").find(".non-participant-box").innerWidth()-30;e=e<1118?e:1118;const t=2*Math.ceil((e+20)/126);this.scope.displayedNonParticipants=0;for(let e=0;e<18;e++)e<t&&e<this.scope.totalNonParticipants?(this.scope.showNonparticipant[e]=!0,this.scope.displayedNonParticipants++):this.scope.showNonparticipant[e]=!1;this.scope.additionalNonParticipants=this.scope.totalNonParticipants>this.scope.displayedNonParticipants?this.scope.totalNonParticipants-this.scope.displayedNonParticipants:0,this.scope.nonParticipationSummary=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.discussion.insights.nonParticipationSummary",params:{count:this.scope.displayedNonParticipants,total:this.scope.totalNonParticipants},noWrap:!0}),this.setNonParticipantMargin(e)}))}setNonParticipantMargin(t){const s=e("li.non-participant"),n=Math.floor(t/126),i=126*n+106,o=n-1>0?20+(t-i-2)/n:20+t-i;e(s).css("margin-right",o),e(s[n]).css("margin-right","2px"),2*n+1<=s.length&&e(s[2*n+1]).css("margin-right","2px")}updateNonParticipantView(){const e=this.bbLocalize.getLocale(this.scope);this.scope.nonParticipantsOptions=this.bbLocalize.translateSync({locale:e,key:"components.directives.discussion.insights.nonparticipantsOptions"}),this.scope.numberOfCommentsToDisplay=o.k()?3:5,this.scope.currentPanelWidth=n.element("#discussion-insights").find(".non-participant-box").innerWidth(),this.scope.currentPanelWidth!==this.scope.lastPanelWidth&&(o.k()?this.scope.showLargeNonparticipantPanel=!1:(this.scope.showLargeNonparticipantPanel=!0,this.toggleIndividualNonParticipantDisplay())),this.scope.lastPanelWidth=this.scope.currentPanelWidth}getSafeHtml(e){return this.$sce.trustAsHtml(e)}hasNavScrollbar(){const e=n.element(".group-selector")[0];return!!(e&&e.scrollWidth>e.clientWidth)}goToDiscussion(e){e?(this.discussion.groupId=e,this.ultraState.goPeekState("discussion.view.with-grading",{contentId:this.scope.contentId,disGroupId:e,courseId:this.scope.courseId})):this.ultraState.goPeekState("discussion.view.with-grading",{contentId:this.scope.contentId,courseId:this.scope.courseId})}goToGrade(e){this.scope.isGradable&&!this.scope.isGroupDiscussion&&this.ultraState.goPeekState("submission-list",{columnId:this.scope.gradingColumn,participantId:e,contentId:this.scope.contentId})}goToMessage(e){this.ultraState.goPeekState(v.CourseRoutes.COURSE_MESSAGE,{courseId:this.scope.courseId,recipientIds:e})}isFocusedNonparticipant(t){return e(document.activeElement).is(n.element(e("a#non-participant-link-"+t)))}sortNamesAlphabetically(e){let t="";return e.sort(((e,t)=>e.givenName+e.familyName<t.givenName+t.familyName?-1:1)).forEach((e=>{t+=e.id+","})),t.slice(0,-1)}goToMessageAll(){const e=this.sortNamesAlphabetically(this.scope.nonParticipants);this.ultraState.goPeekState(v.CourseRoutes.COURSE_MESSAGE,{courseId:this.scope.courseId,recipientIds:e,conversationPerRecipient:!0})}updateDfiPanel(t,s,n){e(".group-selector .selected").removeClass("selected"),e(t.target).addClass("selected"),s?(this.discussion.groupId=s,this.scope.currentGroupId=s,this.scope.currentGroupName=n,this.createDfiReport(this.scope.courseId,this.scope.contentId,s),this.updateNonParticipantView()):(this.discussion.groupId=void 0,this.scope.currentGroupId=void 0,this.scope.currentGroupName=void 0,this.createDfiReport(this.scope.courseId,this.scope.contentId))}isPreferedNameBoth(e){return e.preferredDisplayName===a.PreferredDisplayName.Both}subscribeToReduxChanges(){const e=this.$ngRedux.connect((e=>({otherNameAsDisplayNameSystemPreference:y.select.systemPreference.getSystemPreferenceByKey(e,O.OTHERNAME_AS_DISPLAY_NAME_OPTION)})),(e=>({loadOtherNameAsDisplayNameSystemPreference:t=>e(y.actions.systemPreference.loadSystemPreference(t))})))(this);this.scope.$on("$destroy",e)}handlePreferredDisplayName(e){var t;return e&&(null===(t=this.otherNameAsDisplayNameSystemPreference)||void 0===t?void 0:t.value)&&(e.preferredDisplayName="Y"===this.otherNameAsDisplayNameSystemPreference.value?e.preferredDisplayName:void 0),e}}I.$inject=["$window","$sce","scope","element","$stateParams","$ngRedux",a.serviceName,m.b,p.c,u.d,b.m.serviceName];class D{constructor(e){this.$injector=e,this.restrict="EA",this.template=S,this.scope={content:"&"},this.link=(e,t,s)=>{e.discussionInsights=this.$injector.instantiate(I,{scope:e,element:t,attrs:s})}}}D.$inject=["$injector"],n.module(A,[r.a,c.a,l.a,f.a,d.a,m.a,h.a,u.b]).directive("bbDiscussionInsights",["$injector",e=>e.instantiate(D)])}).call(this,s("71td"))},Tt7N:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-calculation",use:"icon-small-calculation-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-calculation"><path d="M4 2v4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="10" cy="10" r=".5" /><circle cx="14" cy="14" r=".5" /><path d="M2 10l4 4M2 14l4-4M14 10l-4 4M14 4h-4M6 4H2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},TuNX:function(e,t){e.exports='<bb-modal class="notification proctoring-modal" analytics-id-tag-prefix="components.services.proctoring">\n  <div name="modal-contents">\n    <p bb-translate>{{::requirementsText}}</p>\n    <p ng-bind-html="::downloadText"></p>\n    <p bb-translate>{{::browserText}}</p>\n  </div>\n  \x3c!-- htmlhint:analytics-id:disable --\x3e\n  <button name="modal-footer-button-primary"\n          role="button"\n          class="button js-primary-button proctoring-modal-button"\n          ng-click="$parent.$dismiss()"\n          bb-translate-attrs="{\'aria-label\':\'components.services.proctoring.modal.continue\'}"\n          analytics-id="components.services.proctoring.modal.continue.button"\n  >\n  \x3c!-- htmlhint:analytics-id:enable --\x3e\n    <bb-translate>components.services.proctoring.modal.continue</bb-translate>\n  </button>\n</bb-modal>\n'},"U+0H":function(e,t){e.exports='<div class="true-false-question-authoring true-false"  ng-class="::{\'editable\': assessmentQuestion.canEditQuestionText()}">\n  <div class="true-false-answers-container">\n    <ol class="true-false-answers">\n      <li class="true-false-answer js-true-false-answer-true">\n        <input ng-show="assessmentQuestion.isEditState"\n               id="{{::assessmentQuestion.elementId + \'true-false-answer-true\' }}"\n               name="{{::assessmentQuestion.elementId + \'true-false-answers-choice\' }}"\n               aria-labelledby="{{::assessmentQuestion.elementId + \'true-false-answer-true-label\' }}"\n               ng-disabled="::!assessmentQuestion.canModifyQuestionProperties()"\n               type="radio" ng-value="true" ng-model="question.answer"\n               analytics-id="assessment.question.true.false.answer.true.input.radio"/>\n        <label ng-show="assessmentQuestion.isEditState"\n               id="{{::assessmentQuestion.elementId + \'true-false-answer-true-label\' }}"\n               for="{{::assessmentQuestion.elementId + \'true-false-answer-true\' }}"\n               ng-mousedown="assessmentQuestion.updateCorrectAnswer(true)">\n          {{::assessmentQuestion.viewHelper.trueAnswerOptionLabel}}\n        </label>\n        <span class="true-false-answer-option" ng-show="!assessmentQuestion.isEditState" ng-click="assessmentQuestion.edit()"\n              analytics-id="components.directives.assessmentQuestion.edit.label">\n          {{::assessmentQuestion.viewHelper.trueAnswerOptionLabel}}\n        </span>\n        <span class="correct-answer-text" ng-show="!assessmentQuestion.isEditState && question.answer"\n              bb-translate>components.directives.assessment-question.true-false.correct-label</span>\n      </li>\n      <li class="true-false-answer js-true-false-answer-false">\n        <input ng-show="assessmentQuestion.isEditState"\n               id="{{::assessmentQuestion.elementId + \'true-false-answer-false\' }}"\n               name="{{::assessmentQuestion.elementId + \'true-false-answers-choice\' }}"\n               aria-labelledby="{{::assessmentQuestion.elementId + \'true-false-answer-false-label\' }}"\n               ng-disabled="::!assessmentQuestion.canModifyQuestionProperties()"\n               type="radio" ng-value="false" ng-model="question.answer"\n               analytics-id="assessment.question.true.false.answer.false.input.radio"/>\n        <label ng-show="assessmentQuestion.isEditState"\n               id="{{::assessmentQuestion.elementId + \'true-false-answer-false-label\' }}"\n               for="{{::assessmentQuestion.elementId + \'true-false-answer-false\' }}"\n               ng-mousedown="assessmentQuestion.updateCorrectAnswer(false)">\n          {{::assessmentQuestion.viewHelper.falseAnswerOptionLabel}}\n        </label>\n        <span class="true-false-answer-option" ng-show="!assessmentQuestion.isEditState" ng-click="assessmentQuestion.edit()"\n              analytics-id="components.directives.assessmentQuestion.edit.label">\n          {{::assessmentQuestion.viewHelper.falseAnswerOptionLabel}}\n        </span>\n        <span class="correct-answer-text" ng-show="!assessmentQuestion.isEditState && !question.answer"\n              bb-translate>components.directives.assessment-question.true-false.correct-label</span>\n      </li>\n    </ol>\n  </div>\n</div>\n'},U2yg:function(e,t){e.exports='<div bb-load-bundle="components/directives/content-navigator" class="content-navigator-container" ng-if="$ctrl.shouldShowNavigator()" >\n  <div class="content-navigator-pre">\n    <a ng-click="$ctrl.navigate(\'previous\')"\n       translate-attrs-values="{contentItem: $ctrl.sibling.previous.title}"\n       bb-translate-attrs="{\'aria-label\': \'components.directives.content-navigator.previous-content-item\'}"\n       ng-if="$ctrl.sibling.previous"\n       href="javascript:void(0);"\n       ng-disabled="!$ctrl.sibling.previous.canEdit() && $ctrl.sibling.previous.isConditionalReleaseLocked()"\n       analytics-id="components.directives.content.content-navigator.previous.link"\n    >\n      <bb-svg-icon icon="back-arrow" size="medium"></bb-svg-icon>\n      <span ng-if="(!$ctrl.content.isTest() && !$ctrl.content.isGradedScorm()) || $ctrl.forceShowTitle === true" class="ellipse" title="{{::$ctrl.sibling.previous.title}}">{{$ctrl.sibling.previous.title}}</span>\n\n      <div ng-if="!$ctrl.sibling.previous.canEdit() && $ctrl.sibling.previous.isConditionalReleaseLocked()"\n           bb-complex-tooltip\n           enhanced-tooltip="true"\n           tooltip-position="bottom"\n           tooltip-open-on-activation="true"\n           tooltip-disable-on-mouse-over="true"\n           tooltip-scope="$ctrl.cr.previous.tooltipScope"\n           tooltip-template="{{::$ctrl.cr.previous.getConditionalReleaseComplexTooltipTemplate()}}"\n           tabindex="0" onclick="return false;">\n        <bb-svg-icon size="small" icon="lock"></bb-svg-icon>\n        <span class="sr-only">{{::$ctrl.cr.previous.tooltips}}</span>\n      </div>\n    </a>\n  </div>\n\n  <div class="content-navigator-next">\n    <a ng-click="$ctrl.navigate(\'next\')"\n       translate-attrs-values="{contentItem: $ctrl.sibling.next.title}"\n       bb-translate-attrs="{\'aria-label\': \'components.directives.content-navigator.next-content-item\'}"\n       ng-if="$ctrl.sibling.next"\n       href="javascript:void(0);"\n       ng-disabled="!$ctrl.sibling.next.canEdit() && $ctrl.sibling.next.isConditionalReleaseLocked()"\n       analytics-id="components.directives.content.content-navigator.previous.link"\n    >\n      <div ng-if="!$ctrl.sibling.next.canEdit() && $ctrl.sibling.next.isConditionalReleaseLocked()"\n           bb-complex-tooltip\n           enhanced-tooltip="true"\n           tooltip-position="bottom"\n           tooltip-open-on-activation="true"\n           tooltip-disable-on-mouse-over="true"\n           tooltip-scope="$ctrl.cr.next.tooltipScope"\n           tooltip-template="{{::$ctrl.cr.next.getConditionalReleaseComplexTooltipTemplate()}}"\n           tabindex="0" onclick="return false;">\n        <bb-svg-icon size="small" icon="lock"></bb-svg-icon>\n        <span class="sr-only">{{::$ctrl.cr.next.tooltips}}</span>\n      </div>\n\n      <span ng-if="(!$ctrl.content.isTest() && !$ctrl.content.isGradedScorm()) || $ctrl.forceShowTitle === true" class="ellipse" title="{{::$ctrl.sibling.next.title}}">{{$ctrl.sibling.next.title}}</span>\n      <bb-svg-icon icon="forward-arrow" size="medium"></bb-svg-icon>\n    </a>\n  </div>\n</div>\n'},U50L:function(e,t){e.exports='<bb-modal id="notification-modal-api-error"\n          class="notification"\n          modal-aria-type="alertdialog"\n          modal-translate-options="translateOpts"\n          analytics-id-tag-prefix="components.services.error-modal.error-not-enough-submissions">\n  <div name="modal-contents">\n    <p bb-translate>{{::descriptionKey}}</p>\n  </div>\n  <button name="modal-footer-button-primary"\n          ng-click="$parent.$dismiss()"\n          class="button js-primary-button"\n          bb-translate\n          analytics-id="components.services.error-modal.dismiss">components.services.error-modal.dismiss</button>\n</bb-modal>\n'},UEFj:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-beast-analytics",use:"icon-small-beast-analytics-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-beast-analytics"><rect x="1" y="1" width="14" height="14" rx="7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M8 8V1M8 8l5-4M8 8l4.5 4.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},UODz:function(e,t){e.exports='<div class="submission-card" ng-class="{\'is-late\': isLate, \'inline\': inline}" bb-load-bundle="components/directives/submission-card">\n  <div class="panel" ng-class="{\'clickable-panel\': clickable}">\n    <bb-ui-icon-large-assignments class="submission-card__icon" ng-if="!inline" color="{{::submissionCard.showLateIcon ? \'error\' : \'inherit\'}}"></bb-ui-icon-large-assignments>\n    <div class="info" ng-class="{\'completed\': submissionCard.attempt.isCompleted(), \'rubric-icon-spacing\': submissionCard.shouldExpandForRubricIcon()}">\n      <span class="name ellipsis" bb-translate ng-if="!inline">{{title}}</span>\n      <span class="detail">\n        <span class="test-status ellipsis" ng-show="!!status">\n          <span class="inline-status" ng-if="inline && !hasAttempt && showLate" bb-translate>\n            components.directives.submission-card.outlineStatus.late\n          </span>\n          <span class="inline-status" ng-if="inline && !hasAttempt && !showLate" bb-translate>\n            components.directives.submission-card.outlineStatus.new\n          </span>\n          <span ng-if="inline && !hasAttempt"> - </span>\n          <span bb-translate class="status">{{status}}</span>\n          <ng-switch on="submissionCard.attempt.status" ng-if="submissionCard.attempt">\n            <bb-datetime class="date" format="Short" ng-switch-when="COMPLETED" value="::submissionCard.attempt.attemptLastGradedDate"></bb-datetime>\n            <bb-datetime class="date" format="Short" ng-switch-default value="::submissionCard.attempt.attemptDate"></bb-datetime>\n          </ng-switch>\n          <bb-datetime class="date" format="Short" ng-if="!submissionCard.attempt && gradingColumn.dueDate" value="::gradingColumn.dueDate"></bb-datetime>\n        </span>\n      </span>\n    </div>\n    <div class="grade-container">\n      <ng-switch on="gradeDetail.isPosted()">\n        <bb-display-grade ng-switch-when="true"\n                          grade-detail="gradeDetail"\n                          column="gradingColumn"\n                          display-type="GradeColor"\n                          show-rubric-button="showRubricButton()"\n                          show-rubric-div="showRubricDiv()"></bb-display-grade>\n        <bb-display-grade ng-switch-default\n                          attempt="submissionCard.attempt"\n                          display-type="AttemptStatus"></bb-display-grade>\n      </ng-switch>\n    </div>\n  </div>\n</div>\n'},UQC1:function(e,t){e.exports='<div class="calculated-formula-question-container calculated-formula-attempt-review">\n  <bb-rich-text-editor\n    ng-model="assessmentQuestion.viewHelper.questionTextWithVariableValues"\n    plugin-options="editorPluginOptions"\n    supports-inline-document-render="true"\n    is-read-only="true">\n  </bb-rich-text-editor>\n  <div\n    ng-if="::assessmentQuestion.questionAttempt.question.displayFormulaToStudent"\n    class="formula-details"\n  >\n    <img\n      ng-src="{{::assessmentQuestion.imageSource}}"\n      alt="{{::assessmentQuestion.imageAltText}}"\n      class="formula-image" />\n    <ul class="variable-value-list">\n      <li class="variable-value-list-item" ng-repeat="(variable, value) in ::assessmentQuestion.questionAttempt.question.variableValues">\n        <span translate-values="{variableName: variable, variableValue: value}" bb-translate>\n          components.directives.assessment-question.calculated-formula.variableValue\n        </span>\n      </li>\n    </ul>\n  </div>\n  <div\n    ng-if="::assessmentQuestion.questionAttempt.question.correctAnswerPrecision"\n    bb-translate\n    translate-values="{scale: assessmentQuestion.questionAttempt.question.answerScale}"\n    class="rounding-instructions"\n  >\n    {{::assessmentQuestion.viewHelper.getRoundingInstructionsKey()}}\n  </div>\n  <div class="given-answer">\n    <span bb-translate class="given-answer-label">\n      components.directives.assessment-question.calculated-formula.yourAnswer\n    </span>\n    <span dir="ltr">\n      {{::assessmentQuestion.questionAttempt.givenAnswer}}\n    </span>\n  </div>\n  <bb-question-answer-status\n    correctness="::assessmentQuestion.getAnswerResult()"\n    hide-correctness-text="::!assessmentQuestion.canShowCorrectAnswerRelatedDetail()"\n    was-late="::assessmentQuestion.wasAnsweredLate()"\n    class="calculated-formula-question-answer"\n  >\n    <div ng-if="assessmentQuestion.canShowCorrectAnswerRelatedDetail()">\n      <span ng-bind-html="::assessmentQuestion.viewHelper.getCorrectAnswerText()"></span>\n    </div>\n  </bb-question-answer-status>\n  <bb-automated-question-feedback\n    feedback="assessmentQuestion.getAutomatedQuestionFeedback()"\n    is-collapsible="assessmentQuestion.allowCollapsingOfAutomatedFeedbackIfShown()"\n    editor-plugins-options="automatedFeedbackEditorPluginOptions"\n  />\n</div>\n'},UeHE:function(e,t){e.exports='<div ng-if="addContentButton.isCloudServiceAvailable">\n  <bb-file-upload\n    allow-multiple="true"\n    monitor-leave="true"\n    target-div="{{\'#\' + fileListViewId}}"\n    hide-transclude-during-upload="false"\n    click-enabled="false"\n    primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n    skip-zip-file-check="true"\n    disable-drag="true"\n    is-third-party-upload="true"\n    third-party-download-handler="addContentButton.downloadFile"\n    ignored-states="::ignoredStates()">\n    <button ng-click="addContentButton.assignPosition()"\n            class="doc-add-media clear ng-scope"\n            bb-cloud-storage-integration\n            primary-key="primaryKey && primaryKey() ? primaryKey() : fileListViewLocalId"\n            attach-handler="addContentButton.cloudUploadAttachHandler"\n            web-location="{{webLocation}}"\n            file-location="{{fileLocation}}"\n            allow-multiple="true"\n            on-files-selected="addContentButton.onFilesSelectedHandler"\n            analytics-id="components.directives.add-content-button.cloud-upload.button">\n      <div class="import-action-header">\n        <i class="icon-cloud add-content-cloud-upload-icon"></i>\n        <span bb-translate>components.directives.add-content-button.importContentFromCloudStorage.title</span>\n        <div class="action-details" bb-translate="components.directives.add-content-button.importContentFromCloudStorage.description"></div>\n      </div>\n    </button>\n  </bb-file-upload>\n</div>\n'},Ui4O:function(e,t){e.exports='<div class="grade-grid-cell grade-grid-body-cell"\n  ng-click="gradeGridColumnReborn.enterEditor($event)"\n  analytics-id="components.directives.grade.grid.gradeGridColumnReborn.enterEdit"\n>\n  <div class="score hide" aria-label="{{gradeGridColumnReborn.ariaLabelContent}}">\n    <div id="displayedScore" class="hide">\n      <span id="display" class="hide"></span>\n      <span id="posted"  class="grade-posted-symbol hide" bb-translate>components.directives.grade.grid.postedLabel</span>\n      <span id="pastDueZero" class="past-due-zero-symbol hide" bb-translate>components.directives.grade.grid.pastDueZero</span>\n      <span id="slash" class="slash hide"></span>\n      <span id="pointsPossible" class="pointsPossible hide"></span>\n    </div>\n\n    <div id="gradeNow" class="hide" aria-label="{{gradeGridColumnReborn.ariaLabelContent}}">\n      <a href="javascript:void(0);"\n         analytics-id="components.directives.grade.grid.gradeNow"\n         bb-translate>components.directives.grade.grid.gradeNow</a>\n    </div>\n\n    <div id="newSubmission" class="hide">\n      <span class="new-submission" bb-translate>components.directives.grade.grid.newSubmissionLabel</span>\n    </div>\n\n    <span id="blank" class="sr-only">\n        {{gradeGridColumnReborn.ariaLabelContent}}\n    </span>\n  </div>\n  <div id="group" class="group-label" ng-if="!gradeGridColumnReborn.isRestrictedGroupContent">{{gradeGridColumnReborn.group.groupTitle}}</div>\n  <div id="ungraded" class="ungraded hide">\n    <span class="ellipse">{{gradeGridColumnReborn.ungraded}}</span>\n  </div>\n  <div class="anonymous hide">\n    <button\n      bb-tooltip\n      enhanced-tooltip="true"\n      tooltip-position="bottom-center"\n      class="anonymous-button"\n      analytics-id="components.directives.grade.grid.anonymous.button"\n      bb-translate-attrs="{ title: \'components.directives.grade.grid.anonymous.tooltip\' }">\n      <span bb-translate>components.directives.grade.grid.anonymous.label</span>\n    </button>\n  </div>\n</div>\n'},UsDD:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("fewm");const o="ultra.components.directives.bbUiIcon.large.Rubric";Object(n.a)(i.a,o,"bbUiIconLargeRubric")},UyCM:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-messages",use:"icon-small-messages-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-messages"><path d="M1 3h14v10H1V3z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M1 3l7 7 7-7M1 13l5-5M15 13l-5-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},VCKY:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-add",use:"icon-small-add-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-add"><path d="M1 8c0-3.866 3.134-7 7-7v0c3.866 0 7 3.134 7 7v0c0 3.866-3.134 7-7 7v0c-3.866 0-7-3.134-7-7v0zM11 8H5M8 5v6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},VUvS:function(e,t){e.exports='<div bb-load-bundle="components/directives/content/learning-module/learning-module-base-item" class="base-content-item bb-lm-base-item"\n  bb-cache-compilation="lm-base-item" role="region" aria-labelledby="::learning-module-title-{{content.id}}">\n  <div class="content-item-base-container guidance-overflow-fix js-content-item-base" ng-paste="$event.stopPropagation()">\n    <div ng-switch on="content.ui.importPlaceholder">\n      \x3c!-- Import placeholder  --\x3e\n      <div ng-switch-when="true" class="placeholder-container" bb-focus>\n        <div class="placeholder-text" bb-translate>components.directives.content-item-base.copy-placeholder</div>\n        <div class="sr-only" bb-translate>components.directives.content-item-base.please-wait</div>\n      </div>\n\n      \x3c!-- Non-imported content --\x3e\n      <div ng-switch-default class="drag-element-row" ng-class="{\'is-restricted\': content.canEdit() && content.isHiddenFromStudents(), \'isNotClickable\': content.isConditionalReleaseLocked() || content.isRestricted() && !content.canEdit()}">\n        <div class="content-item-row">\n          <div class="content-item-details" ng-class="{\'is-uploading\':content.ui.isUploading}">\n            <div class="element-card outline-item">\n\n              <ng-switch on="content.ui.isUploading">\n                \x3c!-- Uploading section begin --\x3e\n\n                <div ng-switch-when="true" class="upload-file">\n                  <bb-progress displayResults="false" id="{{content.ui.fileUploadId}}" class="bb-progress"></bb-progress>\n                </div>\n                \x3c!-- Uploading section end --\x3e\n\n                <div class="outline-item-inner" ng-switch-default>\n\n                  <div class="lm-header-section">\n                    \x3c!-- Learning Module title --\x3e\n                    <div class="lm-header-row"\n                         ng-class="{\'lm-header-row-with-icon\': baseItem.shouldShowReviewStateIcon()}"\n                         bb-click-to-invoke-child=".list-tree-toggle button">\n                      \x3c!-- Header row section --\x3e\n                      <div class="lm-title-container">\n                        <div class="title-container">\n                          \x3c!-- Conditional release section begin --\x3e\n                          <bb-review-state-icon\n                            ng-if="::baseItem.shouldShowReviewStateIcon()"\n                            content-id="content.id"\n                            course-id="content.courseId"\n                            has-automatic-review-state-transition="!content.canUpdateReviewState()"\n                            before-item-state="baseItem.getNeighborReviewState()"\n                            after-item-state="baseItem.getNeighborReviewState()"\n                          ></bb-review-state-icon>\n                          \x3c!-- Conditional release section end --\x3e\n\n                          \x3c!-- Attach event only at Instructor View --\x3e\n                          <div ng-if="::content.canEdit()" class="lm-title-instructor">\n                            <button class="lm-title secondary-title ellipse"\n                              tabindex="0"\n                              bb-translate-attrs="{\'aria-label\': \'components.directives.learning-module.aria-label.toggleLM\'}"\n                              translate-attrs-values="{learningModuleName: content.title}"\n                              aria-expanded="{{isOpen}}"\n                              id="{{::\'learning-module-title-\' + content.id}}"\n                              ng-click="baseItem.toggleLM()"\n                              analytics-id="course.learning.module.base.item.toggleLm.button"\n                              aria-controls="{{::\'learning-module-contents-\' + content.id}}">\n                              {{content.title}}\n                            </button>\n                          </div>\n\n                          \x3c!-- Just display title at Student View --\x3e\n                          <div class="lm-title-student" ng-if="::(!content.canEdit())">\n                            <button class="lm-title secondary-title ellipse"\n                                tabindex="0"\n                                bb-translate-attrs="{\'aria-label\': \'components.directives.learning-module.aria-label.toggleLM\'}"\n                                translate-attrs-values="{learningModuleName: content.title}"\n                                aria-expanded="{{isOpen}}"\n                                ng-click="!content.isConditionalReleaseLocked() && baseItem.toggleLM()"\n                                id="{{::\'learning-module-title-\' + content.id}}"\n                                analytics-id="course.learning.module.base.item.toggleLm.button"\n                                aria-controls="{{::\'learning-module-contents-\' + content.id}}">\n                              {{::content.title}}\n                            </button>\n                            <div ng-if="content.isConditionalReleaseLocked()"\n                              role="tooltip"\n                              tabindex="0"\n                              class="lock-info"\n                              bb-complex-tooltip\n                              enhanced-tooltip="true"\n                              tooltip-position="bottom"\n                              tooltip-open-on-activation="true"\n                              tooltip-disable-on-mouse-over="true"\n                              tooltip-scope="baseItem.conditionalRelease.tooltipScope"\n                              tooltip-template="{{::baseItem.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}">\n                              <span bb-translate>components.directives.content-item-base.conditionalRelease.lock-info</span>\n                              <span class="sr-only">{{baseItem.conditionalRelease.tooltips}}</span>\n                            </div>\n                          </div>\n                        </div>\n\n                        \x3c!-- Learning Module visibility selector  --\x3e\n                        <div class="lm-visibility-selector" ng-if="content.canEdit() || (baseItem.isCourseCompletedAndInInstructorView() && content.isConditionalRelease())">\n                          <bb-content-visibility-selector\n                            ng-if="::content.canEdit()"\n                            content="content"\n                            is-visibility-selector-enabled="true"\n                            onchange-func="baseItem.onChangeVisibility()"\n                            open-panel-on-restricted="true"\n                            disable-restricted="false"\n                            enable-conditional-release="true">\n                          </bb-content-visibility-selector>\n                          <div class="rules" ng-if="(content.canEdit() || baseItem.isCourseCompletedAndInInstructorView()) && content.isConditionalRelease()">\n                            <a href="javascript:void(0);"\n                              ng-click="baseItem.canOpenConditionalRelease && baseItem.openConditionalRelease()"\n                              bb-complex-tooltip\n                              enhanced-tooltip="true"\n                              tooltip-position="bottom"\n                              tooltip-enable-on-mouse-over-for-all-breakpoints="true"\n                              tooltip-enable-on-mouse-leave-for-all-breakpoints="true"\n                              tooltip-auto-update="true"\n                              tooltip-scope="baseItem.conditionalRelease.tooltipScope"\n                              tooltip-template="{{::baseItem.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}"\n                              analytics-id="components.directives.content-item-base.conditionalRelease.link">\n                              <span>{{baseItem.conditionalRelease.getConditionDescription()}}</span>\n                              <span class="sr-only">{{baseItem.conditionalRelease.tooltips}}</span>\n                            </a>\n                          </div>\n                        </div>\n                        <div ng-if="content.isForcedSequenceModule() && content.canEdit()"\n                          class="lm-instructor-note"\n                          bb-translate\n                        >\n                          components.directives.learning-module.base-item.forced-sequence.instructor-note\n                        </div>\n                        \x3c!-- Learning Module control section begin --\x3e\n\n                        \x3c!-- for student --\x3e\n                        \x3c!-- <div ng-if="::(!content.canEdit())">\n                          <span class="lm-counting">{{baseItem.completed}} / {{baseItem.count}}</span>\n                        </div> --\x3e\n\n                        \x3c!-- for instructor --\x3e\n                        <div ng-if="::(content.canEdit() && canMove)" class="lm-drag-button">\n                          <button bb-drag-handle drag-item-id="{{content.id}}"\n                                  drag-item-name="{{content.title}}"\n                                  drag-item-type="{{content.contentHandler}}"\n                                  drag-item-context="{{contextArea}}"\n                                  class="super-clear small button icon js-drag-handle"\n                                  translate-attrs-values="{contentTitle: content.title}"\n                                  bb-translate-attrs="{\'title\': \'components.directives.content-item-base.move\', \'aria-label\': \'components.directives.content-item-base.aria-label.move\'}"\n                                  analytics-id="course.learning.module.base.item.move.button">\n                            <bb-svg-icon size="small" icon="move-item-up-down"></bb-svg-icon>\n                          </button>\n                        </div>\n                        <div bb-foundation-defer>\n                          <bb-overflow-menu ng-if="::(content.canDelete() || content.canEdit() || content.hasConversation() && !content.isConditionalReleaseLocked())"\n                                            element-id="{{::(\'learning-module\' + baseItem.controlId)}}"\n                                            element-name="{{content.title}}"\n                                            menu-items="baseItem.getOverflowMenu()"\n                                            analytics-id-tag-prefix="components.directives.learning-module.base-item.overflowMenu">\n                          </bb-overflow-menu>\n                        </div>\n                      </div>\n\n                      <div class="lm-description" ng-if="content.description">\n                        <bb-course-content-item-description class="description-show-text-container description-show-text"\n                          description="content.description"\n                        ></bb-course-content-item-description>\n                      </div>\n\n                      \x3c!-- Learning Module control section end --\x3e\n                      <div class="list-tree-toggle" ng-if="::(content.canEdit() || !content.isRestricted())">\n                        <button class="button super-clear" ng-click="baseItem.toggleLM()" aria-controls="{{::\'learning-module-contents-\' + content.id}}"\n                          aria-expanded="{{isOpen}}"\n                          bb-translate-attrs="{title: isOpen ? \'components.directives.learning-module.base-item.collapse\' : \'components.directives.learning-module.base-item.expand\'}"\n                          translate-attrs-values="{learningModuleName: content.title}"\n                          analytics-id="course.learning.module.base.item.toggleLm.button"\n                          >\n                          <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon>\n                        </button>\n                      </div>\n                    </div>\n\n                    <bb-forced-sequence-warning-banner ng-if="baseItem.shouldShowForcedSequenceWarningBanner()"></bb-forced-sequence-warning-banner>\n\n                    \x3c!-- Learning Module title section end --\x3e\n                  </div>\n                </div>\n              </ng-switch>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},VcPJ:function(e,t,s){},WAgA:function(e,t){e.exports='<bb-modal role="alertdialog" class="notification gradebook-upload-failed-modal upload-failed-button" bb-translate-attrs="{\'aria-label\': \'course.grades.grades-upload-settings.wrongDelimiter.title\'}" \n    modal-title-key="course.grades.grades-upload-settings.wrongFormat.title" aria-describedby="wrong-format-content"\n    analytics-id-tag-prefix="course.grades.gradesUploadSettingsWrongFormat">\n    <div name="modal-contents">\n        <p id="wrong-format-content" bb-translate="course.grades.grades-upload-settings.wrongFormat.content"></p>\n    </div>\n    <a name="modal-footer-help-link" \n       href="" \n       bb-translate-attrs="{\'href\': \'course.grades.grades-upload-settings.helpLinkUpload\'}" \n       target="_blank" \n       bb-translate="course.grades.grades-upload-settings.helpButton" \n       rel="noopener noreferrer"\n       analytics-id="course.grades.grades-upload-settings.helpButton">\n    </a>\n    <button name="modal-footer-button-primary" \n            class="button js-discard-changes js-primary-button" \n            ng-click="$dismiss()"\n            analytics-id="course.grades.gradesUploadSettingsWrongFormat.closeButton.button">\n        <span bb-translate="course.grades.grades-upload-settings.closeButton"></span>\n    </button>\n</bb-modal>'},WSu0:function(e,t,s){"use strict";var n=s("aY38");function i(e){this.message=e}i.prototype=new Error,i.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new i("Invalid token specified");var s=!0===(t=t||{}).header?0:1;try{return JSON.parse(n(e.split(".")[s]))}catch(e){throw new i("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=i},Wqh6:function(e,t){e.exports='<div class="panel-wrap telemetry-panel">\n  <bb-telemetry-panel-header title="{{header}}"\n                           course="course"\n                           panel-data-loaded="true">\n  </bb-telemetry-panel-header>\n\n  <nav class="group-selector" ng-class="{\'horizontal-scroll\': discussionInsights.hasNavScrollbar()}" ng-if="isGroupDiscussion">\n    <ul class="group-list">\n      <li class="group-item child-is-invokable"\n          bb-click-to-invoke-child="a.overall-link"\n          tabindex="0">\n        <a href="javascript:void(0);"\n           class="overall-link selected"\n           ng-click="discussionInsights.updateDfiPanel($event)"\n           bb-translate="components.directives.discussion.insights.overall"\n           analytics-id="components.directives.discussion.insights.overall">\n        </a>\n      </li>\n      <li class="group-item child-is-invokable"\n          bb-click-to-invoke-child="a.group-menu-link"\n          tabindex="0"\n          ng-repeat="group in ::groups">\n        <a href="javascript:void(0);"\n           class="group-menu-link"\n           ng-click="discussionInsights.updateDfiPanel($event, group.id, group.name)"\n           analytics-id="components.directives.discussion.insights.group.link">\n          {{group.name}}\n        </a>\n      </li>\n    </ul>\n  </nav>\n\n  <section id="discussion-insights" class="panel-content discussion-insights" bb-foundation-defer>\n    <div class="insights">\n      <div class="insight-summary row collapse summary-box">\n        <div class="column small-12">\n          <bb-statistics\n            config="statisticsConfig"\n            ng-if="isLoaded"\n            small-per-row="1"\n            large-per-row="4"></bb-statistics>\n        </div>\n      </div>\n\n      <div class="participation-chart-container">\n        <div class="bar-chart">\n          <span class="participated"\n                aria-label="{{barchartParticipants}}"\n                title="{{barchartParticipants}}"></span>\n          <span class="opened"\n                aria-label="{{barchartOpenedNonParticipants}}"\n                title="{{barchartOpenedNonParticipants}}"></span>\n          <span class="unopened"\n                aria-label="{{barchartNonParticipants}}"\n                title="{{barchartNonParticipants}}"></span>\n        </div>\n        <div class="legend">\n          <div class="participatedCaption" data-ng-bind-html="discussionInsights.getSafeHtml(percentParticipatedCaption)"></div>\n          <div class="openedCaption" data-ng-bind-html="discussionInsights.getSafeHtml(percentOpenedCaption)"></div>\n        </div>\n      </div>\n\n      <div class="non-participant-groups row" ng-if="displayNonParticipantGroups">\n        <div class="column small-12 non-participant-box clearfix" bb-foundation-defer>\n          <h3 class="stat-title large-non-participants-title"\n              bb-translate="components.directives.discussion.insights.groupNonParticipants"\n              translate-values="{count: totalNonParticipants}"></h3>\n          <div class="float-right">\n            <button class="button super-clear message-all-non-participants-button"\n                type="button"\n                ng-click="discussionInsights.goToMessageAll()"\n                bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.messageNonParticipants\'}"\n                translate-attrs-values="{count: totalNonParticipants}"\n                analytics-id="components.directives.discussion.insights.messageNonParticipants.button">\n              <bb-ui-icon-medium-messages></bb-ui-icon-medium-messages>\n            </button>\n          </div>\n\n          <div class="group-nonparticipants" ng-repeat="nonParticipantGroup in nonParticipantGroups track by nonParticipantGroup.id">\n            <div class="group-heading child-is-invokable" bb-click-to-invoke-child="a.group-link">\n              <a class="group-link"\n                 href="javascript:void(0);"\n                 ng-click="discussionInsights.goToDiscussion(nonParticipantGroup.id)"\n                 analytics-id="components.directives.discussion.insights.nonParticipantGroup.link">\n                {{nonParticipantGroup.name}}\n              </a>\n            </div>\n            <div class="nonparticipant-in-group-container"\n                 ng-class="nonParticipantGroup.total > 3 ? \'space-evenly\' : \'set-margin\' ">\n              <div class="nonparticipant-in-group child-is-invokable"\n                   bb-click-to-invoke-child="a.group-non-participant-link"\n                   ng-repeat="nonParticipant in nonParticipantGroup.nonParticipants | limitTo: 4 track by nonParticipant.id">\n                <bb-avatar user="nonParticipant"></bb-avatar>\n                <a class="group-non-participant-link"\n                   href="javascript:void(0);"\n                   aria-label="{{nonParticipant.localizedName}}"\n                   ng-click="discussionInsights.goToMessage(nonParticipant.id)"\n                   analytics-id="components.directives.discussion.insights.nonParticipant.link">\n                  {{nonParticipant.localizedName}}\n                </a>\n              </div>\n            </div>\n            <div class="count-link">\n              <a ng-click="discussionInsights.goToDiscussion(nonParticipantGroup.id)"\n                 ng-show="nonParticipantGroup.hidden > 0"\n                 href="javascript:void(0);"\n                 bb-translate="components.directives.discussion.insights.moreLink"\n                 translate-values="{count: nonParticipantGroup.hidden}"\n                 analytics-id="components.directives.discussion.insights.moreLink">\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="non-participants row" ng-show="(displayNonParticipants || displayNonParticipantGroup)">\n        <div class="column small-12 non-participant-box clearfix" ng-if="showLargeNonparticipantPanel" bb-foundation-defer>\n          <h3 class="stat-title large-non-participants-title" bb-translate="components.directives.discussion.insights.nonParticipants"></h3>\n          <div class="float-right">\n            <button class="button super-clear message-all-non-participants-button"\n                type="button"\n                ng-click="discussionInsights.goToMessageAll()"\n                bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.messageNonParticipants\'}"\n                translate-attrs-values="{count: totalNonParticipants}"\n                analytics-id="components.directives.discussion.insights.messageNonParticipants.button">\n              <bb-ui-icon-medium-messages></bb-ui-icon-medium-messages>\n            </button>\n          </div>\n          <ul class="non-participant-list clearfix">\n            <li class="non-participant child-is-invokable"\n                bb-click-to-invoke-child="a.non-participant-link"\n                tabindex="-1"\n                ng-show="showNonparticipant[$index]"\n                ng-repeat="nonParticipant in nonParticipants | limitTo: 18 track by nonParticipant.id">\n              <div class="non-participant-cell"\n                   ng-class="{\'show-focus-outline\': discussionInsights.isFocusedNonparticipant(nonParticipant.id)}">\n                <a class="non-participant-link hide-focus-outline"\n                   bb-translate-attrs="{\'aria-label\':\'{{nonParticipant.localizedNameWithoutWrap}}\'}"\n                   id="non-participant-link-{{nonParticipant.id}}"\n                   tabindex="0"\n                   href="javascript:void(0);"\n                   ng-focus="true"\n                   ng-blur="true"\n                   ng-click="discussionInsights.goToMessage(nonParticipant.id)"\n                   analytics-id="components.directives.discussion.insights.nonParticipantLink.link">\n                  <bb-avatar class="non-participant-avatar" user="nonParticipant.avatarData"></bb-avatar>\n                </a>\n                <span ng-if="!discussionInsights.isPreferedNameBoth(nonParticipant)" class="byline stacked" ng-bind-html="discussionInsights.getSafeHtml(nonParticipant.localizedName)"></span>\n\n                <div ng-if="discussionInsights.isPreferedNameBoth(nonParticipant)">\n                  <span class="byline stacked stacked-other-name" ng-bind-html="discussionInsights.getSafeHtml(nonParticipant.otherName)"></span>\n                  <span class="byline stacked stacked-other-name" ng-bind-html="discussionInsights.getSafeHtml(nonParticipant.fullName)"></span>\n                </div>\n              </div>\n            </li>\n          </ul>\n          <label class="summary-line">{{nonParticipationSummary}}</label>\n        </div>\n        <div class="column small-12 non-participant-box clearfix" ng-if="!showLargeNonparticipantPanel">\n          <h3 class="stat-title subheader">{{barchartNonParticipants}}</h3>\n          <button class="messageAllButton button"\n                  bb-translate="components.directives.discussion.insights.messageAll"\n                  bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.messageAll\'}"\n                  ng-click="discussionInsights.goToMessageAll()"\n                  analytics-id="components.directives.discussion.insights.messageAll">\n          </button>\n        </div>\n      </div>\n\n      <div class="row equal-height" ng-if="displayTopComments || displayTopParticipants">\n        <div class="top-comments column {{topCommentsColumns}} student-list-box" ng-if="displayTopComments">\n          <h3 class="stat-title subheader"\n              id="most-replies-heading"\n              bb-translate="components.directives.discussion.insights.mostReplies"></h3>\n          <div class="tabular-list-container">\n            <div class="tabular-row top-comment-row child-is-invokable"\n                 bb-click-to-invoke-child="a.discussion-link"\n                 ng-class="{\'last\':$last}"\n                 ng-repeat="comment in topComments | limitTo: numberOfCommentsToDisplay | orderBy: \'-numReplies\'">\n              <a href="javascript:void(0);"\n                 class="discussion-link"\n                 ng-click="discussionInsights.goToDiscussion(comment.user.group.id)"\n                 aria-labelledby="comment-user-{{comment.user.id}} most-replies-heading"\n                 aria-describedby="comment-message-{{comment.user.id}}\n                 comment-replies-{{comment.user.id}}"\n                 analytics-id="components.directives.discussion.insights.goToDiscussion.link">\n                <bb-avatar class="top-participant-avatar" user="comment.user.avatarData"></bb-avatar>\n                <div class="comment-info">\n                  <div class="comment-message ellipsis" id="comment-message-{{comment.user.id}}">{{comment.message}}</div>\n                  <div class="byline ellipsis">\n                    <span id="comment-user-{{comment.user.id}}">\n                      <bb-translate>components.directives.discussion.insights.by</bb-translate> {{comment.user.localizedName}}\n                      <span ng-show="isGroupDiscussion"><bb-translate>components.directives.discussion.insights.inGroup</bb-translate> {{comment.user.group.name}}</span>\n                    </span> |\n                    <span id="comment-replies-{{comment.user.id}}"> {{comment.numReplies}} <bb-translate>components.directives.discussion.insights.replies</bb-translate></span>\n                  </div>\n                </div>\n              </a>\n            </div>\n          </div>\n        </div>\n        <div class="top-participants column {{topParticipantColumns}} student-list-box" ng-if="displayTopParticipants">\n          <h3 id="top-heading" class="stat-title subheader" bb-translate="components.directives.discussion.insights.topParticipants"></h3>\n          <div class="tabular-list-container">\n            <div class="tabular-row top-participants-row child-is-invokable"\n                 bb-click-to-invoke-child="a.grading-panel-link"\n                 ng-class="{\'last\':$last, \'not-graded\': (!isGradable || isGroupDiscussion), \'group-row\':isGroupDiscussion}"\n                 ng-repeat="participant in topParticipants | limitTo: numberOfCommentsToDisplay | orderBy: \'-numComments\'">\n              <a href="javascript:void(0);"\n                 class="grading-panel-link"\n                 aria-labelledby="user-{{participant.user.id}} top-heading"\n                 aria-describedby="span-replies-{{participant.user.id}} span-feedback-{{participant.user.id}}"\n                 ng-class="{\'not-graded\': (!isGradable || isGroupDiscussion)}"\n                 ng-click="discussionInsights.goToGrade(participant.user.id)"\n                 analytics-id="components.directives.discussion.insights.goToGrade.link">\n                <bb-avatar class="comment-avatar" user="participant.user.avatarData"></bb-avatar>\n                <div class="top-participant-info ellipsis" ng-class="{\'not-graded\': !isGradable}">\n                  <span class="discussion-insights-heading" id="user-{{participant.user.id}}">{{participant.user.localizedName}}</span><br>\n                  <span class="ellipsis" ng-show="isGroupDiscussion">{{participant.user.group.name}}</span><br ng-show="isGroupDiscussion">\n                  <span class="byline" id="span-feedback-{{participant.user.id}}">\n                    <bb-svg-icon class="top-participant-icon" size="small" icon="feedback" bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.feedback\'}"></bb-svg-icon>\n                    {{participant.numComments}}\n                  </span>\n                  <span class="byline" id="span-replies-{{participant.user.id}}">\n                  <bb-svg-icon class="top-participant-icon" size="small" icon="replies" bb-translate-attrs="{\'aria-label\': \'components.directives.discussion.insights.replies\'}"></bb-svg-icon>\n                    {{participant.numReplies}}\n                  </span>\n                </div>\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div ui-view="telemetry-discussion-forum-insights-base@"></div>\n  </section>\n</div>\n'},X4V6:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("Ul6e");const o="ultra.components.directives.bbUiIcon.large.Spreadsheet";Object(n.a)(i.Spreadsheet,o,"bbUiIconLargeSpreadsheet")},X6r5:function(e,t,s){"use strict";var n=s("D57K"),i=(s("smDF"),s("dV61"),s("Ybms"),s("nsO7")),o=s("Sa5G"),a=s("jhBu"),r=s("8W6D"),c=s("pjml"),l=s("0JpG"),d=s("TnpK"),u=s("gkef"),p=s("5KgE"),m=s("p7NW"),h=s("g66W"),b=s("zGdY"),g=s("aHpC"),v=s("UsDD"),f=s("ZQFV"),w=s("yC9S"),S=s("2tKw");s.d(t,"a",(function(){return C}));const C="ultra.components.directives.rubric.rubricList",y="NEW_BADGE_COMPONENT_KEY";let O=class{constructor(e,t,s,n,i,o,a,r,c,l){this.element=e,this.$rootScope=t,this.$scope=s,this.CourseModel=n,this.bbLocalize=i,this.ultraState=o,this.windowSize=a,this.entitlements=r,this.firstTimeHelper=c,this._rubricService=l,this.enableRubricAssociation=!1,this.editable=!1,this.hasViewAccess=!1,this.showCompleteDescription=!1,this.rubricIdList=[],this.contextArea="rubrics",this.shouldShowNewBadge=!1,s.rubricList=this}$onInit(){const e={sort:"title(asc)",limit:1e3,expand:"columnHeaders,rows"};this.CourseModel.$new(this.course.id).rubrics.$fetch(e).$allow(["403"]).$asPromise().then((e=>this.handleRubricResponse(e))),this.destroyRubricSaveListener=this.$rootScope.$on("rubric-save",((t,s)=>{this.course.rubrics.$refresh(e).$allow(["403"]).$asPromise().then((e=>this.handleRubricResponse(e)))})),this.entitlements.hasCourseEntitlement(o.k.ViewRubrics,this.course.id).then((e=>{this.hasViewAccess=e})),this.setShouldShowBadge()}handleRubricResponse(e){403!==e.$response.status&&(this.rubrics=e)}$onDestroy(){if(this.destroyRubricSaveListener(),this.shouldShowNewBadge){const e=Object(h.a)(y,p.a);this.firstTimeHelper.hide(e)}}getOverflowMenuItems(e){return[{icon:"duplicate",labelKey:"components.directives.rubric.list.tooltip.duplicate",show:()=>e.permissions&&e.permissions.edit&&!this.windowSize.isSmallBreakpoint(),onClick:this.copyRubric.bind(this,e),ariaLabel:()=>this.bbLocalize.translateSync({locale:this.course.getLocale()||this.bbLocalize.getAppLocale(),key:"components.directives.rubric.list.copyRubric",params:{title:e.title},noWrap:!0})}]}getDeleteMenuOption(e){const t=(e.readOnly||e.associated)&&e.canDelete(),s=t?"components.directives.rubric.list.deleteInUseRubric.title":"components.directives.rubric.list.deleteRubric.title",n=t?"components.directives.rubric.list.deleteInUseRubric.instructions":"components.directives.rubric.list.deleteRubric.instructions",i=t?"components.directives.rubric.list.deleteInUseRubric.label":"components.directives.rubric.list.deleteRubric.label";return{show:()=>e.canDelete(),onClick:this.deleteRubric.bind(this,e,t),confirmationOptions:{titleKey:s,instructionsKey:n},ariaLabel:()=>this.bbLocalize.translateSync({locale:this.course.getLocale()||this.bbLocalize.getAppLocale(),key:i,params:{title:e.title},noWrap:!0})}}setShouldShowBadge(){const e=this.element.closest(".bb-offcanvas-panel").attr("data-base-state-name"),t=Object(h.a)(y,p.a);this.firstTimeHelper.shouldShow(t,e,!1).then((e=>{this.shouldShowNewBadge=e}))}pointsCheckboxTrigger(e,t){t?this.rubricIdList.push(e):this.rubricIdList.splice(this.rubricIdList.indexOf(e),1)}associateRubric(e){if(this.rubricAssociationHandler&&this.rubricIdList.includes(e.id)){const t=this.getPointsRubricMaxScore(e),s=Math.min(f.Utils.GRADE_MAX_POINTS,t);this.rubricAssociationHandler({rubric:e,maxPoints:s})}else this.rubricAssociationHandler&&this.rubricAssociationHandler({rubric:e})}toggleDescription(){this.showCompleteDescription=!this.showCompleteDescription}getPointsRubricMaxScore(e){if(null==e.rows||this._rubricService.isPercentageOrPercentageRangeRubric(e))return 0;const t=e.rubricType===b.RubricType.POINTS?b.RubricType.POINTS:b.RubricType.POINTS_RANGE;e.rows.forEach(((e,s)=>{this.setMaxRowPoints(e,t)}));const s=e.rows.filter((e=>i.isFinite(e.rowPoints))).reduce(((e,t)=>e+t.rowPoints),0);return parseFloat(f.Utils.parseGradeValue(s))}setMaxRowPoints(e,t){if(i.isFinite(e.rowPoints)||null==e.cells)return;let s=0;e.cells.forEach((e=>{const n=t===b.RubricType.POINTS?e.numericPoints:e.endPointRange;void 0!==n&&!Number.isNaN(n)&&n>s&&(s=n)})),e.rowPoints=s}copyRubric(e){this.ultraState.goPeekState("rubric.mode",{rubricId:e.id,mode:r.a.COPY.toString()})}deleteRubric(e,t){t?e.withParams({cascade:!0}).$destroy():e.$destroy()}};O=Object(n.__decorate)([Object(w.a)({moduleName:C,componentName:"bbRubricList",template:S,bindings:{course:"<",enableRubricAssociation:"<?",rubricAssociationHandler:"&?",editable:"<?"},requireModules:[d.b,u.a,v.a,m.f]}),Object(n.__param)(0,Object(g.b)("$element")),Object(n.__param)(1,Object(g.b)("$rootScope")),Object(n.__param)(2,Object(g.b)("$scope")),Object(n.__param)(3,Object(g.b)(c.m.serviceName)),Object(n.__param)(4,Object(g.b)(l.serviceName)),Object(n.__param)(5,Object(g.b)(d.d)),Object(n.__param)(6,Object(g.b)(u.b)),Object(n.__param)(7,Object(g.b)(a.b)),Object(n.__param)(8,Object(g.b)(p.c)),Object(n.__param)(9,Object(g.b)(m.g))],O)},X8JP:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return r}));var n=s("Vsv2"),i=s("pjml"),o=s("0JpG");const a="ultraUi.components.services.cloudDrive.rteCloudStorageIntegrationModal",r="RteCloudStorageIntegrationService";class c{constructor(e,t,s,n){this.$q=e,this.cloudDriveService=t,this.CloudDriveModel=s,this.bbLocalize=n}initialize(){return this.cloudDriveService.isCloudServiceAvailable().then((e=>this.isCloudServiceAvailable=e))}openFilePicker(e){const t=this.bbLocalize.getLocale(e);return this.cloudDriveService.cloudDriveStorage.openFilePicker(t,!0).then((e=>{if(e){const t=[];return e.forEach((s=>{const n=(e=>e.account+"|"+e.id)(s),i=this.CloudDriveModel.$new("CloudStorageIntegration").contents.$new(n).$fetch({accessToken:e[0].bearer_token.key}).$asPromise();t.push(i)})),this.$q.all(t).then((t=>t.map((t=>({id:t.id,cloudStorageIntegrationAccessToken:e[0].bearer_token.key,name:t.name,size:t.size,type:t.type,updatedTime:t.updatedTime,webLocation:t.webLocation})))))}return this.$q.reject()}))}getModalCallback(e){return()=>this.cloudDriveService.cloudDriveStorage?this.openFilePicker(e):this.cloudDriveService.initializeCloudDrive().then((()=>this.openFilePicker(e)))}}c.$inject=["$q",n.b,i.h.serviceName,o.serviceName],angular.module(a,[n.a]).service(r,c)},XH1I:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("Llzl"),i=s("0JpG"),o=s("AuQm"),a=s("1ZbL");const r="ultra.components.directives.page.size.selector",c={Class:o.LocalizedPageSize,attributes:["analyticsId","className"],bindingNames:["pageSizeOptions","onPageSizeChange","initialPageSize"],renderLocalized:!0};n.module(r,[i.moduleName]).component("bbPageSizeSelector",Object(a.a)(c))},XPgl:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-arrow-down",use:"icon-small-arrow-down-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-arrow-down"><path d="M1 4l7 7 7-7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"XQ/u":function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("D57K"),i=s("yC9S"),o=s("iq5i"),a=s("2Kra");const r="ultra.components.directives.sliderTabNavigation.sliderTabItemIcon";let c=class{};c=Object(n.__decorate)([Object(i.a)({moduleName:r,componentName:"bbSliderTabItemIcon",template:a,bindings:{iconName:"<"},requireModules:[o.a]})],c)},Xcvp:function(e,t){e.exports='<div class="calculated-numeric-question-container calculated-numeric-attempt-authoring guidance-wrapper">\n  <bb-question-attempt\n    question="::questionAttempt.question"\n    given-answer="assessmentQuestion.givenAnswer"\n    question-number="::questionAttempt.visibleQuestionNumber"\n    on-answer-change="::assessmentQuestion.onAnswerChange"\n    ally-service="::allyService"\n    content-id="::contentId"\n  ></bb-question-attempt>\n</div>\n'},Xcx3:function(e,t,s){"use strict";s.r(t),s.d(t,"controllerName",(function(){return z})),s.d(t,"INCORRECT_PASSWORD_ENTERED",(function(){return U})),s.d(t,"BLANK_PASSWORD_KEY",(function(){return V})),s.d(t,"INCORRECT_PASSWORD_KEY",(function(){return H})),s.d(t,"TOO_MANY_ATTEMPTS_KEY",(function(){return Q})),s.d(t,"START_PEER_REVIEW_BUTTON_KEY",(function(){return K})),s.d(t,"START_NEXT_PEER_REVIEW_BUTTON_KEY",(function(){return W})),s.d(t,"AssessmentOverviewController",(function(){return J})),s.d(t,"Controller",(function(){return Y}));var n=s("D57K"),i=(s("SMOU"),s("Mak1"),s("s5UK"),s("6BRP"),s("67oV"),s("l+9M"),s("GkCm"),s("ZKRZ"),s("KXuk"),s("yCl+"),s("dpCN"),s("D1Wg"),s("2MQt"),s("JbSi"),s("TR8k"),s("6ZXc"),s("xoIb"),s("dcnw"),s("sZYy"),s("v0wN"),s("QhTW"),s("H/8/"),s("Ycix"),s("4VOk"),s("9G/E"),s("HApu"),s("zIKm"),s("nfUd"),s("nsO7")),o=s("Llzl"),a=s("8N5j"),r=s("IiJs"),c=s("vdfi"),l=s("nYZ0"),d=s("Fvsw"),u=s("bF8R"),p=s("X455"),m=s("fYJU"),h=s("k9iv"),b=s("oi1r"),g=s("o5Lu"),v=s("vhkR"),f=s("2lxm"),w=s("0JpG"),S=s("p7NW"),C=s("pjml"),y=s("12mu"),O=s("YHe3"),A=s("TnpK"),I=s("+O05"),D=s("IbyE"),k=s("zGdY"),_=s("94SL"),j=s("Kpdw"),T=s("aHpC"),$=s("nmzr"),R=s("9hUw"),E=s("0+Qs"),x=s("lEL+"),P=s("5uPl"),L=s("DU7P"),G=s("9ah5");s.d(t,"template",(function(){return G}));var M=s("0B2D");s.d(t,"alreadySubmittedTemplate",(function(){return M}));var N=s("kirn"),F=s("217T");s.d(t,"groupAlreadySubmittedTemplate",(function(){return F}));var B=s("Fv8s");s.d(t,"assessmentTimerModalTemplate",(function(){return B}));var q=s("Y+9S");const z="ultra.features.course.content.assessmentOverview.controller",U="bb-assessment-password-incorrect",V="course.content.assessment.overview.passwordProtected.errors.empty",H="course.content.assessment.overview.passwordProtected.errors.incorrect",Q="course.content.assessment.overview.passwordProtected.errors.tooManyAttempts",K="course.content.assessment.overview.assignedPeerReviews.startPeerReviews",W="course.content.assessment.overview.assignedPeerReviews.startNextReview";let J=class extends _.a{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,v,f,w,S,C,y,O,A,I,D,k,_,j,T,$){var R,E;super(e,$,c,l,w,I),this.contentData=e,this.course=t,this.$injector=s,this.$ngRedux=n,this.$scope=i,this.$q=o,this.$window=a,this.contentService=r,this.context=c,this.grade=l,this.ultraState=d,this.contentGoalAlignmentPeekStateService=u,this.AttemptModel=p,this.GroupAttemptModel=m,this.errorModalService=h,this.modal=b,this.ltiService=v,this.courseContent=f,this.schemaService=w,this.bbLocalize=S,this.proctoring=C,this.rubricService=y,this.collabUltra=O,this.contextUser=A,this.contextCourseMembership=I,this.assessmentService=D,this.originalityReportService=k,this.peerService=_,this.bbInterval=j,this.bbTimeout=T,this.gradableItemUserOptionService=$,this.alignedGoalsCount=0,this.currentProctoringServiceType=L.a.None,this.customCategory="",this.detailsView=!1,this.goalAlignedContents=[],this.groupUsers=[],this.hideOverview=!1,this.showGoalDetails=!1,this.showRubricDetails=!1,this.showCollabLink=!1,this.hasGroupIndicator=!1,this.hasClassIndicator=!1,this.collabUltraEnabled=!1,this.isAssessmentPasswordProtected=!1,this.givenPassword="",this.passwordErrorMessageKey="",this.isPasswordCheckInProgress=!1,this.remainingTimeInSecondsBeforeDueDateOverridesSoftTimeLimit=Number.NEGATIVE_INFINITY,this.startPeerReviewsButtonVisible=!1,this.startPeerReviewsButtonEnabled=!1,this.startNextPeerReviewButtonKey="",this.assignAndGoToNewPeerReview=null,this.localizedCourseRoles={},this.dismissPeerDeletedBanner=!1,this.assignAndNavigateToPeerReview=()=>{var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.assignNewPeerReview().then((e=>{var t;return null===(t=this.peerReviewContentObject)||void 0===t?void 0:t.navigateToPeerReview(e.delegatedGraderOrder)}))},this.dismissPeerReviewsDeletedBanner=()=>{this.dismissPeerDeletedBanner=!0},this.peerReviewsComponentUpdatedCallback=(e,t,s,n,i)=>{this.startPeerReviewsButtonEnabled=t,this.startPeerReviewsButtonVisible=(e||t)&&!n,this.startNextPeerReviewButtonKey=s?W:K,this.assignAndGoToNewPeerReview=i},i.assessmentOverview=this,this.content=e.courseContent,this.init(),this.peerService.getOrCreatePeerContentWithAttemptsFromContent(this.content).then((e=>this.peerReviewContentObject=e)),this.content.ui.hasConversationAttached=!!this.content.attachedForumLink,this.groupUsers=e.groupMembers,this.isAssessmentPasswordProtected=null===(E=null===(R=this.content.getDeployedAssessment())||void 0===R?void 0:R.deploymentSettings)||void 0===E?void 0:E.isPasswordRequired,this.timedTestAttemptDetail=this.getTimedTestAttemptDetail(),this.startModalTranslateOptions={instructions:{pluralize:!0,params:{totalTimeLimit:Math.floor(this.displayedTimeLimitSeconds/60)},noWrap:!0,noEscape:!0}},this.registerHandlers(),this.content.$fetchIfNotExpanded({expand:"alignedGoals,assignedGroups"}).$then((s=>{u.resolveGoalAlignableContentsForStudent(t,e,this.currentAttempt).then((([e,t])=>{this.goalAlignedContents=e,this.alignedGoalsCount=t})),this.content.courseId&&this.content.assignedGroups&&this.content.assignedGroups[0]&&this.collabUltra.getCollabSessionStatus(this.content.courseId,this.content.assignedGroups[0].groupId).then((e=>{this.runningSessionFlag=e,null!==e&&(this.collabUltraEnabled=!0)}))})),this.detailsView=!!this.ultraState.params.detailsView,this.detailsView&&(this.submitToGRD=!!this.ultraState.params.submitToGRD),this.calculateKeysAndIconsBasedOnCategory(),this.safeAssignEnabled&&this.content.canStudentViewReports()&&this.getOriginalityReportStatus(),this.content.isGroupContent&&this.content.ui.hasConversationAttached&&this.content.attachedForumLink&&this.loadCollabConfig(),this.content.ui.hasConversationAttached&&this.content.attachedForumLink&&this.updateIndicators();const x=this.contentService.indicatorCacheService.$onClassConversationIndicatorRemoved(((e,t,s)=>{t===this.content.courseId&&s===this.content.id&&(this.hasClassIndicator=!1)})),P=this.contentService.indicatorCacheService.$onGroupConversationIndicatorRemoved(((e,t,s)=>{t===this.content.courseId&&s===this.content.id&&(this.hasGroupIndicator=!1)}));i.$on("$destroy",(()=>{x(),P()})),this.contentData.gradingColumn.getAssociatedRubric()&&(this.rubricViewPayload={analyticsId:"assessmentOverview",criteria:y.getCriteriaPayload(this.contentData.gradingColumn),decimalsLength:g.d.DEFAULT_GRADEBOOK_SETTINGS_AFTER_DECIMAL,rubricType:this.contentData.gradingColumn.getAssociatedRubric().rubricType,maxScore:this.contentData.gradingColumn.possible}),this.fetchOriginalityReportProviderType(),this.fetchProctoringService(),Object(q.isInMobileApp)()&&this.notifyMobileApp(),this.initializeRemainingTimeTimer()}notifyMobileApp(e){var t,s,n;let i,o;if(e)o={type:e,status:q.MessageStatus.Success};else{i=this.showBeforeAttemptedFooter?q.MessageType.AssessmentOverviewOpened:q.MessageType.AssessmentDetailOpened;const e=null!==(s=null===(t=this.contentData.gradingColumn.gradebookCategory)||void 0===t?void 0:t.title)&&void 0!==s?s:null;o={type:i,status:q.MessageStatus.Success,contentId:this.content.id,contentTitle:this.content.title,pageTitle:e,prevState:Object(q.fetchState)(null===(n=this.ultraState.prev)||void 0===n?void 0:n.name)}}Object(q.sendMessageToMobile)(o)}fetchOriginalityReportProviderType(){return this.originalityReportService.retrieveOriginalityIntegration(this.content)}fetchProctoringService(){return this.currentProctoringServiceType=this.proctoring.getCurrentProctoringProviderType(this.proctoringHandle),this.proctoring.getProctoringServiceByHandle(this.proctoringHandle).then((e=>{this.currentProctoringService=e}))}get proctoringHandle(){var e;return null===(e=this.content.getDeployedAssessment())||void 0===e?void 0:e.deploymentSettings.proctoringServiceHandle}get latestAttemptDate(){return this.currentAttempt&&this.currentAttempt.attemptDate}getMembershipByUser(e){return i.find(this.course.memberships,(t=>t.user.id===e.id))}getCourseRole(e){return this.getLocalizedRoleNameByCourseRole(this.getMembershipByUser(e).courseRole)}canSendMessage(e){const t=this.getMembershipByUser(e);return!(this.course.isPrivate()||this.course.isComplete())&&t.isAvailable&&t.user.isAvailable}gotoConversation(e){this.ultraState.goPeekState("conversations",{courseId:this.content.courseId,contentId:this.content.id,groupId:e||"default"})}startNextPeerReview(){this.startPeerReviewsButtonEnabled&&this.assignAndGoToNewPeerReview()}isInactive(e){const t=this.getMembershipByUser(e);return!t.isAvailable||!t.user.isAvailable}getLocalizedRoleNameByCourseRole(e){const t=e.identifier.toString();if(this.localizedCourseRoles[t])return this.localizedCourseRoles[t];if(t in C.w.toBeLocalizedRoleLabels){const e=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:C.w.toBeLocalizedRoleLabels[t]});return this.localizedCourseRoles[t]=e,e}return e.courseName.rawValue}registerHandlers(){this.$scope.$on("bb-assessment-attempt-save",((e,t,s,n=!1)=>{var i;this.refreshAttempt(t),this.refreshGrade(),(null===(i=this.peerReviewContentObject)||void 0===i?void 0:i.peerGrading)&&this.peerReviewContentObject.loadReviewableAttempts(),this.setAttemptCountsAndDate()}))}get panelTitle(){const e=this.content.getAssociatedGradingColumn().gradebookCategory,t=e&&!e.isUserDefined;return this.detailsView?"course.content.assessment.panelHeader.details."+(t?e.title:"custom"):"course.content.assessment.type."+(t?e.title:"custom")}getOriginalityReportStatus(){const e=new Array;if(this.contentData.gradeDetail){let t;return t=this.content.isGroupContent?this.contentData.gradingColumn.groupAssociations.$new(this.content.assignedGroups[0].groupAssociationId).groupAttempts.$fetch({excludeUnavailableMembers:!0}):this.contentData.gradingColumn.grades.$buildRaw(this.contentData.gradeDetail).attempts.$fetch({fields:"id,status"}),t.$then((t=>{const s=[];return i.forEach(t,(t=>{if(t.isSubmitted()){const n=t.originality.$fetch().$asPromise().then((t=>{t.hasAttachments()?e.push(t.overallOriginalityProcessed):e.push(void 0)}));s.push(n)}})),this.$q.all(s)})).$then((()=>{e.every((e=>o.isUndefined(e)))?this.originalityReportAvailable=null:this.originalityReportAvailable=e.every((e=>o.isUndefined(e)||!0===e))}))}}calculateKeysAndIconsBasedOnCategory(){const e=this.content.getAssociatedGradingColumn().gradebookCategory,t=this.course.isOrganization?"organization":"course";e&&!e.isUserDefined?(this.completedCourseKey=`${t}.content.assessment.overview.completedCourseNotice.${e.title}`,this.groupAssessmentKey="course.content.assessment.overview.group.groupAssessment."+e.title,this.classConversationFtueKey=`${t}.content.assessment.overview.classConversationFtue.${e.title}`,this.groupConversationFtueKey="course.content.assessment.overview.groupConversationFtue."+e.title):(this.customCategory=e&&e.title||this.content.isScorm()&&this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:"Scorm.name"}),this.completedCourseKey=`${t}.content.assessment.overview.completedCourseNotice.custom`,this.groupAssessmentKey="course.content.assessment.overview.group.groupAssessment.custom",this.classConversationFtueKey=`${t}.content.assessment.overview.classConversationFtue.custom`,this.groupConversationFtueKey="course.content.assessment.overview.groupConversationFtue.custom"),this.content.isGroupContent&&this.content.ui.hasConversationAttached&&this.content.attachedForumLink&&(e&&!e.isUserDefined?(this.classConversationFtueKey=`${t}.content.assessment.overview.classConversationFtue.${e.title}`,this.groupConversationFtueKey="course.content.assessment.overview.groupConversationFtue."+e.title):(this.classConversationFtueKey=`${t}.content.assessment.overview.classConversationFtue.custom`,this.groupConversationFtueKey="course.content.assessment.overview.groupConversationFtue.custom"))}refreshAttempt(e){this.currentAttempt=e,C.A.isGroupAttempt(e)&&(this.contentData.groupAttempt=e)}refreshGrade(){this.grade.loadGrade({courseId:this.course.id,userId:this.contextUser.userId,column:this.contentData.gradingColumn,gradeQueryParams:{expand:"attemptsLeft"}},!1).then((e=>{e.ui.attempt=this.currentAttempt,this.contentData.gradeDetail=e}))}get showScoreCard(){return!this.detailsView&&this.currentAttempt&&this.currentAttempt.isSubmitted()}get showDueDateWarnings(){return this.willDueDateOverrideTimeLimit&&this.showBeforeAttemptedFooter}get showRemainingTime(){return this.showDueDateWarnings&&this.remainingTimeInSecondsBeforeDueDateOverridesSoftTimeLimit>0}get remainingTimeInMinutesBeforeDueDateOverridesSoftTimeLimit(){return Math.ceil(this.remainingTimeInSecondsBeforeDueDateOverridesSoftTimeLimit/60)}initializeRemainingTimeTimer(){var e;if(!this.isDueDateEnforced||!this.timedTestAttemptDetail.hasTimeLimit||!this.showBeforeAttemptedFooter)return;if((null===(e=this.currentAttempt)||void 0===e?void 0:e.isInProgress())&&!this.willDueDateOverrideTimeLimit)return;let t=this.studentHasDueDateException?this.dueDateException.effectiveDueDate:this.dueDate;const s=()=>(t.getTime()-this.context.getServerTime().getTime())/1e3,n=()=>this.timedTestAttemptDetail.adaptedTime.softlimitSeconds;if(s()<0||n()<0)return;const i=()=>Math.max(0,s()-n());if(i()>28800)return;let o;const a=(e,t)=>{const s=((new Date).getTime()-e.getTime())/1e3;this.remainingTimeInSecondsBeforeDueDateOverridesSoftTimeLimit=t-s,this.remainingTimeInSecondsBeforeDueDateOverridesSoftTimeLimit<0&&this.bbInterval.cancel(o)},r=()=>{this.willDueDateOverrideTimeLimit?this.gradableItemUserOptionService.getGradableItemUserOption(this.contentData.courseContent.courseId,this.contentData.gradingColumn.id,[this.contextCourseMembership.courseMembership.id]).then((e=>{this.studentHasDueDateException=!!(null==e?void 0:e.byCourseMembershipId[this.contextCourseMembership.courseMembership.id]),this.studentHasDueDateException&&(this.dueDateException=e.byCourseMembershipId[this.contextCourseMembership.courseMembership.id]),t=this.studentHasDueDateException?this.dueDateException.effectiveDueDate:this.dueDate,this.remainingTimeInSecondsBeforeDueDateOverridesSoftTimeLimit=s(),o=this.bbInterval(a.bind(this,new Date,s()),this.$scope,1e4)})):this.bbTimeout(r,this.$scope,1e3*i())};this.bbTimeout(r,this.$scope,1e3*i())}get showAfterAttemptedFooter(){if(this.showBeforeAttemptedFooter)return!1;if(!this.hideOverview&&!this.detailsView){const e=this.allowMultipleAttempts&&0===this.unsubmittedAttemptsLeft,t=!this.allowMultipleAttempts&&this.showScoreCard,s=this.noNewAttemptsAreAllowed&&this.currentAttempt&&!this.currentAttempt.isInProgress();return e||t||this.startPeerReviewsButtonVisible||s}return!1}get showBeforeAttemptedFooter(){var e,t;return!this.hideOverview&&!this.detailsView&&(this.contentData.gradingColumn.isSingleAttempt()?(null===(e=this.currentAttempt)||void 0===e?void 0:e.isInProgress())||!this.currentAttempt&&!this.noNewAttemptsAreAllowed:(!this.contentData.gradeDetail||this.unsubmittedAttemptsLeft>0||this.isUnlimitedAttempts())&&((null===(t=this.currentAttempt)||void 0===t?void 0:t.isInProgress())||!this.noNewAttemptsAreAllowed))}get shouldShowProctoringErrorMessage(){return this.proctoring.isProctoringPlacementUnavailable(this.proctoringHandle,this.currentProctoringService)}get hasFooterExtension(){return this.isAssessmentPasswordProtected||this.shouldShowProctoringErrorMessage}get shouldShowNonTimedAttemptStartContinueButton(){return!this.hasTimeLimit&&void 0!==this.attemptCount&&!this.shouldShowProctoringErrorMessage}get shouldShowTimedAttemptStartButton(){return this.hasTimeLimit&&(!this.currentAttempt||!this.currentAttempt.isInProgress())&&!this.shouldShowProctoringErrorMessage}get shouldShowTimedAttemptContinueButton(){var e;return this.hasTimeLimit&&(null===(e=this.currentAttempt)||void 0===e?void 0:e.isInProgress())&&!this.shouldShowProctoringErrorMessage}get hasFooter(){return this.showBeforeAttemptedFooter||this.showAfterAttemptedFooter}showProctoringAdditionalNotes(){return this.contentData.gradingColumn.isSingleAttempt()?!this.currentAttempt||this.currentAttempt.isInProgress():!this.contentData.gradeDetail||this.unsubmittedAttemptsLeft>0||this.isUnlimitedAttempts()}get isCourseOpen(){return(!0===this.course.effectiveAvailability||!0===this.course.isAvailable)&&!1===this.course.isClosed}get allowMultipleAttempts(){return this.contentData.gradingColumn.isMultipleAttempts()}get currentAttemptNumber(){var e;return this.attemptCount>this.attemptCountSubmitted?this.attemptCountSubmitted+1:(null===(e=this.currentAttempt)||void 0===e?void 0:e.isInProgress())?this.attemptCount:this.attemptCount+1}getTimedTestAttemptDetail(){var e;return(null===(e=this.currentAttempt)||void 0===e?void 0:e.getTimedTestAttemptDetail())?this.isDueDateEnforced?this.currentAttempt.getTimedTestAttemptDetailWithDueDate(this.dueDate):this.currentAttempt.getTimedTestAttemptDetail():this.contentData.courseContent.getTimedTestDetail()}get hasTimeLimit(){var e;return null===(e=this.timedTestAttemptDetail)||void 0===e?void 0:e.hasTimeLimit}get displayedTimeLimitSeconds(){var e;return null===(e=this.timedTestAttemptDetail)||void 0===e?void 0:e.displayedTimeLimitSeconds}get canContinue(){var e;return null===(e=this.timedTestAttemptDetail)||void 0===e?void 0:e.hasExtraTime}createAttemptWithTimer(){if(!this.navigationPreCheck())return this.$q.resolve();return this.retrievePasswordCheckPromise().then((({result:e})=>{e?(this.willDueDateOverrideTimeLimit&&(this.startModalTranslateOptions.instructions.params.totalTimeLimit=this.remainingTimeInMinutesBeforeDueDateOverridesSoftTimeLimit),this.confirmTimerModal=this.modal.open({template:B,scope:this.$scope})):this.passwordErrorMessageKey=H})).catch((e=>{var t;(null===(t=null==e?void 0:e.error)||void 0===t?void 0:t.status)===k.HttpStatus.TooManyRequests?this.passwordErrorMessageKey=Q:this.errorModalService.handleApiError(e.error)})).finally((()=>{this.isPasswordCheckInProgress=!1}))}retrievePasswordCheckPromise(){var e,t;return this.isAssessmentPasswordProtected?(this.isPasswordCheckInProgress=!0,this.$q.when(Object(D.checkPassword)(this.course.id,null===(t=null===(e=this.content.getDeployedAssessment())||void 0===e?void 0:e.assessment)||void 0===t?void 0:t.id,(new a).update(this.givenPassword).digest("hex")))):this.$q.when(Promise.resolve({result:!0}))}closeModal(e){this.confirmTimerModal.close(),e&&this.navigateAttempt()}navigateAttempt(){if(!this.navigationPreCheck())return;if(I.a.isExternalSubmissionsAssessment(this.content)&&this.content.id)return void this.ultraState.goPeekState($.AssessmentRoutes.ASSESSMENT_EXTERNAL_OVERVIEW,{contentId:this.content.id});const e=this.content.isGroupContent;if(e&&this.content.assignedGroups&&0===this.content.assignedGroups.length)return void this.modal.open({scope:this.$scope,template:F});const t={type:k.AssessmentType.Test};if(this.isAssessmentPasswordProtected){const e=this.bbLocalize.parseNumberSync(this.givenPassword,this.$scope).toString().padStart(6,"0");this.isPasswordCheckInProgress=!0,t.password=(new a).update(e).digest("hex")}if(this.currentProctoringServiceType===L.a.IMS||this.content.isSecureBrowserRequiredToTake())return this.navigateProctoredAttempt(t.password),void(this.isPasswordCheckInProgress=!1);const s=this.$q.defer(),n={scoreProviderHandle:D.ScoreProviderHandle.Test,status:k.AttemptStatus.InProgress,toolAttemptDetail:{"resource/x-bb-assessment":{...t}}},i=e?this.GroupAttemptModel.$build(n):this.AttemptModel.$build(n);this.contentData.attempt=i,e&&(this.contentData.groupAttempt=i),this.contentData.gradingColumn.launchAttempt(i,{},e,e?this.content.assignedGroups[0].groupId:null).then((t=>{var n,i,o,a;if((null===(n=t.$response)||void 0===n?void 0:n.status)===k.HttpStatus.Forbidden&&t.$response.data){const e=t.$response;switch(null===(i=e.data)||void 0===i?void 0:i.code){case"bb-rest-max-group-attempt-reached":this.courseContent.loadContentAndGrades({course:this.course,content:this.contentData.courseContent}).then((e=>{this.currentAttempt=e.groupAttempt,s.resolve(this.currentAttempt.id)}));break;case"bb-rest-max-group-attempt-reached-and-all-group-attempts-submitted":this.showGroupAlreadySubmittedDialog();break;case k.AttemptApiErrors.AttemptCompletedOrForceCompletion:this.showAlreadySubmittedDialog();break;case k.AttemptApiErrors.AttemptPastDue:this.showAttemptCreationDisallowedDialog();break;default:this.errorModalService.handleApiError(e)}}else if((null===(o=t.$response)||void 0===o?void 0:o.status)===k.HttpStatus.Unauthorized&&t.$response.data){const e=t.$response;e.data.code===U?this.passwordErrorMessageKey=H:this.errorModalService.handleApiError(e)}else(null===(a=t.$response)||void 0===a?void 0:a.status)===k.HttpStatus.TooManyRequests?this.passwordErrorMessageKey=Q:(s.resolve(t.id),this.$scope.$root.$broadcast("bb-assessment-attempt-save",t,this.contentData.gradingColumn.id,e));this.isPasswordCheckInProgress=!1})),s.promise.then((e=>{this.ultraState.goPeekState($.AssessmentRoutes.ASSESSMENT_ATTEMPT,{attemptId:e})}))}navigateProctoredAttempt(e){const t={password:e,attemptId:null};this.content.getProctoringLaunchLink(t).then((e=>{this.currentProctoringServiceType===L.a.IMS?this.ltiService.launch(e):this.content.isSecureBrowserRequiredToTake()&&(this.openSecureLaunchLink(e),this.ultraState.goPeekState($.AssessmentRoutes.ASSESSMENT_ATTEMPT_RESPONDUS_REQUIREMENT,{courseId:this.content.courseId,contentId:this.content.id}))})).catch((e=>{var t,s;(null===(t=e.data)||void 0===t?void 0:t.status)===k.HttpStatus.Unauthorized?this.passwordErrorMessageKey=H:(null===(s=e.data)||void 0===s?void 0:s.status)===k.HttpStatus.TooManyRequests?this.passwordErrorMessageKey=Q:this.errorModalService.handleApiError(e)}))}openSecureLaunchLink(e){this.proctoring.openRespondusProctoringLaunchLink(e)}navigateAttemptReview(){this.courseContent.loadContentAndGrades({course:this.course,content:this.contentData.courseContent}).then((e=>{this.currentAttempt=e.groupAttempt,this.openAttemptReview()}))}navigationPreCheck(){return!this.isPasswordCheckInProgress&&(this.passwordErrorMessageKey="",!this.isAssessmentPasswordProtected||!this.isGivenPasswordBlank||(this.passwordErrorMessageKey=V,!1))}showGroupAlreadySubmittedDialog(){return this.modal.open({scope:this.$scope,template:F})}showAlreadySubmittedDialog(){const e=this.$scope.$new();return e.customClose=()=>{this.navigateAttemptReview()},this.modal.open({scope:e,template:M})}showAttemptCreationDisallowedDialog(){return this.modal.open({scope:this.$scope,template:N})}get viewAttemptButtonLabelKey(){let e="course.content.assessment.overview.viewSubmittedAttemptButton";return e+=this.allowMultipleAttempts?".multiple":".single",e}get attemptButtonLabelKey(){let e="course.content.assessment.overview.openAttemptButton.";e+=this.hasTimeLimit?"timed.":"notTimed.",e+=this.attemptIsInProgress?"continue":"start";return e+=this.allowMultipleAttempts&&(this.hasTimeLimit||this.isAssessmentSubmissionComplete)?".multiple":"",e}get safeAssignEnabled(){return this.content.isSafeAssignEnabled()}get attemptIsInProgress(){var e;return(null===(e=this.currentAttempt)||void 0===e?void 0:e.isInProgress())||this.attemptCount>this.attemptCountSubmitted}showGoals(){this.hideOverview=!0,this.showGoalDetails=!0}hideGoals(){this.hideOverview=!1,this.showGoalDetails=!1}showRubricPanel(){this.showRubricDetails=!0,this.hideOverview=!0,this.notifyMobileApp(q.MessageType.AssessmentStudentRubricOpened)}hideRubricPanel(){this.showRubricDetails=!1,this.hideOverview=!1,this.notifyMobileApp(q.MessageType.AssessmentStudentRubricClosed)}openAttemptReview(e=!1){this.currentAttempt&&(this.contentData.gradingColumn.isMultipleAttempts()?this.ultraState.goPeekState($.AssessmentRoutes.ASSESSMENT_MULTIPLE_ATTEMPTS_TAB,{columnId:this.contentData.gradingColumn.id,gradeId:this.contentData.gradeDetail.id,viewOriginalityReport:e,forceOpenFeedbackPanel:!e&&this.hasFeedback()}):this.ultraState.goPeekState($.AssessmentRoutes.ASSESSMENT_ATTEMPT_REVIEW,{attemptId:this.currentAttempt.id,columnId:this.contentData.gradingColumn.id,viewOriginalityReport:e,forceOpenFeedbackPanel:!e&&this.hasFeedback()}))}openAttemptFeedback(e=!1){this.currentAttempt&&(this.contentData.gradingColumn.isMultipleAttempts()?this.ultraState.goPeekState($.AssessmentRoutes.ASSESSMENT_MULTIPLE_ATTEMPTS_TAB,{columnId:this.contentData.gradingColumn.id,gradeId:this.contentData.gradeDetail.id,viewOriginalityReport:e,forceOpenFeedbackPanel:!e&&this.hasFeedback()}):this.ultraState.goPeekState($.AssessmentRoutes.ASSESSMENT_ATTEMPT_REVIEW_FEEDBACK_TAB,{attemptId:this.currentAttempt.id,columnId:this.contentData.gradingColumn.id,viewOriginalityReport:e,forceOpenFeedbackPanel:!e&&this.hasFeedback()}))}openSafeAssign(){this.ultraState.goPeekState("attempt-safe-assign-setting",{submitToGRD:this.submitToGRD})}loadCollabConfig(){this.collabUltra.getCollabB2Info().then((e=>{200===e.$response.status?this.showCollabLink=!0:this.showCollabLink=!1}),(e=>{this.showCollabLink=!1})),!this.forumId&&this.content.attachedForumLink&&this.content.attachedForumLink["resource/x-bb-courselink"]&&this.course.contents.$find(this.content.attachedForumLink["resource/x-bb-courselink"].courseContent).$then((e=>{this.forumId=e.contentDetail["resource/x-bb-forumlink"].id}))}get shouldShowCollabLink(){return this.showCollabLink&&o.isDefined(this.forumId)&&this.collabUltraEnabled}launchCollabSession(){const e=window.open();this.collabUltra.launchDiscussionSession(this.content.courseId,this.forumId,this.content.assignedGroups[0].groupId).then((t=>{e.location.href=t.url}),(t=>{e.close(),t.$response.status=null}))}isSubmittedLate(){let e=this.latestAttemptDate;this.aggregationModelRelevantAttemptDate&&(e=this.contentData.gradeDetail&&!this.contentData.gradeDetail.isPosted()?this.latestAttemptDate:this.aggregationModelRelevantAttemptDate);const t=this.studentHasDueDateException?this.dueDateException.fixedDueDate:this.dueDate;return t&&e&&t.getTime()-e.getTime()<0&&!this.contentData.courseContent.hasDueDateException()}hasPastDueZero(){return this.contentData.gradeDetail&&this.contentData.gradeDetail.isPastDueZero()}showPastDueForDueDate(){return this.isSubmissionLate}hasFeedback(){return I.a.attemptHasFeedback(this.currentAttempt)||this.hasGroupIndividualFeedback()}hasGroupIndividualFeedback(){return!(!this.content.isGroupContent||!I.a.groupAttemptHasIndividualFeedback(this.currentAttempt))}get aggregationModelDescriptionKey(){const e=this.contentData.gradingColumn,t=Object(j.parseAttemptAggregationModel)(null==e?void 0:e.aggregationModel);return t?Object(j.getAttemptAggregationModelStudentLabelKey)(t):null}updateIndicators(){this.content&&this.contentService.fetchIndicators(this.content.courseId).then((()=>{const e=this.contentService.getCourseContentCache(this.content.courseId,this.content.id);e&&(this.hasClassIndicator=e.classConversationHasIndicator,this.hasGroupIndicator=!!e.groupIds)}))}getProctoringBrowserText(){return this.proctoring.getProctoringOverviewBrowserText(this.content)}getProctoringRequirementsText(){return this.proctoring.getProctoringOverviewRequirementsText(this.content)}getProctoringBrowserDownloadText(){return this.proctoring.getProctoringOverviewDownloadText(this.content)}get isPeerGrading(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.peerGrading}get numOfPeerReviewsToComplete(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.numOfPeerReviewsToComplete}get numOfPeerReviewsLeft(){return this.numOfPeerReviewsToComplete-this.completedPeerReviews}showPeerReviewHasBeenDeletedBanner(){return this.hasDeletedPeerReviews()&&!this.dismissPeerDeletedBanner}hasDeletedPeerReviews(){var e;return!!this.isPeerGrading&&(null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.hasDeletedAttempts)}numberOfLatePeerReviews(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.numberOfLatePeerReviews}hasEnoughSubmissionsForPeerAssessment(){var e,t;return null!==(t=null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.hasEnoughSubmissionsForPeerAssessment)&&void 0!==t&&t}canRetrieveNewPeerReview(){var e;return this.isAssessmentSubmissionComplete&&this.hasEnoughSubmissionsForPeerAssessment()&&(null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.isAfterPeerSubmissionDueDate())}get completedPeerReviews(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.completedPeerReviews}get peerReviewDueDate(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.peerReviewDueDate}get isAssessmentSubmissionComplete(){return!!(this.attemptCount&&this.attemptCount>0&&this.attemptCountSubmitted&&this.attemptCountSubmitted>0)}get shouldHaveLateAttemptClass(){return this.isOverdue&&this.showBeforeAttemptedFooter}get isSubmissionLate(){return!this.isAssessmentSubmissionComplete&&this.isOverdue||this.isSubmittedLate()}get allowLatePeerReviews(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.allowLatePeerReviews}get isPeerGradingConfigured(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.isPeerGradingConfigured}get hasDueDateAccommodation(){return this.contextCourseMembership.isDueDateExcepted()}arePeerReviewsComplete(){return this.completedPeerReviews===this.numOfPeerReviewsToComplete}isPeerReviewsLate(){const e=this.context.getServerTime().getTime()>this.peerReviewDueDate.getTime();return!(!this.isPeerGrading||!e||this.hasDueDateAccommodation)&&(!this.arePeerReviewsComplete()||!(0===this.numberOfLatePeerReviews()))}get isGivenPasswordBlank(){return 0===this.givenPassword.length}onPasswordChange(){this.passwordErrorMessageKey=""}get deployedAssessment(){return this.content.getDeployedAssessment()}initAssessmentResultOptions(){this.initAssessmentResultOptionsVisibility();const e=this.getFeedbackOptionsToDisplay(),t=e.filter((e=>!1===this.assessmentResultOptionsVisibilityMap[e]||e===k.AssessmentFeedbackOption.UserAnswers));this.assessmentService.getFeedbackModeLabels(t,this.deployedAssessment.deploymentSettings.feedbackSettings).then((s=>{this.assessmentResultOptions=e.map((e=>{const n=this.bbLocalize.getLocale(this.$scope),i=this.bbLocalize.translateSync({key:`${I.f}.${e}`,locale:n}),o=!0===this.assessmentResultOptionsVisibilityMap[e];let a,r=I.e[e].visible;if(o)if(this.isUserAnswersVisible())a=this.isOptionAvailableForGradedAttempts(e)?this.bbLocalize.translateSync({key:"course.content.assessment.overview.assessmentResults.availableForGradedAttempts",locale:n}):this.bbLocalize.translateSync({key:"course.content.assessment.overview.assessmentResults.availableNow",locale:n});else{const e=t.indexOf(k.AssessmentFeedbackOption.UserAnswers);a=s[e]}else{r=I.e[e].invisible;const i=t.indexOf(e);a=s[i],null===a&&(a=this.bbLocalize.translateSync({key:I.c,locale:n}))}return{icon:r,modeLabel:a,option:e,optionLabel:i,visible:o}}))}))}getFeedbackOptionsToDisplay(){var e,t;const s=null===(t=null===(e=this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings)||void 0===t?void 0:t.feedbackSettings;return I.d.filter((e=>{if(e===k.AssessmentFeedbackOption.UserAnswers)return!0;const t=I.a.isFeedbackOptionEnabled(e,s),n=e===k.AssessmentFeedbackOption.InstructorFeedback&&this.deployedAssessment.assessment.hasAutomatedQuestionFeedback;return t&&(e!==k.AssessmentFeedbackOption.InstructorFeedback||n)}))}initAssessmentResultOptionsVisibility(){var e;const t=this.contentData.gradingColumn.scoreProviderHandle,s=this.currentAttempt.getToolAttemptDetailItem(t),n=null==s?void 0:s.questionAttempts[0];this.assessmentResultOptionsVisibilityMap={[k.AssessmentFeedbackOption.UserAnswers]:this.getOptionVisibility(null==n?void 0:n.isResultVisible,k.AssessmentFeedbackOption.UserAnswers),[k.AssessmentFeedbackOption.InstructorFeedback]:null!==(e=null==n?void 0:n.isFeedbackVisible)&&void 0!==e&&e,[k.AssessmentFeedbackOption.Score]:this.getOptionVisibility(null==n?void 0:n.isScoreVisible,k.AssessmentFeedbackOption.Score),[k.AssessmentFeedbackOption.CorrectAnswers]:this.getOptionVisibility(null==n?void 0:n.isCorrectAnswersVisible,k.AssessmentFeedbackOption.CorrectAnswers)}}getOptionVisibility(e,t){return e?t!==k.AssessmentFeedbackOption.Score&&t!==k.AssessmentFeedbackOption.CorrectAnswers||this.isAtLeastOneAttemptCompleted:this.assessmentService.isAfterIndividualGradeIsPostedFeedbackMode(t,this.deployedAssessment.deploymentSettings.feedbackSettings)&&this.isAtLeastOneAttemptCompleted}shouldDisplayAssessmentResultsWarning(e){return this.assessmentService.isUserAnswersOption(e.option)&&this.isUserAnswersEnabled()&&this.getFeedbackOptionsToDisplay().length>1}isUserAnswersEnabled(){return I.a.isFeedbackOptionEnabled(k.AssessmentFeedbackOption.UserAnswers,this.deployedAssessment.deploymentSettings.feedbackSettings)}isUserAnswersVisible(){return!0===this.assessmentResultOptionsVisibilityMap[k.AssessmentFeedbackOption.UserAnswers]}isOptionAvailable(e){return e&&this.isUserAnswersVisible()}isOptionAvailableForGradedAttempts(e){return!(!this.allowMultipleAttempts||e===k.AssessmentFeedbackOption.InstructorFeedback||this.areAllAttemptsCompleted)&&(e===k.AssessmentFeedbackOption.UserAnswers?this.assessmentService.isAfterIndividualGradeIsPostedFeedbackMode(e,this.deployedAssessment.deploymentSettings.feedbackSettings):!this.assessmentService.isAfterAllGradesArePostedFeedbackMode(e,this.deployedAssessment.deploymentSettings.feedbackSettings))}get showAssessmentResults(){var e,t,s;const n=null===(t=null===(e=this.deployedAssessment)||void 0===e?void 0:e.assessment)||void 0===t?void 0:t.hasAnswerableQuestions;return(null===(s=this.currentAttempt)||void 0===s?void 0:s.isSubmitted())&&n}onAttemptCountComplete(){this.showAssessmentResults&&this.initAssessmentResultOptions()}};J=Object(n.__decorate)([Object(n.__param)(0,Object(T.b)("contentData")),Object(n.__param)(1,Object(T.b)("currentCourse")),Object(n.__param)(2,Object(T.b)("$injector")),Object(n.__param)(3,Object(T.b)("$ngRedux")),Object(n.__param)(4,Object(T.b)("$scope")),Object(n.__param)(5,Object(T.b)("$q")),Object(n.__param)(6,Object(T.b)("$window")),Object(n.__param)(7,Object(T.b)(l.f)),Object(n.__param)(8,Object(T.b)(d.b)),Object(n.__param)(9,Object(T.b)(g.k)),Object(n.__param)(10,Object(T.b)(A.d)),Object(n.__param)(11,Object(T.b)(c.d)),Object(n.__param)(12,Object(T.b)(C.A.serviceName)),Object(n.__param)(13,Object(T.b)(C.E.serviceName)),Object(n.__param)(14,Object(T.b)(h.d)),Object(n.__param)(15,Object(T.b)(y.b)),Object(n.__param)(16,Object(T.b)(v.b)),Object(n.__param)(17,Object(T.b)(u.b)),Object(n.__param)(18,Object(T.b)(b.b)),Object(n.__param)(19,Object(T.b)(w.serviceName)),Object(n.__param)(20,Object(T.b)(O.b)),Object(n.__param)(21,Object(T.b)(S.g)),Object(n.__param)(22,Object(T.b)(r.b)),Object(n.__param)(23,Object(T.b)(m.b)),Object(n.__param)(24,Object(T.b)(p.d)),Object(n.__param)(25,Object(T.b)(I.h)),Object(n.__param)(26,Object(T.b)(P.b)),Object(n.__param)(27,Object(T.b)(R.b)),Object(n.__param)(28,Object(T.b)(E.b)),Object(n.__param)(29,Object(T.b)(x.b)),Object(n.__param)(30,Object(T.b)(f.b))],J);class Y extends J{}},Y0jG:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="course.content.assessment.test.settings.assessmentGrade.autoPostGrades.changeWarningModal.title"\n          modal-aria-type="alertdialog"\n          analytics-id-tag-prefix="course.content.assessment.settings.autoPostGrades.changeWarningModal">\n  <div name="modal-contents">\n    <p course-org-token-resolver bb-translate>course.content.assessment.test.settings.assessmentGrade.autoPostGrades.changeWarningModal.content</p>\n  </div>\n  <button\n    name="modal-footer-button-primary"\n    class="button confirm-ok js-primary-button"\n    ng-click="autoPostGradesChangeModal.confirmAction()"\n    analytics-id="confirmAction.button"\n    bb-translate>\n    course.content.assessment.test.settings.assessmentGrade.autoPostGrades.changeWarningModal.confirmButtonText\n  </button>\n  <button\n    name="modal-footer-button-secondary"\n    class="button button--secondary confirm-cancel js-secondary-button"\n    ng-click="autoPostGradesChangeModal.cancelAction()"\n    analytics-id="cancelAction.button"\n    bb-translate>\n    course.content.assessment.test.settings.assessmentGrade.autoPostGrades.changeWarningModal.cancelButtonText\n  </button>\n</bb-modal>\n'},YHe3:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return S})),s.d(t,"b",(function(){return C}));var n=s("D57K"),i=s("Llzl"),o=s("pjml"),a=s("TnpK"),r=s("Q/M7"),c=s("12mu"),l=s("0JpG"),d=s("nYZ0"),u=s("Qbdf"),p=s("vhkR"),m=s("zJP2"),h=s("IbyE"),b=s("zGdY"),g=s("CY5M"),v=s("nmzr"),f=s("DU7P"),w=s("aHpC");s("TuNX");const S="ultra.components.services.proctoring",C="proctoring",y={Respondus:"respondus"},O="components.services.proctoring.overview.",A="components.services.proctoring.delivery.",I="components.services.proctoring.settings.",D="components.services.proctoring.page.";let k=class{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p){this.$q=e,this.$rootScope=t,this.$sce=s,this.$window=n,this.CourseModel=i,this.CourseContentModel=o,this.ProctoringServicesModel=a,this.modal=r,this.contentService=c,this.contextCourse=l,this.localize=d,this.ultraState=u,this.ltiService=p}getBooksAndToolsDescription(e){return"components.services.proctoring.booksAndTools."+y[e.vendor]+".description"}getProctoringServices(){const e=this.$q.defer();return this.ProctoringServicesModel.$search({"availability.available":"Yes"}).$allow(["400-599"]).$asPromise().then((t=>{t.$response&&t.$response.status>=400?e.resolve([]):e.resolve(t)}),(()=>e.resolve([]))),e.promise}getProctoringAssessmentSettingsText(e){return I+y[e]+".toolLink"}getProctoringAssessmentSettingsRequirementsText(e){const t=I;return e.getProctoringServiceHandle()&&e.isSecureBrowserRequiredToTake()?e.isWebcamRequired()?t+y[e.getProctoringServiceVendor()]+".secureBrowserAndWebcamRequired":t+y[e.getProctoringServiceVendor()]+".secureBrowserRequired":null}getProctoringOverviewBrowserText(e){return e.isSecureBrowserRequiredToTake()?"components.services.proctoring.overview."+y[e.getProctoringServiceVendor()]+".browser":null}getProctoringOverviewRequirementsText(e){const t=O;return e.isSecureBrowserRequiredToTake()?e.isWebcamRequired()?t+y[e.getProctoringServiceVendor()]+".secureBrowserAndWebcamRequired":t+y[e.getProctoringServiceVendor()]+".secureBrowserRequired":null}getProctoringOverviewDownloadText(e){return e.getProctoringDownloadUrl()?"components.services.proctoring.overview."+y[e.getProctoringServiceVendor()]+".downloadBrowser":null}openProctoringLTITool(e,t){let s="/webapps/assessment/controller/proctoring/launchProctoringSettings?proctoring_svc_id="+e.id+"&course_id="+this.contextCourse.courseId;t&&(s+="&content_id="+t.id);const n={toolHref:r.c(s)};t&&t.title&&t.title.length>0&&(n.toolSubtitle=t.title),this.ultraState.goPeekState("proctoring-lti-tool",n)}getProctoringReviewButtonText(e){return A+"review."+y[e]+".reviewResults"}getProctoringReviewDownloadText(e){return A+"review."+y[e]+".download"}getProctoringPageRequirementsText(e){return D+y[e]+".requirements"}getProctoringPageDownloadText(e){return D+y[e]+".download"}getProctoringPageBrowserText(e){return D+y[e]+".browser"}getSecureBbEditorOptions(e){return this.ultraState.current.name===v.BaseRoutes.BASE_PROCTORING_ATTEMPT&&(e.attachment=!1,e.image=!1,e.youtubeVideo=!1,e.video=!1,e.contentMarket=!1),e}handleProctoredAssessmentClose(e,t){if("Respondus"===e.getProctoringServiceVendor())r.p(r.c("/ultra/proctoring/close?rldbsm=1&rldbxb=1"));else if(t){const t={handle:e.getProctoringServiceHandle(),linkType:h.ContentHandler.LtiPlacement};let s=Object(g.getLaunchLinkFromLinkRef)(t);s=r.a(s,"custom_proctoring_end_assessment_return","true"),s=r.a(s,"course_id",e.courseId),s=r.a(s,"content_id",e.id),s=r.a(s,"from_ultra","true"),this.ultraState.leavePeekState().then((()=>{this.ltiService.launch(s)}))}else this.ultraState.goPeekState(v.AssessmentRoutes.ASSESSMENT_OVERVIEW,{contentId:e.id})}getProctoringServiceByHandle(e){return this.$q.resolve(m.a.loadProctoringService(e))}fetchProctoringServices(){return this.$q.resolve(m.a.loadAvailableProctoringServices())}fetchProctoringServiceIntegrations(){return this.$q.resolve(m.a.loadAvailableProctoringServicesWithIntegration())}getCurrentProctoringProviderType(e){return e?e===f.b?f.a.Respondus:f.a.IMS:f.a.None}isRespondusProctoringServiceProvider(e){return this.getCurrentProctoringProviderType(e.handle)===f.a.Respondus}isIMSProctoringServiceProvider(e){return this.getCurrentProctoringProviderType(e.handle)===f.a.IMS}isProctoringServiceUnavailable(e,t){return this.isProctoringPlacementUnavailable(e,t)||this.isProctoringUEFUnavailable(e,t)}isProctoringPlacementUnavailable(e,t){return!!e&&(null==t||t.availability.available===b.PublicAvailability.No)}isProctoringUEFUnavailable(e,t){if(!!e){return!this.isRespondusProctoringServiceProvider(t)&&!this.getProctoringServiceIntegrationId(t)}return!1}getProctoringServiceIntegrationId(e){var t;if(e)return null===(t=m.a.getProctoringIntegration(e.handle))||void 0===t?void 0:t.integrationId}promptIntegrationToSave(e,t,s,n){return this.$q.resolve(m.a.promptIntegrationToSaveSettings(e,t,s,n))}openRespondusProctoringLaunchLink(t){const s="data:text/plain,";if(e("#respondus-iframe").remove(),t.startsWith(s)){const e=`<iframe src="data://text/plain,${t.substring(s.length)}" id="respondus-iframe" style="display:none"></iframe>`;this.createRespondusIFrameAndSetLocation(e)}else this.setRespondusWindowLocation(t)}createRespondusIFrameAndSetLocation(t){document.body.appendChild(e(t)[0])}setRespondusWindowLocation(e){this.$window.location.assign(e)}};k=Object(n.__decorate)([Object(n.__param)(0,Object(w.b)("$q")),Object(n.__param)(1,Object(w.b)("$rootScope")),Object(n.__param)(2,Object(w.b)("$sce")),Object(n.__param)(3,Object(w.b)("$window")),Object(n.__param)(4,Object(w.b)(o.m.serviceName)),Object(n.__param)(5,Object(w.b)(o.p.serviceName)),Object(n.__param)(6,Object(w.b)(o.kb.serviceName)),Object(n.__param)(7,Object(w.b)(c.b)),Object(n.__param)(8,Object(w.b)(d.f)),Object(n.__param)(9,Object(w.b)(u.e)),Object(n.__param)(10,Object(w.b)(l.serviceName)),Object(n.__param)(11,Object(w.b)(a.d)),Object(n.__param)(12,Object(w.b)(p.b))],k);i.module(S,["ngSanitize",d.d,l.moduleName,c.a,a.b,u.b,p.a]).service(C,k)}).call(this,s("71td"))},Ybms:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-duplicate",use:"icon-small-duplicate-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-duplicate"><path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M1 4h11v11H1z" /><path d="M12 12h3V1H4v3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},Youf:function(e,t){e.exports='<a class="content-title"\n   aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n   ng-click="contentItemLtiLaunch.ltiLaunch()"\n   href="javascript:void(0);"\n   analytics-id="content.item.ltilaunch.link"><span>{{ content.title }}</span></a>\n<div ng-if="contentItemBase.isExcludedOrDeletedLtiToolProvider() && !contentItemBase.ltiLinkNeedsApproval() && contentItemBase.scope.content.canViewAsInstructor()">\n      <span class="broken-lti-link" ng-if="!contentItemBase.hasLTIToolConfigurationEntitlement()"\n      bb-translate>components.directives.content-item-base.excluded-lti-provider.instructor</span>\n      <span class="broken-lti-link" ng-if="contentItemBase.hasLTIToolConfigurationEntitlement()"\n      bb-translate>components.directives.content-item-base.excluded-lti-provider.admin</span>\n</div>\n<div ng-if="contentItemBase.isUnlaunchableLtiLink() && !contentItemBase.isExcludedOrDeletedLtiToolProvider() && !contentItemBase.ltiLinkNeedsApproval() && contentItemBase.scope.content.canViewAsInstructor()">\n      <span class="broken-lti-link" ng-if="!contentItemBase.hasLTIToolConfigurationEntitlement()"\n      bb-translate>components.directives.content-item-base.deleted-placement.instructor</span>\n      <span class="broken-lti-link" ng-if="contentItemBase.hasLTIToolConfigurationEntitlement()"\n      bb-translate>components.directives.content-item-base.deleted-placement.admin</span>\n</div>\n<span class="broken-lti-link" ng-if="contentItemBase.isUnlaunchableLtiLink() && contentItemBase.ltiLinkNeedsApproval() && contentItemBase.scope.content.canViewAsInstructor()"\n      bb-translate>components.directives.content-item-base.approval-required</span>\n'},Zy5h:function(e,t){e.exports='<div ng-if="$ctrl.showBanner" class="group-student-enrollment-asmt-banner">\n  <bb-ui-icon-large-attention color="primary" class-name="attention-icon"></bb-ui-icon-large-attention>\n  <div class="banner-text">\n    <span bb-translate>components.directives.content.assessment.group-student-enrollment-asmt-banner.available-to-groups</span>\n    <a ng-if="$ctrl.isOpenEnrollment()" href="javascript:void(0);" ng-click="$ctrl.openContentEnrollPanel()" analytics-id="components.directives.content.assessment.open.content.enroll.panel.link">\n      <span bb-translate>components.directives.content.assessment.group-student-enrollment-asmt-banner.enroll-to-participate</span>\n    </a>\n  </div>\n</div>\n'},a2qY:function(e,t){e.exports='<div bb-load-bundle="components/directives/content-item-base" ng-class="::contentItemBase.getRootClassName()" bb-cache-compilation="content-item-base">\n  <div class="content-item-base-container guidance-overflow-fix js-content-item-base" bb-click-to-invoke-child=".content-title">\n    <div ng-switch on="content.ui.importPlaceholder" class="content-item-row-container">\n      <div ng-switch-when="true" class="placeholder-container" bb-focus>\n        <div class="placeholder-text" bb-translate>components.directives.content-item-base.copy-placeholder</div>\n        <div class="sr-only" bb-translate>components.directives.content-item-base.please-wait</div>\n      </div>\n      <bb-review-state-icon\n        ng-if="contentItemBase.shouldShowReviewStateIcon()"\n        content-id="content.id"\n        course-id="contentItemBase.courseId"\n        on-review-state-icon-click="contentItemBase.onReviewStateIconClick"\n        has-automatic-review-state-transition="!content.canUpdateReviewState()"\n        before-item-state="contentItemBase.getNeighborReviewState(itemBefore)"\n        after-item-state="contentItemBase.getNeighborReviewState(itemAfter)"\n      ></bb-review-state-icon>\n\n      <div ng-switch-default class="row drag-element-row" ng-class="{\n        \'is-restricted\': content.canViewAsInstructor() ? !content.isAvailable : false,\n        \'hidden-from-student-cr\': content.canViewAsInstructor() && content.isConditionalReleaseWithHiddenFromStudent(),\n        \'isNotClickable\': content.isConditionalReleaseLocked() || content.isRestricted() && !content.canViewAsInstructor()}">\n        <div class="content-item-row">\n          <div class="content-item-details" ng-class="{\'is-uploading\':content.ui.isUploading}">\n            <div class="element-card outline-item">\n              <ng-switch on="content.ui.isUploading">\n                <div ng-switch-when="true" class="upload-file">\n                  <bb-progress displayResults="false" id="{{content.ui.fileUploadId}}" class="bb-progress"></bb-progress>\n                </div>\n\n                <div class="outline-item-inner" ng-switch-default>\n                  <div class="element-image" ng-if="contentItemBase.isGradeLoaded" bb-content-item-icon="content" show-alert-icon="contentItemBase.shouldShowAlertIcon()">\n                  </div>\n                  <div class="element-details">\n                    <div ng-if="shouldShowContent">\n                      <bb-content-item-course-outline ng-if="!contentItemBase.isEngagementOutline()"></bb-content-item-course-outline>\n                      <bb-content-item-engagement-outline ng-if="contentItemBase.isEngagementOutline()"></bb-content-item-engagement-outline>\n                    </div>\n                    <div ng-if="!contentItemBase.shouldShowContent">\n                      {{contentItemBase.overrideMessage}}\n                    </div>\n                  </div>\n                </div>\n              </ng-switch>\n            </div>\n          </div>\n          <div ng-if="content.id" class="item-controls">\n            \x3c!-- Show this if the user has edit permissions on the content and it is movable //--\x3e\n            <button bb-drag-handle\n                    drag-item-id="{{content.id}}"\n                    drag-item-name="{{content.title}}"\n                    drag-item-type="{{contentItemBase.contentHandler}}"\n                    drag-item-context="{{contextArea}}"\n                    class="super-clear small button icon js-drag-handle"\n                    ng-if="canMove && content.canEdit()"\n                    translate-attrs-values="{contentTitle: content.title}"\n                    bb-translate-attrs="{\'title\': \'components.directives.content-item-base.move\', \'aria-label\': \'components.directives.content-item-base.aria-label.move\'}"\n                    analytics-id="content.item.base.move.button"\n                    >\n\n              <bb-svg-icon size="small" icon="move-item-up-down"></bb-svg-icon>\n            </button>\n            <bb-ally-content-ref\n                ng-if="contentItemBase.canShowAlly"\n                content-id="{{content.id}}"\n                file-id="{{::contentItemBase.allyService.getXythosIdFromContentItem(content)}}"\n                file-preview-url="{{::content.getContentDisplay().contentUrl()}}"\n            ></bb-ally-content-ref>\n            <bb-ally-show\n              ng-if="contentItemBase.canShowAlly && contentItemBase.isAllyInstructor"\n              content-id="{{content.id}}"\n              show-view-score-link="true"\n              show-icon="true"\n              class="ally-icon"\n            ></bb-ally-show>\n            <bb-ally-show\n              ng-if="contentItemBase.canShowAllyAlternativeFormats(content)"\n              content-id="{{content.id}}"\n              show-alternative-formats-link="true"\n              show-icon="true"\n              class="ally-icon"\n            ></bb-ally-show>\n            \x3c!-- Show this if the user has edit or delete permissions //--\x3e\n            <div class="right" bb-foundation-defer>\n              <bb-overflow-menu ng-show="contentItemBase.showOverflowMenu()"\n                                element-id="{{content.id}}"\n                                element-name="{{content.title}}"\n                                menu-items="contentItemBase.getOverflowMenu()"\n                                on-menu-toggle="contentItemBase.updateAlly()"\n                                ng-attr-data-ally-content-ref="{{content.id}}"\n                                ng-attr-data-ally-show="{{ contentItemBase.overflowMenuIsAllyConditional() ? \'instructorfeedback\' : undefined }}"\n                                analytics-id-tag-prefix="components.directives.content-item-base.overflowMenu">\n              </bb-overflow-menu>\n            </div>\n          </div>\n        </div>\n\n        <div ng-if="contentItemBase.getDescription()" class="content-item-description">\n          <bb-course-content-item-description\n            description="contentItemBase.getDescription()"\n          ></bb-course-content-item-description>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},aCck:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("Llzl"),i=s("pjml"),o=s("eYRL"),a=s("IbyE");const r="ultra.directives.webLinkItem";class c{constructor(e){this.CourseModel=e,this.replace=!0,this.restrict="E",this.scope={content:"=",targetContent:"=?",prefix:"=",aria:"=?",tabbable:"=?"},this.template=o,this.link=(e,t)=>{const s=e.$watch("targetContent.contentHandler",(t=>{null!=t&&(e.$emit("click-to-invoke-child-directive-init"),s())}));!e.targetContent&&e.content&&e.content.contentDetail&&(e.targetContent=e.content.getLinkContentSource(),e.targetContent.$then((()=>{e.content.description=e.targetContent.description}))),e.ariaDescribedBy="content-item-icon-"+e.content.id,e.content.ui.hasIndicator&&(e.ariaDescribedBy+=" activity-indicator-"+e.content.id),a.ContentHelper.isNotAccessibleButVisibleForcedSequenceItem(e.content)?(e.aria=!0,e.tabbable=!0):(e.aria=!1,e.tabbable=!1)}}}c.$inject=[i.m.serviceName],n.module(r,[]).directive("bbWebLinkItem",["$injector",e=>e.instantiate(c)])},aPUy:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return o}));const n="peer-review-assigned";function i(e,t){return e.$broadcast(n,t.listIndex,t.reviewableAttempt)}function o(e,t){return e.$on(n,t)}},aSyE:function(e,t){e.exports='<div class="test-grading uit-submission-grading-wrapper" ng-class="{\'slide-panel-open\': grading.isSlidePanelOpen()}">\n  <div class="panel-wrap">\n    <header class="panel-header">\n      <div class="columns medium-12 large-10">\n        <h1 class="panel-title" bb-translate>course.grades.submission-grading.title</h1>\n        <button class="left-off-canvas-toggle menu-toggle"\n                analytics-id="course.grades.submissionGrading.menu.button">\n          <bb-svg-icon size="small" icon="main-menu"></bb-svg-icon>\n          <span class="sr-only" bb-translate>course.grades.submission-grading.menu</span>\n        </button>\n      </div>\n    </header>\n    <section class="panel-content slide names-slider">\n      \x3c!-- TODO: Check if title should be editable & update can-edit & max-length --\x3e\n      <bb-panel-header\n        content="grading.column"\n        panel-title="grading.column.columnName"\n        can-edit="false"\n        show-visibility="false"\n        disable-restricted="true"\n        show-conversations="false"\n        show-course="true"\n        show-delete="false"\n        has-slider="true"\n        show-submissions-grading="::!grading.isOpenFromStudentList"\n        summary="grading.column.summary"\n        is-filtered="grading.isFiltered"\n        filtered-count="grading.membershipCount">\n      </bb-panel-header>\n\n      \x3c!-- START slide toggle --\x3e\n      <div class="panel-content-slide-toggle slide-toogle-container" ng-if="grading.canViewAttempts">\n        \x3c!-- left arrow --\x3e\n        <div class="panel-content-left-trigger center-icon carousel-arrow"\n             ng-attr-aria-disabled="{{!grading.carouselHelper.showPrevArrow()}}"\n             ng-disabled="!grading.carouselHelper.showPrevArrow()"\n             ng-if="::!grading.isOpenFromStudentList">\n          <button ng-show="grading.carouselHelper.showPrevArrow()"\n                  bb-translate-attrs="{\'aria-label\': \'course.grades.submission-grading.previous\'}"\n                  ng-click="grading.transitionTo(-1)"\n                  analytics-id="course.grades.submissionGrading.previousSubmission.button">\n            <bb-svg-icon size="medium" icon="back-arrow" role="presentation"></bb-svg-icon>\n          </button>\n        </div>\n\n        <div class="panel-content-center-trigger single-user" ng-if="!grading.groupId && grading.isOpenFromStudentList">\n          <span class="slider-name page-title assessment-exception">\n            <span class="submission-grading__username">\n              <bb-username user="grading.carouselHelper.currentRow.user" format="short"></bb-username>\n              <button\n                  class="assessment-exception__btn-tooltip"\n                  bb-complex-tooltip\n                  enhanced-tooltip="true"\n                  tooltip-position="top-center"\n                  tooltip-center-content="true"\n                  tooltip-enable-on-mouse-over-for-all-breakpoints="true"\n                  tooltip-enable-on-mouse-leave-for-all-breakpoints="true"\n                  tooltip-scope="grading.tooltipScope"\n                  tooltip-template="{{grading.getTooltipTemplate()}}"\n                  analytics-id="components.features.course.grades.submissionGrading.exception.button"\n                  ng-if="grading.shouldShowTimeExtraIcon"\n                  >\n                <bb-ui-icon-medium-time-extra></bb-ui-icon-medium-time-extra>\n              </button>\n            </span>\n          </span>\n        </div>\n\n        <div class="panel-content-center-trigger single-group" ng-if="grading.groupId && grading.isOpenFromStudentList">\n          <span class="slider-name" ng-class="\'slick_title\' + grading.groupId" bb-foundation-defer>\n            <bb-multi-user-usercard ng-show="grading.carouselHelper.currentRow.group.ui.users.length"\n                                    class="group-header"\n                                    users="grading.carouselHelper.currentRow.group.ui.users"\n                                    view="\'group-users\'"\n                                    group-users-title="grading.carouselHelper.currentRow.group.title"\n                                    list-header="grading.carouselHelper.currentRow.group.ui.membersText"\n                                    selected-user="grading.carouselHelper.currentRow.group.ui.submittedUser"\n                                    selected-text="{{grading.carouselHelper.currentRow.group.ui.submittedDate}}"\n                                    user-course-availabilities="grading.userCourseAvailabilities">\n            </bb-multi-user-usercard>\n            <span ng-if="grading.carouselHelper.currentRow.group.ui.users.length"\n                  bb-translate\n                  translate-values="{number: grading.carouselHelper.currentRow.group.ui.users.length}">\n              course.grades.submission-grading.members.pural\n            </span>\n          </span>\n        </div>\n\n        <div class="panel-content-center-trigger" ng-show="grading.attemptsWereDeleted || grading.carouselHelper.ready" ng-if="::!grading.isOpenFromStudentList">\n          <bb-next-peer-visibility-ftue\n            class="next-peer-guidance-ftue"\n            ng-if="grading.showNextPeerVisibilityFTUE()"\n          ></bb-next-peer-visibility-ftue>\n          <ul class="names-slide" ng-if="!grading.groupId"\n              bb-carousel="grading.namesCarousel"\n              slides-to-show="3"\n              before-slide-change="grading.contentCarousel.slide($direction)"\n              override-slide-click="grading.overrideSlideClick($toSlide)"\n              responsive="[{ media: \'small-only\', options: { slidesToShow: 1 } }]"\n              support-swipe="true"\n              initial-slide="grading.carouselHelper.initialSlide">\n            <li class="no-select" bb-carousel-slide ng-repeat="row in grading.carouselHelper.rows track by $index">\n              \x3c!-- since we use lazy loading (first show 1 row, then other rows), the data of $index = 0 will change, need auto-update="true" --\x3e\n              <button class="slider-name page-title"\n                      ng-if="$visible"\n                      analytics-id="course.grades.submissionGrading.user.button">\n                \x3c!-- Peer grading has a unique label for anonymous "Peer X", so use that in this case instead\n                of the default anonymous handled by bb-username directive --\x3e\n                <span ng-if="::grading.isPeerGradingAndAnonymousUser(row.user)"\n                      class="js-carousel-peer-username"\n                      bb-translate="course.grades.submission-grading.peer"\n                      translate-values="{peerNumber: $index + 1}"></span>\n                <bb-username ng-if="::!grading.isPeerGradingAndAnonymousUser(row.user)"\n                             user="row.user"\n                             format="short"\n                             class="ellipse username js-carousel-username"\n                             ng-attr-auto-update="{{::$index === 0}}"></bb-username>\n                <bb-ui-icon-small-time-extra ng-if="row.hasDueDateException"\n                                             class="time-extra-icon-carousel"\n                                             bb-translate-attrs="{\'aria-label\': \'course.grades.submission-grading.carouselStudentException\'}"></bb-ui-icon-small-time-extra>\n              </button>\n              <span class="slider-name page-title assessment-exception"\n                    ng-if="$visible">\n                <span ng-if="::grading.isPeerGradingAndAnonymousUser(row.user)"\n                      class="js-carousel-peer-username"\n                      bb-translate\n                      translate-values="{peerNumber: $index + 1}">course.grades.submission-grading.peer</span>\n                <span class="submission-grading__username">\n                  <bb-username ng-if="::!grading.isPeerGradingAndAnonymousUser(row.user)"\n                  user="row.user"\n                  format="short"\n                  class="ellipse username js-carousel-username"\n                  ng-class="{\'has-accommodation\': grading.carouselHelper.currentRow.hasDueDateException}"\n                  ng-attr-auto-update="{{::$index === 0}}"></bb-username>\n                  <button\n                      class="assessment-exception__btn-tooltip"\n                      bb-complex-tooltip\n                      enhanced-tooltip="true"\n                      tooltip-position="top-center"\n                      tooltip-center-content="true"\n                      tooltip-enable-on-mouse-over-for-all-breakpoints="true"\n                      tooltip-enable-on-mouse-leave-for-all-breakpoints="true"\n                      tooltip-scope="grading.tooltipScope"\n                      tooltip-template="{{grading.getTooltipTemplate()}}"\n                      analytics-id="components.features.course.grades.submissionGrading.exception.button"\n                      ng-if="grading.shouldShowTimeExtraIcon"\n                      >\n                    <bb-ui-icon-medium-time-extra></bb-ui-icon-medium-time-extra>\n                  </button>\n                </span>\n              </span>\n            </li>\n          </ul>\n          \x3c!-- Group Card --\x3e\n          <ul class="names-slide" ng-if="grading.groupId && !grading.isOpenFromStudentList"\n              bb-carousel="grading.namesCarousel"\n              slides-to-show="3" focus-on-select="true"\n              before-slide-change="grading.contentCarousel.slide($direction)"\n              override-slide-click="grading.overrideSlideClick($toSlide)"\n              prev-arrow=".panel-content-left-trigger" next-arrow=".panel-content-right-trigger" as-nav-for=".student-submission-content-wrapper"\n              responsive="[{ media: \'small-only\', options: { slidesToShow: 1 } }]"\n              initial-slide="grading.carouselHelper.initialSlide">\n            <li class="no-select group" bb-carousel-slide ng-repeat="row in grading.carouselHelper.rows track by $index">\n              <button class="slider-name page-title ellipse"\n                      ng-if="$visible"\n                      analytics-id="course.grades.submissionGrading.group.button">\n                <bdi>{{row.group.title}}</bdi>\n              </button>\n              <span class="slider-name group-title ellipse" ng-if="grading.carouselHelper.isCurrent($index)" ng-class="\'slick_title\' + grading.groupId" bb-foundation-defer>\n                <bb-multi-user-usercard ng-show="grading.carouselHelper.currentRow.group.ui.users.length"\n                                        users="grading.carouselHelper.currentRow.group.ui.users"\n                                        view="\'group-users\'"\n                                        group-users-title="row.group.title"\n                                        list-header="grading.carouselHelper.currentRow.group.ui.membersText"\n                                        selected-user="grading.carouselHelper.currentRow.group.ui.submittedUser"\n                                        selected-text="{{grading.carouselHelper.currentRow.group.ui.submittedDate}}"\n                                        user-course-availabilities="grading.userCourseAvailabilities">\n                </bb-multi-user-usercard>\n                \x3c!-- Group submissions sub title --\x3e\n                <span ng-if="grading.carouselHelper.currentRow.group.ui.users.length"\n                      bb-translate\n                      translate-values="{number: grading.carouselHelper.currentRow.group.ui.users.length}">\n                  course.grades.submission-grading.members.pural\n                </span>\n              </span>\n            </li>\n          </ul>\n        </div>\n\n        \x3c!-- right arrow --\x3e\n        <div class="panel-content-right-trigger center-icon carousel-arrow"\n             ng-attr-aria-disabled="{{!grading.carouselHelper.showNextArrow()}}"\n             ng-disabled="!grading.carouselHelper.showNextArrow()"\n             ng-if="::!grading.isOpenFromStudentList">\n          <button ng-show="grading.carouselHelper.showNextArrow()"\n                  bb-translate-attrs="{\'aria-label\': \'course.grades.submission-grading.next\'}"\n                  ng-click="grading.transitionTo(1)"\n                  analytics-id="course.grades.submissionGrading.nextSubmission.button">\n            <bb-svg-icon size="medium" icon="forward-arrow" role="presentation"></bb-svg-icon>\n          </button>\n        </div>\n      </div>\n      \x3c!-- END slide toggle --\x3e\n\n      \x3c!-- submission content: single slide slick navigated by slick toggle above --\x3e\n      <div class="student-submission-content-wrapper" ready="{{grading.carouselHelper.ready}}" ng-show="grading.carouselHelper.ready"\n           bb-sliding="grading.contentCarousel"\n           after-sliding="grading.carouselHelper.updateSlide(grading.namesCarousel.currentSlide)"\n      >\n        <div class="slider-submission-content">\n            <div class="slider-bar-container" ng-if="grading.canRenderSubmission()"\n                 ng-switch="grading.column.isMultipleAttempts() || grading.hasExceptionAttempts"\n                 ng-class="::{\'grading-bar-double\': grading.column.isMultipleAttempts() || grading.hasExceptionAttempts}">\n\n              <div class="grading-bar-wrapper">\n                \x3c!-- final score  & attempt grading bars for multiple attempt assessment --\x3e\n                <bb-grading-bar ng-switch-when="true"\n                                is-exception-attempt="grading.hasExceptionAttempts"\n                                is-privileged="true"\n                                column="::grading.column"\n                                grade-detail="grading.carouselHelper.currentRow.grade"\n                                user="grading.carouselHelper.currentRow.user"\n                                on-update="grading.afterGradingBarUpdate(newGrade)"\n                                on-delete="grading.afterGradingBarDelete()"\n                                has-due-date-accommodation="grading.carouselHelper.currentRow.hasDueDateException"\n                                hide-grade="grading.slideoutPanelService.isRubricState() && grading.isSlidePanelOpen()"\n                                has-rubric-clear-confirmation-callout="grading.column.hasRubricAssociation()"\n                                row="grading.getSubmissionListRow()">\n                </bb-grading-bar>\n\n                \x3c!-- grading bar for multiple attempts assessment --\x3e\n                <div ng-switch-when="true">\n                  \x3c!-- grading bar for non-group multiple attempts assessments --\x3e\n                  <bb-grading-bar ng-if="::!grading.column.isGroupContent()"\n                    is-exception-attempt="grading.hasExceptionAttempts"\n                    is-privileged="true"\n                    disable-feedback-buttons="!grading.column.isScorm()"\n                    disable-rubric-action="!grading.column.isScorm()"\n                    enable-editable-input-mode="true"\n                    is-readonly="grading.isDelegatedGradingReadonly()"\n                    column="grading.column"\n                    attempt="grading.getAttempt(grading.carouselHelper.currentRow)"\n                    attempt-index="{{grading.getAttemptIndex(grading.carouselHelper.currentRow)}}"\n                    user="grading.carouselHelper.currentRow.user"\n                    save-as-override="grading.saveAsOverride"\n                    has-due-date-accommodation="grading.carouselHelper.currentRow.hasDueDateException"\n                    on-update="grading.afterGradingBarUpdate(newGrade)"\n                    on-delete="grading.afterGradingBarDelete()"\n                    hide-grade="grading.slideoutPanelService.isRubricState() && grading.isSlidePanelOpen()"\n                    show-comment="!grading.isSlidePanelOpen()"\n                    show-overflow-menu="grading.showOverflowMenu()"\n                    has-rubric-clear-confirmation-callout="grading.column.hasRubricAssociation()"\n                    row="grading.getSubmissionListRow()">\n                  </bb-grading-bar>\n\n                  \x3c!-- grading bar for group assessments with multiple attempts --\x3e\n                  <bb-grading-bar ng-if="::grading.column.isGroupContent()"\n                    is-exception-attempt="grading.hasExceptionAttempts"\n                    is-privileged="true"\n                    disable-feedback-buttons="!grading.column.isScorm()"\n                    disable-rubric-action="!grading.column.isScorm()"\n                    enable-editable-input-mode="true"\n                    is-readonly="grading.isDelegatedGradingReadonly()"\n                    column="grading.column"\n                    attempt="grading.getAttempt(grading.carouselHelper.currentRow)"\n                    attempt-index="{{grading.getAttemptIndex(grading.carouselHelper.currentRow)}}"\n                    user="grading.carouselHelper.currentRow.user"\n                    save-as-override="grading.saveAsOverride"\n                    has-due-date-accommodation="grading.carouselHelper.currentRow.hasDueDateException"\n                    on-update="grading.afterGradingBarUpdate(newGrade)"\n                    on-delete="grading.afterGradingBarDelete()"\n                    hide-grade="grading.slideoutPanelService.isRubricState() && grading.isSlidePanelOpen()"\n                    show-comment="!grading.isSlidePanelOpen()"\n                    show-overflow-menu="grading.showOverflowMenu()"\n                    has-rubric-clear-confirmation-callout="grading.column.hasRubricAssociation()"\n                    show-group-list="grading.column.isGroupContent()"\n                    row="grading.getSubmissionListRow()"\n                    user-course-availabilities="grading.userCourseAvailabilities"\n                    selected-user="grading.carouselHelper.currentRow.group.ui.submittedUser"\n                    selected-text="{{grading.carouselHelper.currentRow.group.ui.submittedDate}}"\n                    user-list="grading.carouselHelper.currentRow.group.ui.users">\n                  </bb-grading-bar>\n                </div>\n\n                \x3c!-- grading bar for single attempt assessment --\x3e\n                <div ng-switch-default>\n                  \x3c!-- grading bar for non-peer single attempt assessments --\x3e\n                  <bb-grading-bar ng-if="!grading.isPeerGrading()"\n                                  is-exception-attempt="grading.hasExceptionAttempts"\n                                  is-privileged="true"\n                                  disable-feedback-buttons="!grading.column.isScorm()"\n                                  disable-rubric-action="!grading.column.isScorm()"\n                                  enable-editable-input-mode="true"\n                                  is-readonly="grading.isDelegatedGradingReadonly()"\n                                  row="grading.carouselHelper.currentRow"\n                                  column="::grading.column"\n                                  grade-detail="grading.carouselHelper.currentRow.grade"\n                                  attempt="grading.getAttempt(grading.carouselHelper.currentRow)"\n                                  user="grading.carouselHelper.currentRow.user"\n                                  on-update="grading.afterGradingBarUpdate(newGrade)"\n                                  on-delete="grading.afterGradingBarDelete()"\n                                  save-as-override="grading.saveAsOverride"\n                                  has-due-date-accommodation="grading.carouselHelper.currentRow.hasDueDateException"\n                                  hide-grade="grading.slideoutPanelService.isRubricState() && grading.isSlidePanelOpen()"\n                                  show-comment="!grading.isSlidePanelOpen()"\n                                  show-overflow-menu="grading.showOverflowMenu()"\n                                  selected-user="grading.carouselHelper.currentRow.group.ui.submittedUser"\n                                  selected-text="{{grading.carouselHelper.currentRow.group.ui.submittedDate}}"\n                                  user-list="grading.carouselHelper.currentRow.group.ui.users"\n                                  user-course-availabilities="grading.userCourseAvailabilities"\n                                  has-rubric-clear-confirmation-callout="grading.column.hasRubricAssociation()"></bb-grading-bar>\n\n                  \x3c!-- grading bar for peer assessments --\x3e\n                  <bb-grading-bar ng-if="grading.isPeerGrading()"\n                                  is-exception-attempt="grading.hasExceptionAttempts"\n                                  is-privileged="true"\n                                  disable-feedback-buttons="!grading.column.isScorm()"\n                                  disable-rubric-action="!grading.column.isScorm()"\n                                  enable-editable-input-mode="true"\n                                  is-readonly="grading.isDelegatedGradingReadonly()"\n                                  row="grading.carouselHelper.currentRow"\n                                  column="::grading.column"\n                                  on-feedback-icon-click="::grading.onFeedbackIconClick()"\n                                  grade-detail="grading.carouselHelper.currentRow.grade"\n                                  attempt="grading.getAttempt(grading.carouselHelper.currentRow)"\n                                  user="grading.carouselHelper.currentRow.user"\n                                  on-update="grading.afterGradingBarUpdate(newGrade)"\n                                  on-delete="grading.afterGradingBarDelete()"\n                                  save-as-override="grading.saveAsOverride"\n                                  has-due-date-accommodation="grading.carouselHelper.currentRow.hasDueDateException"\n                                  hide-grade="grading.isPeerReviewer || (grading.slideoutPanelService.isRubricState() && grading.isSlidePanelOpen())"\n                                  show-comment="!grading.isSlidePanelOpen()"\n                                  show-overflow-menu="grading.showOverflowMenu()"\n                                  selected-user="grading.carouselHelper.currentRow.group.ui.submittedUser"\n                                  selected-text="{{grading.carouselHelper.currentRow.group.ui.submittedDate}}"\n                                  user-list="grading.carouselHelper.currentRow.group.ui.users"\n                                  user-course-availabilities="grading.userCourseAvailabilities"\n                                  has-rubric-clear-confirmation-callout="grading.column.hasRubricAssociation()"></bb-grading-bar>\n                </div>\n              </div>\n\n              <div ng-if="grading.showBanner" class="information-banner">\n                <bb-ui-information-banner\n                  on-close="grading.hideBanner"\n                  message="grading.bannerMessage"\n                />\n              </div>\n\n              \x3c!-- assessment specific submission content --\x3e\n              <div class="slider-bar-content" ng-if="!grading.column.isScorm()" ng-switch="grading.isExternalSubmissions">\n                <div class="slider-bar-content-attempt" ng-switch-when="true">\n                  <bb-external-submission-canvas\n                    attempt="grading.getAttempt(grading.carouselHelper.currentRow)"\n                    class="slider-bar-content-attempt"\n                    has-rubric-association="grading.column.hasRubricAssociation()"\n                    questions="::grading.getQuestionsForAttempt()"\n                    is-any-question-editing="grading.isAnyQuestionEditing"\n                    use-navigation="true"\n                  ></bb-external-submission-canvas>\n                </div>\n                <div class="slider-bar-content-attempt" ng-switch-default>\n                  <bb-attempt-canvas-with-navigation attempt="grading.getAttempt(grading.carouselHelper.currentRow)"\n                                                     peer-reviewer="grading.isPeerReviewer"\n                                                     has-rubric-association="grading.hasRubricAssociation"\n                                                     class="submission-grading-attempt-canvas-with-navigation slider-bar-content-attempt"\n                                                     graded-question-attempts="grading.gradedQuestionAttempts"\n                                                     canvas-type="grading.AssessmentCanvasMode.AttemptGrading"\n                                                     is-any-question-editing="grading.isAnyQuestionEditing"\n                                                     ng-if="grading.showAttemptCanvas()">\n                  </bb-attempt-canvas-with-navigation>\n                </div>\n              </div>\n\n              <div ng-if="grading.column.isScorm() && grading.attemptDetail" id="scorm-report">\n                <bb-scorm-submission\n                  submission-detail="grading.attemptDetail"\n                  class-average-time="grading.classAverageTime"\n                  is-organization="grading.course.isOrganization">\n                </bb-scorm-submission>\n              </div>\n            </div>\n\n            <div class="is-empty-page is-empty-fade angular-animate" ng-if="!grading.isLoading && grading.carouselHelper.wasDeleted()">\n              <div class="is-empty-wrapper">\n                <div class="is-empty-explanation">\n                  <img src="./static/images/delete-illustration.svg" bb-translate bb-translate-attrs="{\'alt\':\'course.grades.submission-grading.attemptDeleted\'}" aria-hidden="true"/>\n                  <p class="is-empty-heading js-grading-attempt-deleted" bb-translate>course.grades.submission-grading.attemptDeleted</p>\n                </div>\n              </div>\n            </div>\n        </div>\n\n      </div>\n\n      <div class="spinner bb-secondary-color-2" ng-if="grading.isLoading" aria-hidden="true"></div>\n    </section>\n  </div>\n\n  <div ui-view="submission-grading-peek"></div>\n</div>\n<div class="hide"\n     bb-confirmation-needed="x-bb-close-without-saving"\n     show-type="always"\n     modal-name="submission-question-regrading"\n     ng-click="grading.closeWithoutSaving()"\n     analytics-id="course.grades.submission-grading.confirmClose"\n    ></div>\n'},aTRN:function(e,t,s){"use strict";var n=s("D57K"),i=s("pjml"),o=s("aHpC"),a=s("4GL6"),r=s("0JpG"),c=s("oi1r"),l=s("TnpK"),d=s("Qbdf"),u=s("X455"),p=s("zGdY"),m=s("IbyE"),h=s("nsO7");const b="performance",g="date";let v=class{constructor(e,t,s,n,i,o,a){this.localizeService=e,this.schemaService=t,this.courseModel=s,this.contextCourse=n,this.contextCourseMembership=i,this.scope=a,this.isPerformanceConditionInvalid=!1,this.role=Object(h.memoize)((()=>this.contextCourseMembership.courseMembership&&this.contextCourseMembership.courseMembership.isStudentMembership()?"student":"instructor")),this.courseId=n.courseId?n.courseId:o.params.courseId}getConditions(e,t,s){var n,i;this.content=e;const o=null===(n=e.adaptiveReleaseRules)||void 0===n?void 0:n.rules;if((null==o?void 0:o.length)||e.isForcedSequenceModule())if((null===(i=null==o?void 0:o[0])||void 0===i?void 0:i.criteria)&&(this.allCriteria=o[0].criteria),this.getACLCriteria()?this.setACLCondition():this.aclToolTips=null,this.getPerformanceCriteria()?this.setPerformanceCondition(t,s):this.performanceToolTips=null,this.getDateCriteria()?this.setDateCondition():this.dateToolTips=null,this.contextCourseMembership.courseMembership.isStudentMembership()&&e.isForcedSequenceItem()){const t=0===e.position?"components.directives.content-item-base.conditionalRelease.student-forced-sequence-first-item-tooltip":"components.directives.content-item-base.conditionalRelease.student-forced-sequence-item-tooltip";this.forcedSequenceTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:t,noWrap:!0,noEscape:!0}),this.updateTooltipScope()}else this.forcedSequenceTips=null}getConditionDescription(){const e=!!this.getACLCriteria(),t=!!this.getPerformanceCriteria(),s=!!this.getDateCriteria(),n=[[e,this.contextCourse.course.isOrganization?"organization-membership":"course-membership"],[s,g],[t,b]].filter((e=>!!e[0])).map((e=>`components.directives.content-item-base.conditionalRelease.conditionDescriptions.${e[1]}`));if(0===n.length)return;const i=this.localizeService.getLocale(this.scope),o=n.map(((e,t)=>this.localizeService.translateSync({locale:i,key:`${e}${0===t?"-capitalized":""}`})));return this.localizeService.formatItemsSync(o,o.length,null,this.scope,!1,{noWrap:!0})}getPerformanceCriteria(){return this.getCriteriaByType(m.AdaptiveReleaseCriteriaType.Grade.toString())||this.getCriteriaByType(m.AdaptiveReleaseCriteriaType.GradePercentage.toString())}getDateCriteria(){return this.getCriteriaByType(m.AdaptiveReleaseCriteriaType.Date.toString())}getACLCriteria(){return this.getCriteriaByType(m.AdaptiveReleaseCriteriaType.ACL.toString())}getCriteriaByType(e){return this.allCriteria&&this.allCriteria.find((t=>t.type===e))}setPerformanceCondition(e,t){this.gradeCriteria=this.getPerformanceCriteria();let s=this.gradeCriteria&&this.gradeCriteria.minScore;const n=this.gradeCriteria&&this.gradeCriteria.maxScore,i=this.gradeCriteria&&this.gradeCriteria.gradeColumnId;let o="",a="";if(!i||t){const e=`components.directives.content-item-base.conditionalRelease.${this.role()}-missing-column-error`;return this.performanceToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:e,noWrap:!0,noEscape:!0}),this.isPerformanceConditionInvalid=!0,void this.updateTooltipScope()}this.courseModel.$new(this.courseId||this.content.courseId).gradebook.columns.$find(i).$allow([403]).$then((t=>{if(t.$response&&403===t.$response.status)return this.performanceToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.content-item-base.conditionalRelease.student-missing-column-error",noWrap:!0,noEscape:!0}),this.isPerformanceConditionInvalid=!0,void this.updateTooltipScope();let i=`components.directives.content-item-base.conditionalRelease.${this.role()}-lock-tooltip`;i+=void 0===n?"-common":s===n?"-equal":"-custom";const r=e||t&&t.columnName;this.schemaService.loadSchemas(this.courseId).then((e=>{const c=e&&e.find((e=>e.id===t.gradingSchemaId))||{};this.gradeCriteria&&"Grade_Range"===this.gradeCriteria.type&&(void 0===n&&c.scaleType!==p.SchemaScaleType.Score&&c.scaleType!==p.SchemaScaleType.Complete||(o=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:s||0},key:"components.directives.content-item-base.conditionalRelease.point.plural",noWrap:!0,noEscape:!0}),a=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:n||t.possible},key:"components.directives.content-item-base.conditionalRelease.point.plural",noWrap:!0,noEscape:!0}))),this.gradeCriteria&&"Grade_Range_Percentage"===this.gradeCriteria.type&&(void 0!==n||c.scaleType===p.SchemaScaleType.Percent?(o=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:s||0},key:"components.directives.content-item-base.conditionalRelease.percentage",noWrap:!0,noEscape:!0}),a=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),params:{score:n||t.possible},key:"components.directives.content-item-base.conditionalRelease.percentage",noWrap:!0,noEscape:!0})):c.scaleType===p.SchemaScaleType.Tabular&&(c.symbols.sort(((e,t)=>e.absoluteTranslation-t.absoluteTranslation)),c.symbols.forEach((e=>{e.absoluteTranslation>=s&&(s=e.symbol,o=s)})))),this.getPerformanceToolTips(i,o,a,r)}))}))}setDateCondition(){if(this.dateCriteria=this.getDateCriteria(),this.dateCriteria){let e=null;this.dateCriteria.start&&this.dateCriteria.end?e="both":this.dateCriteria.start?e="showon":this.dateCriteria.end&&(e="hideafter");const t=`components.directives.content-item-base.conditionalRelease.${this.role()}-${e}-date-tooltip`;this.dateToolTips=e&&this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:t,params:{showon:new Date(this.dateCriteria.start),hideafter:new Date(this.dateCriteria.end)},noWrap:!0,noEscape:!0}),this.updateTooltipScope()}}setACLCondition(){this.aclCriteria=this.getACLCriteria(),this.aclCriteria&&(this.aclToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.content-item-base.conditionalRelease.acl-tooltip",noWrap:!0,noEscape:!0}),this.updateTooltipScope())}getPerformanceToolTips(e,t,s,n,i=""){this.performanceToolTips=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:e,params:{minScore:t,maxScore:s,title:n},noWrap:!0,noEscape:!0}),this.isPerformanceConditionInvalid=!1,this.updateTooltipScope()}updateTooltipScope(){angular.isUndefined(this.tooltipScope)&&(this.tooltipScope=this.scope.$new(!0)),this.tooltipScope.items=[],this.aclToolTips&&this.tooltipScope.items.push(this.aclToolTips),this.performanceToolTips&&(this.tooltipScope.items.push(this.performanceToolTips),this.isPerformanceConditionInvalid)?this.tooltips=this.performanceToolTips:(this.dateToolTips&&this.tooltipScope.items.push(this.dateToolTips),this.forcedSequenceTips&&this.tooltipScope.items.push(this.forcedSequenceTips),this.tooltips=this.tooltipScope.items.join(" "))}getConditionalReleaseComplexTooltipTemplate(){return a.a("conditional-release-tooltip")}};v=Object(n.__decorate)([Object(n.__param)(0,Object(o.b)(r.serviceName)),Object(n.__param)(1,Object(o.b)(c.b)),Object(n.__param)(2,Object(o.b)(i.m.serviceName)),Object(n.__param)(3,Object(o.b)(d.e)),Object(n.__param)(4,Object(o.b)(u.d)),Object(n.__param)(5,Object(o.b)(l.d)),Object(n.__param)(6,Object(o.b)("scope"))],v),t.a=v},aY38:function(e,t,s){var n=s("Jygx");e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(n(e).replace(/(.)/g,(function(e,t){var s=t.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s})))}(t)}catch(e){return n(t)}}},afiT:function(e,t){e.exports='<div class="question-answer-container matching-attempt-review">\n  <bb-rich-text-editor\n    plugin-options="editorPluginOptions"\n    ng-model="assessmentQuestion.questionAttempt.question.questionText.rawText"\n    supports-inline-document-render="true"\n    is-read-only="true">\n  </bb-rich-text-editor>\n  <bb-question-answer-status\n    correctness="::assessmentQuestion.getAnswerResult()"\n    hide-correctness-text="::!assessmentQuestion.canShowCorrectAnswerRelatedDetail()"\n    was-late="::assessmentQuestion.wasAnsweredLate()"\n    class="matching-attempt-review__question-correctness">\n    <bb-translate\n      ng-if="assessmentQuestion.canShowCorrectAnswerRelatedDetail()"\n      translate-values="{correctCount: assessmentQuestion.viewHelper.correctPairCount, totalCount: assessmentQuestion.viewHelper.totalPairCount}">\n      components.directives.assessment-question.matching.review.correct-answer-count.plural\n    </bb-translate>\n  </bb-question-answer-status>\n  <bb-matching-attempt\n    answers="assessmentQuestion.viewHelper.questionAttempt.question.answers"\n    given-answers="assessmentQuestion.viewHelper.questionAttempt.givenAnswers"\n    prompts="assessmentQuestion.viewHelper.questionAttempt.question.prompts"\n    show-results="assessmentQuestion.canShowCorrectAnswerRelatedDetail()"\n  >\n  </bb-matching-attempt>\n  <bb-automated-question-feedback\n    feedback="assessmentQuestion.getAutomatedQuestionFeedback()"\n    is-collapsible="assessmentQuestion.allowCollapsingOfAutomatedFeedbackIfShown()"\n    editor-plugins-options="automatedFeedbackEditorPluginOptions"\n  />\n</div>\n'},agzH:function(e,t,s){"use strict";var n=s("Llzl"),i=s("0JpG"),o=s("1ZbL"),a=s("/5AG");s.d(t,"a",(function(){return r}));const r="ultra.features.course.outline.review-state-icon",c={Class:a.ReviewStateIconButtonWrapper,bindingNames:["afterItemState","beforeItemState","contentId","courseId","hasAutomaticReviewStateTransition","onReviewStateIconClick"],renderLocalized:!0,withProvider:!0};n.module(r,[i.moduleName]).component("bbReviewStateIcon",Object(o.a)(c))},ap1t:function(e,t,s){"use strict";var n=s("D57K"),i=s("Llzl"),o=s("nsO7"),a=s("d8yC"),r=s("en1n"),c=s("0JpG"),l=s("Fvsw"),d=s("X/qj"),u=s("yMoE"),p=s("pjml"),m=s("TnpK"),h=s("g66W"),b=s("fYJU"),g=s("ooAF"),v=s("nmzr"),f=s("zGdY"),w=s("aHpC"),S=s("qH3X");s.d(t,"a",(function(){return C}));const C="ultra.components.directives.grade.displayGradePill",y="--",O="na";let A=class{constructor(e,t,s,n,i,o,a,c,l){this.$injector=e,this.$sce=t,this.scope=s,this.element=n,this.bbLocalize=i,this.context=o,this.ultraState=a,this.gradebookPermissionService=c,this.contextUser=l,this.colorCss="";const d=this.scope.column()&&this.scope.column().courseId;this.bundlePromise=i.loadBundle("components/directives/grade/display-grade"),this.canViewGradebook=this.hasViewGradebook(d),this.isStudent=l.userModel.isStudent(),this.canViewGrades=this.hasViewGrades(d),this.canViewGrades?(this.scope.$watch("::column()",(e=>{if(e){this.scope.$watchGroup(["column()","attempt()","grade()"],(()=>{const e=this.scope.attempt&&this.scope.attempt(),t=this.scope.grade&&this.scope.grade(),s=this.gradeDisplayItem=this.$injector.instantiate(u.a,{gradeDetail:t,scope:this.scope});s.init(this.scope.column()).then((()=>{let n;this.schema=s.schema,this.schema&&(this.scaleType=s.schema.scaleType),e?n=e.displayGrade:t&&this.schema&&(n=t.displayGrade),s.displayGrade=n,this.setFullDisplayValue()}))}))}})),this.scope.$watch((()=>r.g()),(()=>{this.displayValue&&this.setFullDisplayValue()}))):(this.displayValue=y,this.colorCss=O),s.$on(S.a.REFRESH_OVERALL_EDITOR,(()=>{this.gradeDisplayItem.displayValue||this.shouldShowPendingForGrade()||this.shouldShowPendingForAttempt()||this.setNoSubmitView()}))}hasViewGradebook(e){return this.gradebookPermissionService.canView(e)}hasViewGrades(e){return this.isStudent||this.gradebookPermissionService.canViewGrades(e)}shouldShowPendingForGrade(){const e=this.scope.grade;return e&&e()&&!e().isPosted()&&e().hasAttempts()}shouldShowPendingForAttempt(){const e=this.scope.attempt;return e&&e()&&e().isNeedsGrading()}shouldRenderInlineRubric(){const e=this.scope.grade;return this.rubricEvaluationIsComplete()||this.shouldShowPendingForGrade()||this.shouldShowPendingForAttempt()||e().isPastDueZero()}setNoSubmitView(){this.schema&&this.scaleType&&(this.scaleType===f.SchemaScaleType.Percent?this.displayValue="-- %":this.scaleType===f.SchemaScaleType.Score?this.bundlePromise.then((()=>{var e,t,s,n,i,o;const r=null===(e=this.scope)||void 0===e?void 0:e.grade(),c=null!=(null==r?void 0:r.manualGrade)?r.pointsPossible:null===(s=null===(t=this.scope)||void 0===t?void 0:t.column())||void 0===s?void 0:s.possible,l=null!==(o=null!=c?c:null===(i=null===(n=this.scope)||void 0===n?void 0:n.column())||void 0===i?void 0:i.possible)&&void 0!==o?o:0;this.displayValue=y+this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.display-grade.total",params:{total:a.b(l,2)},noWrap:!0})})):this.displayValue=y)}setFullDisplayValue(){this.displayValue=this.gradeDisplayItem&&this.gradeDisplayItem.displayValue,this.gradeDisplayItem.displayValue?(this.shouldShowPossiblePoints()?this.bundlePromise.then((()=>{this.displayValue=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.display-grade.score",params:{grade:this.gradeDisplayItem.displayValue,possible:a.b(this.scope.grade&&this.scope.grade().pointsPossible||this.scope.column().possible,2)},noWrap:!0,noEscape:!0})})):this.displayValue=this.gradeDisplayItem.displayValue,this.colorCss=this.gradeDisplayItem.getGradeColor()):this.isStudent&&(this.shouldShowPendingForGrade()||this.shouldShowPendingForAttempt())?(this.colorCss="na pending",this.bundlePromise.then((()=>{this.displayValue=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.display-grade.pending-grade",noWrap:!0})}))):(this.colorCss=this.isStudent?"na no-attempt":"",this.setNoSubmitView())}get cursorClass(){return this.scope.cursor?`cursor-${this.scope.cursor}`:""}shouldShowPossiblePoints(){return!this.isSmallBP()&&this.gradeDisplayItem&&!o.isNaN(parseFloat(this.gradeDisplayItem.displayValue))&&this.gradeDisplayItem.shouldShowTotalPoints()}isSmallBP(){return r.a.Small.isEqualTo(r.f())}shouldShowRubricButton(){var e,t,s;return!(this.scope.hideRubricIcon||!this.scope.column()||!this.scope.column().hasRubricAssociation())&&(!(!this.scope.column().isDiscussion()&&!this.scope.column().isJournal())||(null!=this.scope.attempt||!(!this.scope.column().isSingleAttempt()||f.AttemptStatus.InProgress===(null===(s=null===(t=null===(e=this.scope.grade())||void 0===e?void 0:e.ui)||void 0===t?void 0:t.attempt)||void 0===s?void 0:s.status))))}rubricEvaluationIsComplete(){const e=this.scope.column();if(e&&e.hasRubricAssociation()){const t=this.scope.attempt?this.scope.attempt():this.scope.grade().ui.attempt;return e.getRubricAssociation().isWithEvaluations&&(t&&t.isCompleted()||e.isDiscussion()||e.isJournal())}return!1}openRubricEvaluation(e){if(this.scope.disableRubricEvalClick&&this.scope.disableRubricEvalClick())return;e.stopPropagation();const t=this.getRubricStateRef();this.ultraState.current.name.endsWith("peek.assessment-submission-feedback")&&this.ultraState.leavePeekState(this.ultraState.current.name),this.ultraState.goPeekState(t.state,t.args)}getRubricStateRef(){var e;let t,s;(this.scope.grade||this.scope.attempt)&&(this.scope.attempt&&(t=null!==(e=this.scope.attempt().groupAttemptId)&&void 0!==e?e:this.scope.attempt().id),this.scope.grade&&this.scope.grade().ui&&this.scope.grade().ui.attempt&&this.scope.grade().ui.attempt.id&&(t=this.scope.grade().ui.attempt.id||this.scope.grade().ui.attempt.groupAttemptId),s=this.scope.attempt?this.scope.attempt().groupId:null,this.scope.grade&&this.scope.grade().ui.groupAttempt&&(s=this.scope.grade().ui.groupAttempt.groupId));const n={state:"",args:{attemptId:t||null,columnId:this.scope.column().id||null,contentId:this.scope.column().contentId||null,courseId:this.scope.column().courseId}};let i="inline-rubric";if(this.scope.isManualStatusPosted||this.gradeDisplayItem.displayValue&&"0"!==this.gradeDisplayItem.displayValue||this.scope.isExternalSubmission||this.scope.column().isCollectExternalSubmissions()||(i=this.shouldRenderInlineRubric()?"inline-rubric":"peek.rubric-view"),this.canViewGradebook||this.scope.column().isDiscussion()||this.scope.column().isJournal()){const e=this.rubricEvaluationIsComplete()?"rubric-evaluation":"rubric-view";n.args.groupId=s||null,n.args.userId=this.scope.grade&&this.scope.grade().user&&(this.scope.grade().user.$pk||this.scope.grade().user.id)||null,n.state=e,this.scope.column().isJournal()&&(n.state=this.rubricEvaluationIsComplete()?v.JournalRoutes.JOURNAL_VIEW_WITH_PARTICIPATION_AND_RUBRIC_EVALUATION:v.JournalRoutes.JOURNAL_VIEW_WITH_PARTICIPATION_AND_RUBRIC_VIEW)}else n.args.groupId=s||null,n.state=`${v.AssessmentRoutes.ASSESSMENT_ATTEMPT_REVIEW}.${i}`;return h.d(this.ultraState.current.name,".peek.course.grades")&&(this.scope.column().isCollectExternalSubmissions()?(n.state=`${v.AssessmentRoutes.ASSESSMENT_ATTEMPT_REVIEW}.inline-rubric`,n.args.skipTransitionEvents=!0):n.state="assessment.overview"),n}};A=Object(n.__decorate)([Object(n.__param)(0,Object(w.b)("$injector")),Object(n.__param)(1,Object(w.b)("$sce")),Object(n.__param)(2,Object(w.b)("scope")),Object(n.__param)(3,Object(w.b)("element")),Object(n.__param)(4,Object(w.b)(c.serviceName)),Object(n.__param)(5,Object(w.b)(l.b)),Object(n.__param)(6,Object(w.b)(m.d)),Object(n.__param)(7,Object(w.b)(d.b)),Object(n.__param)(8,Object(w.b)(b.b))],A);class I{constructor(e){this.$injector=e,this.restrict="E",this.template=g,this.scope={attempt:"&?",column:"&",disableRubricEvalClick:"&?",grade:"&?",isManualStatusPosted:"<?",cursor:"@?",hideRubricIcon:"=?",isExternalSubmission:"=?",rubricStateOverride:"@?"},this.link=(e,t)=>{if(!e.attempt&&!e.grade)throw new Error("An attempt or grade must be included on scope");if(e.attempt&&e.grade)throw new Error("An attempt or grade should be included on scope, not both");if(!e.column)throw new Error("A column must be included on scope");e.displayGradePill=this.$injector.instantiate(A,{scope:e,element:t})}}}I.$inject=["$injector"],i.module(C,[p.N,d.a]).directive("bbDisplayGradePill",["$injector",e=>e.instantiate(I)])},bhWV:function(e,t,s){"use strict";var n=s("D57K"),i=(s("Sq3Z"),s("1NX5"),s("uAJz"),s("66CI"),s("Llzl")),o=s("YHe3"),a=s("TnpK"),r=s("Qbdf"),c=s("jhBu"),l=s("wy9x"),d=s("ga7A"),u=s("Is+C"),p=s("yV5t");const m="ultra.components.directives.content.contentItem.contentItemType.contentItemScormlaunch";class h{constructor(e,t){this.scope=e,this.scormService=t}scormLaunch(){if(!this.scope.content.isScorm())throw new Error("Attempted to launch a non-SCORM content item. "+this.scope.content.contentHandler.toString());this.scormService.scormLaunch({courseId:this.scope.content.courseId,contentId:this.scope.content.id,content:this.scope.content,showPreLaunchPanel:!0})}}h.$inject=["scope",u.c];class b{constructor(e){this.$injector=e,this.restrict="E",this.template=p,this.scope=!1,this.link=(e,t,s)=>{e.contentItemScormLaunch=this.$injector.instantiate(h,{scope:e,element:t,attrs:s})}}}b.$inject=["$injector"],i.module(m,[u.b]).directive("bbContentItemScormlaunch",["$injector",e=>e.instantiate(b)]);var g=s("z+6U"),v=s("Sa5G"),f=s("aHpC"),w=s("nmzr"),S=s("pjml"),C=s("/R3n"),y=s("DU7P"),O=s("zYa8"),A=s("l2+p");const I="ultra.components.directives.bbUiIcon.small.ProctorShield";Object(O.a)(A.ProctorShield,I,"bbUiIconSmallProctorShield");var D=s("zGdY");s.d(t,"a",(function(){return k}));const k="ultra.components.directives.content.contentItem.contentItemCourseOutline";let _=class{constructor(e,t,s,n,i){this.scope=e,this.entitlementService=t,this.proctoringService=s,this.ultraState=n,this.currentCourseService=i,this.customCategory="",this.entitlementService.hasCourseEntitlement(v.e.ModifyContent,this.scope.content.courseId).then((e=>{this.entitledToModifyContent=e}))}get canOpenConditionalRelease(){var e,t,s;return!!(null===(s=null===(t=null===(e=this.scope.content)||void 0===e?void 0:e.permissions)||void 0===t?void 0:t.adaptiveRelease)||void 0===s?void 0:s.view)}shouldAlignMiddle(){const e=this.scope.content;return!e.canViewAsInstructor()&&(!e.description&&(!e.isVisible()||!e.adaptiveReleaseRules))}openConditionalRelease(){if(this.isCourseCompletedAndInInstructorView())return;let e=this.scope.content.id;this.scope.content&&this.scope.content.contentHandler&&this.scope.content.contentDetail&&S.p.ContentHandler.CourseLink.isEqualTo(this.scope.content.contentHandler)&&this.scope.content.getLinkContentSource().$then((t=>{e=t.id})),this.ultraState.goPeekState(w.ContentRoutes.CONDITIONAL_RELEASE_PEEK_PANEL,{contentId:e})}isCourseCompletedAndInInstructorView(){var e;return(null===(e=this.currentCourseService.course)||void 0===e?void 0:e.isComplete())&&this.scope.content.canViewAsInstructor()}displayProctoredTag(){const e=this.scope.content.getProctoringServiceHandle(),t=this.scope.content.isSecureBrowserRequiredToTake(),s=e&&e!==y.b;return t||s}};_=Object(n.__decorate)([Object(n.__param)(0,Object(f.b)("scope")),Object(n.__param)(1,Object(f.b)(c.b)),Object(n.__param)(2,Object(f.b)(o.b)),Object(n.__param)(3,Object(f.b)(a.d)),Object(n.__param)(4,Object(f.b)(r.e))],_);class j{constructor(e){this.$injector=e,this.restrict="E",this.template=C,this.scope=!1,this.link=e=>{if(e.contentItemCourseOutline=this.$injector.instantiate(_,{scope:e}),e.content.getAssociatedGradingColumn()){const t=e.content.getAssociatedGradingColumn().gradebookCategory;t&&!t.isUserDefined?(e.contentItemCourseOutline.groupAssessmentFtueKey="components.directives.content-item-base.group-assessment-description."+t.title,e.contentItemCourseOutline.groupAssessmentFtueTitleKey="components.directives.content-item-base.group-assessment-title."+t.title):(e.contentItemCourseOutline.customCategory=t&&t.title,e.contentItemCourseOutline.groupAssessmentFtueKey="components.directives.content-item-base.group-assessment-description.custom",e.contentItemCourseOutline.groupAssessmentFtueTitleKey="components.directives.content-item-base.group-assessment-title.custom")}else e.contentItemBase.courseLinkContentHandler.isEqualTo(e.content.contentHandler)&&(e.contentItemCourseOutline.groupAssessmentFtueKey=`components.directives.content-item-base.group-assessment-description.${D.KnownGradebookCategoryTitle.Discussion}`,e.contentItemCourseOutline.groupAssessmentFtueTitleKey=`components.directives.content-item-base.group-assessment-title.${D.KnownGradebookCategoryTitle.Discussion}`)}}}j.$inject=["$injector"],i.module(k,[l.a,d.a,g.a,m,o.a,a.b,r.b,I]).directive("bbContentItemCourseOutline",["$injector",e=>e.instantiate(j)])},"bs/4":function(e,t){e.exports='<bb-modal id="confirm-time-up-modal"\n          modal-title-key="course.content.assessment.test.modal.confirmTimeUpAlert.title"\n          class="notification hide-x-button"\n          bb-focus="true"\n          analytics-id-tag-prefix="course.content.assessment.test.modal.confirmTimeUpAlert">\n  <div name="modal-contents">\n    <p bb-translate ng-if="::!assessmentAttempt.hasUploadsInProgress">\n      course.content.assessment.test.modal.confirmTimeUpAlert.body\n    </p>\n    <p bb-translate ng-if="::assessmentAttempt.hasUploadsInProgress">\n      course.content.assessment.test.modal.confirmTimeUpAlert.cancelUploads\n    </p>\n  </div>\n  <button name="modal-footer-button-primary" class="button confirm-ok js-primary-button" ng-click="$parent.$close()" bb-translate analytics-id="global.ok">\n    global.ok\n  </button>\n</bb-modal>\n'},c2Z8:function(e,t){e.exports='<div class="bb-statistics">\n  <ul class="statistics-list total-items-{{::statistics.total}} small-per-row-{{::statistics.smallPerRow}} large-per-row-{{::statistics.largePerRow}}">\n    <li ng-repeat="item in statistics.config">\n      <div class="statistics-item-container" ng-class="{\'no-default-padding\': item.noDefaultPadding, \'full-height\': !item.complexScope}">\n        <div class="stat-title" ng-attr-title="{{ item.hover ? item.hover : undefined }}" bb-translate>{{::item.title}}</div>\n        <div ng-if="::!item.complexScope" bb-simple-statistic item="::item"></div>\n        <div ng-if="::item.complexScope" bb-complex-statistic item="::item"></div>\n      </div>\n    </li>\n  </ul>\n</div>'},c6mg:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("Y2MI");const o="ultra.components.directives.bbUiIcon.medium.Settings";Object(n.a)(i.Settings,o,"bbUiIconMediumSettings")},"c7N/":function(e,t,s){"use strict";s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return l}));var n=s("D57K"),i=s("Fvsw"),o=s("jhBu"),a=s("aHpC"),r=s("Sa5G");const c="ultra.components.services.unsafe-html",l="unsafe-html";let d=class{constructor(e,t){this.contextService=e,this.entitlementService=t}hasEditUnsafeHtmlPermission(){return this.entitlementService.hasCourseEntitlement(r.v.Modify)}isAlternateDomainConfigured(){return this.contextService.getSystemInfo().alternateDomainConfigured}canEditUnsafeHtml(){return this.hasEditUnsafeHtmlPermission().then((e=>e&&this.isAlternateDomainConfigured()))}};d=Object(n.__decorate)([Object(n.__param)(0,Object(a.b)(i.b)),Object(n.__param)(1,Object(a.b)(o.b))],d);angular.module(c,[i.a,o.a]).service(l,d)},cH8o:function(e,t){e.exports='<div id="{{::bbmlEditor.bbmlEditorId}}" class="freeform-response-editor js-bbml-editor">\n  <div class="element-list-row">\n    <bb-rich-text-editor\n      ng-model="bbmlEditor.bbML.rawText"\n      is-read-only="true"\n      plugin-options="{attachment: true, math: true}"\n      expand-inline-files-on-load="expandInlineFilesOnLoad"\n      supports-inline-document-render="supportsInlineDocumentRender"\n    ></bb-rich-text-editor>\n  </div>\n</div>\n'},cR84:function(e,t){e.exports='<bb-modal class="notification js-dismiss-modal" role="alertdialog" bb-translate-attrs="{\'aria-label\': \'course.grades.settings.categorySettings.deleteAlert.title\'}"\n          modal-title-key="course.grades.settings.categorySettings.deleteAlert.title"\n          analytics-id-tag-prefix="course.grades.settings.categorySettings.deleteAlert">\n  <div name="modal-contents">\n    <bb-translate>course.grades.settings.categorySettings.deleteAlert.content</bb-translate>\n  </div>\n  <button name="modal-footer-button-primary" \n          ng-click="$parent.$dismiss()" \n          class="button js-primary-button"\n          analytics-id="course.grades.settings.categorySettings.deleteAlert.ok.button">\n    <span bb-translate="course.grades.settings.categorySettings.deleteAlert.ok-button"></span>\n  </button>\n</bb-modal>'},cbVV:function(e,t,s){"use strict";(function(e){s.d(t,"l",(function(){return C})),s.d(t,"k",(function(){return y})),s.d(t,"c",(function(){return O})),s.d(t,"d",(function(){return A})),s.d(t,"i",(function(){return I})),s.d(t,"j",(function(){return D})),s.d(t,"b",(function(){return k})),s.d(t,"a",(function(){return _})),s.d(t,"g",(function(){return j})),s.d(t,"h",(function(){return T})),s.d(t,"f",(function(){return $})),s.d(t,"e",(function(){return R}));var n=s("D57K"),i=s("nsO7"),o=s("yC9S"),a=s("Sa5G"),r=s("jhBu"),c=s("o5Lu"),l=s("X/qj"),d=s("vhkR"),u=s("Is+C"),p=s("Mc6f"),m=s("8jzW"),h=s("hkqm"),b=s("TnpK"),g=s("dF44"),v=s("aHpC"),f=s("nmzr"),w=s("IbyE");let S=class{constructor(e,t,s,n,i,o,r,c,l,d,u,p,m,h,b,g,v){this.rootScope=e,this.gridData=t,this.data=s,this.headerTemplate=n,this.cellTemplate=i,this.columnWidth=o,this.position=r,this.border=c,this.ltiService=d,this.entitlementService=u,this.gradeService=p,this.gradebookPermissionService=m,this.scormService=h,this.scoreProviderHelper=b,this.toast=g,this.ultraState=v,this.openDownloadTestResultsPanel=()=>{this.ultraState.goPeekState(f.Routes.Grade.DOWNLOAD_TEST_RESULTS,{columnId:this.id})},this.order=null!=l?l:0,this.id=s.id;const w=this.getCourse().id;this.entitlementService.hasCourseEntitlement(a.i.DeleteAssessment,w).then((e=>{this.canDeleteAssessment=e})),this.entitlementService.hasCourseEntitlement(a.e.DeleteContent,w).then((e=>{this.canDeleteContent=e})),this.entitlementService.hasCourseEntitlement(a.i.ModifyAssessment,w).then((e=>{this.canModifyAssessment=e})),this.entitlementService.hasCourseEntitlement(a.e.ModifyContent,w).then((e=>{this.canModifyContent=e})),this.entitlementService.hasCourseEntitlement(a.i.ViewAssessment,w).then((e=>{this.canViewAssessment=e})),this.entitlementService.hasCourseEntitlement(a.e.ViewAsDesigner,w).then((e=>{this.canViewContentDesigner=e}))}getCourse(){return this.gridData.course}hasContextMenuOptions(){return this.isScorm()||this.canView()||this.gradeService.canPostGrades(this.gridData.course,this.data)||this.data.isQuestionAnalysisAvailable()&&this.canViewQuestionAnalysis()||this.canDelete()}isAssessment(){return w.ScoreProviderHandle.Test.isEqualTo(this.data.scoreProviderHandle)}canView(){return!this.data.scoreProviderHandle||(this.isAssessment()?this.canViewAssessment:this.canViewContentDesigner)}canEdit(){return!this.gridData.course.isComplete()&&(this.data.scoreProviderHandle?this.isAssessment()?this.canModifyAssessment:this.canModifyContent:this.gradebookPermissionService.canModify())}canDelete(){return!this.gridData.course.isComplete()&&(this.data.scoreProviderHandle?this.isAssessment()?this.canDeleteAssessment:this.canDeleteContent:this.gradebookPermissionService.canModify())}deleteColumn(){throw new Error("Unsupported operation exception")}deleteColumnFromGridData(){this.gridData.deleteColumn(this)}getConfirmationMessage(){throw new Error("Unsupported operation exception")}viewOrEdit(){if(w.ScoreProviderHandle.PartnerCloud.isEqualTo(this.data.scoreProviderHandle))this.ltiService.ltiLaunch({courseId:this.data.courseId,contentId:this.data.contentId,linkType:a.f.PartnerCloud,linkRefId:this.data.linkId});else{const e=this.data.scoreProviderHandle;e&&!this.scoreProviderHelper.supportsOverall(e)||(this.scoreProviderHelper.supportsExternalEdit(e)?this.ltiService.ltiEditColumn(this.data):this.openEditState())}}canViewQuestionAnalysis(){return this.gradebookPermissionService.canViewGrades()}openQuestionAnalysisOverview(){throw new Error("Unsupported operation exception")}showDownloadResults(){return this.gridData.canViewGrades&&this.isAssessment()&&this.data.summary.numSubmissionsTotal>0}hasDownloads(){return w.ScoreProviderHandle.Test.isEqualTo(this.data.scoreProviderHandle)}canDownloadAll(){return!1}openDownloadAll(){this.ultraState.goPeekState("grades-bulk-download",{columnId:this.id})}previewScorm(){this.isScorm()&&this.scormService.scormLaunch({courseId:this.data.courseId,contentId:this.data.contentId,showPreLaunchPanel:!1})}openEditState(){throw new Error("Unsupported operation exception")}postGrades(){this.data.postReadyGrades().then((()=>(this.toast.show({messageKey:"components.directives.grade.grid.gradesPosted",icon:"icon-check",toastStatus:"success"}),this.data.anonymousGrading?this.data.$fetch().$asPromise().then((()=>this.data.summary.$fetch().$asPromise())):this.data.summary.$fetch().$asPromise()))).then((()=>{this.gridData.updateColumnByMetadata(this.data)&&this.rootScope.$broadcast(g.b.COLUMN)}))}isShowSummary(){return!0}isScorm(){return this.data&&this.data.isScorm()}onClick(){}triggerDelete(t){t.target===t.currentTarget&&(e(t.target).find("a").click(),t.preventDefault(),t.stopPropagation())}getMetadata(){return this.data}filterByColumId(e){return e.indexOf(this.id)>-1}filterByCategoryId(e){return!!this.data.gradebookCategory&&e.indexOf(this.data.gradebookCategoryId)>-1}};S=Object(n.__decorate)([Object(n.__param)(0,Object(v.b)("$rootScope")),Object(n.__param)(1,Object(v.b)("gridData")),Object(n.__param)(2,Object(v.b)("data")),Object(n.__param)(3,Object(v.b)("headerTemplate")),Object(n.__param)(4,Object(v.b)("cellTemplate")),Object(n.__param)(5,Object(v.b)("columnWidth")),Object(n.__param)(6,Object(v.b)("position")),Object(n.__param)(7,Object(v.b)("border")),Object(n.__param)(8,Object(v.b)("order")),Object(n.__param)(9,Object(v.b)(d.b)),Object(n.__param)(10,Object(v.b)(r.b)),Object(n.__param)(11,Object(v.b)(c.k)),Object(n.__param)(12,Object(v.b)(l.b)),Object(n.__param)(13,Object(v.b)(u.c)),Object(n.__param)(14,Object(v.b)(m.c)),Object(n.__param)(15,Object(v.b)(h.b)),Object(n.__param)(16,Object(v.b)(b.d))],S);class C extends S{addBorder(){this.border=!0}deleteBorder(){this.border=!1}filterByColumId(e){return!0}filterByCategoryId(e){return!0}}let y=class extends S{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v){super(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g),this.notationService=v,this.gradeNotations=[],this.loadNotation()}loadNotation(){this.notationService.getGradeNotationsMap(this.gridData.course.id,!0).then((e=>{this.gradeNotations=e}))}openEditState(){this.ultraState.goPeekState("gradebook-item.overall-grade",{columnId:this.id,gradeitemView:"details"})}deleteColumn(){this.data.forceDelete()}getConfirmationMessage(){return"x-bb-grade-calculation"}filterByColumId(e){return!0}filterByCategoryId(e){return!0}};y.$inject=[],y=Object(n.__decorate)([Object(n.__param)(0,Object(v.b)("$rootScope")),Object(n.__param)(1,Object(v.b)("gridData")),Object(n.__param)(2,Object(v.b)("data")),Object(n.__param)(3,Object(v.b)("headerTemplate")),Object(n.__param)(4,Object(v.b)("cellTemplate")),Object(n.__param)(5,Object(v.b)("columnWidth")),Object(n.__param)(6,Object(v.b)("position")),Object(n.__param)(7,Object(v.b)("border")),Object(n.__param)(8,Object(v.b)("order")),Object(n.__param)(9,Object(v.b)(d.b)),Object(n.__param)(10,Object(v.b)(r.b)),Object(n.__param)(11,Object(v.b)(c.k)),Object(n.__param)(12,Object(v.b)(l.b)),Object(n.__param)(13,Object(v.b)(u.c)),Object(n.__param)(14,Object(v.b)(m.c)),Object(n.__param)(15,Object(v.b)(h.b)),Object(n.__param)(16,Object(v.b)(b.d)),Object(n.__param)(17,Object(v.b)(p.b))],y);class O extends S{refreshAffectedColumns(){this.findAffectedColumns().forEach((e=>this.gridData.updateColumnByMetadata(e.data)))}findAffectedColumns(e=[]){const t=i.differenceBy(this.gridData.getColumns().filter((e=>e instanceof O&&e.isAffected(this))),e,"id");let s=i.unionBy([],t,"id");return e=i.unionBy(t,e,"id"),t.forEach((t=>{s=i.unionBy(s,t.findAffectedColumns(e),"id")})),s}}class A extends O{isAffected(e){const t=this.data.calculatedFormula&&this.data.calculatedFormula.aliases;return!i.isUndefined(t)&&(!i.isUndefined(i.findKey(t,(t=>t===e.id)))||!i.isUndefined(i.findKey(t,(t=>e.data.gradebookCategory&&t===e.data.gradebookCategory.id))))}openEditState(){this.ultraState.goPeekState("gradebook-item.calculation",{columnId:this.id,gradeitemView:"details"})}deleteColumn(){this.data.forceDelete()}getConfirmationMessage(){return"x-bb-grade-calculation"}}let I=class extends O{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g){super(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g),this._affectedColumnsBeforeEdit=[]}getConfirmationMessage(){return"x-bb-grade-column"}stashAffectedColumnsBeforeEdit(){this._affectedColumnsBeforeEdit=this.findAffectedColumns()}get affectedColumnsBeforeEdit(){return this._affectedColumnsBeforeEdit}isAffected(e){return!1}};I.$inject=[],I=Object(n.__decorate)([Object(n.__param)(0,Object(v.b)("$rootScope")),Object(n.__param)(1,Object(v.b)("gridData")),Object(n.__param)(2,Object(v.b)("data")),Object(n.__param)(3,Object(v.b)("headerTemplate")),Object(n.__param)(4,Object(v.b)("cellTemplate")),Object(n.__param)(5,Object(v.b)("columnWidth")),Object(n.__param)(6,Object(v.b)("position")),Object(n.__param)(7,Object(v.b)("border")),Object(n.__param)(8,Object(v.b)("order")),Object(n.__param)(9,Object(v.b)(d.b)),Object(n.__param)(10,Object(v.b)(r.b)),Object(n.__param)(11,Object(v.b)(c.k)),Object(n.__param)(12,Object(v.b)(l.b)),Object(n.__param)(13,Object(v.b)(u.c)),Object(n.__param)(14,Object(v.b)(m.c)),Object(n.__param)(15,Object(v.b)(h.b)),Object(n.__param)(16,Object(v.b)(b.d))],I);class D extends I{openEditState(){this.stashAffectedColumnsBeforeEdit(),this.ultraState.goPeekState("grade-item.edit",{id:this.id})}deleteColumn(){this.data.forceDelete()}}let k=class extends I{constructor(e,t,s,n,i,a,r,c,l,d,u,p,m,h,b,g,v){super(e,t,s,n,i,a,r,c,l,d,u,p,m,h,b,g,v),this.checkIfAttendanceRecordsExist(),o.b.OnRootScope(e,"$stateChangeSuccess",((e,t,s,n)=>{n.name.indexOf("attendance")>=0&&this.checkIfAttendanceRecordsExist()}))}canDelete(){return super.canDelete()&&this.showAttendanceDeleteOption}get canBePost(){return!1}openEditState(){this.stashAffectedColumnsBeforeEdit();const e={courseId:this.data.courseId,contentId:this.data.contentId};this.scoreProviderHelper.editStateRef(this.data.scoreProviderHandle,e,m.a.GoToState)}deleteColumn(){this.data.forceDelete()}checkIfAttendanceIsAvailable(){if(this.gridData.course.tools){const e=this.gridData.course.tools.getToolById("bb-attendance");if(e&&e.toolEnabledSetting.isAvailable)return!0}return!1}checkIfAttendanceRecordsExist(){this.showAttendanceDeleteOption=!1,this.checkIfAttendanceIsAvailable()&&this.gridData.course.attendanceRecordsExist().then((e=>{this.showAttendanceDeleteOption=!e}))}};k.$inject=[],k=Object(n.__decorate)([Object(n.__param)(0,Object(v.b)("$rootScope")),Object(n.__param)(1,Object(v.b)("gridData")),Object(n.__param)(2,Object(v.b)("data")),Object(n.__param)(3,Object(v.b)("headerTemplate")),Object(n.__param)(4,Object(v.b)("cellTemplate")),Object(n.__param)(5,Object(v.b)("columnWidth")),Object(n.__param)(6,Object(v.b)("position")),Object(n.__param)(7,Object(v.b)("border")),Object(n.__param)(8,Object(v.b)("order")),Object(n.__param)(9,Object(v.b)(d.b)),Object(n.__param)(10,Object(v.b)(r.b)),Object(n.__param)(11,Object(v.b)(c.k)),Object(n.__param)(12,Object(v.b)(l.b)),Object(n.__param)(13,Object(v.b)(u.c)),Object(n.__param)(14,Object(v.b)(m.c)),Object(n.__param)(15,Object(v.b)(h.b)),Object(n.__param)(16,Object(v.b)(b.d))],k);class _ extends I{canDownloadAll(){return(!this.data||!this.data.anonymousGrading)&&this.gradebookPermissionService.canViewBulkDownload()}showDownloadResults(){return(!this.data||!this.data.anonymousGrading)&&super.showDownloadResults()}openEditState(){this.stashAffectedColumnsBeforeEdit();const e={courseId:this.data.courseId,contentId:this.data.contentId};this.scoreProviderHelper.editStateRef(this.data.scoreProviderHandle,e,m.a.GoToState)}deleteColumn(){this.rootScope.$broadcast("bb-delete-column",this.data)}openQuestionAnalysisOverview(){this.ultraState.goPeekState("question-analysis.report",{qaContentId:this.data.contentId})}}let j=class extends _{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v){super(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g),this.groups=v,this._userIdGroupIdMap={},this.initializeUserIdGroupIdMap()}initializeUserIdGroupIdMap(){const e=this.gridData.getColumnIdGroupsMap()[this.id];i.isEmpty(e)||e.forEach((e=>{const t=this.gridData.getGroupIdUserIdMap()[e.groupId];i.isEmpty(t)||t.forEach((t=>{this._userIdGroupIdMap[t]=e.groupId}))}))}canDownloadAll(){return!1}get userIdGroupIdMap(){return this._userIdGroupIdMap}getGroupById(e){return i.find(this.groups,(t=>t.groupId===e))}};j.$inject=[],j=Object(n.__decorate)([Object(n.__param)(0,Object(v.b)("$rootScope")),Object(n.__param)(1,Object(v.b)("gridData")),Object(n.__param)(2,Object(v.b)("data")),Object(n.__param)(3,Object(v.b)("headerTemplate")),Object(n.__param)(4,Object(v.b)("cellTemplate")),Object(n.__param)(5,Object(v.b)("columnWidth")),Object(n.__param)(6,Object(v.b)("position")),Object(n.__param)(7,Object(v.b)("border")),Object(n.__param)(8,Object(v.b)("order")),Object(n.__param)(9,Object(v.b)(d.b)),Object(n.__param)(10,Object(v.b)(r.b)),Object(n.__param)(11,Object(v.b)(c.k)),Object(n.__param)(12,Object(v.b)(l.b)),Object(n.__param)(13,Object(v.b)(u.c)),Object(n.__param)(14,Object(v.b)(m.c)),Object(n.__param)(15,Object(v.b)(h.b)),Object(n.__param)(16,Object(v.b)(b.d)),Object(n.__param)(17,Object(v.b)("groups"))],j);class T extends j{}class $ extends j{}class R extends _{}}).call(this,s("71td"))},cghv:function(e,t){e.exports=' <div class="assigned-peer-reviews row collapse">\n  <div class="small-12 columns title">\n    <h2 bb-translate>course.content.assessment.overview.assignedPeerReviews.title</h2>\n  </div>\n   <div class="columns description">\n     <span bb-translate\n           translate-values="{datetime: assignedPeerReviews.submissionDueDate}">course.content.assessment.overview.assignedPeerReviews.description.{{assignedPeerReviews.getDescriptionTextKey()}}</span>\n   </div>\n  <div class="columns list">\n    <ul class="row">\n      <li ng-repeat="peerReview in assignedPeerReviews.peerReviews track by $index" class="item">\n        <div ng-class="{disabled: !assignedPeerReviews.isPeerReviewPeriodOpen}">\n          <span ng-if="!assignedPeerReviews.isInPeerSubmissionWindow" ng-switch on="assignedPeerReviews.getPeerReviewStatus(peerReview)">\n            <div ng-switch-default>\n              \x3c!-- reviewed submission was deleted --\x3e\n              <bb-ui-assigned-peer-grading-tooltip ng-if="assignedPeerReviews.isReviewedAttemptDeleted(peerReview)"\n                                                   class="peer-review-icon unavailable submission-deleted"\n                                                   tooltip-title="::assignedPeerReviews.getTooltipText()">\n              </bb-ui-assigned-peer-grading-tooltip>\n              \x3c!-- peer review otherwise unavailable --\x3e\n              <bb-ui-icon-small-lock ng-if="!assignedPeerReviews.isReviewedAttemptDeleted(peerReview)"\n                                     class="peer-review-icon unavailable">\n              </bb-ui-icon-small-lock>\n            </div>\n            \x3c!-- peer review not started --\x3e\n            <bb-ui-icon-small-unlocked ng-switch-when="NotStarted" class="peer-review-icon not-started"></bb-ui-icon-small-unlocked>\n            \x3c!-- peer review late --\x3e\n            <bb-ui-icon-small-attention ng-switch-when="PastDue"\n                                        class="peer-review-icon past-due"\n                                        ng-class="{draft: assignedPeerReviews.isPeerReviewSaved(peerReview)}">\n            </bb-ui-icon-small-attention>\n            \x3c!-- peer review started--\x3e\n            <bb-ui-icon-small-started ng-switch-when="Started" class="peer-review-icon started"></bb-ui-icon-small-started>\n            \x3c!-- peer review complete --\x3e\n            <bb-ui-icon-small-complete ng-switch-when="Completed" class="peer-review-icon completed"></bb-ui-icon-small-complete>\n          </span>\n          <span ng-if="assignedPeerReviews.isInPeerSubmissionWindow">\n            <bb-ui-icon-small-lock class="peer-review-icon unavailable"></bb-ui-icon-small-lock>\n          </span>\n          <div ng-if="assignedPeerReviews.isPeerReviewDisabled(peerReview)"\n               ng-switch on="assignedPeerReviews.getPeerReviewStatus(peerReview)"\n               class="peer-review-text">\n            <span class="peer-review-number"\n                  bb-translate\n                  translate-values="{peerReviewIndex: {{$index + 1}}}">course.content.assessment.overview.assignedPeerReviews.submissionLabel</span>&nbsp;\n            <span ng-switch-when="NotStarted" class="peer-review-status not-started" bb-translate>course.content.assessment.overview.assignedPeerReviews.start</span>\n            <span ng-switch-when="PastDue" class="peer-review-status past-due" bb-translate>course.content.assessment.overview.pastDue</span>\n            <span ng-switch-default class="peer-review-status unavailable" bb-translate>course.content.assessment.overview.assignedPeerReviews.unavailable</span>\n          </div>\n          <a ng-if="!assignedPeerReviews.isPeerReviewDisabled(peerReview)"\n             class="peer-review-link"\n             ng-class="{disabled: !assignedPeerReviews.isPeerReviewPeriodOpen}"\n             ng-switch on="assignedPeerReviews.getPeerReviewStatus(peerReview)"\n             analytics-id="course.content.assessment.peer.assessment.peer.review.button"\n             ng-click="assignedPeerReviews.navigateToPeerReview($index)"\n             href="javascript:void(0);"\n            >\n            <span class="peer-review-number"\n                  bb-translate\n                  translate-values="{peerReviewIndex: {{$index + 1}}}">course.content.assessment.overview.assignedPeerReviews.submissionLabel</span>&nbsp;\n            \x3c!-- peer review late --\x3e\n            <span ng-switch-when="PastDue">\n              <span class="peer-review-status past-due" bb-translate>course.content.assessment.overview.pastDue</span>\n              <span class="peer-review-status draft"\n                    ng-if="assignedPeerReviews.isPeerReviewSaved(peerReview)"\n                    bb-translate\n                    translate-values="{datetime: peerReview.attemptLastGradedDate}">course.content.assessment.overview.assignedPeerReviews.draft</span>\n            </span>\n            \x3c!-- peer review started--\x3e\n            <span ng-switch-when="Started">\n              <span bb-translate class="peer-review-status started"\n                    ng-if="!assignedPeerReviews.isPeerReviewSaved(peerReview)">course.content.assessment.overview.assignedPeerReviews.started</span>\n              <span bb-translate class="peer-review-status saved"\n                    ng-if="assignedPeerReviews.isPeerReviewSaved(peerReview)"\n                    translate-values="{datetime: peerReview.attemptLastGradedDate}">course.content.assessment.overview.assignedPeerReviews.draft</span>\n            </span>\n            \x3c!-- peer review complete --\x3e\n            <span ng-switch-when="Completed">\n              <span class="peer-review-status completed" ng-class="{\'vertical-bar\' : assignedPeerReviews.isPeerReviewLate(peerReview) }" bb-translate>course.content.assessment.overview.assignedPeerReviews.complete</span>\n              <span ng-if="assignedPeerReviews.isPeerReviewLate(peerReview)" class="peer-review-status late" bb-translate>course.content.assessment.overview.late</span>\n            </span>\n          </a>\n        </div>\n      </li>\n    </ul>\n  </div>\n</div>\n'},ckcj:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("69Wd");const o="ultra.components.directives.bbUiIcon.large.Assignments";Object(n.a)(i.Assignments,o,"bbUiIconLargeAssignments")},cpZm:function(e,t,s){"use strict";var n=s("D57K"),i=s("Llzl"),o=s("ERkP"),a=s("SToD"),r=s("1ZbL"),c=s("tN4z"),l=s("TUnR"),d=s("MC1S"),u=s("uDfI"),p=s("IbyE");const m="ultra.components.services.gradebookListViewTabs",h=e=>{const{onChange:t,value:s,tabs:n,localize:i,analyticsId:a,ftue:r}=e,[m,h]=o.useState(),b=Object(u.useDispatch)(),[g]=Object(l.useShowGuidance)(null==r?void 0:r.componentKey);return o.createElement("div",{className:"gradebook-list-view-tabs"},o.createElement(c.AnalyticsTabs,{onChange:t,value:s,analyticsId:`${a}.gradebook.listViewTabs`},n&&n.map((e=>{const t={analyticsId:`${a}.gradebook.listViewTab.${e.id}`,className:`js-gradebook-tab-${e.id}`,key:e.id,value:e.id,label:i.translate(e.displayKey)};return e.id===(null==r?void 0:r.targetId)&&(t.innerRef=h),o.createElement(c.AnalyticsTab,{...t})}))),g&&m&&o.createElement(l.GuidanceTeachingBubble,{componentKey:r.componentKey,onDismiss:()=>{b(p.actions.userPreference.persistUserPreference({key:r.componentKey,value:"1"}))},targetElement:m,headline:i.translate("components.directives.grade.course-grades-grader.views.studentListViewGuidanceHeader"),calloutProps:{directionalHint:d.DirectionalHint.bottomAutoEdge},analyticsId:`${a}.ftue`},i.translate("components.directives.grade.course-grades-grader.views.studentListViewGuidanceBody"),o.createElement(c.AnalyticsPrimaryButton,{analyticsId:`${a}.gradebook.PrimaryButton`,className:"ftue-action",onClick:()=>{b(p.actions.userPreference.persistUserPreference({key:r.componentKey,value:"1"})),r.action()}},i.translate("components.directives.grade.course-grades-grader.views.studentListViewGuidanceTry"))))};class b extends o.Component{render(){return o.createElement(h,{...this.props})}}const g={Class:Object(a.a)(b),attributes:["analyticsId"],bindingNames:["value","onChange","tabs","ftue"],renderLocalized:!0,withProvider:!0};i.module(m,[]).component("bbUiGradebookListViewTabs",Object(r.a)(g));var v=s("aHpC"),f=s("Y+9S");s.d(t,"c",(function(){return w})),s.d(t,"a",(function(){return S})),s.d(t,"b",(function(){return C}));const w="ultra.components.directives.gradebookListViewTabs",S={id:"assignments",ariaLabel:"components.directives.grade.course-grades-grader.views.gradableItemsListView",displayKey:"components.directives.grade.course-grades-grader.views.gradableItemsListViewTabLabel"},C={id:"students",ariaLabel:"components.directives.grade.course-grades-grader.views.studentListView",displayKey:"components.directives.grade.course-grades-grader.views.studentListViewTabLabel"},y=[S,C],O="students";let A=class{constructor(e){this.scope=e,this.onTabChange=(e,t)=>{const s=this.tabs.find((e=>e.id===t));Object(f.notifyMobileApp)(t===C.id?f.MessageType.StudentsTabOpened:f.MessageType.GradableItemTabOpened),this.scope.onTabChanged&&this.scope.onTabChanged(s.id),this.scope.$apply()},this.tabs=y,this.ftue={componentKey:"ftue.grades.grader.studentlistview",targetId:O,action:()=>{this.scope.onTabChanged(O)}}}};A=Object(n.__decorate)([Object(n.__param)(0,Object(v.b)("scope"))],A);let I=class{constructor(e){this.$injector=e,this.restrict="E",this.template='<bb-ui-gradebook-list-view-tabs\n                            value="gradebookListViewTabs.scope.selectedTab"\n                            on-change="gradebookListViewTabs.onTabChange"\n                            tabs="gradebookListViewTabs.tabs"\n                            ftue="gradebookListViewTabs.ftue">\n                      </bb-ui-gradebook-list-view-tabs>',this.scope={onTabChanged:"<?",selectedTab:"="},this.link=e=>{e.gradebookListViewTabs=this.$injector.instantiate(A,{scope:e})}}};I=Object(n.__decorate)([Object(n.__param)(0,Object(v.b)("$injector"))],I),angular.module(w,[m]).directive("bbGradebookListViewTabs",["$injector",e=>e.instantiate(I)])},dCrD:function(e,t,s){"use strict";s.d(t,"a",(function(){return I}));var n=s("D57K"),i=s("nbDY"),o=s.n(i),a=s("Oyr+"),r=s("0JpG"),c=s("RPq7"),l=s("Qbdf"),d=s("nYZ0"),u=s("Vsv2"),p=s("jx5I"),m=s("A+IJ"),h=s("+4Px"),b=s("pjml"),g=s("3Jgm"),v=s("e6jQ"),f=s("lEL+"),w=s("TnpK"),S=s("PoQW"),C=s("aHpC"),y=s("zGdY"),O=s("Y+9S");class A extends o.a{}A.Unzip=new A("Unzip"),A.Website=new A("Website"),A.Default=new A("Default");let I=class{constructor(e,t,s){this.scope=t,this.element=s,this.alwaysShow=!1,this.isButtonVisible=!1,this.isMobile=!1,this.isUploadMultipleFiles=!1,this.removeDefaultRenderClass=!1,this.uuid=Object(v.b)(),this.downloadFile=e=>{this.scope.$broadcast("downloadFile",e,this.positionForFiles)},this.defaultAttachHandler=(e,t,s,n,i)=>{const o=n||this.$q.defer();let a={parentId:void 0,positionBefore:"start",positionAfter:void 0,depth:0};return this.isUploadMultipleFiles=s,this.insertLocation=i||this.getInsertLocationData(),a=t.ui&&t.ui.parentId?{parentId:t.ui.parentId,positionBefore:t.ui.positionBefore,positionAfter:t.ui.positionAfter,depth:t.ui.depth}:this.insertLocation,"folder"===t.type?(this.closeMenu(),!t.ui||t.ui.depth<=m.l?this._addFolderToCourseOutline(t,a).then((e=>{t.ui={parentId:e.id,positionBefore:"start",depth:1+Number(e.depth)},o.resolve(t)}),(e=>{o.reject(e)})):o.resolve()):this._addContentToCourseOutline(t,e,a).then((e=>{const s=null==i?void 0:i.positionAfter;this.scope.$root.$broadcast("uploadComplete",t,s),e.$save().$then((s=>{t.ui&&t.ui.needUnzip&&(e=s),o.resolve()}))})),o.promise},this.toggleAddContentMenu=()=>{this.isEmptyFolder()?this.scope.$emit("toggle-folder-by-id",this.scope.content.id):this.isMenuVisible=!this.isMenuVisible,this.timeout((()=>{this.scope.$apply()}),this.scope)},this.hideAddContentMenu=e=>{null===e.target.closest(`#${this.getButtonWrapperId()}`)&&(this.isMenuVisible=!1,this.timeout((()=>{this.scope.$apply()}),this.scope))},this.$q=e.get("$q"),this.$rootScope=e.get("$rootScope"),this.bbLocalize=e.get(r.serviceName),this.cloudDriveService=e.get(u.b),this.fileUploadSettingsService=e.get(p.b),this.timeout=e.get(f.b),this.contentSvc=e.get(d.f),this.CourseModel=e.get(b.m.serviceName),this.PartnerService=e.get(g.b),this.ultraState=e.get(w.d),this.contextCourse=e.get(l.e),this.scope.addMenuId=v.a(),this.showMenuOverride=this.scope.showMenuOverride,this.alwaysShow=this.scope.alwaysShow,this.currentCourse=this.contextCourse.course,this.isCloudServiceAvailablePromise=this.cloudDriveService.isCloudServiceAvailable().then((e=>this.isCloudServiceAvailable=e)),this.bbLocalize.loadBundle("components/directives/add-content-button").then((()=>{let e="content";this.scope.itemIndex&&null!=this.scope.itemIndex()?e="item-index":"grades"===this.scope.contextArea?e="grades":"course-group"===this.scope.contextArea?e="group":"bbml-editor-single-file"===this.scope.contextArea&&(this.scope.addContentButton.isMenuVisible=!0),this.isMenuVisible=!1,this.addButtonAriaLabel=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button.aria-label."+e+".add-button-label"});const t="components.directives.add-content-button.aria-label.content."+(this.isMobile?"yourDevice":"yourComputer");if(this.uploadAriaLabel=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:t}),this.scope.itemName||this.scope.itemType){const t=t=>{const[s,n,i]=t;if(s||n){const t=n?n+"-":"",o=this.scope.positionAfter?"after":"before";this.addButtonAriaLabel=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button.aria-label."+e+".add-button-label-item-name-"+t+o,params:{itemName:s,itemIndex:i},noWrap:!0,noEscape:!0})}};this.scope.$watchGroup(["itemName()","itemType()","itemIndex()"],t)}})),s.mouseover((()=>{this.$rootScope.$broadcast("mouseover-add-content-button"),this.scope.$apply((()=>{this.scope.addContentButton.showButton()}))})),this.scope.$on("close-all-add-menus",(()=>{this.showMenuOverride?this.isEmptyFolder()&&this.scope.content.ui.isOpen&&(this.scope.addContentButton.isMenuVisible=!0):this.scope.addContentButton.isMenuVisible=!1})),this.scope.showBothButtons&&this.scope.showBothButtons()||this.scope.$on("mouseover-add-content-button",(()=>{this.scope.addContentButton.hideButton()})),this.scope.$on("content-item-hover",((e,t)=>{this.scope.addContentButton.hideButton();const n=()=>{let e;return e=s.closest(".folder-contents").find("bb-add-content-button").first().is(s)?s.closest(".folder-contents").find(".js-content-div .element-list-row").first():s.closest(".js-content-div").next(".js-content-div").find(".element-list-row").first(),e.hasClass("element-list-row")||(e=s.next().find(".js-content-div").first().find(".element-list-row")),!!e.is(t.element)&&this.scope.addContentButton.showButton()},i=()=>{let e=!1;s.closest(".js-content-div").find(".element-list-row").first().is(t.element)&&(e=!0),s.closest(".folder").is(t.element.parent(".folder"))&&(e=!1),t.element.hasClass("js-parent")&&t.element.hasClass("open")&&(e=!1),this.scope.addContentButton.isButtonVisible!==e&&(this.scope.addContentButton.isButtonVisible=e)};this.scope.showBothButtons&&this.scope.showBothButtons()?n()||i():t.relativeMousePosition.isEqualTo(c.a.Top)?n():i()})),this.scope.$on("content-outline-hover-end",(()=>{this.scope.addContentButton.hideButton()})),this.scope.$watch("alwaysShow",(e=>{this.alwaysShow=e})),s.on("drop",(e=>{this.closeMenu(),this.scope.$emit(a.e,this.scope.parentId(),this.scope.positionBefore&&this.scope.positionBefore(),this.scope.positionAfter&&this.scope.positionAfter(),this.scope.depth(),void 0,this.scope.content,a.c.AssignDropTarget)})),this.scope.$on("$stateChangeStart",(()=>{this.ultraState.includes("**.content-manage.import.**")?this.isMenuVisible=this.isEmptyFolder():this.isEmptyFolder()?this.isMenuVisible=!0:this.isMenuVisible=!1,this.timeout((()=>{this.scope.$apply()}),this.scope)})),this.scope.$on(a.b,(()=>{this.closeMenu()})),this.isMenuVisible=this.scope.showMenuOverride,null!=this.scope.showMenuOverride&&this.scope.$watch((()=>this.scope.showMenuOverride),(e=>{this.scope.addContentButton.isMenuVisible=e,this.showMenuOverride=e})),this.getInsertLocationData()}onKeydown(e){e.keyCode===h.g&&this.isMenuVisible&&(this.closeMenu(),this.element.find("a.js-show-add-options").focus(),e.stopPropagation(),e.preventDefault())}showButton(){this.isButtonVisible=!0}hideButton(){this.isButtonVisible=!1}turnOffAlwaysShow(){this.alwaysShow=!1}toggleMenu(){if(this.showMenuOverride)this.showMenuOverride&&this.isEmptyFolder()&&this.scope.$emit("toggle-folder-by-id",this.scope.content.id);else{const e=this.isMenuVisible;e||this.$rootScope.$broadcast("close-all-add-menus"),this.isMenuVisible||this.timeout((()=>{this.element.scrollintoview({duration:250})}),this.scope,0,!1),this.isMenuVisible=!e}}isForceShowAddButton(){return this.scope.forceShowAddButton}closeMenu(){this.isMenuVisible&&this.toggleMenu()}getInsertLocationData(){return this.insertLocation={parentId:this.scope.parentId(),positionBefore:this.scope.positionBefore&&this.scope.positionBefore(),positionAfter:this.scope.positionAfter&&this.scope.positionAfter(),depth:this.scope.depth(),contentId:"create"}}assignPosition(){Object(O.notifyMobileApp)(O.MessageType.CloudStorageOpened),this.closeMenu(),this.scope.$emit("bb-bbml-editor-assign-position",this.getInsertLocationData())}_addFolderToCourseOutline(e,t){return this.contentSvc.makeContentInContentTree(this.scope.rootContent&&this.scope.rootContent(),this.contextCourse.courseId,t.parentId,t.positionBefore,t.positionAfter,!0).then((s=>{const n=s.content;return n.parentId=t.parentId,n.positionBefore=t.positionBefore,n.positionAfter=t.positionAfter,n.isAvailable=!1,n.depth=t.depth,n.description="",n.title=e.name,n.contentDetail={"resource/x-bb-folder":{isFolder:!0}},n.courseId=this.contextCourse.courseId,n.contentHandler=b.p.ContentHandler.Folder,n.$save().$asPromise()}))}_addContentToCourseOutline(e,t,s){return this.contentSvc.makeContentInContentTree(this.scope.rootContent&&this.scope.rootContent(),this.contextCourse.courseId,s.parentId,s.positionBefore,s.positionAfter,!0).then((e=>e.content)).then((n=>(n.parentId=s.parentId,n.positionBefore=s.positionBefore,n.positionAfter=s.positionAfter,n.isAvailable=!1,n.depth=s.depth,n.description="",n.title=t.fileName,n.contentHandler=b.p.ContentHandler.File,n.contentDetail={"resource/x-bb-file":{file:{fileName:t.fileName,fileLocation:t.fileLocation},fileAssociationMode:y.FileAssociationMode.Embed}},e.ui&&e.ui.needUnzip&&(n.contentDetail["resource/x-bb-file"].action=A.Unzip.toString()),n.courseId=this.contextCourse.courseId,n.$asPromise())))}getTargetId(){return`addContentButton-${this.uuid}`}getButtonWrapperId(){return`addContentButtonWrapper-${this.uuid}`}getDirectionalHint(){return S.DirectionalHint.bottomCenter}isEmptyFolder(){const{content:e,folderNestedButton:t}=this.scope;return!!(e&&e.isFolder()&&e.children&&0===e.children.length&&t&&t())}};I=Object(n.__decorate)([Object(n.__param)(0,Object(C.b)("$injector")),Object(n.__param)(1,Object(C.b)("scope")),Object(n.__param)(2,Object(C.b)("element"))],I)},dEnf:function(e,t){e.exports='<div class="question-answer-container">\n  <bb-rich-text-editor\n    ng-model="assessmentQuestion.questionAttempt.question.questionText.rawText"\n    is-read-only="true"\n    supports-inline-document-render="true"\n    plugin-options="editorPluginOptions">\n  </bb-rich-text-editor>\n</div>\n'},dF44:function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"e",(function(){return i})),s.d(t,"a",(function(){return o})),s.d(t,"d",(function(){return a})),s.d(t,"c",(function(){return r}));const n={CELL_FOCUSED:"rb_grid_cell_focused",COLUMN:"rb_grid_column",DATA_UPDATE:"rb_grid_data_update",ENTER_CELL:"rb_grid_enter_cell",ENTER_NEXT_CELL:"rb_grid_enter_next_cell",FOCUS_CELL:"rb_grid_focus_cell",LEAVE_CELL:"rb_grid_leave_cell",LEAVE_GRID:"rb_grid_leave_grid",ROW:"rb_grid_row",SCROLL_H:"rb_grid_scroll_h",SCROLL_V:"rb_grid_scroll_v"},i=2,o=2,a=50,r=50},"dL5/":function(e,t){e.exports='<span class="group-count-directive" bb-load-bundle="components/directives/group/group-count">\n  <bb-translate translate-values="{number: $ctrl.content.assignedGroups.length}"\n                ng-if="!$ctrl.isSelfEnrollment()">components.directives.group-count.groups.plural</bb-translate>\n  <bb-translate translate-values="{number: $ctrl.content.assignedGroups.length}"\n                ng-if="$ctrl.isSelfEnrollment()">components.directives.group-count.groups.selfEnroll.plural</bb-translate>\n</span>\n'},dcnw:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-grade",use:"icon-medium-grade-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-grade"><path d="M21 11V1H3v22h8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M17.5 12l1.2348 3.8004h3.996l-3.2328 2.3488 1.2348 3.8004L17.5 19.6008l-3.2328 2.3488 1.2348-3.8004-3.2328-2.3488h3.996L17.5 12zM7 5h8M7 9h10M7 13h3M7 17h2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},dd1C:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return c}));s("zAxy"),s("10QP");var n=s("Llzl"),i=s("0JpG"),o=s("e6jQ"),a=s("GbAM"),r=s("3mUc");const c="ultra.components.directives.grade.inlineValidation";class l{constructor(t,s,n,i,a){this.scope=t,this.element=s,this.attrs=n,this.$compile=i,this.bbLocalize=a,this.scope.$on("$destroy",(()=>{this.element.off(),this.element=null,e(`#${this.scope.tooltipId}`).remove()}));const r=o.a();t.tooltipId=`inline-validation-tooltip-${r}`,t.alertTextId=`inline-validation-alert-text-${r}`,this.updateErrorMessage(),this.scope.focusableElement=this.element.find(":tabbable, input:enabled"),this.setupEventHandlers(),t.$watch((()=>this.scope.focusableElement.val()),(e=>{null!=e&&this.checkErrors()})),t.$watch((()=>this.scope.showError()),(e=>{this.checkErrors()})),t.$watch("errorMessage",(e=>this.updateErrorMessage()))}tooltipExists(){return 0!==e(`#${this.scope.tooltipId}`).length}updateErrorMessage(){this.scope.errorMessage?this.scope.errorMessageRefined=this.scope.errorMessage:this.bbLocalize.loadBundle("components/directives/grade/inline-validation").then((()=>{this.scope.errorMessageRefined=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.inline-validation.default"})}))}checkErrors(){this.scope.showError()?this.showErrorTip():this.hideErrorTip()}setupEventHandlers(){this.scope.focusableElement.on("focus",(()=>{this.checkErrors()})).on("blur",(()=>{this.hideErrorTip()})),this.scope.$on("bb-inline-validation-check",(()=>{this.checkErrors()}))}showErrorTip(){if(this.scope.focusableElement[0]===document.activeElement){this.tooltipExists()||e("body").append(this.$compile(`\n          <div id="${this.scope.tooltipId}"\n            class="tooltip inline-validation f-dropdown content inline-validation-tooltip">\n            <span class="validation-message" ng-bind="errorMessageRefined" aria-role="text"></span>\n            <span class="nub"></span>\n          </div>\n        `)(this.scope));const t=this.element.children().first(),s=e(`#${this.scope.tooltipId}`);window.Foundation.libs.tooltip.reposition(t,s,t.attr("class")),s.show(),this.scope.$root.$broadcast(a.a,this.scope.errorMessageRefined)}}hideErrorTip(){e(`#${this.scope.tooltipId}`).hide()}}l.$inject=["scope","element","attrs","$compile",i.serviceName];class d{constructor(e){this.$injector=e,this.restrict="E",this.transclude=!0,this.template=r,this.scope={showError:"&",errorMessage:"@"},this.link=(e,t,s,n)=>{e.inlineValidation=this.$injector.instantiate(l,{scope:e,element:t,attrs:s})}}}d.$inject=["$injector"],n.module(c,[i.moduleName]).directive("bbInlineValidation",["$injector",e=>e.instantiate(d)])}).call(this,s("71td"))},"dha+":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("13AT");const o="ultra.components.directives.bbUiIcon.large.Lti";Object(n.a)(i.Lti,o,"bbUiIconLargeLti")},dkOF:function(e,t,s){},dpCN:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-attempts",use:"icon-medium-attempts-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-attempts"><rect x="1" y="4" width="19" height="19" rx="2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M20 20h1c1.1046 0 2-.8954 2-2V3c0-1.1046-.8954-2-2-2H6c-1.1046 0-2 .8954-2 2v1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M5 14l4 4 7-8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},e0uO:function(e,t,s){"use strict";var n=s("nbDY"),i=s.n(n);class o extends i.a{}o.QuestionReview=new o("QuestionReview"),o.AttemptAuthoring=new o("AttemptAuthoring"),o.AttemptGrading=new o("AttemptGrading"),o.AttemptReview=new o("AttemptReview"),t.a=o},e6qG:function(e,t,s){"use strict";var n=s("Llzl"),i=s("YHe3"),o=s("D57K"),a=s("DYK3"),r=s("FHk9"),c=s("vYaK"),l=s("X/qj"),d=s("0JpG"),u=s("lEL+"),p=s("TnpK"),m=s("Qbdf"),h=s("Fvsw"),b=s("Ed3w"),g=s("X8JP"),v=s("vhkR"),f=s("ERsv"),w=s("zGdY"),S=s("aHpC"),C=s("cs5G"),y=s("ohO4"),O=s("jx5I"),A=s("5dtR"),I=s("iJ4p"),D=s("7b1Y");class k extends a.a{createQuestion(e,t,s){const n=super.createQuestion(e,t,s);return n.questionType=w.QuestionType.Essay,n.isShortAnswer=!0,n}getAttemptAuthoringHandler(e,t,s){return this.$injector.instantiate(_,{attrs:s,element:t,scope:e})}getAttemptGradingHandler(e,t,s){return this.$injector.instantiate(j,{attrs:s,element:t,scope:e})}getAttemptReviewHandler(e,t,s){return this.$injector.instantiate(T,{attrs:s,element:t,scope:e})}}let _=class extends a.e{constructor(e,t,s,n,i,o,a,c,l,d,u,p){if(super(e,t,n,i,o,a,c,l,d,u),this.$compile=e,this.$window=t,this.$q=s,this.attrs=n,this.CourseModel=i,this.element=o,this.gradebookPermissionService=a,this.localizeService=c,this.scope=l,this.timeout=d,this.ultraState=u,this.proctoringService=p,this.isInitializing=!0,this.isSaving=!1,this.isNewAttachmentSaving=!1,this.isDisabled=!1,this.onBbRichTextEditorChange=e=>{this.toBbML=e},this.isEditorActive=!1,this.toBbML=Object(f.generateToBbML)(l.questionAttempt.givenAnswer.rawText),this.pluginOptions=p.getSecureBbEditorOptions({attachment:!0,image:!0,math:!0,video:!0,contentMarket:!0}),!l.questionAttempt)throw new Error("Question attempt must be provided in attempt authoring mode.");this.insertQuestionSpecificTemplate(A),this.scope.questionTextEditorOptions={deleteOnNoText:!1,focusOnInit:!1,maintainOriginalTextOnRefresh:!0,onChangeFunc:()=>this.scope.$broadcast(r.EVENT_BBML_EDITOR_FORCE_UPDATE),placeholderKey:"components.directives.assessment-question.essay.placeholder.attempt",saveOnBlur:()=>!0,showCancelButton:()=>!1,showDeleteButton:()=>!1,showEditButton:()=>!1,showSaveButton:()=>!1,watchReadonly:"true"}}onEditorBlur(){this.isEditorActive=!1}onNewAttachmentSaving(){this.isNewAttachmentSaving=!0}onEditorFocus(){this.isInitializing=!1,this.isEditorActive=!0}initializeGivenAnswer(){const e=this.scope.$watch("questionAttempt.givenAnswer",(t=>{this.givenAnswer||(this.givenAnswer=t,e())}));this.scope.$watch("assessmentQuestion.givenAnswer.rawText",(e=>{"string"==typeof e&&(this.isInitializing?this.isInitializing=!1:this.scope.questionAttempt.givenAnswer.rawText=e)}))}persist(){return this.attemptIsDirty&&!this.isSaving?this.$q.when(this.toBbML(!0)).then((e=>(this.scope.questionAttempt.givenAnswer.rawText=e,super.persist()))):this.$q.resolve(null)}validate(){return!0}prepareGivenAnswer(e){this.isNewAttachmentSaving&&(this.isDisabled=!0),this.isSaving=!0}onPersistFinished(){super.onPersistFinished(),this.isSaving=!1,this.isDisabled=!1}setDirtyAndUpdateGivenAnswer(e){return this.isNewAttachmentSaving?(this.givenAnswer=e.givenAnswer,this.attemptIsDirty=!1,this.isNewAttachmentSaving=!1):this.attemptIsDirty=e.givenAnswer.rawText!==this.givenAnswer.rawText,e}};_.$inject=[],_=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$window")),Object(o.__param)(2,Object(S.b)("$q")),Object(o.__param)(3,Object(S.b)("attrs")),Object(o.__param)(4,Object(S.b)(c.serviceName)),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)(d.serviceName)),Object(o.__param)(8,Object(S.b)("scope")),Object(o.__param)(9,Object(S.b)(u.b)),Object(o.__param)(10,Object(S.b)(p.d)),Object(o.__param)(11,Object(S.b)(i.b))],_);let j=class extends a.f{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v){if(super(e,t,s,n,i,o,a,r,c,l,d,m,u,p,h,b,g,v),this.$compile=e,this.$sce=t,this.$window=s,this.attrs=n,this.element=i,this.gradebookPermissionService=o,this.scope=a,this.timeout=r,this.localizeService=c,this.contextCourse=l,this.$ngRedux=d,this.ltiService=u,this.CloudStorageIntegrationModalService=p,this.scheduleTask=m,this.contextService=h,this.allyService=b,this.featureFlagService=g,this.fileUploadSettingsService=v,!a.gradedQuestionAttempt)throw new Error("Graded Question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(I),this.constructViewHelper()}constructViewHelper(){}};j.$inject=[],j=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$sce")),Object(o.__param)(2,Object(S.b)("$window")),Object(o.__param)(3,Object(S.b)("attrs")),Object(o.__param)(4,Object(S.b)("element")),Object(o.__param)(5,Object(S.b)(l.b)),Object(o.__param)(6,Object(S.b)("scope")),Object(o.__param)(7,Object(S.b)(u.b)),Object(o.__param)(8,Object(S.b)(d.serviceName)),Object(o.__param)(9,Object(S.b)(m.e)),Object(o.__param)(10,Object(S.b)("$ngRedux")),Object(o.__param)(11,Object(S.b)(v.b)),Object(o.__param)(12,Object(S.b)(g.b)),Object(o.__param)(13,Object(S.b)(b.c)),Object(o.__param)(14,Object(S.b)(h.b)),Object(o.__param)(15,Object(S.b)(C.b)),Object(o.__param)(16,Object(S.b)(y.b)),Object(o.__param)(17,Object(S.b)(O.b))],j);let T=class extends a.g{constructor(e,t,s,n,i,o,a,r,c,l){if(super(e,t,s,n,i,o,r,c,l,a),this.$compile=e,this.$sce=t,this.$window=s,this.attrs=n,this.element=i,this.gradebookPermissionService=o,this.localizeService=a,this.scope=r,this.timeout=c,this.ultraState=l,!r.gradedQuestionAttempt)throw new Error("Graded question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(D)}};T.$inject=[],T=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$sce")),Object(o.__param)(2,Object(S.b)("$window")),Object(o.__param)(3,Object(S.b)("attrs")),Object(o.__param)(4,Object(S.b)("element")),Object(o.__param)(5,Object(S.b)(l.b)),Object(o.__param)(6,Object(S.b)(d.serviceName)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(p.d))],T);var $=s("nsO7"),R=s("g66W");class E{constructor(e,t,s){this.scope=e,this.localizeService=t,this.questionAttempt=s,this.orderedIdentifiers=[],this.translatedIdentifiers=new Map,this.questionTextElement=document.createElement("div");let n=this.questionAttempt.question.questionText.rawText;this.questionTextElement.innerHTML=n,this.answerElements.forEach((e=>{const t=e.innerHTML,i=R.a(t,/(^\[|]$)/g),o=this.translateIdentifier(i);if(i in s.givenAnswers){this.orderedIdentifiers.push(i),this.translatedIdentifiers.set(i,o);const s=this.questionAttempt.givenAnswers[i];e.innerHTML=s||o,n=n.replace(t,s||o)}})),this.questionText=n}translateIdentifier(e){const t=e.split("-")[1];return this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"assessments.canvas.question.fimb.blank",params:{count:t},noEscape:!1,noWrap:!0})}get answerElements(){return Array.from(this.questionTextElement.querySelectorAll("a[data-bbfile]")).filter((e=>-1!==e.dataset.bbfile.indexOf("fimb-answer-value")&&0!==e.innerHTML.trim().length))}}let x=class extends E{constructor(e,t,s){super(e,t,s),this.scope=e,this.localizeService=t,this.questionAttempt=s}replaceAnswerInQuestionTextWithText(e,t){const s=this.answerElements;if(null==t||""===t){const t=this.orderedIdentifiers[e],n=this.translatedIdentifiers.get(t);s[e].innerHTML=n}else $.unescape(s[e].innerHTML)!==t&&(s[e].innerHTML=$.escape(t));this.questionText=this.questionTextElement.innerHTML}shouldShowFTUEOnAnswer(e){return 0===this.questionAttempt.question.ui.questionTypePosition&&(1===e||1===this.orderedIdentifiers.length)}};x=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("scope")),Object(o.__param)(1,Object(S.b)(d.serviceName)),Object(o.__param)(2,Object(S.b)("questionAttempt"))],x);let P=class extends E{constructor(e,t,s,n,i){super(e,t,s.questionAttempt),this.scope=e,this.localizeService=t,this.gradedQuestionAttempt=s,this.showAnswerCorrectness=n,this.isCorrect=i,this.answersMap={};(this.questionAttempt.question.answers||[]).forEach((e=>{this.answersMap[e.ident]={values:e.answerValues.map((e=>e.value)),evaluationType:e.answerValues[0].evaluationType,caseSensitive:e.answerValues[0].caseSensitive}})),null!=this.questionAttempt.answerCorrectness?(this.answerElements.forEach(((e,t)=>{const s=e.dataset.bbfile,i=s.indexOf("fimb-answer-value"),o=this.orderedIdentifiers[t];if(n){const t=this.questionAttempt.answerCorrectness[o]?"correct":"incorrect";e.dataset.bbfile=`${s.slice(0,i)} ${t} ${s.slice(i)}`}})),this.questionText=this.questionTextElement.innerHTML):!this.showAnswerCorrectness&&this.isCorrect&&(this.answerElements.forEach((e=>{const t=e.dataset.bbfile,s=t.indexOf("fimb-answer-value");if(n){const n="correct";e.dataset.bbfile=`${t.slice(0,s)} ${n} ${t.slice(s)}`}})),this.questionText=this.questionTextElement.innerHTML)}alignIconTop(){return this.orderedIdentifiers.length>1||this.answersMap[this.orderedIdentifiers[0]]&&this.answersMap[this.orderedIdentifiers[0]].evaluationType!==w.FIMBAnswerEvaluationType.Matches}showDetailsForAnswer(e){const t=this.answersMap[e];return null!=t&&(t.evaluationType===w.FIMBAnswerEvaluationType.Exact||t.evaluationType===w.FIMBAnswerEvaluationType.Contains)}};P=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("scope")),Object(o.__param)(1,Object(S.b)(d.serviceName)),Object(o.__param)(2,Object(S.b)("gradedQuestionAttempt")),Object(o.__param)(3,Object(S.b)("showAnswerCorrectness")),Object(o.__param)(4,Object(S.b)("isCorrect"))],P);var L=s("/UyG"),G=s("7TUR");class M extends a.a{createQuestion(e,t,s){const n=super.createQuestion(e,t,s);return n.questionType=w.QuestionType.FIMB,n}getAttemptAuthoringHandler(e,t,s){return this.$injector.instantiate(F,{attrs:s,element:t,scope:e})}getAttemptGradingHandler(e,t,s){return this.$injector.instantiate(B,{attrs:s,element:t,scope:e})}getAttemptReviewHandler(e,t,s){return this.$injector.instantiate(q,{attrs:s,element:t,scope:e})}}function N(e){const t=e;for(const s in e)null!=e[s]&&(t[s]=$.unescape(e[s]));return t}let F=class extends a.e{constructor(e,t,s,n,i,o,a,r,c,l,d){if(super(e,s,n,i,o,a,r,c,l,d),this.$compile=e,this.$injector=t,this.$window=s,this.attrs=n,this.CourseModel=i,this.element=o,this.gradebookPermissionService=a,this.localizeService=r,this.scope=c,this.timeout=l,this.ultraState=d,!c.questionAttempt)throw new Error("Question attempt must be provided in attempt authoring mode.");this.insertQuestionSpecificTemplate(L),this.viewHelper=t.instantiate(x,{questionAttempt:this.scope.questionAttempt,scope:c})}initializeGivenAnswer(){this.scope.questionAttempt.givenAnswers=N(this.scope.questionAttempt.givenAnswers),this.givenAnswer=this.scope.questionAttempt.givenAnswers,this.scope.$watchCollection("assessmentQuestion.givenAnswer",(()=>{this.scope.questionAttempt.givenAnswers=this.givenAnswer}))}prepareGivenAnswer(e){e.givenAnswers=$.mapValues(e.givenAnswers,(e=>null==e?"":e))}setDirtyAndUpdateGivenAnswer(e){return this.attemptIsDirty=!$.isEqual(e.givenAnswers,this.givenAnswer),e.givenAnswers=this.givenAnswer,e}};F.$inject=[],F=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$window")),Object(o.__param)(3,Object(S.b)("attrs")),Object(o.__param)(4,Object(S.b)(c.serviceName)),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)(d.serviceName)),Object(o.__param)(8,Object(S.b)("scope")),Object(o.__param)(9,Object(S.b)(u.b)),Object(o.__param)(10,Object(S.b)(p.d))],F);let B=class extends a.f{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v,f){if(super(e,s,n,i,o,a,r,c,l,d,u,h,p,m,b,g,v,f),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.scope=r,this.timeout=c,this.localizeService=l,this.contextCourse=d,this.$ngRedux=u,this.ltiService=p,this.CloudStorageIntegrationModalService=m,this.scheduleTask=h,this.contextService=b,this.allyService=g,this.featureFlagService=v,this.fileUploadSettingsService=f,!r.gradedQuestionAttempt)throw new Error("Graded question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(G),this.constructViewHelper()}constructViewHelper(){this.questionAttempt.givenAnswers=N(this.questionAttempt.givenAnswers),this.viewHelper=this.$injector.instantiate(P,{gradedQuestionAttempt:this.scope.gradedQuestionAttempt,showAnswerCorrectness:this.canShowCorrectAnswerRelatedDetail(),isCorrect:this.isCorrect(),scope:this.scope})}};B.$inject=[],B=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(d.serviceName)),Object(o.__param)(10,Object(S.b)(m.e)),Object(o.__param)(11,Object(S.b)("$ngRedux")),Object(o.__param)(12,Object(S.b)(v.b)),Object(o.__param)(13,Object(S.b)(g.b)),Object(o.__param)(14,Object(S.b)(b.c)),Object(o.__param)(15,Object(S.b)(h.b)),Object(o.__param)(16,Object(S.b)(C.b)),Object(o.__param)(17,Object(S.b)(y.b)),Object(o.__param)(18,Object(S.b)(O.b))],B);let q=class extends a.g{constructor(e,t,s,n,i,o,a,r,c,l,d){if(super(e,s,n,i,o,a,c,l,d,r),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.localizeService=r,this.scope=c,this.timeout=l,this.ultraState=d,!c.gradedQuestionAttempt)throw new Error("Question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(G),this.questionAttempt.givenAnswers=N(this.questionAttempt.givenAnswers),this.viewHelper=t.instantiate(P,{gradedQuestionAttempt:this.scope.gradedQuestionAttempt,showAnswerCorrectness:this.canShowCorrectAnswerRelatedDetail(),isCorrect:this.isCorrect(),scope:this.scope})}};q.$inject=[],q=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)(d.serviceName)),Object(o.__param)(8,Object(S.b)("scope")),Object(o.__param)(9,Object(S.b)(u.b)),Object(o.__param)(10,Object(S.b)(p.d))],q);class z{constructor(e,t,s){this.scope=e,this.questionAttempt=t,this.bbLocalize=s,this.attempt=this.scope.attempt,this.prepareQuestionText()}prepareQuestionText(){let e=this.questionAttempt.question.questionText.rawText;Object.keys(this.questionAttempt.question.variableValues).forEach((t=>{const s=new RegExp(`\\[${t}\\]`,"g");e=e.replace(s,`${this.questionAttempt.question.variableValues[t]}`)})),this.questionTextWithVariableValues=e}getCorrectAnswerText(){return this.bbLocalize.translateSync({key:"components.directives.assessment-question.calculated-formula.review.correctAnswer",locale:this.bbLocalize.getLocale(this.scope),noEscape:!0,params:{correctAnswer:this.questionAttempt.correctAnswer}})}getRoundingInstructionsKey(){return`components.directives.assessment-question.calculated-formula.roundingInstructions.${this.questionAttempt.question.correctAnswerPrecision===w.CalculatedFormulaAnswerPrecisionType.Decimal?"decimal":"significantFigures"}.plural`}}z.$inject=["scope","questionAttempt",d.serviceName];var U=s("5O3l"),V=s("UQC1"),H=s("a6r6"),Q=s("IbyE");class K extends a.a{createQuestion(e,t,s){const n=super.createQuestion(e,t,s);return n.questionType=w.QuestionType.CalculatedFormula,n}getAttemptAuthoringHandler(e,t,s){return this.$injector.instantiate(W,{attrs:s,element:t,scope:e})}getAttemptGradingHandler(e,t,s){return this.$injector.instantiate(J,{attrs:s,element:t,scope:e})}getAttemptReviewHandler(e,t,s){return this.$injector.instantiate(Y,{attrs:s,element:t,scope:e})}}let W=class extends a.e{constructor(e,t,s,n,i,o,a,r,c,l,d,u){if(super(e,n,i,o,a,r,c,l,d,u),this.$compile=e,this.$q=t,this.$injector=s,this.$window=n,this.attrs=i,this.CourseModel=o,this.element=a,this.gradebookPermissionService=r,this.localizeService=c,this.scope=l,this.timeout=d,this.ultraState=u,this.isInitializing=!0,!l.questionAttempt)throw new Error("Question attempt must be provided in attempt authoring mode.");this.insertQuestionSpecificTemplate(U),this.constructViewHelper()}constructViewHelper(){const e={questionAttempt:this.scope.questionAttempt,scope:this.scope},t=this.$injector.instantiate(z,e);this.viewHelper=t,this.convertMathToImage()}initializeGivenAnswer(){const e=this.scope.$watch("questionAttempt.givenAnswer",(t=>{this.givenAnswer||(this.givenAnswer=t,e())}));this.scope.$watch("assessmentQuestion.givenAnswer",(e=>{"string"==typeof e&&(this.isInitializing?this.isInitializing=!1:this.scope.questionAttempt.givenAnswer=e)}))}setDirtyAndUpdateGivenAnswer(e){return this.attemptIsDirty=e.givenAnswer!==this.givenAnswer,this.attemptIsDirty&&(e.givenAnswer=this.givenAnswer),e}persist(){return this.attemptIsDirty?super.persist():this.$q.resolve(null)}convertMathToImage(){new H.WirisPluginsService({...Q.config,locale:this.localizeService.getLocale(this.scope)}).getImageMetadataFromMathML(this.scope.questionAttempt.question.answerFormula).then((({src:e,alt:t})=>{this.imageSource=e,this.imageAltText=t}))}};W.$inject=[],W=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$q")),Object(o.__param)(2,Object(S.b)("$injector")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)(c.serviceName)),Object(o.__param)(6,Object(S.b)("element")),Object(o.__param)(7,Object(S.b)(l.b)),Object(o.__param)(8,Object(S.b)(d.serviceName)),Object(o.__param)(9,Object(S.b)("scope")),Object(o.__param)(10,Object(S.b)(u.b)),Object(o.__param)(11,Object(S.b)(p.d))],W);let J=class extends a.f{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v,f){if(super(e,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v,f),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.scope=r,this.timeout=c,this.localizeService=l,this.contextCourse=d,this.$ngRedux=u,this.scheduleTask=p,this.ltiService=m,this.CloudStorageIntegrationModalService=h,this.contextService=b,this.allyService=g,this.featureFlagService=v,this.fileUploadSettingsService=f,!r.gradedQuestionAttempt)throw new Error("Graded question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(V),this.constructViewHelper()}constructViewHelper(){this.viewHelper=this.$injector.instantiate(z,{questionAttempt:this.questionAttempt,scope:this.scope})}};J.$inject=[],J=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(d.serviceName)),Object(o.__param)(10,Object(S.b)(m.e)),Object(o.__param)(11,Object(S.b)("$ngRedux")),Object(o.__param)(12,Object(S.b)(b.c)),Object(o.__param)(13,Object(S.b)(v.b)),Object(o.__param)(14,Object(S.b)(g.b)),Object(o.__param)(15,Object(S.b)(h.b)),Object(o.__param)(16,Object(S.b)(C.b)),Object(o.__param)(17,Object(S.b)(y.b)),Object(o.__param)(18,Object(S.b)(O.b))],J);let Y=class extends a.g{constructor(e,t,s,n,i,o,a,r,c,l,d){if(super(e,s,n,i,o,a,r,c,l,d),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.scope=r,this.timeout=c,this.ultraState=l,this.localizeService=d,!r.gradedQuestionAttempt)throw new Error("Question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(V),this.viewHelper=t.instantiate(z,{questionAttempt:this.questionAttempt,scope:r}),this.convertMathToImage()}convertMathToImage(){new H.WirisPluginsService({...Q.config,locale:this.localizeService.getLocale(this.scope)}).getImageMetadataFromMathML(this.scope.gradedQuestionAttempt.questionAttempt.question.answerFormula).then((({src:e,alt:t})=>{this.imageSource=e,this.imageAltText=t}))}};Y.$inject=[],Y=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(p.d)),Object(o.__param)(10,Object(S.b)(d.serviceName))],Y);var Z=s("Xcvp"),X=s("oXbF");class ee extends a.a{createQuestion(e,t,s){const n=super.createQuestion(e,t,s);return n.questionType=w.QuestionType.CalculatedNumeric,n}getAttemptAuthoringHandler(e,t,s){return this.$injector.instantiate(te,{attrs:s,element:t,scope:e})}getAttemptGradingHandler(e,t,s){return this.$injector.instantiate(se,{attrs:s,element:t,scope:e})}getAttemptReviewHandler(e,t,s){return this.$injector.instantiate(ne,{attrs:s,element:t,scope:e})}}let te=class extends a.e{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p){super(e,n,i,o,a,r,c,l,d,u),this.$compile=e,this.$q=t,this.$injector=s,this.$window=n,this.attrs=i,this.CourseModel=o,this.element=a,this.gradebookPermissionService=r,this.localizeService=c,this.scope=l,this.timeout=d,this.ultraState=u,this.allyService=p,this.onAnswerChange=e=>{this.scope.$apply((()=>{this.scope.questionAttempt.givenAnswer=e,this.givenAnswer=e,this.attemptIsDirty=!0,this.scope.$broadcast("bb-autosave-save-trigger-debounce")}))},this.scope.allyService=this.allyService.getReactService(this.scope),this.insertQuestionSpecificTemplate(Z)}initializeGivenAnswer(){const e=this.scope.$watch("questionAttempt.givenAnswer",(t=>{this.givenAnswer||(this.givenAnswer=t,e())}))}setDirtyAndUpdateGivenAnswer(e){return this.attemptIsDirty=e.givenAnswer!==this.givenAnswer,this.attemptIsDirty&&(e.givenAnswer=this.givenAnswer),e}persist(){return this.attemptIsDirty?super.persist():this.$q.resolve(null)}};te.$inject=[],te=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$q")),Object(o.__param)(2,Object(S.b)("$injector")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)(c.serviceName)),Object(o.__param)(6,Object(S.b)("element")),Object(o.__param)(7,Object(S.b)(l.b)),Object(o.__param)(8,Object(S.b)(d.serviceName)),Object(o.__param)(9,Object(S.b)("scope")),Object(o.__param)(10,Object(S.b)(u.b)),Object(o.__param)(11,Object(S.b)(p.d)),Object(o.__param)(12,Object(S.b)(C.b))],te);let se=class extends a.f{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v,f){super(e,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v,f),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.scope=r,this.timeout=c,this.localizeService=l,this.contextCourse=d,this.$ngRedux=u,this.scheduleTask=p,this.ltiService=m,this.CloudStorageIntegrationModalService=h,this.contextService=b,this.allyService=g,this.featureFlagService=v,this.fileUploadSettingsService=f,this.scope.allyService=this.allyService.getReactService(this.scope),this.insertQuestionSpecificTemplate(X)}constructViewHelper(){}};se.$inject=[],se=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(d.serviceName)),Object(o.__param)(10,Object(S.b)(m.e)),Object(o.__param)(11,Object(S.b)("$ngRedux")),Object(o.__param)(12,Object(S.b)(b.c)),Object(o.__param)(13,Object(S.b)(v.b)),Object(o.__param)(14,Object(S.b)(g.b)),Object(o.__param)(15,Object(S.b)(h.b)),Object(o.__param)(16,Object(S.b)(C.b)),Object(o.__param)(17,Object(S.b)(y.b)),Object(o.__param)(18,Object(S.b)(O.b))],se);let ne=class extends a.g{constructor(e,t,s,n,i,o,a,r,c,l,d,u){super(e,s,n,i,o,a,r,c,l,d),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.scope=r,this.timeout=c,this.ultraState=l,this.localizeService=d,this.allyService=u,this.scope.allyService=this.allyService.getReactService(this.scope),this.insertQuestionSpecificTemplate(X)}};ne.$inject=[],ne=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(p.d)),Object(o.__param)(10,Object(S.b)(d.serviceName)),Object(o.__param)(11,Object(S.b)(C.b))],ne);var ie=s("IaSh"),oe=s("bd9L"),ae=s("fiT5"),re=s("StAH");class ce extends a.a{createQuestion(e,t,s){const n=super.createQuestion(e,t,s);return n.questionType=w.QuestionType.Hotspot,n}getAttemptAuthoringHandler(e,t,s){return this.$injector.instantiate(le,{attrs:s,element:t,scope:e})}getAttemptGradingHandler(e,t,s){return this.$injector.instantiate(de,{attrs:s,element:t,scope:e})}getAttemptReviewHandler(e,t,s){return this.$injector.instantiate(ue,{attrs:s,element:t,scope:e})}}let le=class extends a.e{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p){super(e,n,i,o,a,r,c,l,d,u),this.$compile=e,this.$q=t,this.$injector=s,this.$window=n,this.attrs=i,this.CourseModel=o,this.element=a,this.gradebookPermissionService=r,this.localizeService=c,this.scope=l,this.timeout=d,this.ultraState=u,this.allyService=p,this.onAnswerChange=e=>{this.scope.$apply((()=>{this.scope.questionAttempt.givenAnswers=e,this.givenAnswer=e,this.attemptIsDirty=!0,this.scope.$broadcast(oe.a)}))},this.scope.allyService=this.allyService.getReactService(this.scope),this.insertQuestionSpecificTemplate(ae)}initializeGivenAnswer(){const e=this.scope.$watch("questionAttempt.givenAnswers",(t=>{this.givenAnswer||(this.givenAnswer=t,e())}))}setDirtyAndUpdateGivenAnswer(e){return this.attemptIsDirty=!this.givenAnswer||e.givenAnswers.some(((e,t)=>Object(ie.coordinatesDiffer)(e.coordinates,this.givenAnswer[t].coordinates))),this.attemptIsDirty&&(e.givenAnswers=this.givenAnswer),e}};le.$inject=[],le=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$q")),Object(o.__param)(2,Object(S.b)("$injector")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)(c.serviceName)),Object(o.__param)(6,Object(S.b)("element")),Object(o.__param)(7,Object(S.b)(l.b)),Object(o.__param)(8,Object(S.b)(d.serviceName)),Object(o.__param)(9,Object(S.b)("scope")),Object(o.__param)(10,Object(S.b)(u.b)),Object(o.__param)(11,Object(S.b)(p.d)),Object(o.__param)(12,Object(S.b)(C.b))],le);let de=class extends a.f{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v,f){super(e,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v,f),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.scope=r,this.timeout=c,this.localizeService=l,this.contextCourse=d,this.$ngRedux=u,this.scheduleTask=p,this.ltiService=m,this.CloudStorageIntegrationModalService=h,this.contextService=b,this.allyService=g,this.featureFlagService=v,this.fileUploadSettingsService=f,this.isAttemptGradingView=!0,this.scope.allyService=this.allyService.getReactService(this.scope),this.insertQuestionSpecificTemplate(re)}constructViewHelper(){}};de.$inject=[],de=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(d.serviceName)),Object(o.__param)(10,Object(S.b)(m.e)),Object(o.__param)(11,Object(S.b)("$ngRedux")),Object(o.__param)(12,Object(S.b)(b.c)),Object(o.__param)(13,Object(S.b)(v.b)),Object(o.__param)(14,Object(S.b)(g.b)),Object(o.__param)(15,Object(S.b)(h.b)),Object(o.__param)(16,Object(S.b)(C.b)),Object(o.__param)(17,Object(S.b)(y.b)),Object(o.__param)(18,Object(S.b)(O.b))],de);let ue=class extends a.g{constructor(e,t,s,n,i,o,a,r,c,l,d,u){super(e,s,n,i,o,a,r,c,l,d),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.scope=r,this.timeout=c,this.ultraState=l,this.localizeService=d,this.allyService=u,this.scope.allyService=this.allyService.getReactService(this.scope),this.insertQuestionSpecificTemplate(re)}};ue.$inject=[],ue=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(p.d)),Object(o.__param)(10,Object(S.b)(d.serviceName)),Object(o.__param)(11,Object(S.b)(C.b))],ue);class pe{constructor(e,t){this.scope=e,this.questionAttempt=t,this.correctPairCount=this.calculateCorrectPairCount()}get totalPairCount(){return this.questionAttempt.question.prompts.length}calculateCorrectPairCount(){let e=0;return this.questionAttempt.question.prompts.forEach(((t,s)=>{t.matchingAnswerIndex===this.questionAttempt.givenAnswers[s]&&e++})),e}}pe.$inject=["scope","questionAttempt"];var me=s("1ZbL"),he=s("ERkP"),be=s("E1pj"),ge=s("5MwF"),ve=s("Q/M7"),fe=s("0x+l");const we=e=>{const{answeredCorrectly:t,localize:s,locale:n}=e,i=t?"correct":"incorrect";return he.createElement("div",{className:"matching-attempt-review-pair__correctness-label"},s.translateSync({locale:n,key:`components.directives.assessment-question.status.${i}`}))},Se=e=>{const{submittedAnswer:t,bbEditorPlugins:s,showTitle:n,localize:i,locale:o}=e;return he.createElement("div",null,n&&he.createElement("div",null,i.translateSync({locale:o,key:"components.directives.assessment-question.matching.review.submitted-answer"})),t?he.createElement(ke,{plugins:s,bbml:t.answerText.rawText}):he.createElement("div",null,i.translateSync({locale:o,key:"components.directives.assessment-question.matching.review.none-selected"})))},Ce=e=>{const{acceptableAnswer:t,bbEditorPlugins:s,localize:n,locale:i}=e;return he.createElement("div",null,he.createElement("div",null,n.translateSync({locale:i,key:"components.directives.assessment-question.matching.review.acceptable-answer"})),he.createElement(ke,{plugins:s,bbml:t.answerText.rawText}))};class ye extends he.Component{render(){const{answers:e,bbEditorPlugins:t,givenAnswer:s,showResults:n,locale:i,localize:o,prompt:a}=this.props,r=void 0!==a.matchingAnswerIndex&&n,c=s===a.matchingAnswerIndex;let l;l=r?c?"correct":"incorrect":"ungraded";const d=c?he.createElement(fe.Complete,{className:"matching-attempt-review-pair__correctness-icon js-correct-icon"}):he.createElement(fe.Clear,{className:"matching-attempt-review-pair__correctness-icon js-incorrect-icon"});return he.createElement("div",{className:"matching-attempt-review-pair"},he.createElement("div",{className:"matching-attempt-review-pair__prompt"},he.createElement(ke,{plugins:t,bbml:a.promptText.rawText,allyService:this.props.allyService,rootContentId:this.props.rootContentId})),he.createElement("div",{className:`matching-attempt-review-pair__answer matching-attempt-review-pair--${l}`},r&&d,he.createElement("div",null,r&&he.createElement(we,{answeredCorrectly:c,localize:o,locale:i}),(!c||!r)&&he.createElement(Se,{submittedAnswer:e[s],bbEditorPlugins:t,showTitle:r,localize:o,locale:i}),r&&he.createElement(Ce,{acceptableAnswer:e[a.matchingAnswerIndex],bbEditorPlugins:t,localize:o,locale:i}))))}}var Oe=ye,Ae=s("MC1S");class Ie extends he.Component{constructor(){super(...arguments),this.onChange=e=>{const{onChange:t,index:s}=this.props;t(s,e.key)}}onRichContentClick(e){"A"===e.target.nodeName&&e.stopPropagation()}render(){const{answers:e,bbEditorPlugins:t,givenAnswer:s,locale:n,localize:i,prompt:o,questionIndex:a,UltraWindowSize:r}=this.props,c=he.createElement("div",null,he.createElement("div",{className:"sr-only"},i.translateSync({locale:n,key:"components.directives.assessment-question.question-title",params:{index:a},noWrap:!0})),r.isSmallBreakpoint()&&he.createElement("div",{className:"matching-attempt-authoring-pair__prompt-label",role:"presentation"},i.translateSync({locale:n,key:"components.directives.assessment-question.matching.headers.prompt"})),he.createElement("div",{className:"matching-attempt-authoring-pair__prompt"},he.createElement(ke,{bbml:o.promptText.rawText,plugins:t,allyService:this.props.allyService,rootContentId:this.props.rootContentId})),r.isSmallBreakpoint()&&he.createElement("div",{className:"matching-attempt-authoring-pair__answer-label",role:"presentation"},i.translateSync({locale:n,key:"components.directives.assessment-question.matching.headers.answer"}))),l=e.map(((e,s)=>({key:s,content:he.createElement(ke,{plugins:t,bbml:e.answerText.rawText,allyService:this.props.allyService,rootContentId:this.props.rootContentId})})));return he.createElement("div",{className:"matching-attempt-authoring-pair"},he.createElement(Ae.RichDropdown,{calloutProps:{className:"matching-answer-rich-dropdown",directionalHintFixed:!1},defaultSelectedKey:s,label:c,onChanged:this.onChange,options:l,placeHolder:i.translateSync({locale:n,key:"components.directives.assessment-question.matching.answer-dropdown-placeholder"}),analyticsId:"components.directives.assessmentQuestion.matching.richDropdown"}))}}var De=Object(be.windowResizingResponsiveComponentWrapper)(Ie);const ke=({bbml:e,plugins:t,rootContentId:s,allyService:n})=>{const i={service:n,indexMap:new Map};return he.createElement(f.BbEditor,{bbml:e,isReadOnly:!0,plugins:t,rootContentId:s,ally:i})};class _e extends he.Component{constructor(e){super(e),this.givenAnswers=[],this.localize=this.props[d.serviceName],this.context=this.props[h.b],this.contextCourse=this.props[m.e],this.toolbarPlugins=[Object(f.link)(),Object(f.image)(),Object(f.video)()],this.onChange=(e,t)=>{this.givenAnswers[e]=t,this.props.onChange(this.givenAnswers)},this.givenAnswers=e.givenAnswers,this.toolbarPlugins.push(Object(f.math)({apiBasePath:Object(ve.c)(ge.a.apiBasePath),courseId:this.contextCourse.courseId,xsrfToken:this.context.xsrfToken,locale:this.localize.getLocale(this.props.$scope)})),this.toolbarPlugins.push(Object(f.insertLocalFile)({apiBasePath:Object(ve.c)(ge.a.apiBasePath),xsrfToken:this.context.xsrfToken})),this.allyService=this.props.ally.getReactService(this.props.$scope)}render(){const{answers:e,givenAnswers:t,prompts:s,questionIndex:n,UltraWindowSize:i}=this.props,o=this.localize.getLocale(this.props.$scope);let a;this.props.ultraState&&this.props.ultraState.getCurrentResolvedValues&&this.props.ultraState.getCurrentResolvedValues().currentContent&&(a=this.props.ultraState.getCurrentResolvedValues().currentContent.id);const r=s.map(((s,r)=>he.createElement("li",{key:s.id,className:"matching-attempt__list-item"},he.createElement(je,{answers:e,bbEditorPlugins:this.toolbarPlugins,index:r,givenAnswer:t[r],showResults:this.props.showResults,locale:o,localize:this.localize,onChange:this.props.onChange&&this.onChange,questionIndex:n,prompt:s,UltraWindowSize:i,allyService:this.allyService,rootContentId:a})))),c=!!s.find((e=>void 0!==e.matchingAnswerIndex))?"components.directives.assessment-question.matching.headers.answers":"components.directives.assessment-question.matching.headers.submitted-answers";return he.createElement("div",{className:"matching-attempt__pairs"},!i.isSmallBreakpoint()&&he.createElement("div",{className:"matching-attempt__column-titles-container"},he.createElement("div",{className:"matching-attempt__column-title"},this.localize.translateSync({locale:o,key:"components.directives.assessment-question.matching.headers.prompts"})),he.createElement("div",{className:"matching-attempt__column-title"},this.localize.translateSync({locale:o,key:c}))),he.createElement("ol",{className:"matching-attempt__list"},r))}}class je extends he.Component{render(){const{onChange:e}=this.props;return null!=e?he.createElement(De,{...this.props,onChange:this.props.onChange}):he.createElement(Oe,{...this.props})}}var Te=Object(be.windowResizingResponsiveComponentWrapper)(_e),$e=s("/qTg"),Re=s("afiT");const Ee="ultra.components.directives.assessment.assessment-question.question-handlers.matching-question-handler";class xe extends a.a{createQuestion(e,t,s){const n=super.createQuestion(e,t,s);return n.questionType=w.QuestionType.Matching,n}getAttemptAuthoringHandler(e,t,s){return this.$injector.instantiate(Pe,{attrs:s,element:t,scope:e})}getAttemptGradingHandler(e,t,s){return this.$injector.instantiate(Le,{attrs:s,element:t,scope:e})}getAttemptReviewHandler(e,t,s){return this.$injector.instantiate(Ge,{attrs:s,element:t,scope:e})}}let Pe=class extends a.e{constructor(e,t,s,n,i,o,a,r,c,l){if(super(e,t,s,n,i,o,a,r,c,l),this.$compile=e,this.$window=t,this.attrs=s,this.CourseModel=n,this.element=i,this.gradebookPermissionService=o,this.localizeService=a,this.scope=r,this.timeout=c,this.ultraState=l,this.onAnswersChange=e=>{this.scope.questionAttempt.givenAnswers=e,this.givenAnswer=e,this.attemptIsDirty=!0,this.scope.$broadcast("bb-autosave-save-trigger-debounce")},!r.questionAttempt)throw new Error("Question attempt must be provided in attempt authoring mode.");this.insertQuestionSpecificTemplate($e)}initializeGivenAnswer(){$.isEmpty(this.scope.questionAttempt.givenAnswers)&&$.times(this.scope.questionAttempt.question.prompts.length,(()=>{this.scope.questionAttempt.givenAnswers.push(null)})),this.givenAnswer=this.scope.questionAttempt.givenAnswers}setDirtyAndUpdateGivenAnswer(e){return this.attemptIsDirty=!$.isEqual(e.givenAnswers,this.givenAnswer),e.givenAnswers=this.givenAnswer,e}};Pe.$inject=[],Pe=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$window")),Object(o.__param)(2,Object(S.b)("attrs")),Object(o.__param)(3,Object(S.b)(c.serviceName)),Object(o.__param)(4,Object(S.b)("element")),Object(o.__param)(5,Object(S.b)(l.b)),Object(o.__param)(6,Object(S.b)(d.serviceName)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(p.d))],Pe);let Le=class extends a.f{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v,f){if(super(e,s,n,i,o,a,r,c,l,d,u,h,p,m,b,g,v,f),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.scope=r,this.timeout=c,this.localizeService=l,this.contextCourse=d,this.$ngRedux=u,this.ltiService=p,this.CloudStorageIntegrationModalService=m,this.scheduleTask=h,this.contextService=b,this.allyService=g,this.featureFlagService=v,this.fileUploadSettingsService=f,!r.gradedQuestionAttempt)throw new Error("Graded Question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(Re),this.constructViewHelper()}constructViewHelper(){this.viewHelper=this.$injector.instantiate(pe,{questionAttempt:this.questionAttempt,scope:this.scope})}};Le.$inject=[],Le=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(d.serviceName)),Object(o.__param)(10,Object(S.b)(m.e)),Object(o.__param)(11,Object(S.b)("$ngRedux")),Object(o.__param)(12,Object(S.b)(v.b)),Object(o.__param)(13,Object(S.b)(g.b)),Object(o.__param)(14,Object(S.b)(b.c)),Object(o.__param)(15,Object(S.b)(h.b)),Object(o.__param)(16,Object(S.b)(C.b)),Object(o.__param)(17,Object(S.b)(y.b)),Object(o.__param)(18,Object(S.b)(O.b))],Le);let Ge=class extends a.g{constructor(e,t,s,n,i,o,a,r,c,l,d){if(super(e,s,n,i,o,a,c,l,d,r),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.localizeService=r,this.scope=c,this.timeout=l,this.ultraState=d,!c.gradedQuestionAttempt)throw new Error("Graded question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(Re),this.viewHelper=t.instantiate(pe,{questionAttempt:this.questionAttempt,scope:c})}};Ge.$inject=[],Ge=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)(d.serviceName)),Object(o.__param)(8,Object(S.b)("scope")),Object(o.__param)(9,Object(S.b)(u.b)),Object(o.__param)(10,Object(S.b)(p.d))],Ge);const Me={Class:Te,bindingNames:["answers","givenAnswers","showResults","onChange","prompts","questionIndex"],injectNames:["$scope",h.b,d.serviceName,m.e,p.d,C.b],renderLocalized:!0,withThemeProvider:!1};n.module(Ee,[]).component("bbMatchingAttempt",Object(me.a)(Me));s("xXFZ"),s("2MQt"),s("uEsA"),s("LRgG"),s("gORw"),s("dV61");var Ne=s("nbDY"),Fe=s.n(Ne),Be=s("Xq/A"),qe=s("Fdwu");let ze=class{constructor(e,t,s,n,i,o){this.questionAttempt=e,this.showCorrectAnswer=t,this.isCorrect=s,this.scope=n,this.bbLocalize=i,this.bbmlEditor=o,this.correctAnswers=[],this.setupCorrectAnswers(),this.hideAnswerOptions=this.isCorrect}isOnlyPartialCredit(){return!this.questionAttempt.correct&&this.questionAttempt.partiallyCorrect}toggleAnswerOptions(){this.hideAnswerOptions=!this.hideAnswerOptions}showIncorrectIndicator(e){var t;const s=this.questionAttempt.givenAnswer[e],n=null===(t=this.questionAttempt.question.answers[e])||void 0===t?void 0:t.correctAnswer;return this.showCorrectAnswer&&s&&!n}getTruncatedAnswerText(e){return R.f(e,25)}setupCorrectAnswers(){return this.questionAttempt.question.answers.forEach(((e,t)=>{if(e.correctAnswer){const s=this.bbmlEditor.convertBbMLToContentBlocks(e.answerText.rawText).contentBlocks[0];this.correctAnswers.push({answer:e,index:t,displayText:s?s.textBlock.replace(qe.a,""):""})}})),this.formatAnswerString(),this.correctAnswers}formatAnswerString(){const e=[];this.correctAnswers.forEach((t=>{const s="("+this.getOptionLabelByIndex(t.index)+") "+this.getTruncatedAnswerText(t.displayText);e.push(s)})),this.bbLocalize.formatItems(e,e.length,null,!1,{noWrap:!0}).then((e=>{e="<strong>"+e+"</strong>",this.isCorrect?this.formattedAnswerString=e:this.formattedAnswerString=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.assessment-question.multiple-answer.review.correct-answer.plural",params:{count:this.correctAnswers.length,answer:e},noWrap:!0,noEscape:!0})}))}getOptionLabelByIndex(e){return String.fromCharCode(65+e)}};ze=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("questionAttempt")),Object(o.__param)(1,Object(S.b)("showCorrectAnswer")),Object(o.__param)(2,Object(S.b)("isCorrect")),Object(o.__param)(3,Object(S.b)("scope")),Object(o.__param)(4,Object(S.b)(d.serviceName)),Object(o.__param)(5,Object(S.b)(Be.c))],ze);var Ue=s("+sRu"),Ve=s("+O05"),He=s("LQXi"),Qe=s("I5V3");class Ke extends a.a{createQuestion(e,t,s){const n=super.createQuestion(e,t,s);return n.questionType=w.QuestionType.Multiple,n.singleCorrectAnswer=!0,n}getAttemptAuthoringHandler(e,t,s){return this.$injector.instantiate(Je,{attrs:s,element:t,scope:e})}getAttemptGradingHandler(e,t,s){return this.$injector.instantiate(Ye,{attrs:s,element:t,scope:e})}getAttemptReviewHandler(e,t,s){return this.$injector.instantiate(Ze,{attrs:s,element:t,scope:e})}}class We extends Fe.a{}We.NoPartialCredit=new We("NO_PARTIAL_CREDIT"),We.PartialCreditNoPenalty=new We("PARTIAL_CREDIT_NO_PENALTY"),We.PartialCreditWithPenalty=new We("PARTIAL_CREDIT_WITH_PENALTY");let Je=class extends a.e{constructor(e,t,s,n,i,o,a,r,c,l){if(super(e,t,s,n,i,o,a,r,c,l),this.$compile=e,this.$window=t,this.attrs=s,this.CourseModel=n,this.element=i,this.gradebookPermissionService=o,this.localizeService=a,this.scope=r,this.timeout=c,this.ultraState=l,!r.questionAttempt)throw new Error("Question attempt must be provided in attempt authoring mode.");this.insertQuestionSpecificTemplate(He)}onSingleAnswerInputChanged(e){this.givenAnswer=this.givenAnswer.map(((t,s)=>e===s)),this.scope.questionAttempt.givenAnswer=this.givenAnswer,this.attemptIsDirty=!0,this.scope.$broadcast(oe.a)}initializeGivenAnswer(){$.isEmpty(this.scope.questionAttempt.givenAnswer)&&$.times(this.scope.questionAttempt.question.answersCount,(()=>{this.scope.questionAttempt.givenAnswer.push(!1)})),this.givenAnswer=this.scope.questionAttempt.givenAnswer,this.scope.$watchCollection("assessmentQuestion.givenAnswer",(()=>{this.scope.questionAttempt.givenAnswer=this.givenAnswer}))}setDirtyAndUpdateGivenAnswer(e){return this.attemptIsDirty=!$.isEqual(e.givenAnswer,this.givenAnswer),this.attemptIsDirty&&(e.givenAnswer=this.givenAnswer),e}};Je.$inject=[],Je=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$window")),Object(o.__param)(2,Object(S.b)("attrs")),Object(o.__param)(3,Object(S.b)(c.serviceName)),Object(o.__param)(4,Object(S.b)("element")),Object(o.__param)(5,Object(S.b)(l.b)),Object(o.__param)(6,Object(S.b)(d.serviceName)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(p.d))],Je);let Ye=class extends a.f{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v,f){if(super(e,s,n,i,o,a,r,c,l,d,u,h,p,m,b,g,v,f),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.scope=r,this.timeout=c,this.localizeService=l,this.contextCourse=d,this.$ngRedux=u,this.ltiService=p,this.CloudStorageIntegrationModalService=m,this.scheduleTask=h,this.contextService=b,this.allyService=g,this.featureFlagService=v,this.fileUploadSettingsService=f,!r.gradedQuestionAttempt)throw new Error("Graded question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(Qe),this.constructViewHelper()}showAnswerOptions(){return!this.viewHelper.hideAnswerOptions}getAnswerChoiceStyles(e){const t=this.questionAttempt.givenAnswer[e],s=this.questionAttempt.question.answers[e].correctAnswer;return this.getAnswerStyles(t,s,!0)}constructViewHelper(){this.viewHelper=this.$injector.instantiate(ze,{questionAttempt:this.questionAttempt,showCorrectAnswer:!0,isCorrect:this.isCorrect(),scope:this.scope})}};Ye.$inject=[],Ye=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(d.serviceName)),Object(o.__param)(10,Object(S.b)(m.e)),Object(o.__param)(11,Object(S.b)("$ngRedux")),Object(o.__param)(12,Object(S.b)(v.b)),Object(o.__param)(13,Object(S.b)(g.b)),Object(o.__param)(14,Object(S.b)(b.c)),Object(o.__param)(15,Object(S.b)(h.b)),Object(o.__param)(16,Object(S.b)(C.b)),Object(o.__param)(17,Object(S.b)(y.b)),Object(o.__param)(18,Object(S.b)(O.b))],Ye);let Ze=class extends a.g{constructor(e,t,s,n,i,o,a,r,c,l,d){if(super(e,s,n,i,o,a,c,l,d,r),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.localizeService=r,this.scope=c,this.timeout=l,this.ultraState=d,!c.gradedQuestionAttempt)throw new Error("Question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(Qe),this.viewHelper=t.instantiate(ze,{questionAttempt:this.questionAttempt,showCorrectAnswer:this.canShowCorrectAnswerRelatedDetail(),isCorrect:this.isCorrect(),scope:c})}getAnswerChoiceStyles(e){const t=this.questionAttempt.givenAnswer[e];if(!Ve.a.studentCanViewAttemptResults(this.attempt))return t?`${Ue.a.IsSelected} ${Ue.a.AnswerSelectedNotPosted}`:Ue.a.AnswerNotSelected;const s=this.questionAttempt.question.answers[e].correctAnswer,n=this.canShowCorrectAnswerRelatedDetail();return this.getAnswerStyles(t,s,n)}showAnswerOptions(){return!Ve.a.studentCanViewAttemptResults(this.attempt)||!this.viewHelper.hideAnswerOptions||this.canShowCorrectAnswerRelatedDetail()&&!this.canShowQuestionScoreRelatedDetail()}};Ze.$inject=[],Ze=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)(d.serviceName)),Object(o.__param)(8,Object(S.b)("scope")),Object(o.__param)(9,Object(S.b)(u.b)),Object(o.__param)(10,Object(S.b)(p.d))],Ze);var Xe=s("r8DE"),et=s("nvgb"),tt=s("APyD"),st=s("dEnf");class nt extends Fe.a{}nt.FileAttachment=new nt("presentation-file-attachment"),nt.FileInline=new nt("presentation-file-inline"),nt.FileInlineAudio=new nt("presentation-file-inline-audio"),nt.Text=new nt("presentation-text");class it extends a.a{createQuestion(e,t,s){const n=super.createQuestion(e,t,s);return n.questionType=w.QuestionType.PresentationOnly,n.subType=s?s.subType:w.QuestionSubType.Text,s&&s.file&&(n.initialUploadFile=s.file),n}getQuestionReviewHandler(e,t,s){return this.$injector.instantiate(ot,{attrs:s,element:t,scope:e})}getAttemptAuthoringHandler(e,t,s){return this.$injector.instantiate(at,{attrs:s,element:t,scope:e})}getAttemptGradingHandler(e,t,s){return this.$injector.instantiate(rt,{attrs:s,element:t,scope:e})}getAttemptReviewHandler(e,t,s){return this.$injector.instantiate(ct,{attrs:s,element:t,scope:e})}}let ot=class extends a.h{constructor(e,t,s,n,i,o,a,r,c,l){if(super(e,t,s,n,i,o,r,c,a,l,{hasPoints:!1,hasQuestionCountTitle:!1,points:0,showQuestionControls:!1}),this.$compile=e,this.$sce=t,this.$window=s,this.attrs=n,this.element=i,this.gradebookPermissionService=o,this.localizeService=a,this.scope=r,this.timeout=c,this.ultraState=l,!r.question)throw new Error("Question must be provided in question review mode.");this.insertQuestionSpecificTemplate(Xe)}};ot.$inject=[],ot=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$sce")),Object(o.__param)(2,Object(S.b)("$window")),Object(o.__param)(3,Object(S.b)("attrs")),Object(o.__param)(4,Object(S.b)("element")),Object(o.__param)(5,Object(S.b)(l.b)),Object(o.__param)(6,Object(S.b)(d.serviceName)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(p.d))],ot);let at=class extends a.e{constructor(e,t,s,n,i,o,a,r,c,l){if(super(e,t,s,n,i,o,a,r,c,l,{hasPoints:!1,hasQuestionCountTitle:!1,points:0,showQuestionControls:!1}),this.$compile=e,this.$window=t,this.attrs=s,this.CourseModel=n,this.element=i,this.gradebookPermissionService=o,this.localizeService=a,this.scope=r,this.timeout=c,this.ultraState=l,!r.questionAttempt)throw new Error("Question attempt must be provided in attempt authoring mode.");this.insertQuestionSpecificTemplate(et)}initializeGivenAnswer(){}setDirtyAndUpdateGivenAnswer(){}};at.$inject=[],at=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$window")),Object(o.__param)(2,Object(S.b)("attrs")),Object(o.__param)(3,Object(S.b)(c.serviceName)),Object(o.__param)(4,Object(S.b)("element")),Object(o.__param)(5,Object(S.b)(l.b)),Object(o.__param)(6,Object(S.b)(d.serviceName)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(p.d))],at);let rt=class extends a.f{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v){if(super(e,t,s,n,i,o,a,r,c,l,d,m,u,p,h,b,g,v,{hasPoints:!1,hasQuestionCountTitle:!1,points:0,showQuestionControls:!1}),this.$compile=e,this.$sce=t,this.$window=s,this.attrs=n,this.element=i,this.gradebookPermissionService=o,this.scope=a,this.timeout=r,this.localizeService=c,this.contextCourse=l,this.$ngRedux=d,this.ltiService=u,this.CloudStorageIntegrationModalService=p,this.scheduleTask=m,this.contextService=h,this.allyService=b,this.featureFlagService=g,this.fileUploadSettingsService=v,!a.gradedQuestionAttempt)throw new Error("Graded question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(tt)}constructViewHelper(){}};rt.$inject=[],rt=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$sce")),Object(o.__param)(2,Object(S.b)("$window")),Object(o.__param)(3,Object(S.b)("attrs")),Object(o.__param)(4,Object(S.b)("element")),Object(o.__param)(5,Object(S.b)(l.b)),Object(o.__param)(6,Object(S.b)("scope")),Object(o.__param)(7,Object(S.b)(u.b)),Object(o.__param)(8,Object(S.b)(d.serviceName)),Object(o.__param)(9,Object(S.b)(m.e)),Object(o.__param)(10,Object(S.b)("$ngRedux")),Object(o.__param)(11,Object(S.b)(v.b)),Object(o.__param)(12,Object(S.b)(g.b)),Object(o.__param)(13,Object(S.b)(b.c)),Object(o.__param)(14,Object(S.b)(h.b)),Object(o.__param)(15,Object(S.b)(C.b)),Object(o.__param)(16,Object(S.b)(y.b)),Object(o.__param)(17,Object(S.b)(O.b))],rt);let ct=class extends a.g{constructor(e,t,s,n,i,o,a,r,c,l){if(super(e,t,s,n,i,o,r,c,l,a,{hasPoints:!1,hasQuestionCountTitle:!1,points:0,showQuestionControls:!1}),this.$compile=e,this.$sce=t,this.$window=s,this.attrs=n,this.element=i,this.gradebookPermissionService=o,this.localizeService=a,this.scope=r,this.timeout=c,this.ultraState=l,!r.gradedQuestionAttempt)throw new Error("Graded question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(st)}};ct.$inject=[],ct=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$sce")),Object(o.__param)(2,Object(S.b)("$window")),Object(o.__param)(3,Object(S.b)("attrs")),Object(o.__param)(4,Object(S.b)("element")),Object(o.__param)(5,Object(S.b)(l.b)),Object(o.__param)(6,Object(S.b)(d.serviceName)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(p.d))],ct);class lt{constructor(e,t,s,n,i){this.scope=e,this.bbLocalize=t,this.question=s,this.questionAttempt=n,this.showCorrectAnswer=i,this.setAnswerStringLabels()}setAnswerStringLabels(){this.hasUserEnteredLabels()?(this.trueAnswerOptionLabel=this.question.userEnteredCorrectAnswerLabel,this.falseAnswerOptionLabel=this.question.userEnteredIncorrectAnswerLabel):(this.trueAnswerOptionLabel=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:`components.directives.assessment-question.true-false.answer-type.${this.question.answerType}.true.label`}),this.falseAnswerOptionLabel=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:`components.directives.assessment-question.true-false.answer-type.${this.question.answerType}.false.label`}))}isAnswerChoiceCorrect(e){return this.questionAttempt.question.answer===e}isAnswerChoiceSelected(e){return this.questionAttempt.givenAnswer===e}showIncorrectIndicator(e){const t=this.isAnswerChoiceSelected(e),s=this.isAnswerChoiceCorrect(e);return this.showCorrectAnswer&&t&&!s}hasUserEnteredLabels(){return this.question.answerType===w.TrueFalseAnswerType.UserEnteredLabels}get answerDescriptionKey(){return this.question.answer?"components.directives.assessment-question.true-false.review.description-true":"components.directives.assessment-question.true-false.review.description-false"}}lt.$inject=["scope",d.serviceName,"question","questionAttempt","showCorrectAnswer"];s("U+0H");var dt=s("Ee/I"),ut=s("ys4f");class pt extends a.a{createQuestion(e,t,s){const n=super.createQuestion(e,t,s);return n.questionType=w.QuestionType.Either,n.answer=!0,n.answerType=w.TrueFalseAnswerType.TrueFalse,n}getAttemptAuthoringHandler(e,t,s){return this.$injector.instantiate(mt,{attrs:s,element:t,scope:e})}getAttemptGradingHandler(e,t,s){return this.$injector.instantiate(ht,{attrs:s,element:t,scope:e})}getAttemptReviewHandler(e,t,s){return this.$injector.instantiate(bt,{attrs:s,element:t,scope:e})}}let mt=class extends a.e{constructor(e,t,s,n,i,o,a,r,c,l,d){if(super(e,s,n,i,o,a,r,c,l,d),this.$compile=e,this.$injector=t,this.$window=s,this.attrs=n,this.CourseModel=i,this.element=o,this.gradebookPermissionService=a,this.localizeService=r,this.scope=c,this.timeout=l,this.ultraState=d,!c.questionAttempt)throw new Error("Question attempt must be provided in attempt authoring mode.");this.scope.$watch((()=>this.scope.questionAttempt.givenAnswer),((e,t)=>{e!==t&&$.isUndefined(t)&&this.getCurrentForm()[this.getFormInputName()].$setDirty(!0)})),this.insertQuestionSpecificTemplate(dt),this.viewHelper=t.instantiate(lt,{question:this.scope.questionAttempt.question,questionAttempt:null,showCorrectAnswer:null,scope:c})}getFormInputName(){return`${this.elementId}true-false-answers-choice`}initializeGivenAnswer(){this.givenAnswer=this.scope.questionAttempt.givenAnswer,this.scope.$watch("assessmentQuestion.givenAnswer",(()=>{this.scope.questionAttempt.givenAnswer=this.givenAnswer}))}setDirtyAndUpdateGivenAnswer(e){return this.attemptIsDirty=e.givenAnswer!==this.givenAnswer,e.givenAnswer=this.givenAnswer,e}};mt.$inject=[],mt=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$window")),Object(o.__param)(3,Object(S.b)("attrs")),Object(o.__param)(4,Object(S.b)(c.serviceName)),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)(d.serviceName)),Object(o.__param)(8,Object(S.b)("scope")),Object(o.__param)(9,Object(S.b)(u.b)),Object(o.__param)(10,Object(S.b)(p.d))],mt);let ht=class extends a.f{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g,v,f){if(super(e,s,n,i,o,a,r,c,l,d,u,h,p,m,b,g,v,f),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.scope=r,this.timeout=c,this.localizeService=l,this.contextCourse=d,this.$ngRedux=u,this.ltiService=p,this.CloudStorageIntegrationModalService=m,this.scheduleTask=h,this.contextService=b,this.allyService=g,this.featureFlagService=v,this.fileUploadSettingsService=f,!r.gradedQuestionAttempt)throw new Error("Graded question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(ut),this.constructViewHelper()}getAnswerChoiceStyles(e){const t=this.viewHelper.isAnswerChoiceSelected(e),s=this.viewHelper.isAnswerChoiceCorrect(e);return this.getAnswerStyles(t,s,!0)}constructViewHelper(){this.viewHelper=this.$injector.instantiate(lt,{question:this.questionAttempt.question,questionAttempt:this.questionAttempt,showCorrectAnswer:!0,scope:this.scope})}};ht.$inject=[],ht=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)("scope")),Object(o.__param)(8,Object(S.b)(u.b)),Object(o.__param)(9,Object(S.b)(d.serviceName)),Object(o.__param)(10,Object(S.b)(m.e)),Object(o.__param)(11,Object(S.b)("$ngRedux")),Object(o.__param)(12,Object(S.b)(v.b)),Object(o.__param)(13,Object(S.b)(g.b)),Object(o.__param)(14,Object(S.b)(b.c)),Object(o.__param)(15,Object(S.b)(h.b)),Object(o.__param)(16,Object(S.b)(C.b)),Object(o.__param)(17,Object(S.b)(y.b)),Object(o.__param)(18,Object(S.b)(O.b))],ht);let bt=class extends a.g{constructor(e,t,s,n,i,o,a,r,c,l,d){if(super(e,s,n,i,o,a,c,l,d,r),this.$compile=e,this.$injector=t,this.$sce=s,this.$window=n,this.attrs=i,this.element=o,this.gradebookPermissionService=a,this.localizeService=r,this.scope=c,this.timeout=l,this.ultraState=d,!c.gradedQuestionAttempt)throw new Error("Graded question attempt must be provided in attempt grading mode.");this.insertQuestionSpecificTemplate(ut),this.viewHelper=t.instantiate(lt,{question:this.questionAttempt.question,questionAttempt:this.questionAttempt,showCorrectAnswer:this.canShowCorrectAnswerRelatedDetail(),scope:c})}getAnswerChoiceStyles(e){const t=this.viewHelper.isAnswerChoiceSelected(e);if(!Ve.a.studentCanViewAttemptResults(this.attempt))return t?`${Ue.a.IsSelected} ${Ue.a.AnswerSelectedNotPosted}`:Ue.a.AnswerNotSelected;const s=this.viewHelper.isAnswerChoiceCorrect(e),n=this.canShowCorrectAnswerRelatedDetail();return this.getAnswerStyles(t,s,n)}};bt.$inject=[],bt=Object(o.__decorate)([Object(o.__param)(0,Object(S.b)("$compile")),Object(o.__param)(1,Object(S.b)("$injector")),Object(o.__param)(2,Object(S.b)("$sce")),Object(o.__param)(3,Object(S.b)("$window")),Object(o.__param)(4,Object(S.b)("attrs")),Object(o.__param)(5,Object(S.b)("element")),Object(o.__param)(6,Object(S.b)(l.b)),Object(o.__param)(7,Object(S.b)(d.serviceName)),Object(o.__param)(8,Object(S.b)("scope")),Object(o.__param)(9,Object(S.b)(u.b)),Object(o.__param)(10,Object(S.b)(p.d))],bt),s.d(t,"a",(function(){return gt})),s.d(t,"b",(function(){return vt}));const gt="ultra.components.directives.assessment.assessment-question.question-handlers",vt="questionFactory";n.module(gt,[i.a,d.moduleName,Ee,b.b]).factory(vt,["$injector",d.serviceName,(e,t)=>{const s=t.loadBundle("components/directives/assessment/assessment-question");return{getQuestionHandler:(t,n,i)=>s.then((()=>{let s;s=t.gradedQuestionAttempt?t.gradedQuestionAttempt.questionAttempt.questionType:t.question?t.question.questionType:t.questionAttempt.questionType;return function(t){switch(t){case w.QuestionType.Essay:return e.instantiate(k);case w.QuestionType.PresentationOnly:return e.instantiate(it);case w.QuestionType.Multiple:return e.instantiate(Ke);case w.QuestionType.Either:return e.instantiate(pt);case w.QuestionType.FIMB:return e.instantiate(M);case w.QuestionType.Matching:return e.instantiate(xe);case w.QuestionType.CalculatedFormula:return e.instantiate(K);case w.QuestionType.CalculatedNumeric:return e.instantiate(ee);case w.QuestionType.Hotspot:return e.instantiate(ce);default:throw new Error("Unsupported question type:"+t)}}(s).getHandlerByMode(t,n,i)}))}}])},e7Kn:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return D}));var n=s("D57K"),i=(s("1/hr"),s("Llzl")),o=s("lx16"),a=s("0JpG"),r=s("kC07"),c=s("RPq7"),l=s("nYZ0"),d=s("LdA1"),u=s("sLTT"),p=s("M8+u"),m=s("D8d/"),h=s("L+81"),b=s("lr7J"),g=s("aHpC"),v=s("pjml"),f=s("rtZE"),w=s("tfx2"),S=s("lEL+"),C=s("gkef"),y=s("oQrK"),O=s("fN3Q"),A=s("hDL0"),I=s("W6wm");const D="ultra.directives.contentOutline";let k=class{constructor(t,s,n,i,o,a,r,c){this.scope=t,this.element=s,this.ContentService=i,this.CourseContentModel=o,this.timeout=a,this.windowService=r,this.localizeService=c,this.cloudUploadInProgress={},this.showContentImportProgress=!1,this.LARGE_CONTAINER_SELECTOR=".bb-offcanvas-panel-wrap .panel-wrap",this.SMALL_CONTAINER_SELECTOR=".bb-offcanvas-panel-wrap .panel-wrap .panel-content",this.getContentTrackingId=e=>null!=e.id?e.id:(e.ui.tempId||(e.ui.tempId=this.getTempId()),e.ui.tempId),this.contextArea=t.contextArea,this.addContentButtonLocation=null,this.loadMoreChildren=t.loadMoreChildren,this.parentFolder=t.parentFolder,this.onFileDropHandler=t.onFileDropHandler,this.onMoveHandler=t.onMoveHandler,this.onMoveIntoFolderHandler=t.onMoveIntoFolderHandler,this.canMove=t.canMove&&(!t.contents.permissions||t.contents.permissions.move),this.showMenuOverride=!1,null!=t.contents&&"function"==typeof t.contents.$asPromise&&t.contents.$asPromise().then((()=>{this.showMenuOverride=0===t.contents.length})),this.placeholderContent=this.CourseContentModel.$buildRaw({id:this.parentFolder&&this.parentFolder.id&&this.parentFolder.id+"_placeholder",parentId:this.parentFolder&&this.parentFolder.id,contentHandler:v.p.ContentHandler.Unknown.toString(),depth:this.parentFolder&&this.parentFolder.depth&&this.parentFolder.depth+1}),t.$watch("contents.length",((n,i)=>{this.showMenuOverride=0===n,this.placeholderContent.id=this.parentFolder&&this.parentFolder.id&&this.parentFolder.id+"_placeholder",this.placeholderContent.parentId=this.parentFolder&&this.parentFolder.id,this.resetMovableAddContentButton(s),n<i&&(t.$emit("content-outline-infinite-scroll-check"),e(`#add-button${this.scope.parentFolder.id}`).appendTo(e(`#add-button-container${this.scope.parentFolder.id}`)))})),t.$eval(n.showContentImportProgress)&&this.addImportPlaceholder(),t.$on("bb-drag-start",(()=>{this.resetMovableAddContentButton(s)})),t.$on("keyboard-drag-start",(()=>{this.resetMovableAddContentButton(s)})),t.$on("showContentImportProgress",((e,t,s)=>{"-1"!==s&&this.parentFolder.id!==s||this.addImportPlaceholder()})),t.$on(w.b,((e,t)=>{this.cloudUploadInProgress[t]||(this.cloudUploadInProgress[t]=!0)}))}resetMovableAddContentButton(e){this.addContentButtonLocation=null,e.append(this.getMovableAddContentButton())}addImportPlaceholder(){this.ContentService.getOrMakeContentInContentTree(this.parentFolder,this.parentFolder.courseId,void 0,this.parentFolder.id,"start").then((t=>{t.content.ui.importPlaceholder=!0,this.timeout((()=>{e(".placeholder-container").closest(".js-content-div").scrollintoview({duration:300})}),this.scope,0,!1)}))}getScrollContainerSelector(){return this.windowService.isLargeBreakpoint()?this.LARGE_CONTAINER_SELECTOR:this.SMALL_CONTAINER_SELECTOR}getScrollForceShowSelector(){return`.${r.a}`}isAllContentsLoaded(){return!!(this.scope.contents&&this.scope.contents.paging&&this.scope.contents.paging.count)&&this.scope.contents.length>=this.scope.contents.paging.count}isAddContentButtonUnattached(e){return!!e&&(!this.addContentButtonLocation||e!==this.addContentButtonLocation.id)}placeAddButton(t,s=!1){const n=this.parentFolder?`.movable-add-content-button-folder${this.parentFolder.id}`:"";if(!this.isAddContentButtonUnattached(t.id)||this.contextArea===I.a.Discussions||void 0===t.id)return;const i=!!document.querySelector(".ms-ContextualMenu-list.is-open");!s&&i||(this.getMovableAddContentButton().appendTo(e(`#add-button-placeholder${t.id}`)),this.addContentButtonLocation=t,this.scope.$broadcast("change-add-content-button-position",{reopen:i}),s&&this.element.find(`.movable-add-content-button.movable-add-content-button${n} .button-add-content.js-show-add-options`).focus())}getMovableAddContentButton(){const e=this.parentFolder?`.movable-add-content-button-folder${this.parentFolder.id}`:"";return this.element.find(`.movable-add-content-button${e}`)}getAddButtonLineLabel(e){return this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.add-content-button.aria-label.content.add-button-label-item-name-after",params:{itemName:e},noWrap:!0,noEscape:!0})}isMobileDevice(){return y.a.detect().mobile()}shouldShowMenuOverride(){return(!this.parentFolder||0!==this.parentFolder.depth)&&this.showMenuOverride}shouldShowAddButton(){return this.scope.isFirst||this.scope.contents&&0===this.scope.contents.length}hasId(e){return this.scope.contents.some((t=>t.ui.tempId===e||t.id===e))}getTempId(){let e,t=!1;for(;!t;)e=Object(O.v4)(),t=!this.hasId(e);return e}isProgressTrackingStateShown(e){var t;return null===(t=e.permissions)||void 0===t?void 0:t.canViewReviewState}};k=Object(n.__decorate)([Object(n.__param)(0,Object(g.b)("scope")),Object(n.__param)(1,Object(g.b)("element")),Object(n.__param)(2,Object(g.b)("attrs")),Object(n.__param)(3,Object(g.b)(l.f)),Object(n.__param)(4,Object(g.b)(v.p.serviceName)),Object(n.__param)(5,Object(g.b)(S.b)),Object(n.__param)(6,Object(g.b)(C.b)),Object(n.__param)(7,Object(g.b)(a.serviceName))],k);class _{constructor(e,t){this.link=e,this.recursionHelper=t,this.replace=!0,this.restrict="E",this.scope={canCreate:"=",contents:"=",contextArea:"=",loadMoreChildren:"=",isFirst:"=",parentFolder:"=",onFileDropHandler:"=?",onMoveHandler:"=",onMoveIntoFolderHandler:"=?",canMove:"=",canCreateAllContents:"=?",canCopyImport:"=?",hideAddMenuOverride:"=?"},this.compile=e=>this.recursionHelper.compile("content-outline-directive",e,this.link),this.template=A}}_.$inject=["link",f.b],i.module(D,[o.a,r.b,u.a,p.a,d.a,c.b,l.d,m.a,h.a,b.b,f.a,C.a,a.moduleName]).directive("bbContentOutline",["$injector",l.f,e=>e.instantiate(_,{link:(t,s,n)=>{t.contentOutline=e.instantiate(k,{scope:t,element:s,attrs:n})}})])}).call(this,s("71td"))},eAnr:function(e,t,s){"use strict";s.d(t,"a",(function(){return c})),s.d(t,"c",(function(){return l})),s.d(t,"b",(function(){return d}));var n=s("Llzl"),i=s("g7Mf"),o=s("TnpK"),a=s("uFkY"),r=s("zGdY");const c="ultra.services.feedback",l="feedbackService",d="engagement-submissions-list:reload-on-feedback-save";class u{constructor(e,t){this.$q=e,this.$sce=t,this.emptyFeedback=()=>this.$q.when({}),this.fetchAttemptFeedback=e=>e.grade.attempts.$fetch().$asPromise().then((t=>(e.grade.attempts=t,{feedbackToUser:t[0]&&t[0].feedbackToUser,feedback:this.$sce.trustAsHtml(t[0]&&t[0].feedbackToUser?t[0].feedbackToUser.rawText:"")}))),this.findAttemptFeedback=e=>{const t=e.attemptsReadyToPost[0];return e.grade.attempts.$find(t.id).$asPromise().then((e=>e.feedbackToUser?{feedbackToUser:e.feedbackToUser,feedback:e.feedbackToUser.rawText}:this.emptyFeedback()))},this.resolveGradeFeedback=e=>this.$q.when({feedbackToUser:e.grade.instructorFeedback,feedback:this.$sce.trustAsHtml(e.grade.instructorFeedback.rawText)})}}u.$inject=["$q","$sce"];class p{constructor(e,t,s,n,i){this.$injector=e,this.$q=t,this.$rootScope=s,this.discussionService=n,this.ultraStateService=i,this.loadFeedbackFromRow=e=>e&&e.grade?this.hasGradeFeedback(e)?this.loadHelper.resolveGradeFeedback(e):this.needsGrading(e)&&this.hasAttemptReadyToPost(e)?this.loadHelper.findAttemptFeedback(e):this.loadHelper.fetchAttemptFeedback(e):this.loadHelper.emptyFeedback(),this.needsGrading=e=>e.grade&&r.GradeStatus.NeedsGrading===e.grade.status,this.hasAttemptReadyToPost=e=>e.attemptsReadyToPost&&e.attemptsReadyToPost[0],this.hasGradeFeedback=e=>e.grade&&e.grade.instructorFeedback,this.refreshDiscussionPanel=()=>{this.$rootScope.$broadcast("reload-discussion-panel")},this.refreshAfterEngagementFeedbackSave=e=>{this.$rootScope.$broadcast(d,e)},this.refreshAfterAssessmentAttemptFeedbackSave=(e,t)=>Object(a.b)(this.$rootScope,e,t),this.refreshAfterIndividualfeedbackSave=e=>Object(a.c)(this.$rootScope,e),this.refreshGradeGridView=(e,t)=>{this.$rootScope.$broadcast(a.a,this.getCurrentColumn().id,t,null,e)},this.getCurrentColumn=()=>this.discussionService.column,this.getOrCreateGrade=e=>{const t=this.getCurrentColumn().grades,s=t.find((t=>t.user.$pk===e.user.id));return s?this.$q.when(s):t.$new().withParams({userId:e.user.id}).$save().$asPromise()},this.loadHelper=e.instantiate(u)}}p.$inject=["$injector","$q","$rootScope",i.c,o.d];n.module(c,[]).service(l,p)},eWdw:function(e,t,s){},eYRL:function(e,t){e.exports='<ng-switch on="targetContent.contentHandler.toString()">\n  <a ng-switch-when="resource/x-bb-forumlink" class="content-title"\n     bb-peek-sref="discussion.view.with-grading({contentId:\'{{targetContent.id}}\'})"\n     bb-prevent-click-if="targetContent.isConditionalReleaseLocked()"\n     aria-describedby="{{ariaDescribedBy}}"\n     analytics-id="course.link.item.forumLink.link"\n     aria-hidden="{{ aria }}"\n     tabindex="{{ tabbable ? -1 : 0 }}"><span>{{ content.title }}</span></a>\n  <div ng-switch-default class="content-title">{{ content.title }}</div>\n</ng-switch>\n'},fGDP:function(e,t,s){"use strict";var n=s("D57K"),i=(s("HwkA"),s("CG4K"),s("8wib"),s("6ZXc"),s("3Lzw"),s("5m/6"),s("nsO7")),o=s("Llzl"),a=s("en1n"),r=(s("s4xR"),s("lx16")),c=s("RPq7"),l=s("D8d/"),d=s("pKNj"),u=s("X/qj"),p=s("o5Lu"),m=s("P2dS"),h=s("ujI6"),b=s("0JpG"),g=s("lEL+"),v=s("IbyE"),f=s("Efpj"),w=s("ZQFV"),S=s("aHpC");const C="ultra.components.directives.grade.courseGradesGraderList";let y=class{constructor(e,t,s,n,i,o){this.scope=e,this.attrs=t,this.gradebookPermissionService=s,this.$ngRedux=n,this.grade=i,this.categoryService=o,this.categoryMap={},this.onMoveGraderItem=e=>{const t=this.findGraderItemById(e.dragContentId),s=t.positionBeforeId?t.positionBeforeId:null,n=t.positionAfterId?t.positionAfterId:null,i=this.columns.indexOfItemById(e.dragContentId);let o=null;return e.positionBeforeId?(o=this.columns.indexOfItemById(e.positionBeforeId),-1!==o&&-1!==i&&i<o&&o--,t.positionBeforeId=e.positionBeforeId):e.positionAfterId&&(o=this.columns.indexOfItemById(e.positionAfterId),-1!==o&&-1!==i&&i>o&&o++,t.positionAfterId=e.positionAfterId),null==o||i===o||-1===i||-1===o?(t.positionBeforeId=s,void(t.positionAfterId=n)):(this.columns.splice(o,0,this.columns.splice(i,1)[0]),t.$patch())},this.canModify=this.gradebookPermissionService.canModify(),this.contextArea="grades",this.columns=e.columns,this.course=e.course(),this.hasColumns=!0,this.subscribeToReduxChanges(),this.categoryService.getOrLoadCategoriesForCourse(this.scope.course().id).then((e=>{e.forEach((e=>{this.categoryMap[e.id]=e}))})),this.scope.showSetupOverallColumn&&this.loadSetupOverallGradeMessageIsHiddenPreference&&!this.setupOverallGradeMessageIsHiddenPreference&&this.loadSetupOverallGradeMessageIsHiddenPreference(w.SETUP_OVERALL_GRADE_MESSAGE_COURSE_PREFERENCE.key).then((()=>{var e;const t="true"===(null===(e=this.setupOverallGradeMessageIsHiddenPreference)||void 0===e?void 0:e.value);this.showSetupOverallGradeMessage=!t})),e.$watchCollection("columns",(t=>{t&&(this.columns=t,this.hasColumns=0!==t.length,this.attendanceColumnExists=this.columns.some((e=>e.isAttendance())),e.$broadcast("update-content-menu"))})),e.$on("content-item-mouseover",((t,s)=>{e.$apply((()=>{e.$broadcast("content-item-hover",s)}))})),e.$on("course-gradebook-mouse-leave",(()=>{e.$broadcast("content-outline-hover-end")})),e.$on("attempt-base-content-update",((e,t)=>{const s=this.columns.filter((e=>t.id===e.contentId));s.length>0&&s.forEach((e=>{e.$fetch()}))})),e.$on("bb-change-overall-panel-visibility",((e,t,s)=>{var n;if(this.course.id!==t&&this.course.isComplete())return;const i="true"===(null===(n=this.setupOverallGradeMessageIsHiddenPreference)||void 0===n?void 0:n.value);this.showSetupOverallGradeMessage=i?!i:s}))}subscribeToReduxChanges(){const e=this.$ngRedux.connect((e=>({setupOverallGradeMessageIsHiddenPreference:v.select.coursePreference.getCoursePreferenceByKeyAndCourseId(e,w.SETUP_OVERALL_GRADE_MESSAGE_COURSE_PREFERENCE.key,this.course.id)})),(e=>({loadSetupOverallGradeMessageIsHiddenPreference:t=>e(v.actions.coursePreference.loadCoursePreference({key:t,courseId:this.course.id}))})))(this);this.scope.$on("$destroy",e)}findGraderItemById(e){return i.find(this.columns,(t=>t.id===e))}setupOverallGradeHideMessageCallback(){this.scope.$apply((()=>this.showSetupOverallGradeMessage=!1))}};y=Object(n.__decorate)([Object(n.__param)(0,Object(S.b)("scope")),Object(n.__param)(1,Object(S.b)("attrs")),Object(n.__param)(2,Object(S.b)(u.b)),Object(n.__param)(3,Object(S.b)("$ngRedux")),Object(n.__param)(4,Object(S.b)(p.k)),Object(n.__param)(5,Object(S.b)(m.c))],y);class O{constructor(e,t){this.$injector=e,this.timeout=t,this.restrict="E",this.template=f,this.scope={course:"&",columns:"=",showSetupOverallColumn:"=",isFirst:"=",attendanceIsAvailable:"&"},this.link=(e,t,s)=>{this.timeout((()=>{e.courseGradesGraderList=this.$injector.instantiate(y,{scope:e,element:t,attrs:s})}),e)}}}O.$inject=["$injector",g.b],o.module(C,[d.a,h.c,r.a,c.b,l.a]).directive("bbCourseGradesGraderList",["$injector",b.serviceName,(e,t)=>(t.loadBundle("components/directives/grade/course-grades-grader-list"),e.instantiate(O))]);var A=s("jhBu"),I=s("cbVV");const D="ultra.components.services.gradebookSearchbox",k="gradebookSearchbox";var _;!function(e){e.USER="user",e.COLUMN="column",e.CATEGORY="category",e.NO_RESULT="noResult"}(_||(_={}));let j=class e{constructor(e,t,s){this.$rootScope=e,this.$q=t,this.bbLocalize=s}typeAheadSearch(t,s,n){const i=new RegExp("^.*"+t.replace(e.REGULAR_EXPRESSION_TOKENS,"\\$&")+".*$","i"),o=[];this.searchUsersResults(i,t,n).forEach((e=>{o.push({type:_.USER,data:e})}));this.searchColumnResults(i,t,s).forEach((e=>{o.push({type:_.COLUMN,data:e})}));return this.searchCategoryResults(i,t,s).forEach((e=>{o.push({type:_.CATEGORY,data:e,id:e.data.gradebookCategory.id})})),0===o.length&&o.push({type:_.NO_RESULT,data:null}),o}searchUsersResults(e,t,s){const n=[s=>{const n=(s,n)=>e.test(s)&&0===s.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())&&t.length>n;return n(`${s.user.givenName} ${s.user.familyName}`,s.user.givenName.length)||n(`${s.user.familyName} ${s.user.givenName}`,s.user.familyName.length)},t=>e.test(`${t.user.givenName}`),t=>e.test(`${t.user.familyName}`),t=>t.user.userName&&e.test(t.user.userName),t=>t.user.studentId&&e.test(t.user.studentId)];return Object(i.orderBy)(s.filter((e=>{let s=0;const i=n.findIndex((t=>t(e)));switch(i){case 1:s=e.user.givenName.toLocaleLowerCase().indexOf(t.toLocaleLowerCase());break;case 2:s=e.user.familyName.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())+.5;break;case 3:s=e.user.userName.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())+100;break;case 4:s=e.user.studentId.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())+1e3}return e.ui._weight=s,i>=0})),["ui._weight","user.givenName","user.familyName"],["asc","asc","asc"])}searchColumnResults(e,t,s){const n=[t=>e.test(`${t.data.columnName}`)],o=s.filter((e=>!(e instanceof I.l||e instanceof I.k)));return Object(i.orderBy)(o.filter((e=>{let s=0;const i=n.findIndex((t=>t(e)));return-1!==i&&(s=e.data.effectiveColumnName&&e.data.effectiveColumnName.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())),e.weight=s,i>=0})),["weight","data.columnName"],["asc","asc"])}searchCategoryResults(e,t,s){const n=[(()=>t=>{const s=this.getCategoryTitle(t.data.gradebookCategory);return e.test(`${s}`)})()],o=s.filter((e=>!!e.data.gradebookCategory)),a=Object(i.uniqBy)(o,(e=>e.data.gradebookCategory.id));return Object(i.orderBy)(a.filter((e=>{let s=0;const i=n.findIndex((t=>t(e))),o=this.getCategoryTitle(e.data.gradebookCategory);return-1!==i&&(s=o.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())),e.weight=s,i>=0})),["weight","data.categoryTitle"],["asc","asc"])}getCategoryTitle(e){return e.isUserDefined?e.title:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$rootScope),key:e.localizableTitle.languageKey})}};j.REGULAR_EXPRESSION_TOKENS=/[-\/\\^$*+?.()|[\]{}]/g,j=Object(n.__decorate)([Object(n.__param)(0,Object(S.b)("$rootScope")),Object(n.__param)(1,Object(S.b)("$q")),Object(n.__param)(2,Object(S.b)(b.serviceName))],j);o.module(D,[b.moduleName]).service(k,j);var T=s("lr7J"),$=s("12mu"),R=s("pjml"),E=s("TnpK"),x=s("yC9S"),P=s("oQrK"),L=s("LN5R"),G=s("qH3X"),M=s("2o5C"),N=s("kp/p"),F=s("ERkP"),B=s("1ZbL"),q=s("SToD");const z="ultra.directives.grade.studentListViewTable";class U extends F.Component{render(){const{analyticsId:e,courseId:t,currentUserId:s}=this.props;return F.createElement(w.StudentListView,{analyticsId:e,courseId:t,currentUserId:s})}}const V={Class:Object(q.a)(U),attributes:["analyticsId"],bindingNames:["courseId","currentUserId"],renderLocalized:!0,withProvider:!0};o.module(z,[]).component("bbStudentListViewTable",Object(B.a)(V));var H=s("fYJU");const Q="ultra.components.directives.studentListView";let K=class{constructor(e,t){this.scope=e,this.currentUserId=t.userId}};K=Object(n.__decorate)([Object(n.__param)(0,Object(S.b)("scope")),Object(n.__param)(1,Object(S.b)(H.b))],K);let W=class{constructor(e){this.$injector=e,this.restrict="E",this.template='<bb-student-list-view-table\n                        analytics-id="components.directives.grades.studentListView"\n                        course-id="studentListView.scope.courseId"\n                        current-user-id="studentListView.currentUserId"\n                      ></bb-student-list-view-table>',this.scope={courseId:"<"},this.link=e=>{e.studentListView=this.$injector.instantiate(K,{scope:e})}}};W=Object(n.__decorate)([Object(n.__param)(0,Object(S.b)("$injector"))],W),angular.module(Q,[z]).directive("bbStudentListView",["$injector",e=>e.instantiate(W)]);const J="ultra.directives.grade.overallGradeSetup",Y={Class:({showFixedView:e,courseId:t,analyticsId:s,setupOverallGradeHideMessageCallback:n})=>F.createElement(w.OverallGradeSetup,{analyticsId:s,showFixedView:e,courseId:t,setupOverallGradeHideMessageCallback:n}),attributes:["analyticsId"],bindingNames:["showFixedView","courseId","setupOverallGradeHideMessageCallback"],renderLocalized:!0,withProvider:!0,withThemeProvider:!0};o.module(J,[]).component("bbOverallGradeSetup",Object(B.a)(Y));const Z="ultra.components.directives.setupOverallGrade";let X=class{constructor(e){this.$injector=e,this.restrict="E",this.template='<bb-overall-grade-setup\n                        analytics-id="components.directives.grade.overall-panel"\n                        show-fixed-view="showFixedView"\n                        course-id="courseId"\n                        setup-overall-grade-hide-message-callback="setupOverallGradeHideMessageCallback">\n                      </bb-overall-grade-setup>',this.scope={showFixedView:"<",courseId:"<",setupOverallGradeHideMessageCallback:"&"}}};X=Object(n.__decorate)([Object(n.__param)(0,Object(S.b)("$injector"))],X),angular.module(Z,[J]).directive("bbSetupOverallGrade",["$injector",e=>e.instantiate(X)]);var ee=s("cpZm"),te=s("zYa8"),se=s("93oC");const ne="ultra.components.directives.bbUiIcon.small.FilterOptions";Object(te.a)(se.FilterOptions,ne,"bbUiIconSmallFilterOptions");var ie=s("KvMR"),oe=s("884J"),ae=s("c6mg"),re=s("3+vU"),ce=s("Pq3J");const le="ultra.components.directives.grade.gradebook-advanced-filters-ftue";let de=class{constructor(e,t,s){this.$scope=e,this.$q=t,this.localizeService=s,this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.buttonAriaLabel").then((e=>this.buttonAriaLabel=e)),this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.title").then((e=>this.announcementTitle=e)),this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.content").then((e=>this.content=e)),this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.doneButtonText").then((e=>this.doneButtonText=e)),this.translate("global.close").then((e=>this.closeLabel=e)),this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.moreInfoLinkText").then((e=>this.linkText=e)),this.translate("components.directives.grade.course-grades-grader.ftue.advancedFilters.moreInfoLinkUrl").then((e=>this.linkHref=e))}translate(e){return this.localizeService.translate({locale:this.localizeService.getLocale(this.$scope),key:e,noWrap:!0,noEscape:!0})}};de=Object(n.__decorate)([Object(x.a)({moduleName:le,componentName:"bbGradebookAdvancedFiltersFtue",template:ce,bindings:{},requireModules:[re.a]}),Object(n.__param)(0,Object(S.b)("$scope")),Object(n.__param)(1,Object(S.b)("$q")),Object(n.__param)(2,Object(S.b)(b.serviceName))],de);var ue=s("PxC7");const pe="ultra.components.directives.bbUiIcon.medium.ContentView";Object(te.a)(ue.a,pe,"bbUiIconMediumContentView");var me=s("Sa5G"),he=s("po/h"),be=s("dF44"),ge=s("ZzR9"),ve=s("Y+9S"),fe=s("ewIX");s.d(t,"c",(function(){return we})),s.d(t,"a",(function(){return Se})),s.d(t,"b",(function(){return Ce}));const we="ultra.directives.grade.courseGradesGrader",Se="after-update-grades";var Ce;!function(e){e.List="list",e.Grid="grid"}(Ce||(Ce={}));const ye=new Set([Ce.List,Ce.Grid]),Oe=Ce.List,Ae=new Set([ee.a.id,ee.b.id]),Ie=ee.a.id;let De=class{constructor(e,t,s,n,i,o,a,r,c,l,d,u,m){this.$modal=e,this.$location=t,this.scope=s,this.$q=n,this.entitlementService=i,this.grade=o,this.gradebookPermissionService=a,this.categoryService=r,this.ultraState=c,this.timeout=l,this.gradeSearchBox=d,this.bbLocalize=u,this.$ngRedux=m,this.GRADE_COLUMN_LOAD_LIMIT=1e3,this.GRADE_COLUMN_RENDER_LIMIT=50,this.currentlyLoading=!1,this.categoryTitleMap={},this.allCategoriesLoaded=!1,this.isDesktop=!1,this.firstRender=!0,this.canDownloadGradebook=!1,this.canUploadGradebook=!1,this.showFilterCriteriaSettings=!1,this.mergedCourses=[],this.filteredColumns=[],this.filteredRows=[],this.advancedFiltersEmptyResults=!1,this.checkForURLFilters=()=>{const e=this.$location.search();this.hasUrlFilters=!!(e.memberId||e.gradebookColumnId||e.gradebookCategoryId||e.courseGroupId||e.childCourseId)},this.changeListViewType=e=>{Ae.has(e)&&(this.currentTabId=e)},this.handleLocationChanged=()=>{var e;const t=null===(e=this.$location.search())||void 0===e?void 0:e.gradebookView;ye.has(t)&&(this.view=t)};const h=c.params.gradebookView,b=c.params.listViewType;this.setUpLastViewGradebookPreferenceKey(),this.subscribeToReduxChanges(),this.isDesktop=P.a.detect().desktop(),ye.has(h)?this.view=h:this.getLastViewPreference(),Ae.has(b)?this.currentTabId=b:this.currentTabId=Ie,this.checkForURLFilters(),s.$on(ge.a.$locationChangeSuccess,this.checkForURLFilters),this.setupColumnUpdateResponder(),this.setupColumnDeleteResponder(),this.setupViewChange(),this.setupBreakpointChange(),this.setupListViewTypeChange(),this.userHasViewGradebookPermission=this.gradebookPermissionService.canView(),s.$on("bb-update-category-icon",((e,t,s)=>{t.categoryTitle=this.categoryTitleMap[s]})),s.$on(M.b,(()=>{this.expandColumnSummaries(this.visibleColumns)})),s.$on(G.a.GRADEBOOK_CLEAR_SEARCHBOX_SELECTION,(e=>{this.updateFilteredCount()})),s.$on(G.a.ADVANCED_FILTERS_COLUMNS,((e,t)=>{var s,n;this.filteredColumns=t,_.CATEGORY!==(null===(s=this.selectedItem)||void 0===s?void 0:s.type)&&_.COLUMN!==(null===(n=this.selectedItem)||void 0===n?void 0:n.type)||this.itemSelected(this.selectedItem)})),s.$on(G.a.ADVANCED_FILTERS_ROWS,((e,t)=>{var s;this.filteredRows=t,_.USER===(null===(s=this.selectedItem)||void 0===s?void 0:s.type)&&this.itemSelected(this.selectedItem)})),x.b.OnRootScope(s,p.b,((e,t)=>{const s=this.visibleColumns.find((e=>e.id===t.columnId));s&&(s.summary.$fetch(),this.scope.$root.$broadcast("bb-update-summary"),this.scope.$root.$broadcast("bb-update-category-icon",s),this.replaceOrInsertColumnWrapper(s),s.$fetch())})),this.canUploadGradebook=a.canModify(),this.scope.courseGrades.course.$then((e=>{e.isToolAvailable("bb-attendance").then((e=>{this.attendanceIsAvailable=e})),this.loadColumns(),this.course=e,this.loadMergedCourse(),this.canDownloadGradebook=a.canViewGrades()&&this.entitlementService.isEntitled("course.gradebook-data.export.EXECUTE",this.course.id),this.notifyMobileApp()}))}getLastViewPreference(){this.isDesktop&&!this.isSmallScreen?this.loadUserPreference({key:this.lastViewGradebookPreferenceKey}).then((()=>{const e=this.lastViewPreference;this.view=(null==e?void 0:e.value)&&ye.has(e.value)?e.value:Oe})).catch((()=>{this.view=Oe})):this.view=Oe}notifyMobileApp(){if(Object(ve.isInMobileApp)()){const e={showDownload:this.canDownloadGradebook,showSettings:this.userHasViewGradebookPermission,showUpload:this.canUploadGradebook,showSubmissionReceipt:!0},t={type:ve.MessageType.CourseGradeOpened,status:ve.MessageStatus.Success,permission:e},s=Object(ve.registerMobileEventHandler)(t);s.response.subscribe((e=>this.mobileEventHandlerSubscriber(e))),this.scope.$on("$destroy",(()=>{Object(ve.clearMobileEventHandler)(s.correlationId)}))}}mobileEventHandlerSubscriber(e){e.event===ve.EventType.GotoSettings?this.ultraState.goPeekState(fe.GradeRoutes.GRADE_SETTING):e.event===ve.EventType.GotoDownload?this.ultraState.goPeekState(fe.GradeRoutes.GRADE_DOWNLOAD_SETTINGS):e.event===ve.EventType.GotoUpload?this.ultraState.goPeekState(fe.GradeRoutes.GRADE_UPLOAD):e.event===ve.EventType.GotoSubmissionReceipt&&this.ultraState.goPeekState(fe.GradeRoutes.ATTEMPT_RECEIPT_SEARCH)}get squareToggleValue(){return this.isGridView?Ce.Grid:Ce.List}set squareToggleValue(e){void 0!==this.lastViewGradebookPreferenceKey&&this.saveUserPreference({key:this.lastViewGradebookPreferenceKey,value:e}),this.view=e}get areFilterResultsEmpty(){const e=this.filteredColumns.filter((e=>!(e instanceof I.k||e instanceof I.l)));return this.hasUrlFilters&&(0===e.length||0===this.filteredRows.length||this.selectionNotAvailable)}clearSelection(){var e,t,s;_.USER===(null===(e=this.selectedItem)||void 0===e?void 0:e.type)?this.scope.$broadcast(be.b.ROW,this.filteredRows):_.CATEGORY!==(null===(t=this.selectedItem)||void 0===t?void 0:t.type)&&_.COLUMN!==(null===(s=this.selectedItem)||void 0===s?void 0:s.type)||this.scope.$broadcast(be.b.COLUMN,this.filteredColumns),this.selectedItem=void 0,this.selectionNotAvailable=!1}itemSelected(e){switch(this.clearSelection(),this.selectedItem=e,e.type){case _.USER:return this.selectUser(e);case _.COLUMN:return this.selectColumn(e);case _.CATEGORY:return this.selectCategory(e)}}selectUser(e){const t=e.data.user.id,s=this.filteredRows.findIndex((e=>e.userId===t));return this.selectionNotAvailable=-1===s,-1!==s&&this.scope.$broadcast(G.a.GRADEBOOK_USER_SELECTED,[t]),this.bbLocalize.formatUsernameSync(e.data.user,b.ILocaleUsernameFormat.Short,this.scope,{noWrap:!0,noEscape:!0})}selectColumn(e){const t=e.data.id,s=this.filteredColumns.findIndex((e=>e.id===t));return this.selectionNotAvailable=-1===s,-1!==s&&this.scope.$broadcast(G.a.GRADEBOOK_COLUMN_SELECTED,[t]),e.data.getMetadata().columnName}selectCategory(e){const t=e.id,s=this.filteredColumns.findIndex((e=>e.data.gradebookCategoryId===t));return this.selectionNotAvailable=-1===s,-1!==s&&this.scope.$broadcast(G.a.GRADEBOOK_CATEGORY_SELECTED,[t]),this.gradeSearchBox.getCategoryTitle(e.data.getMetadata().gradebookCategory)}typeAheadSearch(e){const t=this.gradeSearchBox.typeAheadSearch(e,this.filteredColumns,this.filteredRows);return this.$q.resolve(t)}renderMoreColumns(){if(this.currentlyLoading||this.firstRender)this.firstRender=!1;else if(this.columns.length<this.visibleColumns.length){const e=this.addColumns();this.scope.$root.$broadcast(T.a,"course-grades-grader",e)}}addColumns(){const e=this.$q.defer();return this.timeout((()=>{const t=this.columns.length;this.visibleColumns.length-t>this.GRADE_COLUMN_RENDER_LIMIT?this.columns.push(...this.visibleColumns.$slice(t,t+this.GRADE_COLUMN_RENDER_LIMIT)):this.columns=this.visibleColumns,e.resolve()}),this.scope,1e3),e.promise}showGradeListContainer(){return this.allCategoriesLoaded&&(this.columns.length>0&&!this.hasUrlFilters||this.hasUrlFilters)}updateFilteredCount(){this.filteredCount=this.mergedCourses.filter((e=>!0===e.ui.checked)).length}calculateCanAddOverallGrade(e,t){if(!this.gradebookPermissionService.canModify())return void(this.showSetupOverallColumn=!1);(!t||this.course.id===t)&&!this.course.isComplete()?this.showSetupOverallColumn=e:this.showSetupOverallColumn=!1}loadColumns(){this.currentlyLoading=!0;const e=this.grade.loadColumns(this.scope.courseGrades.course,!0,{expand:"collectExternalSubmissions",limit:this.GRADE_COLUMN_LOAD_LIMIT,offset:this.visibleColumns?this.visibleColumns.length:0});this.scope.$root.$broadcast(T.a,"course-grades-grader",e),e.then((e=>e.attachRelatedContentsByScoreProviderHandle(v.ScoreProviderHandle.Scorm))).then((e=>{this.removeNotVisibleColumns(e),this.visibleColumns&&this.visibleColumns.length>0?this.visibleColumns.concat(e):this.visibleColumns=e,this.totalColumnCount=e.paging.count,e.paging.nextPage?this.loadColumns():(this.currentlyLoading=!1,this.loadCategories(),this.grade.needsToSetupOverall(this.visibleColumns,this.course.id).then((e=>{this.calculateCanAddOverallGrade(e)})),this.visibleColumns.length>this.GRADE_COLUMN_RENDER_LIMIT?this.columns=this.visibleColumns.$slice(0,this.GRADE_COLUMN_RENDER_LIMIT):this.columns=this.visibleColumns,this.expandColumnSummaries(this.visibleColumns))}))}expandColumnSummaries(e){const t=1e3,s=e.paging&&e.paging.count||t,n=this.course.gradebook.summaries.expandingColumns(e);return this.$q.all(i.range(0,s,t).map((e=>n.$fetch({limit:t,offset:e,excludeCalculations:!0}).$asPromise()))).then((()=>e))}loadCategories(){this.categoryService.getOrLoadCategoriesForCourse(this.scope.courseGrades.course.id).then((e=>{e.forEach((e=>{this.categoryTitleMap[e.id]=e.title})),this.visibleColumns&&this.visibleColumns.forEach((e=>{e.gradebookCategoryId&&(e.categoryTitle=this.categoryTitleMap[e.gradebookCategoryId])})),this.allCategoriesLoaded=!0}))}loadMergedCourse(){this.entitlementService.isEntitled(me.i.ViewChildCourse,this.course.id)&&this.course.getChildrenCourses().then((e=>{const t=i.sortBy(e,(e=>e.childCourse.name));this.mergedCourses.push(...t),this.mergedCourses.forEach((e=>{e.ui={checked:!1,hidden:!1}}))}))}setupColumnUpdateResponder(){this.scope.$on(p.c,((e,t)=>{this.replaceOrInsertColumnWrapper(t),t.summary.$fetch()})),this.scope.$on("content-update",((e,t)=>{if(t.isScorm()){t.getScormGradebookItems().forEach((e=>{const s=this.course.gradebook.columns.$buildRaw(e.gradingColumn);s.ui={content:t},this.replaceOrInsertColumnWrapper(s),s.summary.$fetch()}))}})),this.scope.$on("bb-change-overall-panel-visibility",((e,t,s)=>{this.calculateCanAddOverallGrade(s,t)})),this.scope.$on("$stateChangeStart",((e,t,s,n)=>{if(n.name.indexOf("attendance")>-1){const e=this.visibleColumns.find((e=>e.isAttendance()));e?e.$fetch().$asPromise().then((()=>this.removeNotVisibleColumns(this.columns))):this.loadColumns()}})),this.scope.$on(N.b,((e,t)=>{this.grade.loadColumns(this.scope.courseGrades.course,!0).then((e=>{this.visibleColumns=e,this.visibleColumns.forEach((e=>e.summary.$fetch())),this.scope.$broadcast(Se,t)}))}))}replaceOrInsertColumnWrapper(e){const t=this.replaceOrInsertColumn(this.visibleColumns,e);this.columns!==this.visibleColumns&&t<this.columns.length&&this.replaceOrInsertColumn(this.columns,e)}replaceOrInsertColumn(e,t){let s=i.findIndex(e,(e=>e.id===t.id));return s>-1?e[s]=t:(t.positionBeforeId?s="start"===t.positionBeforeId.toLowerCase()?0:i.findIndex(e,(e=>t.positionBeforeId===e.id)):t.positionAfterId&&("start"===t.positionAfterId.toLowerCase()?s=0:"end"===t.positionAfterId.toLowerCase()?s=e.length:(s=i.findIndex(e,(e=>t.positionAfterId===e.id)),s>=0&&s++)),s>=e.length||s<0?e.push(t):e.splice(s,0,t),this.totalColumnCount++),s>-1?s:0}_removeColumn(e,t){const s=i.findIndex(e,(e=>e.id===t.id));s>-1&&e.splice(s,1)}removeNotVisibleColumns(e){let t=0;e.forEach(((s,n)=>{!1===s.visibleInBook&&(e.splice(n,1),t++,s.isAttendance()&&(this.scope.$broadcast("bb-delete-column",s),this.scope.$root.$broadcast("bb-reload-grid-view"),this.attendanceIsAvailable=!1))})),e.paging.count=e.paging.count-t}setupColumnDeleteResponder(){this.scope.$on("bb-delete-column",((e,t)=>{this.removeColumn(t),t.externalGrade&&(this.scope.$root.$broadcast("bb-reload-grid-view"),this.scope.$root.$broadcast("bb-change-overall-panel-visibility",t.courseId,!0))}))}removeColumn(e){if(this._removeColumn(this.visibleColumns,e),this.columns!==this.visibleColumns&&this._removeColumn(this.columns,e),this.totalColumnCount--,e&&e.contentId){const t=this.visibleColumns&&this.visibleColumns.find((t=>t.contentId===e.contentId));t&&this.removeColumn(t)}}setupViewChange(){this.scope.$watch("courseGradesGrader.view",(()=>{var e;const t=!(null===(e=this.$location.search())||void 0===e?void 0:e.gradebookView);this.ultraState.search("gradebookView",this.view,{location:!t||"replace",notify:!1}),this.scope.$root.$broadcast(G.a.GRADEBOOK_CLEAR_SEARCHBOX_SELECTION,!0)})),this.scope.$on(ge.a.$locationChangeSuccess,this.handleLocationChanged)}setupListViewTypeChange(){this.scope.$watch("courseGradesGrader.currentTabId",(()=>{this.ultraState.search("listViewType",this.currentTabId)}))}setupBreakpointChange(){x.b.OnWindow("resize",i.debounce((()=>{a.k()&&this.isGridView&&(this.view=Ce.List)}),100),this.scope)}setUpLastViewGradebookPreferenceKey(){const e=this.scope.courseGrades.course.id.replace(/_/g,".");this.lastViewGradebookPreferenceKey="grade.last.gradebook.view"+e}subscribeToReduxChanges(){const e=this.$ngRedux.connect((e=>({lastViewPreference:v.select.userPreference.getUserPreferenceByKey(e,this.lastViewGradebookPreferenceKey)})),(e=>({loadUserPreference:t=>e(v.actions.userPreference.loadUserPreference({...t})),saveUserPreference:t=>e(v.actions.userPreference.persistUserPreference(t))})))(this);this.scope.$on("$destroy",e)}get isSmallScreen(){return a.k()}get isGridView(){return this.view===Ce.Grid}get isGradableItemsListView(){return this.view===Ce.List&&this.currentTabId===ee.a.id}get isStudentListView(){return this.view===Ce.List&&this.currentTabId===ee.b.id}};De=Object(n.__decorate)([Object(n.__param)(0,Object(S.b)("$modal")),Object(n.__param)(1,Object(S.b)("$location")),Object(n.__param)(2,Object(S.b)("scope")),Object(n.__param)(3,Object(S.b)("$q")),Object(n.__param)(4,Object(S.b)(A.b)),Object(n.__param)(5,Object(S.b)(p.k)),Object(n.__param)(6,Object(S.b)(u.b)),Object(n.__param)(7,Object(S.b)(m.c)),Object(n.__param)(8,Object(S.b)(E.d)),Object(n.__param)(9,Object(S.b)(g.b)),Object(n.__param)(10,Object(S.b)(k)),Object(n.__param)(11,Object(S.b)(b.serviceName)),Object(n.__param)(12,Object(S.b)("$ngRedux"))],De);let ke=class{constructor(e){this.$injector=e,this.restrict="E",this.template=he,this.scope=!0,this.link=e=>{e.courseGradesGrader=this.$injector.instantiate(De,{scope:e})}}};ke=Object(n.__decorate)([Object(n.__param)(0,Object(S.b)("$injector"))],ke),o.module(we,[$.a,C,h.c,p.j,u.a,b.moduleName,T.b,R.N,L.b,ee.c,Q,Z,ae.a,ie.a,ne,oe.a,D,le,pe]).directive("bbCourseGradesGrader",["$injector",b.serviceName,(e,t)=>(t.loadBundle("components/directives/grade/course-grades-grader"),e.instantiate(ke))])},fL5R:function(e,t){e.exports='<bb-modal id="peer-confirm-submit-feedback-modal" class="notification success"\n          modal-aria-type="alertdialog"\n          modal-title-key="course.grades.submission-grading.modal.title.review"\n          modal-translate-options="grading.submitModalTranslateOptions"\n          analytics-id-tag-prefix="course.content.assessment.test.modal.confirmSubmitAttemptAlert">\n  <div name="modal-contents">\n    <p bb-translate>course.grades.submission-grading.modal.body.review</p>\n  </div>\n  <button name="modal-footer-button-primary" class="button confirm-ok js-primary-button" ng-click="$parent.$close()" bb-translate course-org-token-resolver analytics-id="course.content.assessment.test.modal.confirmSubmitAttemptAlert.submit">\n    course.content.assessment.test.modal.confirmSubmitAttemptAlert.submit\n  </button>\n  <button name="modal-footer-button-secondary" class="button button--secondary confirm-cancel js-secondary-button" ng-click="$parent.$dismiss()" bb-translate analytics-id="global.cancel">global.cancel</button>\n</bb-modal>\n'},fiT5:function(e,t){e.exports='<div class="hotspot-question-container hotspot-attempt-authoring guidance-wrapper">\n  <bb-question-attempt\n    question="::questionAttempt.question"\n    given-answer="assessmentQuestion.givenAnswer"\n    question-number="::questionAttempt.visibleQuestionNumber"\n    on-answer-change="::assessmentQuestion.onAnswerChange"\n    ally-service="::allyService"\n    content-id="::contentId"\n  ></bb-question-attempt>\n</div>\n'},ftvW:function(e,t,s){"use strict";var n=s("D57K"),i=(s("r+pC"),s("2szi"),s("lwNT"),s("yC9S")),o=s("nYZ0"),a=s("Qbdf"),r=s("X455"),c=s("TnpK"),l=s("aTRN"),d=s("Is+C"),u=s("pjml"),p=s("Q/M7"),m=s("U2yg"),h=s("zGdY"),b=s("nmzr"),g=s("Htol");s.d(t,"a",(function(){return v}));const v="ultra.components.directives.content.contentNavigator";let f=class{constructor(e,t,s,n,i,o,a,r){this.scope=e,this.$state=t,this.timeout=s,this.contentService=n,this.contextCourse=i,this.contextCourseMembership=o,this.$injector=a,this.scormService=r,this.sibling={next:null,previous:null},this.cr={next:null,previous:null}}$onChanges(){this.init()}isStudent(){return this.contextCourseMembership.isStudentMembership()}init(){this.content&&this.isStudent()&&1!==this.content.depth&&this.$state.includes("**.outline.**")&&(this.scope.content=this.content,this.getLearningModuleContent().then((e=>{e.isLearningModule()&&(this.learningModuleContent=e,this.scope.$on(g.b,((e,t,s)=>{s===h.ContentReviewState.Completed&&this.getSibling("next")})),this.getSibling("next"),this.getSibling("previous"))})))}getSibling(e){this.content.getSibling(e,this.learningModuleContent.id).then((t=>{t&&(this.sibling[e]=t,this.cr[e]=this.$injector.instantiate(l.a,{scope:this.scope}),this.cr[e].getConditions(t))}))}getLearningModuleContent(){const e=this.contextCourse.course,t=this.contentService.findRootNode(e,u.p.ContentRootNode.ROOT),s=n=>this.contentService.getParentFolder(n.parentId,e.id,t).$asPromise().then((e=>e.isRoot()?n:s(e)));return s(this.content)}shouldShowNavigator(){return this.isStudent()&&(!!this.sibling.next||!!this.sibling.previous)}navigate(e){if(!this.sibling[e].canEdit()&&this.sibling[e].isConditionalReleaseLocked())return;const t=this.$state.current.name.split("."),s=t.length-t.lastIndexOf("peek")-1,n=this.sibling[e],i="content-navigator-transition-"+(n.isTest()?"peek":"full");this.$state.go("^.".repeat(s)+i).then(this.timeout).then((()=>{if(n.isDiscussionInOutline()){const e=n.contentDetail[u.p.ContentHandler.CourseLink.toString()].linkSourceId;this.$state.go("^.discussion.view.with-grading",{contentId:e})}else if(n.isTest())this.$state.go("^.assessment.overview",{contentId:n.id});else if(n.isDocument())this.$state.go(`^.${b.ContentRoutes.DOCUMENT}`,{id:n.id});else if(n.isJournal())this.$state.go(`^.${b.Routes.Journal.JOURNAL_VIEW_WITH_PARTICIPATION}`,{contentId:n.id});else if(n.isFile())this.$state.go(`^.${b.Routes.File.PREVIEW_FILE}`,{id:n.id});else if(n.isPlaceHolderContent())this.$state.go("^.content-navigator-placeholder",{contentId:n.id});else if(n.isScorm())if(n.getAssociatedGradingColumn())this.$state.go("^.scorm-overview.student",{contentId:n.id});else{let e=p.c(this.scormService.getLaunchLinkFromContent(n));e=p.a(e,"from_ultra","true"),this.$state.go("^.scorm-launch-frame",{toolHref:e,contentId:n.id})}}))}};f.$inject=["$scope",c.d,"$timeout",o.f,a.e,r.d,"$injector",d.c],f=Object(n.__decorate)([Object(i.a)({moduleName:v,componentName:"bbContentNavigator",template:m,bindings:{content:"<",forceShowTitle:"<"},requireModules:[o.d,a.b,r.a,c.b,d.b]})],f)},fvgg:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("LxBy");const o="ultra.components.directives.bbUiIcon.medium.Messages";Object(n.a)(i.a,o,"bbUiIconMediumMessages")},"gK/k":function(e,t,s){"use strict";var n=s("D57K"),i=s("nsO7"),o=s("Llzl"),a=s("9Fiv"),r=s("L2Kv"),c=s("TmUJ"),l=s("yC9S"),d=s("5Dl8"),u=s("dF44"),p=s("TML7"),m=s("kjyA"),h=s("aHpC");s.d(t,"b",(function(){return b})),s.d(t,"a",(function(){return g}));const b="ultra.components.directives.gridReborn",g="bbGridReborn";let v=class{constructor(e,t,s,n,o,a){this.$scope=e,this.$element=t,this.$attrs=s,this.$injector=n,this.$q=o,this.debounce=a,this.containers=Object.create(null),this.afterCellDataUpdatedHooks=[],this.onColumnEvent=(e,t)=>{this.initializedWithOptions.then((()=>{t&&(this.options.columns=t),this.setDefaultValues(),this.afterCellDataUpdated((()=>{this.initStyles(),i.forEach(this.containers,(e=>e.initColumnsPosition()))})),i.forEach(this.splitColumns(),((e,t)=>{this.containers[t].resetColumns(e)}))}))},this.onRowEvent=(e,t)=>{this.initializedWithOptions.then((()=>{t&&(this.options.memberships=t),this.setDefaultValues(),this.initStyles(),this.initRowsPosition(),i.forEach(this.containers,(e=>e.resetRows(t)))}))},this.onDataUpdate=()=>{this.debounceRefresh()},this.notifyScrollHorizontally=i.throttle(this.$scope.$broadcast.bind(this.$scope.$root,u.b.SCROLL_H),u.d),this.notifyScrollVertically=i.throttle(this.$scope.$broadcast.bind(this.$scope.$root,u.b.SCROLL_V),u.d),this.id="rb-grid-"+s.id,t.addClass(this.id),this.scrollbarWidth=Object(c.a)(),this.deferredInitWithOptions=o.defer(),this.initializedWithOptions=this.deferredInitWithOptions.promise;const r=e.$watch(s[g],(e=>{e&&(this.initialize(e),r())}));this.debounceRefresh=this.debounce.asDebounced(this.refreshImpl.bind(this),this.$scope,u.d),this.onWindowResize=this.debounce.asDebounced(this.onWindowResizeImpl.bind(this),this.$scope,u.d),l.b.OnWindow("resize",this.onWindowResize,e),e.$on(u.b.COLUMN,this.onColumnEvent),e.$on(u.b.ROW,this.onRowEvent),e.$on(u.b.DATA_UPDATE,this.onDataUpdate)}onWindowResizeImpl(){i.forEach(this.containers,(e=>{e.adjustRows(),e.adjustColumns()}))}initialize(e){this.options=e,this.setDefaultValues(),this.initStyles(),this.createContainers(),this.initRowsPosition(),this.initColumnsPosition(),this.deferredInitWithOptions.resolve(e)}initStyles(){const e=[],t=this.$element.find("style#rb-grid");e.push(`.${this.id} .rb-header-row {height: ${Object(d.b)(this.options.headerHeight)};}`),e.push(`.${this.id} .column-header-button-wrapper, .${this.id} .rb-add-column-placeholder {height: ${Object(d.b)(this.options.headerContentHeight)};}`),e.push(`.${this.id} .rb-cell-row {height: ${Object(d.b)(this.options.rowHeight)};}`),Array.prototype.push.apply(e,this.options.columns.map((e=>`.${this.id} .rb-col-${e.id} {width: ${Object(d.b)(e.columnWidth)};}`))),e.push(`.${this.id} .rb-grid-scrollbar-placeholder-x {height: ${Object(d.b)(this.scrollbarWidth)};}`),e.push(`.${this.id} .rb-grid-scrollbar-placeholder-y {width: ${Object(d.b)(this.scrollbarWidth)};}`),t.text(e.join("\n"))}initRowsPosition(){const e=this.options.memberships,t=[],s=this.$element.find("style#rb-grid-rows-initial-position");for(let s=0;s<e.length;s++)t.push(`.${this.id} .rb-row-position-${e[s].id} {top: ${Object(d.b)(s*this.options.rowHeight)};}`);s.text(t.join("\n"))}initColumnsPosition(){i.values(this.containers).forEach((e=>e.initColumnsPosition()))}createContainers(){i.forEach(this.splitColumns(),((e,t)=>this.containers[t]=this.$injector.instantiate(a.a,{position:t,columns:e,grid:this}))),this.containers.center.hasHScrollbar=!0,(this.containers.right||this.containers.center).hasVScrollbar=!0}setDefaultValues(e=this.options){e.headerContentHeight=e.headerContentHeight||e.headerHeight,e.headerBorder=!1!==e.headerBorder,e.rowBorder=!1!==e.rowBorder,e.columns.forEach((e=>{e.position=e.position||"center",e.border=!1!==e.border,e.focusable=!1!==e.focusable}))}getFocusableColumns(){const e=this.containers.left,t=this.containers.right;return(e&&e.columns||[]).concat(this.containers.center.columns,t&&t.columns||[]).filter((e=>e.focusable))}splitColumns(e=this.options.columns){const t=i.groupBy(e,(e=>e.position));return t.center=t.center||[],t}scrollContainers({scrollTop:e=-1,scrollLeft:t}){e>=0&&(this.notifyScrollVertically(e),i.forEach(this.containers,(t=>{t.scrollVertically(e)}))),null!=t&&(this.notifyScrollHorizontally(t),this.containers.center.scrollHorizontally(t))}scrollToLeft(e){this.scroll({scrollLeft:0},e)}scrollToRight(e){this.scroll({scrollLeft:this.containers.center.getMaxScrollLeft()},e)}scrollToRightWithTop(e,t){this.scroll({scrollLeft:this.containers.center.getMaxScrollLeft(),scrollTop:e},t)}scrollToTop(e){this.scroll({scrollTop:0},e)}scrollToBottom(e){this.scroll({scrollTop:this.containers.center.getMaxScrollTop()},e)}scroll(e,t){t&&this.afterCellDataUpdated(t),this.scrollContainers(e)}canAddColumn(){return!!this.options.callbacks.column}afterCellDataUpdated(e){this.afterCellDataUpdatedHooks.push(e)}applyAfterCellUpdatedOnce(){for(let e=0;e<this.afterCellDataUpdatedHooks.length;e++)try{this.afterCellDataUpdatedHooks[e]()}catch(e){console.error(e)}this.afterCellDataUpdatedHooks.length=0}refreshImpl(){i.forEach(this.containers,(e=>e.applyData()));const e=i.values(this.containers).reduce(((e,t)=>e.concat(t.renderedColumns)),[]);(this.options.callbacks.data||o.noop)(this.containers.center.renderedRows,e),this.$scope.$apply(),this.applyAfterCellUpdatedOnce()}};v=Object(n.__decorate)([Object(n.__param)(0,Object(h.b)("$scope")),Object(n.__param)(1,Object(h.b)("$element")),Object(n.__param)(2,Object(h.b)("$attrs")),Object(n.__param)(3,Object(h.b)("$injector")),Object(n.__param)(4,Object(h.b)("$q")),Object(n.__param)(5,Object(h.b)(m.b))],v);class f{constructor(e){this.$injector=e,this.replace=!0,this.restrict="A",this.template=p,this.transclude=!0,this.controller=v,this.controllerAs="grid",this.scope=!0}}f.$inject=["$injector"],o.module(b,[m.a]).directive(g,["$injector",e=>e.instantiate(f)]).directive(a.c,["$injector",e=>e.instantiate(a.b)]).directive(r.b,["$injector",e=>e.instantiate(r.a)])},gKdT:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(e){var t=void 0;return"undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys?t=Reflect.ownKeys(e.prototype):(t=Object.getOwnPropertyNames(e.prototype),"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e.prototype)))),t.forEach((function(t){if("constructor"!==t){var s=Object.getOwnPropertyDescriptor(e.prototype,t);"function"==typeof s.value&&Object.defineProperty(e.prototype,t,o(e,t,s))}})),e}function o(e,t,s){var i=s.value;if("function"!=typeof i)throw new Error("@autobind decorator can only be applied to methods not: "+(void 0===i?"undefined":n(i)));var o=!1;return{configurable:!0,get:function(){if(o||this===e.prototype||this.hasOwnProperty(t)||"function"!=typeof i)return i;var s=i.bind(this);return o=!0,Object.defineProperty(this,t,{configurable:!0,get:function(){return s},set:function(e){i=e,delete this[t]}}),o=!1,s},set:function(e){i=e}}}t.default=function(){return 1===arguments.length?i.apply(void 0,arguments):o.apply(void 0,arguments)}},gORw:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-move-item-up-down",use:"icon-small-move-item-up-down-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-move-item-up-down"><path d="M5 11V3M7 4L5 2 3 4M11 5v8M9 12l2 2 2-2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},ga7A:function(e,t,s){"use strict";s.d(t,"a",(function(){return l}));var n=s("Llzl"),i=s("pjml"),o=s("vhkR"),a=s("X455"),r=s("Youf"),c=s("Y+9S");const l="ultra.components.directives.content.contentItem.contentItemType.contentItemLtilaunch";class d{constructor(e,t,s){this.scope=e,this.ltiService=t,this.contextCourseMembership=s}ltiLaunch(){if(!this.scope.content.getContentDisplay().isLtiLink())throw new Error("Attempted to LTI launch a non-LTI content item. "+this.scope.content.contentHandler.toString());this.notifyMobileAppOnItemClick(),this.ltiService.ltiLaunch({courseId:this.scope.content.courseId,contentId:this.scope.content.id,content:this.scope.content,showPreLaunchPanel:!0})}notifyMobileAppOnItemClick(){const e={type:c.MessageType.LTILaunched,status:c.MessageStatus.Success,contentId:this.scope.content.id,contentTitle:this.scope.content.title,contentType:c.MobileContentType.LTIConnection};Object(c.sendMessageToMobile)(e)}ltiLinkNeedsApproval(){const e=this.ltiService.getDomainConfigStatusType(this.scope.content);return i.K.LTIStatusType.NeedsApproval.isEqualTo(e)}}d.$inject=["scope",o.b,a.d];class u{constructor(e){this.$injector=e,this.restrict="E",this.template=r,this.scope=!1,this.link=(e,t,s)=>{e.contentItemLtiLaunch=this.$injector.instantiate(d,{scope:e,element:t,attrs:s})}}}u.$inject=["$injector"],n.module(l,[o.a,a.a]).directive("bbContentItemLtilaunch",["$injector",e=>e.instantiate(u)])},hAzl:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-password",use:"icon-medium-password-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-password"><path d="M3 8v5M1 12l4-3M1 9l4 3M1 16h4M12 8v5M10 12l4-3M10 9l4 3M10 16h4M21 8v5M19 12l4-3M19 9l4 3M19 16h4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},hDL0:function(e,t){e.exports='<div class="content-outline" bb-load-bundle="components/directives/content/content-outline">\n  <bb-add-content-button ng-if="!hideAddMenuOverride && canCreate"\n                         can-create-all-contents="canCreateAllContents"\n                         is-render-by-default="contentOutline.parentFolder.depth === 0"\n                         show-menu-override="contentOutline.shouldShowMenuOverride()"\n                         parent-id="contentOutline.parentFolder.id" root-content="contentOutline.parentFolder"\n                         position-before="\'start\'" item-name="contents[0].title"\n                         depth="(contentOutline.parentFolder.depth + 1)"\n                         always-show="contentOutline.shouldShowAddButton()" context-area="contentOutline.contextArea"\n                         can-copy-import="canCopyImport">\n  </bb-add-content-button>\n  <div class="add-element" ng-if="hideAddMenuOverride && !canCreate"> </div>\n  <div ng-if="contents">\n    <div class="content-outline-scroll-container"\n         bb-infinite-scroll="contentOutline.loadMoreChildren(contentOutline.parentFolder)"\n         infinite-scroll-immediate-check="true" infinite-scroll-disabled="contentOutline.isAllContentsLoaded()"\n         infinite-scroll-container="contentOutline.getScrollContainerSelector()"\n         infinite-scroll-listen-for-event="content-outline-infinite-scroll-check"\n         infinite-scroll-current-count="contents.length" infinite-scroll-total-count="contents.paging.count"\n         infinite-scroll-load-limit="contents.paging.limit"\n         infinite-scroll-tray-id="content-outline-{{::contentOutline.parentFolder.id}}"\n         infinite-scroll-focusable-children-selector=".content-title"\n         infinite-scroll-localization-keys-prefix="components.directives.content.content-outline.infiniteScroll.{{::contentOutline.contextArea === \'discussions\' ? \'discussions\' : \'content\'}}"\n         infinite-scroll-force-show-ancestor-selector="{{::contentOutline.getScrollForceShowSelector()}}"\n         sortable-parent>\n      <div class="content-outline-scroll-list" data-parent-id="{{::contentOutline.parentFolder.id}}">\n        <div class="js-content-div drag-element"\n             ng-class="{\'last\': $last, \'has-conversation-indicator\': content.ui.hasIndicator}"\n             ng-repeat="content in contents track by contentOutline.getContentTrackingId(content)" data-content-id="{{content.id}}"\n             ng-mouseenter="contentOutline.placeAddButton(content)">\n            <ng-switch on="(content.isFolder() && !content.isBbPage()) || content.isLearningModule()">\n              <div ng-switch-when="true">\n                <bb-folder root-content="contentOutline.parentFolder"\n                          on-file-drop-handler="contentOutline.onFileDropHandler"\n                          on-move-handler="contentOutline.onMoveHandler"\n                          on-move-into-folder-handler="contentOutline.onMoveIntoFolderHandler" contents="contents"\n                          content="content" next-content-id="contents[$index + 1].id"\n                          previous-content-id="contents[$index - 1].id"\n                          load-more-children="contentOutline.loadMoreChildren" can-create="canCreate"\n                          can-move="contentOutline.canMove" context-area="contentOutline.contextArea"\n                          can-copy-import="canCopyImport"></bb-folder>\n              </div>\n              <div ng-switch-when="false" bb-drag drag-item="::content.id" can-move="contentOutline.canMove">\n                <div ng-if="!content.isGroupContent || content.assignedGroups.length >= 0 || contentOutline.canMove">\n                  <div bb-drop-handler on-file-drop-handler="contentOutline.onFileDropHandler"\n                      on-move-handler="contentOutline.onMoveHandler"\n                      on-move-into-folder-handler="contentOutline.onMoveIntoFolderHandler" content="content"\n                      root-content="contentOutline.parentFolder" next-content-id="contents[$index + 1].id"\n                      previous-content-id="contents[$index - 1].id">\n                    <div class="row collapse element-list-row js-course-skip-link-target" can-create="canCreate"\n                        can-move="contentOutline.canMove" bb-content-item-mouseover\n                        ng-class="{ \'element-list-row-extra-icon\': contentOutline.isProgressTrackingStateShown(content) }">\n                      <bb-content-item-base contents="contents" content="content" context-area="contentOutline.contextArea"\n                                            can-move="contentOutline.canMove"\n                                            item-before="contents[$index - 1]"\n                                            item-after="contents[$index + 1]"\n                                            ></bb-content-item-base>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </ng-switch>\n\n            <div id="add-button-placeholder{{content.id}}"\n                class="add-element-container"\n                ng-if="::canCreate">\n              <div ng-if="contentOutline.isAddContentButtonUnattached(content.id)"\n                  id="add-button-line{{content.id}}" class="add-element" tabindex="0" role="button"\n                  ng-class="{\'mobile-center-content-button\': contentOutline.isMobileDevice()}"\n                  aria-label="{{::contentOutline.getAddButtonLineLabel(content.title)}}"\n                  ng-focus="contentOutline.placeAddButton(content, true)">\n                <bb-svg-icon size="small" icon="add" class="mobile-add-content-icon" ng-if="contentOutline.isMobileDevice()"></bb-svg-icon>\n              </div>\n            </div>\n          <bb-progress\n              ng-if="contentOutline.cloudUploadInProgress[content.id]"\n              target-div="#progress{{content.id}}"\n              primary-key="\'progress\' + content.id"\n              display-results="false"\n          >\n          </bb-progress>\n        </div>\n        <div class="drag-element">\n          <div drag-item-id="{{contentOutline.placeholderContent.id}}"></div>\n          <div class="drop-placeholder" bb-drop-handler content="contentOutline.placeholderContent"\n               on-move-handler="contentOutline.onMoveHandler"\n               on-move-into-folder-handler="contentOutline.onMoveIntoFolderHandler">\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n  \x3c!-- LRN-123904: For file upload content items `positionAfter` is set to `content.id` in course-outline.html. But when file upload is\n  in progress, `content.id` stays undefined. As a result `positionAfter` receives undefined.\n  `positionAfter` value is not used when `content.id` is not available. i.e.: When upload-in-progress file is very first item - `positionAfter` value is not\n  available, therefore `positionBefore` is used instead. --\x3e\n  <bb-add-content-button\n    class="movable-add-content-button movable-add-content-button-folder{{::contentOutline.parentFolder.id}}"\n    ng-hide="!contentOutline.addContentButtonLocation"\n    ng-if="::canCreate && !content.ui.importPlaceholder"\n    can-create-all-contents="canCreateAllContents"\n    content="contentOutline.addContentButtonLocation"\n    root-content="contentOutline.parentFolder"\n    is-button-location-changable="true"\n    parent-id="contentOutline.parentFolder.id"\n    position-after="contentOutline.addContentButtonLocation.id || contentOutline.addContentButtonLocation.positionAfter"\n    position-before="(contentOutline.addContentButtonLocation.id || contentOutline.addContentButtonLocation.positionAfter) ? null : contentOutline.addContentButtonLocation.positionBefore"\n    item-name="contentOutline.addContentButtonLocation.title"\n    depth="contentOutline.addContentButtonLocation.depth"\n    context-area="contentOutline.contextArea"\n    can-copy-import="canCopyImport">\n  </bb-add-content-button>\n</div>\n'},hG4E:function(e,t){e.exports='<div id="{{::bbmlEditor.bbmlEditorId}}" class="freeform-response-editor js-bbml-editor">\n  <div ng-show="bbmlEditor.showOverflowMenu()" class="content-item-controls overflow-menu-container" bb-foundation-defer>\n    <bb-overflow-menu\n      ng-if="bbmlEditor.overflowMenuItems"\n      element-id="{{\'overflow-menu\' + bbmlEditor.bbmlEditorId}}"\n      menu-items="bbmlEditor.overflowMenuItems"\n      analytics-id-tag-prefix="components.directives.attempt-canvas.freeform-response.overflowMenu">\n    </bb-overflow-menu>\n  </div>\n  <form bb-autosave\n        save-func="bbmlEditor.save()"\n        auto-save-context-id="freeform"\n        auto-save-context-area="{{::autoSaveContextArea}}"\n        validation-func="bbmlEditor.isValid()"\n        use-save-numbers="true"\n        novalidate\n        name="editorForm">\n    <bb-rich-text-editor\n      ng-class="{\'bb-editor-read-only-with-overflow-menu\': bbmlEditor.showOverflowMenu()}"\n      class="bb-text-editor-controls-wrapper"\n      name="responseEditor"\n      ng-model="bbmlEditor.rawText"\n      is-toolbar-hidden="!bbmlEditor.isEditing"\n      is-disabled="bbmlEditor.isDisabled"\n      on-blur="bbmlEditor.onBlur()"\n      on-focus="bbmlEditor.focusEditor()"\n      on-change="bbmlEditor.onChange"\n      on-new-attachment-save-pressed="bbmlEditor.onNewAttachmentSaving()"\n      plugin-options="bbmlEditor.pluginOptions"\n      show-word-count="isPrivileged"\n      expand-inline-files-on-load="expandInlineFilesOnLoad"\n      editor-placeholder-key="{{::bbmlEditor.scope.textEditorPlaceholderKey}}"\n    ></bb-rich-text-editor>\n  </form>\n</div>\n'},hKQ4:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-discussion",use:"icon-small-discussion-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-discussion"><path d="M15 8c0 3.866-3.134 7-7 7a6.983 6.983 0 01-2.528-.4704L1 15l.5-4.3969C1.1775 9.7984 1 8.9199 1 8c0-3.866 3.134-7 7-7s7 3.134 7 7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><circle cx="5" cy="8" r=".5" /><circle cx="8" cy="8" r=".5" /><circle cx="11" cy="8" r=".5" /></symbol>'});i.add(o);e.exports=o},ho2F:function(e,t){e.exports='<ul id="performanceCodes-{{gradeInput.id}}" class="f-dropdown performance-code-options bb-foundation-dropdown-close-esc-override" data-dropdown-content>\n  <li class="performance-option-header" bb-translate>components.directives.grade.grade-input.selectPerformanceCode</li>\n  <li ng-repeat="perfCode in gradeNotations()" bb-click-to-invoke-child="a.performance-code-option">\n    <a href="javascript:void(0);"\n       tabindex="0"\n       role="menuitem"\n       ng-click="gradeInput.clickGradeNotation(perfCode,$event)"\n       class="performance-code-option"\n       analytics-id="directives.gradeInput.selectPerformanceCode.item.link">\n      <span class="code" title="{{perfCode.code}}">{{perfCode.code}}</span>\n      <span class="description" title="{{perfCode.description}}">{{perfCode.description}}</span>\n    </a>\n  </li>\n  <li ng-if="gradeDetail.displayGrade.isOverride" class="undo-override" bb-click-to-invoke-child="button.js-undo-override">\n    <a href="javascript:void(0);"\n       tabindex="0"\n       role="menuitem"\n       class="js-undo-override performance-code-option"\n       ng-click="gradeInput.undoOverride()"\n       analytics-id="directives.grade-input.undoOverride.link">\n      <bb-svg-icon size="small" icon="undo"></bb-svg-icon>\n      <span bb-translate>components.directives.grade.grade-input.undoOverride</span>\n    </a>\n  </li>\n</ul>\n\n'},iAHr:function(e,t,s){"use strict";var n=s("D57K"),i=(s("SMOU"),s("Mak1"),s("s5UK"),s("xjJw"),s("ZKRZ"),s("dpCN"),s("D1Wg"),s("JbSi"),s("TR8k"),s("sZYy"),s("v0wN"),s("QhTW"),s("H/8/"),s("4VOk"),s("HApu"),s("nsO7")),o=s("Llzl"),a=s("Y/dt"),r=s("ihlU"),c=s("QW6a"),l=s("bd9L"),d=s("w9Zy"),u=s("mCEN"),p=s("IiJs"),m=s("vdfi"),h=s("ftvW"),b=s("nYZ0"),g=s("Fvsw"),v=s("NxQJ"),f=s("2lxm"),w=s("ZzYr"),S=s("X455"),C=s("ap1t"),y=s("QyCV"),O=s("oi1r"),A=s("o5Lu"),I=s("0JpG"),D=s("pjml"),k=s("u4ux"),_=s("YHe3"),j=s("6mvz"),T=s("zjPK"),$=s("lEL+"),R=s("TnpK"),E=s("AuQm"),x=s("1ZbL");const P="ultra.components.directives.components.connectionLostDialog",L={Class:E.ConnectionLostDialog,attributes:["analyticsId"],bindingNames:["onDismiss","isVisible"],renderLocalized:!0};o.module(P,[I.moduleName]).component("connectionLostDialog",Object(x.a)(L));const G=/[\\/:*?"<>|()^#%&@+={}~']/g;function M(e,t){const s=`data:application/octet-stream,${encodeURIComponent(t)}`,n=function(e){return e.replace(G,"").substring(0,250)}(e),i=document.createElement("a");i.setAttribute("href",s),i.setAttribute("download",`${n}`),document.body.appendChild(i),i.click(),i.remove()}var N=s("zYa8"),F=s("bwTs");const B="ultra.components.directives.bbUiIcon.small.AlertError";Object(N.a)(F.a,B,"bbUiIconSmallAlertError");var q=s("iq5i"),z=s("jcim"),U=s("7eG8"),V=s("SJlu");const H="ultra.components.directives.bbUiIcon.medium.Calendar";Object(N.a)(V.a,H,"bbUiIconMediumCalendar");var Q=s("94SL"),K=s("Oyr+"),W=s("Y+9S"),J=s("9hUw"),Y=s("3PCF"),Z=s("IbyE"),X=s("zGdY"),ee=s("IaSh");const te="ultra.components.directives.assessment-progress-bar",se={Class:ee.LocalizedAssessmentProgressBar,bindingNames:["answerableQuestionCount","unansweredQuestionCount"],attributes:["descriptionId"],renderLocalized:!0};o.module(te,[]).component("bbAssessmentProgressBar",Object(x.a)(se));const ne="ultra.components.directives.assessmentAttemptViewManager",ie={Class:ee.AssessmentAttemptViewManager,bindingNames:["isOneQuestionAtATime","isPreventBacktracking","attemptId","courseId","onAfterInitializeQuestionAttemptView","onAfterAsyncViewAction","onBeforeQuestionAttemptsInitialized","onAfterQuestionAttemptsInitialized"],renderLocalized:!0,withProvider:!0};o.module(ne,[]).component("bbAssessmentAttemptViewManager",Object(x.a)(ie));const oe="ultra.components.directives.assessment-question-counts",ae={Class:ee.LocalizedAssessmentQuestionCounts,bindingNames:["answerableQuestionCount","unansweredQuestionCount"],attributes:["descriptionId"],renderLocalized:!0};o.module(oe,[]).component("bbAssessmentQuestionCounts",Object(x.a)(ae));const re="ultra.components.directives.assessment-applied-filters",ce={Class:ee.AssessmentAppliedFilters,bindingNames:["filter","onFilterAvailable","onFilterChanged","questionTypes"],renderLocalized:!0};o.module(re,[]).component("bbAssessmentAppliedFilters",Object(x.a)(ce));const le="ultra.components.directives.assessment-controls-container",de={Class:ee.LocalizedAssessmentControlsContainer,bindingNames:["showNavigation","showFilter","filter","isBacktrackingProhibited","canNavigateForward","canNavigateBackward","onFilterAvailable","questionsMatchingFilterCount","questionTypes","onFilterChanged","onNavigationChanged"],renderLocalized:!0,withProvider:!0};o.module(le,[]).component("bbAssessmentControlsContainer",Object(x.a)(de));var ue=s("ohO4"),pe=s("TLR+"),me=s("wNBd"),he=s("bs/4"),be=s("3LmG"),ge=s("B5op"),ve=s("ifgA"),fe=s("0B2D"),we=s("aHpC"),Se=s("5uPl"),Ce=s("DU7P"),ye=s("Htol"),Oe=s("e0uO"),Ae=s("gkef"),Ie=s("0x+l");s.d(t,"a",(function(){return De}));const De="ultra.components.directives.assessment.assessmentAttempt";let ke=class extends Q.a{constructor(e,t,s,n,i,o,r,d,u,p,m,h,b,g,v,f,w,S,C,y,O,A,D){var k,_,j,T;super(s.contentData(),D,h,d,f,S),this.$injector=e,this.$interval=t,this.scope=s,this.$rootScope=n,this.$q=i,this.$modal=o,this.bbOffcanvas=r,this.grade=d,this.localize=u,this.timeout=p,this.contentService=m,this.context=h,this.proctoring=b,this.ultraState=g,this.contentGoalAlignmentPeekStateService=v,this.schemaService=f,this.collabUltra=w,this.currentMembership=S,this.originalityReportService=C,this.windowSize=y,this.peerService=O,this.featureFlagService=A,this.gradableItemUserOptionService=D,this.AssessmentCanvasMode=Oe.a,this.alignedGoalsCount=0,this.customCategory="",this.confirmedToClose=!1,this.hideOverview=!1,this.preventAutoSubmit=!1,this.errorMessage="",this.submitToGRD=!1,this.showCollabLink=!1,this.hasGroupIndicator=!1,this.hasClassIndicator=!1,this._saveInProgress=!1,this._submitInProgress=!1,this.collabUltraEnabled=!1,this.localizedCourseRoles={},this.wasLostConnectionSnackbarShown=!1,this.patchDirtyStudentSubmission=()=>{const e=this.$q.defer();return this.questionAttemptView.isFreeformSaveFailed()?this.attempt.$patch(["studentSubmission"]).$asPromise().then(e.resolve).catch(e.reject):e.resolve(),e.promise},this.submitConfirmedAttempt=()=>{var e;this.preventAutoSubmit=!0;!!(null===(e=this.attempt.studentSubmission)||void 0===e?void 0:e.rawText)||(this.attempt.studentSubmission=null);const t={type:W.MessageType.AttemptSubmitted,status:W.MessageStatus.Fail};return this.patchAttempt().then((e=>{this.scope.$broadcast(K.a),this.scope.$broadcast("cancel-upload-all"),this.$rootScope.$broadcast(ye.a),this.updateContentReviewState(X.ContentReviewState.Completed),this.openSubmissionReceiptModal(e)}),(()=>{this.submitInProgress=!1,Object(W.sendMessageToMobile)(t)}))},this.openSubmissionReceiptModal=e=>{var t;const s=this.scope.$new(),n=this.localize.getLocale(this.scope),i=null===(t=this.content)||void 0===t?void 0:t.getDeployedAssessment(),o=this.proctoring.getCurrentProctoringProviderType(null==i?void 0:i.deploymentSettings.proctoringServiceHandle);s.submissionDate=this.localize.formatDatetimeSync(e.attemptReceipt.submissionDate),s.id=e.attemptReceipt.receiptId,s.hasProctoringEnabled=o!==Ce.a.None,s.onClose=e=>{e(),this.onDismissSubmissionReceiptModal()},s.hasProctoringEnabled?s.emailConfirmation=this.localize.translateSync({locale:n,key:"components.directives.submission-receipt.proctoring-email-confirmation"}):(s.emailConfirmation=this.localize.translateSync({locale:n,key:"components.directives.submission-receipt.email-confirmation"}),s.downloadClicked=()=>{const e=this.localize.translateSync({locale:n,key:"components.directives.submission-receipt.submission-successful"}),t=this.localize.translateSync({locale:n,key:"components.directives.receiptDownload.course",params:{courseID:this.course.courseId,courseName:this.course.displayName},noWrap:!0,noEscape:!0}),i=this.localize.translateSync({locale:n,key:"components.directives.receiptDownload.assessment",params:{assessmentName:this.content.title},noWrap:!0,noEscape:!0}),o=this.localize.translateSync({locale:n,key:"components.directives.receiptDownload.submission-date",params:{submissionDate:s.submissionDate},noWrap:!0,noEscape:!0}),a=this.localize.translateSync({locale:n,key:"components.directives.receiptDownload.submitter",params:{username:this.localize.formatUsernameSync(this.contentData.submitter,I.ILocaleUsernameFormat.Short,this.scope,{noWrap:!0,noEscape:!0})},noWrap:!0,noEscape:!0}),r=this.localize.translateSync({locale:n,key:"components.directives.receiptDownload.confirmation-number",params:{GUID:s.id},noWrap:!0,noEscape:!0});M(`receipt-${this.course.courseId}-${this.content.title}.txt`,this.localize.translateSync({locale:n,key:"components.directives.receiptDownload.file-content",params:{successfulSubmission:e,course:t,assessment:i,submissionDate:o,submitter:a,GUID:r},noWrap:!0,noEscape:!0})),this.submissionReceiptModalInstance.close()}),this.submissionReceiptModalInstance=this.$modal.open({template:pe,scope:s}),this.submissionReceiptModalInstance.result.finally(this.onDismissSubmissionReceiptModal)},this.onDismissSubmissionReceiptModal=()=>{this.redirectFromAttempt().then((()=>{this.submitInProgress=!1}))},this.patchAttempt=()=>this.assessmentAttemptRequest.submitAttempt(this.submitToGRD).catch((e=>{throw this.setErrorMessage(e.$response),e})),this.redirectFromAttempt=()=>{const e=this.$q.defer();return this.assessmentAttemptRequest.refreshAttempt().then(this.redirect).then((()=>{this.saveInProgress=!1,e.resolve()})).catch((t=>{this.saveInProgress=!1,this.setErrorMessage(t.$response),e.reject()})),e.promise},this.onFilterChanged=(e,t=!1)=>{this.canFilterOrNavigate()&&this.scope.$apply((()=>{var s;this.scope.$broadcast(a.f),null===(s=this.questionAttemptView)||void 0===s||s.onFilterChanged(e,t)}))},this.onNavigationChanged=e=>{this.canFilterOrNavigate()&&this.scope.$apply((()=>{var t,s,n,i;switch(this.scope.$broadcast(a.f),e){case ee.NavigationOptions.First:null===(t=this.questionAttemptView)||void 0===t||t.navigateFirst();break;case ee.NavigationOptions.Previous:null===(s=this.questionAttemptView)||void 0===s||s.navigatePrevious();break;case ee.NavigationOptions.Next:null===(n=this.questionAttemptView)||void 0===n||n.navigateNext();break;case ee.NavigationOptions.Last:null===(i=this.questionAttemptView)||void 0===i||i.navigateLast()}}))},this.onAfterInitializeQuestionAttemptView=e=>{this.questionAttemptView=e,this.questionAttemptView.setNavigationOrFilteringChangedCallback((()=>{var e;let t=".assessment-attempt-panel";this.windowSize.isLargeBreakpoint()||(t=`${t} .panel-content`),null===(e=document.querySelector(t))||void 0===e||e.scrollTo({top:0,left:0,behavior:"auto"})}))},this.launchRestoredConnectionSnackbar=()=>{E.SnackbarManager.getInstance().enqueueSnackbar(E.SnackbarKey.AssessmentConnectivity,{snackbarMessage:this.restoredConnectionSnackbarMsg,isPersistent:!1,isErrorOrWarning:!0},null,Ie.Connection)},this.launchLostConnectionSnackbar=()=>{E.SnackbarManager.getInstance().enqueueSnackbar(E.SnackbarKey.AssessmentConnectivity,{snackbarMessage:this.lostConnectionSnackbarMsg,isPersistent:!1,isErrorOrWarning:!0},null,Ie.ConnectionIssue)},this.dismissConnectionSnackbar=()=>{E.SnackbarManager.getInstance().dequeueSnackbar(E.SnackbarKey.AssessmentConnectivity)},this.canFilterOrNavigate=e=>!this.autoSaveRetryInterval||(null==e||e.preventDefault(),null==e||e.stopImmediatePropagation(),this.dismissConnectionSnackbar(),this.launchLostConnectionSnackbar(),!1),this.onAfterAsyncViewAction=e=>{this.timeout(e,this.scope,0,!0)},this.onBeforeQuestionAttemptsInitialized=e=>{let t;return e.map((e=>(t||(t=this.course.gradebook.attempts.$new(e.attemptId)),t.assessment.answers.$buildRaw(e))))},this.onAfterQuestionAttemptsInitialized=e=>{this.hasManualPageBreaks=e.hasManualPageBreaks(),this.showPageNavigation=this.isOneQuestionAtATime||this.hasManualPageBreaks},this.isNavAndFilterFooterVisible=()=>{var e;return this.isOneQuestionAtATime||this.hasManualPageBreaks||(null===(e=this.questionAttemptView)||void 0===e?void 0:e.isFilterable())&&this.featureFlagService.isFeatureEnabled(ee.filterFeatureFlag)},this.onDismissConnectionLostDialogCallback=()=>{this.scope.$apply((()=>{this.connectionLostDialog.isVisible=!1,this.autosaveRetriesCounter=0}))},this.buildConnectionLostDialog=()=>{this.connectionLostDialog={isVisible:!1,onDismiss:this.onDismissConnectionLostDialogCallback},this.autosaveRetriesCounter=0},this.attempt=s.attempt(),this.contentData=s.contentData(),this.init(),this.peerService.getOrCreatePeerContentWithAttemptsFromContent(this.contentData.courseContent).then((e=>this.peerReviewContentObject=e)),this.course=s.course(),this.redirect=s.redirect,this.dueDateException=this.gradableItemUserOptionService.getGradableItemUserOptionByMembershipId(this.contentData.gradingColumn.id,S.courseMembership.id);const $=null!==(_=null===(k=this.dueDateException)||void 0===k?void 0:k.effectiveDueDate)&&void 0!==_?_:this.dueDate;this.timedTestAttemptDetail=this.isDueDateEnforced?this.attempt.getTimedTestAttemptDetailWithDueDate($):this.attempt.getTimedTestAttemptDetail(),this.scoreProviderHandle=this.contentData.gradingColumn.scoreProviderHandle||Z.ScoreProviderHandle.Test;const R=null===(T=null===(j=this.content)||void 0===j?void 0:j.getDeployedAssessment())||void 0===T?void 0:T.deploymentSettings;this.isOneQuestionAtATime=X.AssessmentDeliveryType.Item===R.deliveryType,this.isPreventBacktracking=R.isBacktrackingProhibited,h.userHasGradebookModificationEntitlement().then((t=>{if(t)this.ultraState.goPeekState("course.outline",{courseId:this.course.id});else{s.assessmentAttempt=this,this.toolAttemptDetail=this.attempt.getToolAttemptDetailItem(this.scoreProviderHandle),Z.ScoreProviderHandle.Test.isEqualTo(this.scoreProviderHandle)&&(this.hasTimeLimit=this.timedTestAttemptDetail.hasTimeLimit,this.hasTimeLimit&&(this.canContinue=this.timedTestAttemptDetail.hasExtraTime,this.hasUnlimitedExtraTime=this.timedTestAttemptDetail.hasUnlimitedExtraTime,this.hasLimitedExtraTime=this.timedTestAttemptDetail.hasLimitedExtraTime,this.willAutoSubmit=this.timedTestAttemptDetail.willAutoSubmit,this.displayedTimeLimit=Math.floor(this.timedTestAttemptDetail.displayedTimeLimitSeconds/60),this.displayedExtraTime=Math.floor(this.timedTestAttemptDetail.displayedExtraTimeSeconds/60))),this.attemptHandlers=e.instantiate(je),s.$on("bb-register-question-attempt-handlers",((e,t,s,n)=>{this.attemptHandlers.registerHandler(t,s,n)})),this.safeAssignEnabled=this.content.isSafeAssignEnabled(),this.assessmentAttemptRequest=new _e(this.attempt,this.safeAssignEnabled,this.attemptHandlers,this),this.registerAutoSaveEventsAndHandlers(),null==this.contentData.gradingColumn.rubricAssociations&&this.contentData.gradingColumn.$fetch({expand:"associatedRubrics"}).$asPromise().then((e=>{this.contentData.gradingColumn.rubricAssociations=e.rubricAssociations})),this.content.$fetchIfNotExpanded({expand:"assignedGroups,alignedGoals"}).$then((e=>{v.resolveGoalAlignableContentsForStudent(this.course,this.contentData,this.attempt).then((([e,t])=>{this.goalAlignedContents=e,this.alignedGoalsCount=t}));const t=this.content.assignedGroups&&this.content.assignedGroups[0];this.content.courseId&&t&&this.collabUltra.getCollabSessionStatus(this.content.courseId,t.groupId).then((e=>{null!==e&&(this.collabUltraEnabled=!0)}))})),this.calculateKeysAndIconsBasedOnCategory(),this.content.canSubmitToGlobalReferenceDatabase()&&this.context.getPreference(c.b).then((e=>{e&&(this.submitToGRD="true"===e.value)})),s.$on(a.e,(()=>{this.save()})),s.$on("$stateChangeStart",((e,t,n,i,o)=>{const a=t.name;if(i.name!==a&&a.indexOf("attempt")<0&&a.indexOf("assessment-details")<0){const t={type:W.MessageType.AttemptSaveAndClosed,status:W.MessageStatus.Success},n={type:W.MessageType.AttemptSubmitted,status:W.MessageStatus.Success};if(this.confirmedToClose)return void Object(W.sendMessageToMobile)(t);if(!this.canFilterOrNavigate())return void e.preventDefault();if(s.currentRemainingSeconds>0&&!this.submitInProgress&&this.hasTimeLimit)return e.preventDefault(),this.confirmLeavingModal&&this.confirmLeavingModal.dismiss(),void this.showConfirmLeavingModal();if(this.submitInProgress)return void Object(W.sendMessageToMobile)(n);Object(W.sendMessageToMobile)(t)}})),s.$on("bb-test-resumed",(e=>{this.context.getPreference(this.extraTimeAcknowledgedKey).catch((e=>{404===e.$response.status&&(this.extraTimeAcknowledged="true",this.showResumeTestModal())}))})),s.$on("bb-time-is-up",((e,t)=>{const s=document.activeElement;if((null==s?void 0:s.className.includes("bb-editor"))&&s.blur(),this.preventAutoSubmit)return;this.submitModalInstance&&this.submitModalInstance.dismiss(),this.softTimeUpModal&&this.softTimeUpModal.dismiss(),this.confirmLeavingModal&&this.confirmLeavingModal.dismiss(),this.resumeTestModal&&this.resumeTestModal.dismiss();const n=this.$q.defer();n.promise.then((()=>{if(this.clearAutoSaveRetryInterval(),"hard"===t.stopMode)this.showTimeUpModal(),this.forceSave();else if("soft"===t.stopMode){const e=6e4;this.scope.showTimeUpIndicator=!0,this.timeout((()=>{this.scope.showTimeUpIndicator=!1}),this.scope,e),this.extraTimeAcknowledged="true",this.showSoftTimeUpModal()}})),this.autoSaveMonitorDeferred?this.scope.$broadcast("bb-start-auto-submission",n):n.resolve()})),s.$on("submit-to-global-reference",((e,t)=>{this.submitToGRD=t.submitToGRD})),this.content.isGroupContent&&this.content.ui.hasConversationAttached&&this.content.attachedForumLink&&this.loadCollabConfig(),this.showConversations()&&this.updateIndicators();const t=this.contentService.indicatorCacheService.$onClassConversationIndicatorRemoved(((e,t,s)=>{t===this.content.courseId&&s===this.content.id&&(this.hasClassIndicator=!1)})),n=this.contentService.indicatorCacheService.$onGroupConversationIndicatorRemoved(((e,t,s)=>{t===this.content.courseId&&s===this.content.id&&(this.hasGroupIndicator=!1)}));s.$on("$destroy",(()=>{var e,s,i,o,a;t(),n(),null===(e=this.timeUpTestModal)||void 0===e||e.dismiss(),null===(s=this.submitModalInstance)||void 0===s||s.dismiss(),null===(i=this.softTimeUpModal)||void 0===i||i.dismiss(),null===(o=this.confirmLeavingModal)||void 0===o||o.dismiss(),null===(a=this.resumeTestModal)||void 0===a||a.dismiss(),E.SnackbarManager.getInstance().dequeueSnackbar(E.SnackbarKey.AssessmentConnectivity)}))}this.fetchOriginalityReportProviderType()})),this.buildConnectionLostDialog(),this.lostConnectionSnackbarMsg=this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.snackbar.networkConnectivity.lost"}),this.restoredConnectionSnackbarMsg=this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.snackbar.networkConnectivity.restored"}),this.scope.$on(l.c,((e,t,s,n)=>{var i;(null==n?void 0:n.area)===E.AutoSaveContextArea.Assessments&&(null===(i=this.questionAttemptView)||void 0===i||i.onAutoSaveStatusChanged(n.id,n.saveNumber,t))}))}fetchOriginalityReportProviderType(){return this.originalityReportService.retrieveOriginalityIntegration(this.content)}get assessmentDueDate(){return this.studentHasDueDateException?this.dueDateException.effectiveDueDate:this.dueDate}get attemptId(){return this.content.isGroupContent&&D.A.isGroupAttempt(this.attempt)?this.attempt.attempts[0].id:this.attempt.id}get isBacktrackingProhibited(){var e,t,s;return!!(null===(s=null===(t=null===(e=this.content)||void 0===e?void 0:e.getDeployedAssessment())||void 0===t?void 0:t.deploymentSettings)||void 0===s?void 0:s.isBacktrackingProhibited)}get isPeerGrading(){var e;return!!(null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.peerGrading)}get peerReviewDueDate(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.peerReviewDueDate}get numOfPeerReviewsToComplete(){var e;return null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.numOfPeerReviewsToComplete}get hasDueDateAccommodation(){return this.currentMembership.isDueDateExcepted()}get allowLatePeerReviews(){var e;return!!(null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.allowLatePeerReviews)}get isPeerGradingConfigured(){var e;return!!(null===(e=this.peerReviewContentObject)||void 0===e?void 0:e.isPeerGradingConfigured)}get isSubmissionLate(){return this.isOverdue&&!this.isAssessmentSubmissionComplete||this.attemptCountSubmittedLate>0}get shouldShowTimedTestIndicator(){return this.hasTimeLimit||this.isDueDateEnforced}get shouldShowMarkedLateNotice(){return this.isOverdue&&!this.isDueDateEnforced}get isAssessmentSubmissionComplete(){return!!(this.attemptCount&&this.attemptCount>0&&this.attemptCountSubmitted&&this.attemptCountSubmitted>0)}getMembershipByUser(e){return i.find(this.course.memberships,(t=>t.user.id===e.id))}getCourseRole(e){return this.getLocalizedRoleNameByCourseRole(this.getMembershipByUser(e).courseRole)}canSendMessage(e){const t=this.getMembershipByUser(e);return!(this.course.isPrivate()||this.course.isComplete())&&t.isAvailable&&t.user.isAvailable}isInactive(e){const t=this.getMembershipByUser(e);return!t.isAvailable||!t.user.isAvailable}getLocalizedRoleNameByCourseRole(e){const t=e.identifier.toString();if(this.localizedCourseRoles[t])return this.localizedCourseRoles[t];if(t in D.w.toBeLocalizedRoleLabels){const e=this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:D.w.toBeLocalizedRoleLabels[t]});return this.localizedCourseRoles[t]=e,e}return e.courseName.rawValue}set extraTimeAcknowledged(e){this.context.setPreference(this.extraTimeAcknowledgedKey,e)}get extraTimeAcknowledgedKey(){return"attempt"+this.attempt.id.split("_").join(".")+".extra.time.acknowledged"}get currentRemainingMinutes(){return Math.ceil(this.scope.currentRemainingSeconds/60)}get groupId(){return this.content&&this.content.assignedGroups&&this.content.assignedGroups[0].groupId}get showProgressHeader(){return this.shouldShowTimedTestIndicator||this.hasAnswerableQuestions}initExecAutoSubmitDeferred(){this.execAutoSubmitDeferred||(this.execAutoSubmitDeferred=this.$q.defer())}forceSave(){if(this.autoSaveMonitorDeferred){const e={type:W.MessageType.AttemptSubmitted,status:W.MessageStatus.Fail};this.initExecAutoSubmitDeferred(),this.submitInProgress=!0,this.patchAttempt().then((()=>{this.scope.$broadcast(K.a),this.scope.$broadcast("cancel-upload-all"),this.$rootScope.$broadcast(ye.a),this.execAutoSubmitDeferred.resolve()}),(()=>{this.submitInProgress=!1,Object(W.sendMessageToMobile)(e)}))}else this.autoSubmit()}calculateKeysAndIconsBasedOnCategory(){const e=this.contentData.gradingColumn.gradebookCategory,t=e&&!e.isUserDefined,s=`${this.course.isOrganization?"organization":"course"}.content.assessment.modal.confirmSubmitAttemptAlert`;let n=t?e.title:"custom",i="body";this.isOverdue&&(i="late"),this.customCategory=t?"":e&&e.title,this.iconClass=t?n.split(".")[0].toLowerCase():"custom-item",this.groupAssessmentKey=`course.content.assessment.settings.groupAssessment.${n}`,this.headerKey=`course.content.assessment.type.${n}`,this.content.isGroupContent&&(n=t?"group"+n:"groupCustom"),this.submitModalHeaderKey=`${s}.title.${n}`,this.submitModalBodyKey=`${s}.${i}.${n}`,t||(this.submitModalTranslateOptions={title:{locale:this.localize.getLocale(this.scope),key:this.submitModalHeaderKey,params:{title:this.customCategory},noWrap:!0,noEscape:!0}})}get content(){return this.contentData.courseContent}closePanel(){this.confirmedToClose=!0,this.redirectFromAttempt()}showAlreadySubmittedDialog(){const e=this.scope.$new();return e.customClose=()=>{this.closePanel()},this.$modal.open({scope:e,template:fe})}showConfirmLeavingModal(){this.confirmLeavingModal=this.$modal.open({template:ge,scope:this.scope}),this.confirmLeavingModal.result.then((()=>{this.closePanel()}))}showSoftTimeUpModal(){this.softTimeUpModal=this.$modal.open({template:be,backdrop:"static",scope:this.scope}),this.softTimeUpModal.result.then((()=>{this.forceSave(),this.execAutoSubmitDeferred.promise.then((()=>{this.updateContentReviewState(X.ContentReviewState.Completed),this.openSubmissionReceiptModal(this.attempt)}))}),(()=>{this.scope.showTimeUpIndicator=!1,this.scope.$broadcast("bb-cancel-auto-submission")}))}updateContentReviewState(e){var t;if(null===(t=this.content.permissions)||void 0===t?void 0:t.canHaveReviewState)return this.content.updateState(e)}showResumeTestModal(){this.resumeTestModal=this.$modal.open({template:be,backdrop:"static",scope:this.scope}),this.resumeTestModal.result.then((()=>{this.forceSave(),this.execAutoSubmitDeferred.promise.then((()=>{this.updateContentReviewState(X.ContentReviewState.Completed),this.openSubmissionReceiptModal(this.attempt)}))}))}showTimeUpModal(){this.timeUpTestModal=this.$modal.open({template:he,backdrop:"static",scope:this.scope}),this.timeUpTestModal.result.then((()=>{this.execAutoSubmitDeferred.promise.then((()=>{this.updateContentReviewState(X.ContentReviewState.Completed),this.openSubmissionReceiptModal(this.attempt)}))}),(()=>{this.execAutoSubmitDeferred.promise.then((()=>{this.redirectFromAttempt()}))}))}save(){if(this.saveInProgress||!this.canFilterOrNavigate())return;this.saveInProgress=!0;const e={type:W.MessageType.AttemptSaveAndClosed,status:W.MessageStatus.Fail};this.saveDeferred?this.saveDeferred.promise.then((()=>{this.attemptHandlers.patchAllDirtyAttempts(this.isBacktrackingProhibited).then(this.patchDirtyStudentSubmission).then(this.redirectFromAttempt).catch((()=>{this.saveInProgress=!1,Object(W.sendMessageToMobile)(e)}))})).catch((()=>{this.saveInProgress=!1,Object(W.sendMessageToMobile)(e)})):(this.saveInProgress=!0,this.attemptHandlers.patchAllDirtyAttempts(this.isBacktrackingProhibited).then(this.patchDirtyStudentSubmission).then(this.redirectFromAttempt).catch((()=>{this.saveInProgress=!1,Object(W.sendMessageToMobile)(e)})))}submit(){!this.saveInProgress&&this.canFilterOrNavigate()&&(this.saveDeferred?(this.saveInProgress=!0,this.saveDeferred.promise.then((()=>{this.doSubmit(),this.saveInProgress=!1}),(()=>{this.saveInProgress=!1}))):this.doSubmit())}get shouldShowInProgressWarning(){return this.questionAttemptView.unansweredQuestionCount>0}get isQuestionFilterFeatureFlagOn(){return this.featureFlagService.isFeatureEnabled(ee.filterFeatureFlag)}doSubmit(){this.submitInProgress=!0,this.calculateKeysAndIconsBasedOnCategory(),this.submitModalInstance=this.$modal.open({template:me,scope:this.scope}),this.submitModalInstance.result.then(this.submitConfirmedAttempt,(()=>{var e;this.shouldShowInProgressWarning&&this.isQuestionFilterFeatureFlagOn&&!this.isBacktrackingProhibited&&(null===(e=this.questionAttemptView)||void 0===e||e.onFilterChanged({status:ee.QuestionStatusFilter.Unanswered},!0)),this.submitInProgress=!1}))}getStudentSubmissionRawText(e){return e.studentSubmission&&e.studentSubmission.rawText||""}disableButtonsOnEmptySubmission(){return""===this.getStudentSubmissionRawText(this.attempt)}disableButtonsOnNoAttempt(){var e,t,s;const{toolAttemptDetail:n}=this.attempt,i=n&&n[this.scoreProviderHandle.toString()],o=i&&i.status;return X.AttemptStatus.Completed===o?!(null===(e=i.assessment)||void 0===e?void 0:e.hasAnswerableQuestions)&&((null===(t=i.assessment)||void 0===t?void 0:t.hasPresentationOnlyQuestions)||0===(null===(s=i.assessment)||void 0===s?void 0:s.questionCount)):X.AttemptStatus.NotAttempted===o}shouldDisableSaveSubmitButtons(){var e,t,s;const n=this.disableButtonsOnEmptySubmission(),i=this.disableButtonsOnNoAttempt(),o=(null===(e=this.attempt.toolAttemptDetail)||void 0===e?void 0:e[this.scoreProviderHandle.toString()]).assessment,a=!(null==o?void 0:o.hasAnswerableQuestions)&&(null==o?void 0:o.hasPresentationOnlyQuestions);return this.saveInProgress||(null===(t=this.assessmentAttemptRequest)||void 0===t?void 0:t.isRequestInProgress())||(null===(s=this.questionAttemptView)||void 0===s?void 0:s.isWaitingForAnswersToPersist())||n&&i&&a||n&&i&&!this.lastSaved&&""===this.errorMessage}autoSubmit(){const e={type:W.MessageType.AttemptSubmitted,status:W.MessageStatus.Fail};this.submitInProgress=!0,this.attempt.status=X.AttemptStatus.NeedsGrading,this.attempt.toolAttemptDetail={},this.attempt.toolAttemptDetail[this.scoreProviderHandle.toString()]={type:X.AssessmentType.Test},this.safeAssignEnabled&&(this.attempt.submissionParams={[Y.b]:{globalReferenceDatabase:this.submitToGRD}}),this.initExecAutoSubmitDeferred(),this.attempt.$patch().$then((()=>{this.scope.$broadcast(K.a),this.scope.$broadcast("cancel-upload-all"),this.execAutoSubmitDeferred.resolve()}),(t=>{Object(W.isInMobileApp)()&&401!==t.$response.status&&(t.$response.status=null),Object(W.sendMessageToMobile)(e)}))}set saveInProgress(e){this._saveInProgress=e,this.$rootScope.$broadcast(e?a.b:a.a),this.scope.$broadcast("bb-assessment-attempt-question-readonly",this._saveInProgress)}get saveInProgress(){return this._saveInProgress}set submitInProgress(e){this.$rootScope.$broadcast(e?a.d:a.c),this._submitInProgress=e}get submitInProgress(){return this._submitInProgress}setErrorMessage(e){var t;-1===e.status?(this.setupAutoSaveRetryInterval(),this.errorMessage=this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.footer.errorMessage.lostConnection"})):(null===(t=e.data)||void 0===t?void 0:t.code)===X.INPUT_TOO_LONG?(this.clearAutoSaveRetryInterval(),this.errorMessage=this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.footer.errorMessage.answerTooLong",params:{maxInputSize:e.data.developerMessage?parseInt(e.data.developerMessage,10):-1}})):(this.clearAutoSaveRetryInterval(),this.errorMessage=this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.footer.errorMessage.default"}))}registerAutoSaveEventsAndHandlers(){this.scope.$on("bb-autosave-form",((e,t,s)=>{switch(t){case E.AutoSaveMessage.Change:this.saveInProgress||(this.saveDeferred=this.$q.defer(),this.autoSaveMonitorDeferred=this.$q.defer());break;case E.AutoSaveMessage.Saved:this.errorMessage="",this.clearAutoSaveRetryInterval(),this.saveDeferred&&this.timeout((()=>{this.saveDeferred.resolve(),this.scope.$broadcast(a.f),this.lastSaved=new Date}),this.scope),this.autoSaveMonitorDeferred&&this.autoSaveMonitorDeferred.resolve();break;case E.AutoSaveMessage.SaveFailure:this.saveDeferred&&this.saveDeferred.resolve(),s&&this.setErrorMessage(s.$response)}}))}setupAutoSaveRetryInterval(){this.autoSaveRetryInterval||(this.wasLostConnectionSnackbarShown||(this.dismissConnectionSnackbar(),this.launchLostConnectionSnackbar(),this.wasLostConnectionSnackbarShown=!0),this.autoSaveRetryInterval=this.$interval((()=>{this.scope.$broadcast(a.f),this.autosaveRetriesCounter++,this.autosaveRetriesCounter===l.d&&(this.dismissConnectionSnackbar(),this.connectionLostDialog.isVisible=!0)}),l.e))}clearAutoSaveRetryInterval(){this.autoSaveRetryInterval&&(this.wasLostConnectionSnackbarShown&&(this.dismissConnectionSnackbar(),this.launchRestoredConnectionSnackbar(),this.wasLostConnectionSnackbarShown=!1),this.$interval.cancel(this.autoSaveRetryInterval),this.autoSaveRetryInterval=null,this.autosaveRetriesCounter=0,this.connectionLostDialog.isVisible=!1)}showGoals(){this.hideOverview=!0}hideGoals(){this.hideOverview=!1}showConversations(){return v.a.showConversations(this.content)}openRubricView(){this.timeout((()=>{const e={columnId:this.contentData.gradingColumn.id};this.ultraState.goPeekState("rubric-view",e)}),this.scope,0,!1)}openSafeAssignView(){this.ultraState.goPeekState("attempt-safe-assign-setting",{submitToGRD:this.submitToGRD})}loadCollabConfig(){this.collabUltra.getCollabB2Info().then((e=>{200===e.$response.status?this.showCollabLink=!0:this.showCollabLink=!1}),(e=>{this.showCollabLink=!1})),!this.forumId&&this.content.attachedForumLink&&this.content.attachedForumLink["resource/x-bb-courselink"]&&this.course.contents.$find(this.content.attachedForumLink["resource/x-bb-courselink"].courseContent).$then((e=>{this.forumId=e.contentDetail["resource/x-bb-forumlink"].id}))}get shouldShowCollabLink(){return this.showCollabLink&&o.isDefined(this.forumId)&&this.collabUltraEnabled}launchCollabSession(){const e=window.open();this.collabUltra.launchDiscussionSession(this.content.courseId,this.forumId,this.content.assignedGroups[0].groupId).then((t=>{e.location.href=t.url}),(t=>{e.close(),t.$response.status=null}))}updateIndicators(){this.content&&this.contentService.fetchIndicators(this.content.courseId).then((()=>{const e=this.contentService.getCourseContentCache(this.content.courseId,this.content.id);e&&(this.hasClassIndicator=e.classConversationHasIndicator,this.hasGroupIndicator=!!e.groupIds)}))}getProctoringBrowserText(){return this.proctoring.getProctoringOverviewBrowserText(this.content)}get hasAnswerableQuestions(){var e,t;const s=(null===(e=this.attempt.toolAttemptDetail)||void 0===e?void 0:e[this.scoreProviderHandle.toString()]).assessment;return null!==(t=null==s?void 0:s.hasAnswerableQuestions)&&void 0!==t&&t}get hasFilterApplied(){var e,t;return null!==(t=null===(e=this.questionAttemptView)||void 0===e?void 0:e.hasFilterApplied())&&void 0!==t&&t}};ke=Object(n.__decorate)([Object(n.__param)(0,Object(we.b)("$injector")),Object(n.__param)(1,Object(we.b)("$interval")),Object(n.__param)(2,Object(we.b)("scope")),Object(n.__param)(3,Object(we.b)("$rootScope")),Object(n.__param)(4,Object(we.b)("$q")),Object(n.__param)(5,Object(we.b)("$modal")),Object(n.__param)(6,Object(we.b)(d.e)),Object(n.__param)(7,Object(we.b)(A.k)),Object(n.__param)(8,Object(we.b)(I.serviceName)),Object(n.__param)(9,Object(we.b)($.b)),Object(n.__param)(10,Object(we.b)(b.f)),Object(n.__param)(11,Object(we.b)(g.b)),Object(n.__param)(12,Object(we.b)(_.b)),Object(n.__param)(13,Object(we.b)(R.d)),Object(n.__param)(14,Object(we.b)(m.d)),Object(n.__param)(15,Object(we.b)(O.b)),Object(n.__param)(16,Object(we.b)(p.b)),Object(n.__param)(17,Object(we.b)(S.d)),Object(n.__param)(18,Object(we.b)(Se.b)),Object(n.__param)(19,Object(we.b)(Ae.b)),Object(n.__param)(20,Object(we.b)(J.b)),Object(n.__param)(21,Object(we.b)(ue.b)),Object(n.__param)(22,Object(we.b)(f.b))],ke);class _e{constructor(e,t,s,n){this.attempt=e,this.isSafeAssignEnabled=t,this.attemptHandlers=s,this.assessmentAttemptView=n,this.isAttemptPatchInProgress=!1,this.isAttemptRefreshInProgress=!1}waitForInProgressAttemptPatch(){return this.attempt.$asPromise()}refreshAttempt(){return this.isAttemptRefreshInProgress=!0,this.attempt.$fetch({expand:"toolAttemptDetail"}).$asPromise().finally((e=>(this.isAttemptRefreshInProgress=!1,e)))}submitAttempt(e){return this.isAttemptPatchInProgress=!0,this.attemptHandlers.patchAllDirtyAttempts(this.assessmentAttemptView.isBacktrackingProhibited).then(this.assessmentAttemptView.patchDirtyStudentSubmission).then((()=>this.waitForInProgressAttemptPatch().then((()=>(this.attempt.status=X.AttemptStatus.NeedsGrading,this.attempt.toolAttemptDetail={},this.attempt.toolAttemptDetail[Z.ScoreProviderHandle.Test.toString()]={type:X.AssessmentType.Test},this.isSafeAssignEnabled&&(this.attempt.submissionParams={[Y.b]:{globalReferenceDatabase:e}}),this.attempt.$patch().$asPromise()))).finally((e=>e)))).finally((()=>{this.isAttemptPatchInProgress=!1}))}isRequestInProgress(){return this.isAttemptPatchInProgress||this.isAttemptRefreshInProgress}}class je{constructor(e){this.$q=e,this.attempts=[]}registerHandler(e,t,s){this.attempts.push(new Te(e,t,s))}patchAllDirtyAttempts(e){const t=[];return this.attempts.forEach((s=>{!s.isDirty()||e&&s.getAttempt().attemptStatus===X.AttemptStatus.InProgress||(s.getAttempt().$cancel(),s.prepareGivenAnswer(),t.push(s.getAttempt().$patch(["questionType","givenAnswer","givenAnswers"]).$asPromise()))})),this.$q.all(t)}length(){return this.attempts.length}}je.$inject=["$q"];class Te{constructor(e,t,s){this.isDirty=e,this.getAttempt=t,this.prepareQuestionAttemptGivenAnswer=s}prepareGivenAnswer(){return this.prepareQuestionAttemptGivenAnswer(this.getAttempt())}}class $e{constructor(e,t){this.$compile=e,this.$injector=t,this.restrict="E",this.scope={attempt:"&",contentData:"&",course:"&",redirect:"&"},this.template=ve,this.link=(e,t,s)=>{e.assessmentAttempt=this.$injector.instantiate(ke,{scope:e,element:t,attrs:s})}}}$e.$inject=["$compile","$injector"],o.module(De,[te,oe,re,le,ne,r.a,B,q.a,z.a,U.a,H,w.a,C.a,y.a,k.b,j.a,T.a,p.a,h.a,_.a,J.a,u.a,ue.a,f.a,P,Ae.a]).directive("bbAssessmentAttempt",["$injector",e=>e.instantiate($e)])},iJ4p:function(e,t){e.exports='<bb-rich-text-editor\n  plugin-options="{\'attachment\': true, \'math\': true, \'contentMarket\': true}"\n  ng-model="assessmentQuestion.questionAttempt.question.questionText.rawText"\n  supports-inline-document-render="true"\n  is-read-only="true">\n</bb-rich-text-editor>\n\n<bb-question-answer-status was-late="::assessmentQuestion.wasAnsweredLate()"\n                           hide-correctness-text="true"\n                           class="essay-attention">\n</bb-question-answer-status>\n<div class="panel">\n  <span class="answer-panel-heading" bb-translate>components.directives.assessment-question.essay.answer-header</span>\n  <bb-rich-text-editor\n    plugin-options="{\'attachment\': true, \'math\': true}"\n    ng-model="assessmentQuestion.questionAttempt.givenAnswer.rawText"\n    supports-inline-document-render="false"\n    is-read-only="true">\n  </bb-rich-text-editor>\n</div>\n'},iQEt:function(e,t,s){"use strict";var n=s("D57K"),i=s("Llzl"),o=s("wgY5"),a=s("nbDY"),r=s.n(a),c=s("aHpC"),l=s("IbyE"),d=s("Fvsw"),u=s("0JpG"),p=s("lEL+"),m=s("gZZS"),h=s("VdDF"),b=s("e6jQ"),g=s("nYkW");s.d(t,"c",(function(){return v})),s.d(t,"a",(function(){return f})),s.d(t,"b",(function(){return w}));const v="ultra.components.directives.content.dueDate",f="due-date",w="due-time";class S extends r.a{}S.Overdue=new S("overdue"),S.TooSoon=new S("tooSoon");let C=class e{constructor(e,t,s,n,o,a,r){var c;this.$ngRedux=e,this.scope=t,this.form=s,this.element=n,this.bbLocalize=o,this.context=a,this.timeout=r,this.dueDateId="due-date-"+Object(b.a)(),this.container=this.dueDateId+"-container";const l=null!==(c=t.customDueDatePrefix)&&void 0!==c?c:"";this.dueDateFieldName=l+f,this.dueTimeFieldName=l+w,this.isMandatory=this.scope.isMandatory;const d=i.isFunction(this.scope.shouldDefaultDueDate);if(void 0===this.scope.model&&!1===d||!0===d&&this.scope.shouldDefaultDueDate()){const e=new Date(this.context.getServerTime().getTime());e.setDate(e.getDate()+1),this.scope.model=e}this.scope.skipBumpHalfHourOnSameDate()||this.registerTodayPlaceholderDate(),this.subscribeToReduxChanges();const u=this.bbLocalize.getAppLocaleISO();this.getLocaleSettings&&this.getLocaleSettings({locale:u}),this.scope.$watch((()=>this.scope.model&&this.scope.model.getTime()),((e,t)=>{this.dueDateField||(this.dueDateField=this.form[this.dueDateFieldName]),this.dueTimeField||(this.dueTimeField=this.form[this.dueTimeFieldName]),e&&e!==t&&(this.scope.onDateChangeValidation&&this.scope.onDateChangeValidation(),this.dueDateField.$setDirty(),this.dueTimeField.$setDirty()),this.timeout((()=>{(this.scope.needsValidation&&this.scope.needsValidation()||!this.scope.needsValidation)&&this.checkDate(this.scope.model)}),this.scope,1e3,!0)})),this.onViewValueCleared=(e,t)=>{this.scope.model=t?null:this.scope.model}}static calculatePlaceholderDate(t){const s=e.TODAY_OFFSET-(t.minutes()+e.FUTURE_OFFSET)%e.TODAY_OFFSET+e.FUTURE_OFFSET;return t.add(s,"minutes").toDate()}get isDisabled(){return this.scope.disabled&&!this.scope.readOnly}get isReadOnly(){return this.scope.readOnly}get isDueDateValid(){var e;return null===(e=this.dueDateField)||void 0===e?void 0:e.$valid}get isTimeDueDateValid(){var e;return null===(e=this.dueTimeField)||void 0===e?void 0:e.$valid}getLabelToken(){return this.scope.alternateLabelToken?this.scope.alternateLabelToken:"components.directives.due-date.label"}shouldFocus(){return this.scope.shouldFocusOnDateField&&this.scope.shouldFocusOnDateField()}checkDate(t){var s,n;let i=!1,o=!1,a=!1,r=!1;if(t){const c=this.context.getServerTime(),l=t.getTime()-c.getTime(),d=l<0;o=d&&h.a.isSameDay(t,c),i=!o&&d,a=!d&&l<e.FUTURE_OFFSET_MS;const u=null===(n=(s=this.scope).getOriginalDueDate)||void 0===n?void 0:n.call(s);r=(null==u?void 0:u.getTime())===t.getTime()}return this.dueDateField.$setValidity(S.Overdue.toString(),r||!i),this.dueTimeField.$setValidity(S.Overdue.toString(),r||!o),this.dueTimeField.$setValidity(S.TooSoon.toString(),!a),this.scope.model}registerTodayPlaceholderDate(){this.timeout((()=>{this.element.find("#"+this.dueDateId).on("changeDate",(t=>{if(t.date){const s=new Date;h.a.isSameDay(t.date,s)&&(this.scope.model=e.calculatePlaceholderDate(o(s)))}}))}),this.scope,0,!0)}subscribeToReduxChanges(){const e=this.$ngRedux.connect((e=>({localeSettings:l.select.locale.getLocaleSettings(e,this.bbLocalize.getAppLocaleISO())})),(e=>({getLocaleSettings:t=>e(l.actions.locale.getLocaleSettings(t))})))(this);this.scope.$on("$destroy",e)}};C.FUTURE_OFFSET=5,C.FUTURE_OFFSET_MS=60*C.FUTURE_OFFSET*1e3,C.TODAY_OFFSET=30,C=Object(n.__decorate)([Object(n.__param)(0,Object(c.b)("$ngRedux")),Object(n.__param)(1,Object(c.b)("scope")),Object(n.__param)(2,Object(c.b)("form")),Object(n.__param)(3,Object(c.b)("element")),Object(n.__param)(4,Object(c.b)(u.serviceName)),Object(n.__param)(5,Object(c.b)(d.b)),Object(n.__param)(6,Object(c.b)(p.b))],C);class y{constructor(e){this.$injector=e,this.restrict="E",this.require="^form",this.template=g,this.transclude={customValidationMessages:"?bbDueDateCustomValidationMessages"},this.scope={disabled:"=?ngDisabled",model:"=",needsValidation:"&?",shouldFocusOnDateField:"&?",shouldDefaultDueDate:"&?",alternateLabelToken:"@",skipBumpHalfHourOnSameDate:"&",isDataLoadedExternal:"&?",onDateChangeValidation:"&?",isMandatory:"@?",analyticsIdTagPrefix:"@?",readOnly:"<?",customDueDatePrefix:"<?",getOriginalDueDate:"&?"},this.link=(e,t,s,n)=>{e.dueDate=this.$injector.instantiate(C,{scope:e,form:n,element:t})}}}y.$inject=["$injector"],i.module(v,[d.a,u.moduleName,m.a,p.a]).directive("bbDueDate",["$injector",e=>e.instantiate(y)])},iU4J:function(e,t,s){"use strict";var n=s("D57K"),i=(s("s5UK"),s("67oV"),s("1NX5"),s("dV61"),s("2MQt"),s("xoIb"),s("dcnw"),s("sZYy"),s("HApu"),s("hAzl"),s("4VOk"),s("nsO7")),o=s("Llzl"),a=s("JuBR"),r=s("mrqE");function c(e){Object(r.a)(1,arguments);var t=Object(a.a)(e);return t.setSeconds(0,0),t}var l,d=s("Sa5G"),u=s("ZQFV"),p=s("bd9L"),m=s("0JpG"),h=s("en1n"),b=s("nYZ0"),g=s("Fvsw"),v=s("NxQJ"),f=s("fYJU"),w=s("jhBu"),S=s("5Yfa"),C=s("2lxm"),y=s("X/qj"),O=s("lEL+"),A=s("gKdT"),I=s.n(A),D=s("VdDF"),k=s("oi1r"),_=s("P2dS"),j=s("YHe3"),T=s("pjml"),$=s("w/V/"),R=s("TnpK"),E=s("gkef"),x=s("5uPl"),P=s("k9iv"),L=s("IbyE"),G=s("zGdY"),M=s("MoIS"),N=s("aHpC"),F=s("3Nzc"),B=s("vdfi"),q=s("lmMM"),z=s("+O05"),U=s("GCTi"),V=s("iQEt"),H=s("DU7P"),Q=s("12mu"),K=s("IHOP"),W=s("Y+9S");!function(e){e.AccessCode="accessCode",e.AnonymousGrading="anonymousGrading",e.Conversations="conversations",e.DueDateEnforced="isDueDateEnforced",e.EntitlementRestriction="entitlementRestriction",e.ExternalSubmissions="externalSubmissions",e.Groups="groups",e.HasResponses="hasResponses",e.LateAttemptCreationDisallowed="isLateAttemptCreationDisallowed",e.MultipleAttempts="multipleAttempts",e.NoAnswerableQuestions="noAnswerableQuestions",e.NotDueDate="notDueDate",e.OriginalityReport="originalityReport",e.PeerGrading="peerGrading",e.PresentationOnlyQuestions="presentationOnlyQuestions",e.SecurityFeatures="testSecurity",e.None="None"}(l||(l={}));class J{static hasDisabledReason(e){return e!==l.None}static hasAnyDisabledReason(...e){return e.some((e=>this.hasDisabledReason(e)))}}J.Reason=l;var Y=s("AuQm"),Z=s("ohO4"),X=s("Y0jG");s.d(t,"c",(function(){return ee})),s.d(t,"a",(function(){return se})),s.d(t,"b",(function(){return oe}));const ee="ultra.features.course.content.assessment.settings.assessmentSettings.controller",te="assessment-settings",se="bb-assessment-settings-auto-post-grades-updated",ne="course.content.assessment.test.settings.testResults.restriction.entitlementRestriction",ie=[G.SchemaScaleType.Tabular,G.SchemaScaleType.Score,G.SchemaScaleType.Percent];let oe=class e{constructor(t,s,n,i,o,a,r,c,l,m,g,v,f,w,C,y,O,A,I,D,k,_,j,R,E,x,P,L,M){var N,F;this.$injector=t,this.$log=s,this.$q=n,this.$rootScope=i,this.$scope=o,this.$ngRedux=a,this.course=r,this.bbLocalize=c,this.contentSvc=l,this.schemaService=m,this.categoryService=g,this.ultraState=v,this.windowSize=f,this.context=C,this.entitlement=y,this.gradableItemUserOptionService=O,this.gradebookPermissionService=A,this.contextUser=I,this.timeout=D,this.assessment=k,this.localize=_,this.originalityReportService=j,this.CourseModel=R,this.ContentModel=E,this.proctoring=x,this.errorModal=P,this.flagService=L,this.$modal=M,this.assessmentResultOptions=[{option:G.AssessmentFeedbackOption.UserAnswers,icon:"visible",modeLabel:"",optionLabel:""},{option:G.AssessmentFeedbackOption.InstructorFeedback,icon:"feedback",modeLabel:"",optionLabel:""},{option:G.AssessmentFeedbackOption.Score,icon:"grade",modeLabel:"",optionLabel:""},{option:G.AssessmentFeedbackOption.CorrectAnswers,icon:"check-circle",modeLabel:"",optionLabel:""}],this.analyticsContext=!1,this.alignedGoalsCount=0,this.canCreateRubrics=!1,this.categoryOptions=[],this.unsavedSafeAssignSettings=void 0,this.gradebookCategoryTitle="",this.goalAlignedContents=[],this.isMobile=!1,this.isAllowTimeLimit=!1,this.shouldFocusPeerReviewDueDate=!1,this.subpanelId="",this.showSafeAssignSettings=!1,this.isRespondusAvailable=!1,this.isIMSProctoringAvailable=!1,this.isRubricMaxPointsUpdated=!1,this.rubricMaxPoints=void 0,this.maxTimeLimit=e.DEFAULT_MAX_TIME_LIMIT,this.accessCodeRestrictionKey=ne,this.testResultsRestrictionKey="",this.hasDueDateExceptions=!1,this.showHasDueDateExceptionsAlert=!1,this.startDate=null,this.endDate=null,this.confirmedToClose=!1,this.previousDueDate=null,this.isOriginalDueDateUpdated=!1,this.originalDueDate=null,this.peerReviewDueDateObject=null,this.multipleAttemptsAndGroupsFeatureFlag=!1,this.onDisplayOneQuestionAtATimeChanged=e=>{this.$scope.$apply((()=>{var t;(null===(t=this.deployedAssessment)||void 0===t?void 0:t.deploymentSettings)&&(this.deployedAssessment.deploymentSettings.deliveryType=e?G.AssessmentDeliveryType.Item:G.AssessmentDeliveryType.Assessment,!e&&this.shouldProhibitBacktracking&&(this.shouldProhibitBacktracking=!1))}))},this.onRandomizeQuestionsChanged=e=>{this.$scope.$apply((()=>{var t;(null===(t=this.deployedAssessment)||void 0===t?void 0:t.deploymentSettings)&&(this.deployedAssessment.deploymentSettings.isRandomizationOfQuestionsRequired=e)}))},this.isShowingSubpanel=()=>!!this.subpanelId,this.isShowingNewSubpanel=()=>this.isFeedbackSubpanelShowing||this.isImsProctoringSubpanelShowing,this.hideSubpanel=()=>{this.subpanelId="",this.scrollPanelToTop(),this.timeout((()=>{this.subpanelId=""}),this.$scope)},this.showSubpanel=e=>{this.subpanelId=e,this.scrollPanelToTop()},this.scrollPanelToTop=()=>{const e=h.k()?"assessment-settings-panel-content":"assessment-settings-panel-wrap";document.getElementById(e).scrollTop=0},this.onAccessCodeSettingsConfirm=(e,t)=>{this.accessCode=e.accessCode,e.accessCodeEnabled?(this.accessCodeEnabled=e.accessCodeEnabled,this.hideSubpanel()):this.showRemoveAccessCodeModal()},this.showRemoveAccessCodeModal=()=>{this.$scope.$broadcast(q.a,"remove-access-code-from-assessment")},this.confirmAccessCodeRemovalModal=()=>{this.accessCodeEnabled=!1,this.accessCode=this.pristineDeployedAssessment.deploymentSettings.password,this.hideSubpanel()},this.toggleSafeAssign=()=>{var e;this.unsavedSafeAssignSettings.checkAttempts=!(null===(e=this.unsavedSafeAssignSettings)||void 0===e?void 0:e.checkAttempts),this.clearSafeAssignSetting()},this.toggleSafeAssign$apply=()=>{this.$scope.$applyAsync((()=>this.toggleSafeAssign()))},this.toggleIntegrationOriginality=()=>{this.isOriginalityIntegrationEnabled=!this.isOriginalityIntegrationEnabled},this.toggleIntegrationOriginality$apply=()=>{this.$scope.$applyAsync((()=>this.toggleIntegrationOriginality()))},this.onSaveOriginalityReportSettings=()=>(this.originalitySubmissionService.capabilities.OriginalityReport.enabled=this.isOriginalityIntegrationEnabled,this.originalityReportService.setCourseContent(this.content,!0),this.originalitySettingsSaving=!0,this.originalityReportService.saveOriginalityConfiguration(this.originalitySubmissionService).then((e=>{this.originalitySettingsSaving=!1,e.success?(this.setOriginalityReportProvider(),this.$scope.$root.$broadcast("originality-updated",this.originalitySubmissionService),this.originalitySettingsError=void 0,this.hideSubpanel()):this.originalitySettingsError=e.error}))),this.hasACLCriteria=()=>!!this.aclCriteria,o.assessmentSettings=this,this.stateParams=v.params,(null===(N=this.stateParams)||void 0===N?void 0:N.subpanelId)&&(this.subpanelId=null===(F=this.stateParams)||void 0===F?void 0:F.subpanelId),this.focusEleId=this.stateParams.focusEleId,this.isMobile=window.Modernizr.touch&&!this.windowSize.isLargeBreakpoint(),this.alignedGoalsCount=w.alignedGoalsCount,this.canModifyGradebookContent=this.isEditable()&&this.gradebookPermissionService.canModify(),this.canViewGradebookContent=this.gradebookPermissionService.canView(),this.canViewGroupsAsAdmin=this.entitlement.isEntitled(d.n.ViewGroupsAsAdmin),this.canModifySettings=this.entitlement.isEntitled(d.i.ModifyAssessment),this.canCreateRubrics=this.entitlement.isEntitled(d.k.CreateRubrics),this.schemaService.loadSchemas(this.course.id,ie).then((e=>{if(this.schemas=e,this.schemas.forEach((e=>{e.localizableTitle&&(e.ui.displayTitle=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:e.ui.displayTitleKey}))})),o.gradebookItem){const e=o.$watch("gradebookItem.content",(t=>{t&&(this.content=t,this.setupContent(),this.showPeerSettingsPanelOnStart(),e())}))}else{const e=l.findRootNode(r,T.p.ContentRootNode.ROOT);l.getContentInContentTree(e,this.stateParams.courseId,this.stateParams.contentId).then((e=>{this.content=e.content,this.setupContent(),this.showPeerSettingsPanelOnStart()}))}})),this.canViewGradebookContent&&this.loadCategories(),this.subscribeToReduxStore(),this.getLocaleSettings({locale:this.bbLocalize.getAppLocaleISO()}),this.setColorClass(),this.checkProctoringServicesAvailability(),this.registerSaveAndCloseListener(),this.registerRestoreFromBrowserListener(),this.registerStateChangeListener(),this.registerDelegatedGradersSettingsUpdateListener(),this.registerProctoringServiceWatchers(),this.$scope.$on("event-error-settings-fields-conflict",(()=>{this.$scope.$broadcast(p.b),this.confirmToClose()})),this.$scope.$on("open-rubric-list-panel",(()=>{this.subpanelId=e.RUBRICS_SUBPANEL_ID})),this.$scope.$on($.a,((e,t,s)=>{if(!this.isRubricMaxPointsUpdated)return;this.isRubricMaxPointsUpdated=!1;const n=this.content.$getPreviousVersion();n.contentDetail[n.contentHandler.toString()].test.gradingColumn.possible=this.rubricMaxPoints,this.maxPointsInput=u.Utils.parseGradeValue(this.rubricMaxPoints),this.deployedAssessment.gradingColumn.possible=this.rubricMaxPoints})),this.$scope.$on(b.a,((e,t)=>{this.content&&this.content.$getPreviousVersion()&&(this.content.$getPreviousVersion().assignedGroups=t.assignedGroups,this.content.$getPreviousVersion().isGroupContent=t.isGroupContent)})),this.$scope.$on("date-selection-changed",((e,t,s)=>{this.dateSelection={start:t,end:s}})),this.$scope.$on("$destroy",(()=>{this.unsubscribeFromReduxStore&&this.unsubscribeFromReduxStore()})),this.$scope.$on(S.b,(()=>{w.resolveGoalAlignableContents(this.course,this.content,{id:this.deployedAssessment.gradingColumn.id}).then((([e,t])=>{this.goalAlignedContents=e,this.alignedGoalsCount=t}))})),r.gradebook.settings.$resolve().$then((e=>{this.isPastDueSettingTurnOn=e.countUnsubmittedWorkAsZero||!1})),this.gradableItemUserOptionService.getGradableItemUserOptionCount(this.course.id,this.$scope.gradebookItem.column.id).then((e=>{this.hasDueDateExceptions=e.results.withDueDateExceptionCount>0})),this.setMultipleAttemptGroupsFeatureFlag()}checkProctoringServicesAvailability(){return this.proctoring.fetchProctoringServices().then((e=>{this.isRespondusAvailable=e.some((e=>e.handle===H.b)),this.isIMSProctoringAvailable=e.some((e=>e.handle!==H.b))}))}setProctoringService(e){return this.proctoring.getProctoringServiceByHandle(e).then((e=>{this.proctoringService=e}))}showPeerSettingsPanelOnStart(){this.contentPromise&&this.contentPromise.then((()=>{"enable-peer-grading"===this.focusEleId&&this.peerGrading&&(this.subpanelId=e.PEER_SETTINGS_SUBPANEL_ID)}))}initAssessmentResultOptions(e,t){var s;const n=null!=e?e:null===(s=this.deployedAssessment)||void 0===s?void 0:s.deploymentSettings.feedbackSettings;t&&(this.analyticsContext=!0),this.assessment.getFeedbackModeLabels(z.d,n).then((e=>{this.assessmentResultOptions=z.d.map(((t,s)=>{const n=this.bbLocalize.getLocale(this.$scope),i=this.bbLocalize.translateSync({key:`${z.f}.${t}`,locale:n});let o=z.e[t].visible,a=e[s];return null===a&&(o=z.e[t].invisible,a=this.assessment.isUserAnswersOption(t)?this.bbLocalize.translateSync({key:"course.content.assessment.test.settings.testResults.feedbackMode.submissionHidden",locale:n}):this.bbLocalize.translateSync({key:"course.content.assessment.test.settings.testResults.feedbackMode.enableMode",locale:n})),{option:t,icon:o,modeLabel:a,optionLabel:i}}))}))}registerProctoringServiceWatchers(){this.$scope.$watch((()=>{var e;return null===(e=this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings.proctoringServiceHandle}),((e,t)=>{t!==e&&this.setProctoringService(e)})),this.$scope.$watchCollection((()=>{var e;return null===(e=this.content)||void 0===e?void 0:e.getDeployedAssessment().deploymentSettings}),((e,t)=>{i.isEqual(e,t)||(this.deployedAssessment.deploymentSettings.proctoringServiceHandle=e.proctoringServiceHandle,this.deployedAssessment.deploymentSettings.proctoringServiceVendor=e.proctoringServiceVendor,this.deployedAssessment.deploymentSettings.proctoringDownloadUrl=e.proctoringDownloadUrl,this.deployedAssessment.deploymentSettings.isSecureBrowserRequiredToTake=e.isSecureBrowserRequiredToTake,this.deployedAssessment.deploymentSettings.isSecureBrowserRequiredToReview=e.isSecureBrowserRequiredToReview,this.deployedAssessment.deploymentSettings.isWebcamRequired=e.isWebcamRequired)}))}registerDelegatedGradersSettingsUpdateListener(){Object(K.b)(this.$rootScope,this.updateWithNewDelegatedGraders.bind(this))}updateWithNewDelegatedGraders(e,t){this.deployedAssessment.gradingColumn.delegatedGraders=t}shouldFocus(e){return this.focusEleId===e}subscribeToReduxStore(){this.unsubscribeFromReduxStore=this.$ngRedux.connect((e=>{const t=this.stateParams?this.stateParams.contentId:null,s=L.select.gradebookColumn.getGradebookColumnByContentId(e,t),n=i.cloneDeep(s);return{localeSettings:L.select.locale.getLocaleSettings(e,this.bbLocalize.getAppLocaleISO()),reduxColumn:n,multipleAttemptsAndGroupsFeatureFlag:this.getMultipleAttemptGroupsFeatureFlagValue(e)}}),(e=>({getLocaleSettings:t=>e(L.actions.locale.getLocaleSettings(t))})))(this)}registerSaveAndCloseListener(){this.$scope.$on("bb-autosave-form",((e,t)=>{Y.AutoSaveMessage.Saved===t&&(this.$scope.$root.$broadcast("content-column",this.pristineDeployedAssessment.gradingColumn,!0),this.ultraState.leavePeekState(this.ultraState.current.name))}))}registerRestoreFromBrowserListener(){this.$scope.$on("bb-autosave-browser-restore-data",((t,s)=>{this.contentPromise.then((()=>{const t=s.assessmentSettings.content?s.assessmentSettings.content.adaptiveReleaseRules:null;t&&(t.startDate=t.startDate&&D.a.parseStringToDate(t.startDate.toString()),t.endDate=t.endDate&&D.a.parseStringToDate(t.endDate.toString())),i.assign(this.content,i.omit(s.assessmentSettings.content,e.ADDITIONAL_CONTENT_FIELDS))}))}))}registerStateChangeListener(){this.stateChangeListener=this.$scope.$on("$stateChangeStart",((e,t)=>{if(t.name.indexOf(te)<0){if(!this.confirmedToClose&&(this.contentSettingsChanged()||!o.equals(this.dateSelection,this.originalDateSelection)))return e.preventDefault(),void this.$scope.$broadcast(q.a,te);this.content.ui.hasConversationAttached=void 0,this.content.$revert(),this.$scope.$broadcast(p.b)}}))}contentSettingsChanged(){const e=!o.equals(this.deployedAssessment,this.pristineDeployedAssessment);return!o.equals(this.content.$wrap("U"),this.content.$getPreviousVersion())||e}shouldShowExceptionsErrorMessage(){return!Object.keys(this.$scope.assessmentSettingsForm.$error).length&&this.isDueDateExceptionRemovalNeeded()}isDueDateExceptionRemovalNeeded(){return this.hasDueDateExceptions&&!this.dueDate}validate(){const e=this.isDueDateValid(),t=this.isPossiblePointsValid(),s=this.isDueDateExceptionRemovalNeeded();return e&&t&&!s}castAssessmentFormItem(e){return this.$scope.assessmentSettingsForm[e]}persist(){this.content.ui.hasConversationAttached=this.content.allowConversations,this._conversationService.markAllConversationsForRemoval();const e=this.castAssessmentFormItem(V.b).$dirty||this.castAssessmentFormItem(V.a).$dirty,t=this.castAssessmentFormItem("grade-using").$dirty,s=this.castAssessmentFormItem("max-points").$dirty,n=this.castAssessmentFormItem("grade-category").$dirty,i=this.castAssessmentFormItem("auto-post-grades").$dirty;return this.content.$patch().$then((()=>{this.canModifyGradebookContent&&this.$scope.$broadcast($.c),this._conversationService.checkAndAddAllConversations(),(e||t||n)&&(this.$scope.$root.$broadcast("attempt-base-content-update",this.content),this.$scope.gradebookItem&&(t&&(this.$scope.gradebookItem.column.gradingSchemaId=this.schema.id,this.$scope.$root.$broadcast("bb-grid-refresh-columns",[this.$scope.gradebookItem.column.id])),e?this.$scope.gradebookItem.column.dueDate=this.dueDate:this.$scope.$root.$broadcast(b.a,this.content),n&&(this.$scope.$root.$broadcast("bb-update-category-icon",this.pristineDeployedAssessment.gradingColumn,this.pristineDeployedAssessment.gradingColumn.gradebookCategoryId),this.$scope.gradebookItem.column.gradebookCategory=this.pristineDeployedAssessment.gradingColumn.gradebookCategory))),s&&this.$scope.$root.$broadcast("bb-update-max-points",this.pristineDeployedAssessment.gradingColumn),i&&this.$scope.$root.$broadcast(se,this.autoPostGrades)})).$asPromise()}cancelClicked(){return this.ultraState.leavePeekState(this.ultraState.current.name)}saveClicked(){return this.shouldDisplayDueDateChangedDialog()?(this.$scope.$broadcast(M.a,"assessment.enforced"),this.$q.resolve()):this.shouldDisplayPastDueZero()?(this.$scope.$broadcast(M.a,this.pastDueStatus),this.$q.resolve()):this.checkDelegatedAssignment()&&this.checkPeerSettings()&&this.checkMaxPoints()?this.saveAction():this.$q.resolve()}getContext(){var e;return this.analyticsContext?null===(e=this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings.feedbackSettings:""}isIMSProctoringServiceAdded(){const{proctoringServiceHandle:e}=this.pristineDeployedAssessment.deploymentSettings,{proctoringServiceHandle:t}=this.deployedAssessment.deploymentSettings;return!e&&!!t}isIMSProctoringServiceRemoved(){const{proctoringServiceHandle:e}=this.pristineDeployedAssessment.deploymentSettings,{proctoringServiceHandle:t}=this.deployedAssessment.deploymentSettings;return!!e&&!t}isIMSProctoringServiceChanged(){const{proctoringServiceHandle:e}=this.pristineDeployedAssessment.deploymentSettings,{proctoringServiceHandle:t}=this.deployedAssessment.deploymentSettings;return!!e&&!!t&&e!==t}clearProctoringService(){return this.content.patchProctoringService("")}promptIntegrationToSave(e,t){const s=this.content.id,n=this.course.uuid;return this.proctoring.promptIntegrationToSave(e,n,s,t).then((e=>{if(!e.success)return this.$q.reject(e.error)}),(t=>{this.$log.error(`Error calling out to the proctoring tool provider (handle: ${e}) to save assessment proctoring settings.`,t)}))}saveProctoringServiceSettings(){const{proctoringServiceHandle:e}=this.pristineDeployedAssessment.deploymentSettings,{proctoringServiceHandle:t}=this.deployedAssessment.deploymentSettings;return this.isIMSProctoringServiceChanged()?this.promptIntegrationToSave(e,!1).then((()=>this.clearProctoringService())).then((()=>this.promptIntegrationToSave(t,!0))).catch((e=>this.$q.reject(e))):this.isIMSProctoringServiceRemoved()?this.promptIntegrationToSave(e,!1):this.promptIntegrationToSave(t,!0)}assignAssessmentChangesAndSaveToServer(){Object.assign(this.pristineDeployedAssessment,this.deployedAssessment),this.$scope.$broadcast(p.f)}shouldShowPossiblePointsMessage(){return i.isFinite(this.rubricMaxPoints)&&parseFloat(this.maxPointsInput)===this.rubricMaxPoints}checkMaxPoints(){var e;return this.pristineDeployedAssessment.gradingColumn.possible===this.deployedAssessment.gradingColumn.possible||!(null===(e=this.$scope.gradebookItem)||void 0===e?void 0:e.column.hasRubricAssociation())||(this.$scope.$broadcast(q.a,"max-points-updated-having-associated-rubric"),!1)}restoreMaxPoints(){this.maxPointsInput=u.Utils.parseGradeValue(this.pristineDeployedAssessment.gradingColumn.possible),this.deployedAssessment.gradingColumn.possible=this.pristineDeployedAssessment.gradingColumn.possible}saveAction(){if(!this.validate())return this.$q.reject();this.stateChangeListener(),null==this.deployedAssessment.gradingColumn.possible&&(this.deployedAssessment.gradingColumn.possible=u.Utils.GRADE_DEFAULT_POINTS);const e=[];if(this.deployedAssessment.gradingColumn.peerGrading&&e.push(this.fetchPotentialGraders()),this.isIMSProctoringServiceAdded()||this.isIMSProctoringServiceChanged()||this.isIMSProctoringServiceRemoved()){const t=this.saveProctoringServiceSettings().catch((()=>{const e=this.localize.translateSync({key:"course.content.assessment.test.modal.proctoringSaveError.body",locale:this.localize.getLocale(this.$scope)});return this.errorModal.handleError(e),this.$q.reject()}));e.push(t)}return this.$q.all(e).then((()=>{this.assignAssessmentChangesAndSaveToServer()}))}editCurrentDelegatedGraders(e){const t=this.delegatedGraders.reduce(((e,{userId:t},s)=>e.set(t,s)),new Map);e.forEach((e=>{var s;const n=null===(s=null==e?void 0:e.user)||void 0===s?void 0:s.id,i={userId:n,canReconcile:!0,isUnassigned:!1};t.has(n)?this.delegatedGraders[t.get(n)]=i:this.delegatedGraders.push(i)}))}fetchPotentialGraders(){return this.course.memberships.$refresh({filter:L.CourseMembershipFilterField.PotentialGraders,expand:L.CourseMembershipExpandField.DefaultReconciler}).$asPromise().then((e=>this.editCurrentDelegatedGraders(e)))}get deployedAssessment(){return this.unsavedDeployedAssessment?this.unsavedDeployedAssessment:this.pristineDeployedAssessment}get pristineDeployedAssessment(){var e;return null===(e=this.content)||void 0===e?void 0:e.getDeployedAssessment()}get column(){return this.deployedAssessment&&this.deployedAssessment.gradingColumn}get schema(){if(this.schemas&&this.deployedAssessment&&this.deployedAssessment.gradingColumn)return i.find(this.schemas,(e=>e.id===this.deployedAssessment.gradingColumn.gradingSchemaId))}set schema(e){this.deployedAssessment.gradingColumn.gradingSchemaId=e.id}set description(e){if(e||""===e){this.content.description=e,this.deployedAssessment.assessment.description||(this.deployedAssessment.assessment.description=Object.create(null));const t=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");this.deployedAssessment.assessment.description.rawText=t}}get description(){return this.content&&(this.content.description||""===this.content.description)?this.content.description:this.deployedAssessment&&this.deployedAssessment.assessment&&this.deployedAssessment.assessment.description?this.deployedAssessment.assessment.description.rawText:void 0}set dueDate(e){this.deployedAssessment&&(this.deployedAssessment.gradingColumn.dueDate=D.a.parseDateToISOString(e)||null,this.isDueDateValid()),e?this.canModifySettings||(this.isDueDateEnforced=this.pristineDeployedAssessment.deploymentSettings.isDueDateEnforced,this.isLateAttemptCreationDisallowed=this.pristineDeployedAssessment.deploymentSettings.isLateAttemptCreationDisallowed):this.isDueDateEnforced=!1}get dueDate(){if(this.deployedAssessment&&this.deployedAssessment.gradingColumn){const e=D.a.parseStringToDate(this.deployedAssessment.gradingColumn.dueDate);return this.originalDueDate||this.isOriginalDueDateUpdated||(this.originalDueDate=e,this.isOriginalDueDateUpdated=!0),(this.previousDueDate&&this.previousDueDate.getTime())===(e&&e.getTime())?this.previousDueDate:this.previousDueDate=e}}set peerReviewDueDate(e){this.deployedAssessment&&this.deployedAssessment.peerSettings&&(this.deployedAssessment.peerSettings.peerReviewDueDate=D.a.parseDateToISOString(e))}get peerReviewDueDate(){if(this.deployedAssessment&&this.deployedAssessment.peerSettings)return null==this.peerReviewDueDateObject&&(this.peerReviewDueDateObject=D.a.parseStringToDate(this.deployedAssessment.peerSettings.peerReviewDueDate)),D.a.parseDateToISOString(this.peerReviewDueDateObject)!==this.deployedAssessment.peerSettings.peerReviewDueDate&&(this.peerReviewDueDateObject=D.a.parseStringToDate(this.deployedAssessment.peerSettings.peerReviewDueDate)),this.peerReviewDueDateObject}updateMaxPoints(){const e=parseFloat(this.maxPointsInput);this.deployedAssessment.gradingColumn.possible=Number.isNaN(e)?null:e,this.isPossiblePointsValid()}get gradingColumnMaxPoints(){return this.deployedAssessment&&this.deployedAssessment.gradingColumn.possible}get maxPointsDecimals(){return u.Utils.GRADE_POINTS_DECIMALS_RULE_1}get maxPossiblePoints(){return u.Utils.GRADE_MAX_POINTS}get minPossiblePoints(){return u.Utils.GRADE_MIN_POINTS}set anonymousGrading(e){this.deployedAssessment&&(this.deployedAssessment.gradingColumn.anonymousGrading=e)}get anonymousGrading(){return this.deployedAssessment&&this.deployedAssessment.gradingColumn.anonymousGrading}set isDueDateEnforced(e){this.deployedAssessment&&(this.deployedAssessment.deploymentSettings.isDueDateEnforced=e,this.deployedAssessment.deploymentSettings.isLateAttemptCreationDisallowed=e,e&&(this.deployedAssessment.gradingColumn.peerGrading=!1,this.delegatedGrading=!1,this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions=!1),this.shouldShowEnforceDueDateBanner=e&&this.hasTimeLimit()&&(!this.isAutoSubmissionTimeLimit()||this.isUnlimitedTime()))}get isDueDateEnforced(){var e,t;return null!==(t=null===(e=this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings.isDueDateEnforced)&&void 0!==t&&t}set isLateAttemptCreationDisallowed(e){this.deployedAssessment&&(this.deployedAssessment.deploymentSettings.isLateAttemptCreationDisallowed=e)}get isLateAttemptCreationDisallowed(){var e,t;return null!==(t=null===(e=this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings.isLateAttemptCreationDisallowed)&&void 0!==t&&t}set delegatedGrading(e){this.deployedAssessment&&(this.deployedAssessment.gradingColumn.delegatedGrading=e)}get delegatedGrading(){return this.deployedAssessment&&this.deployedAssessment.gradingColumn&&this.deployedAssessment.gradingColumn.delegatedGrading&&!this.deployedAssessment.gradingColumn.peerGrading}get delegatedGraders(){var e,t,s;return(null===(e=this.deployedAssessment)||void 0===e?void 0:e.gradingColumn)&&!this.deployedAssessment.gradingColumn.delegatedGraders&&(this.deployedAssessment.gradingColumn.delegatedGraders=[]),null===(s=null===(t=this.deployedAssessment)||void 0===t?void 0:t.gradingColumn)||void 0===s?void 0:s.delegatedGraders}set peerGrading(e){this.deployedAssessment&&(this.deployedAssessment.gradingColumn.peerGrading=e,this.delegatedGrading=e,e&&this.disableDueDateOptions())}get peerGrading(){return this.deployedAssessment&&this.deployedAssessment.gradingColumn&&this.deployedAssessment.gradingColumn.delegatedGrading&&this.deployedAssessment.gradingColumn.peerGrading}set gradeCategory(e){this.deployedAssessment.gradingColumn.gradebookCategoryId=e}get gradeCategory(){return this.deployedAssessment&&this.deployedAssessment.gradingColumn&&this.deployedAssessment.gradingColumn.gradebookCategoryId}get usingSecureFeatures(){return this.deployedAssessment&&this.deployedAssessment.deploymentSettings&&(this.deployedAssessment.deploymentSettings.isSecureBrowserRequiredToTake||this.deployedAssessment.deploymentSettings.isSecureBrowserRequiredToReview||this.deployedAssessment.deploymentSettings.isWebcamRequired||this.proctoringServiceType===H.a.IMS)}get disabledReasonHelper(){return J}get disableDisplayOneQuestionAtATime(){return!this.canEdit()||(this.shouldProhibitBacktracking?J.hasAnyDisabledReason(this.getProhibitBacktrackingDisabledReason(),this.getQuestionOneAtATimeDisabledReason()):J.hasDisabledReason(this.getQuestionOneAtATimeDisabledReason()))}get shouldDisplayOneQuestionAtATime(){var e,t;return(null===(t=null===(e=this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings)||void 0===t?void 0:t.deliveryType)===G.AssessmentDeliveryType.Item}get shouldDisableProhibitBacktracking(){return J.hasDisabledReason(this.getProhibitBacktrackingDisabledReason())||!this.shouldDisplayOneQuestionAtATime||!this.canEdit()}getProhibitBacktrackingDisabledReason(){return this.deployedAssessment&&this.hasResponses()?l.HasResponses:l.None}get shouldProhibitBacktracking(){var e,t,s;return null!==(s=null===(t=null===(e=this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings)||void 0===t?void 0:t.isBacktrackingProhibited)&&void 0!==s&&s}set shouldProhibitBacktracking(e){this.deployedAssessment&&(this.deployedAssessment.deploymentSettings.isBacktrackingProhibited=e)}get disableRandomizeQuestions(){return!this.canEdit()||null!==this.getQuestionRandomizationDisabledReason()}get shouldRandomizeQuestions(){var e,t;return null===(t=null===(e=this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings)||void 0===t?void 0:t.isRandomizationOfQuestionsRequired}get assessmentId(){var e;return null===(e=this.deployedAssessment)||void 0===e?void 0:e.assessment.id}set autoPostGrades(e){if(this.deployedAssessment)if(this.hasResponses()){let t;this.$scope.autoPostGradesChangeModal={confirmAction:()=>{this.deployedAssessment.gradingColumn.autoPostGrades=e,t.close()},cancelAction:()=>{t.close()}},t=this.$modal.open({template:X,scope:this.$scope,resolve:{translations:[m.serviceName,e=>e.loadBundle("features/course/content/assessment/assessment")]}})}else this.deployedAssessment.gradingColumn.autoPostGrades=e}get autoPostGrades(){return this.deployedAssessment&&this.deployedAssessment.gradingColumn.autoPostGrades}get proctoringServiceType(){return this.proctoring.getCurrentProctoringProviderType(this.proctoringServiceHandle)}showRespondusProctoringSummary(){return this.isRespondusAvailable&&this.proctoringServiceType!==H.a.IMS||!this.isRespondusAvailable&&this.proctoringServiceType===H.a.Respondus}showIMSProctoringSummary(){return this.isIMSProctoringAvailable&&this.proctoringServiceType!==H.a.Respondus||!this.isIMSProctoringAvailable&&this.proctoringServiceType===H.a.IMS}showErrorInIMSProctoringSummary(){return this.proctoring.isProctoringServiceUnavailable(this.proctoringServiceHandle,this.proctoringService)}get proctoringServiceHandle(){var e;return null===(e=this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings.proctoringServiceHandle}isEditable(){return!(!this.course||!("isClosed"in this.course))&&!this.course.isClosed}get hasPeerReviews(){var e;const t=!!(null===(e=this.columnSummary)||void 0===e?void 0:e.hasAnyPeerReviewsBeenSubmitted);return this.peerGrading&&t}canEdit(){const e=this.deployedAssessment&&this.deployedAssessment.permissions;return this.isEditable()&&e&&e.modify}canCreateGroups(){return this.entitlement.isEntitled(d.n.CreateGroups)}canEditGroups(){return this.entitlement.isEntitled(d.n.ModifyGroups)}canViewGroups(){return this.entitlement.isEntitled(d.n.ViewGroups)||this.entitlement.isEntitled(d.n.ViewGroupsAsAdmin)}get shouldRandomizeAnswers(){var e,t;return(null===(t=null===(e=this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings)||void 0===t?void 0:t.isRandomizationOfAnswersRequired)===G.RandomizeAnswers.Always}set shouldRandomizeAnswers(e){const t=e?G.RandomizeAnswers.Always:G.RandomizeAnswers.Never;this.deployedAssessment&&this.deployedAssessment.deploymentSettings&&(this.deployedAssessment.deploymentSettings.isRandomizationOfAnswersRequired=t)}isPossiblePointsValid(){return this.gradingColumnMaxPoints>=u.Utils.GRADE_MIN_POINTS&&this.gradingColumnMaxPoints<=u.Utils.GRADE_MAX_POINTS}canEditDueDate(){var e,t,s,n;const i=!!(null===(t=null===(e=this.deployedAssessment)||void 0===e?void 0:e.permissions)||void 0===t?void 0:t.modifyDueDate),o=!!(null===(n=null===(s=this.deployedAssessment)||void 0===s?void 0:s.permissions)||void 0===n?void 0:n.modify);return i||o}isNotEnoughPeerSubmissionsToStart(){var e,t,s,n;if(!this.peerGrading)return!1;const i=null!==(t=null===(e=this.columnSummary)||void 0===e?void 0:e.numStudentSubmissions())&&void 0!==t?t:0,o=null!==(n=null===(s=this.deployedAssessment.peerSettings)||void 0===s?void 0:s.peerReviewsPerStudent)&&void 0!==n?n:0;return this.isPastDue(this.dueDate)&&i<o+1}get collectExternalSubmissions(){return this.deployedAssessment&&this.deployedAssessment.deploymentSettings&&this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions}set collectExternalSubmissions(e){this.deployedAssessment&&this.deployedAssessment.deploymentSettings&&(this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions=e,e&&(this.removeTimeLimit(),this.content.isSafeAssignOn()&&(this.content.contentDetail[this.content.contentHandler.toString()].safeAssignOptions={checkAttempts:!1,canStudentViewReports:!1,excludeSubmissions:!1,globalSearch:!1},this.clearSafeAssignSetting()),this.disableDueDateOptions()))}disableDueDateOptions(){this.deployedAssessment.deploymentSettings.isDueDateEnforced=!1,this.deployedAssessment.deploymentSettings.isLateAttemptCreationDisallowed=!1}isDueDateValid(){return this.isDueDateValidForPeerReview()&&this.isDueDateValidForConditionalAvailability()&&this.isDueDateValidForFeedbackResults()&&this.isDueDateValidWhenEnforceDueDateIsSet()}isDueDateValidForConditionalAvailability(){return this.isDateValid(this.startDate,this.endDate,e.INVALID_DUE_DATE_PER_START_END_RANGE_ERROR_KEY,e.INVALID_DUE_DATE_PER_START_END_RANGE_ERROR_KEY)}isDueDateValidForPeerReview(){return this.peerGrading?this.isDateValid(null,this.peerReviewDueDate,e.INVALID_DUE_DATE_PER_PEER_REVIEW_DATE_ERROR_KEY,e.INVALID_DUE_DATE_PER_PEER_REVIEW_TIME_ERROR_KEY):(this.castAssessmentFormItem(V.a).$setValidity(e.INVALID_DUE_DATE_PER_PEER_REVIEW_DATE_ERROR_KEY,!0),this.castAssessmentFormItem(V.b).$setValidity(e.INVALID_DUE_DATE_PER_PEER_REVIEW_TIME_ERROR_KEY,!0),!0)}isDueDateValidForFeedbackResults(){var t,s;const n=null===(s=null===(t=this.deployedAssessment)||void 0===t?void 0:t.deploymentSettings)||void 0===s?void 0:s.feedbackSettings,i=L.FeedbackSettings.getFeedbackModeByOption(G.AssessmentFeedbackOption.Score,n),o=L.FeedbackSettings.getFeedbackModeByOption(G.AssessmentFeedbackOption.CorrectAnswers,n);let a=null,r=null;return Object(U.c)(i.mode,o.mode)&&(a=i.associatedDate,r=o.associatedDate),this.isDateValid(a,r,e.INVALID_DUE_DATE_PER_FEEDBACK_RELEASE_DATE_ERROR_KEY,e.INVALID_DUE_DATE_PER_FEEDBACK_RELEASE_DATE_ERROR_KEY)}isDueDateValidWhenEnforceDueDateIsSet(){var t,s,n,i;const o=(null===(t=this.originalDueDate)||void 0===t?void 0:t.getTime())!==(null===(s=this.dueDate)||void 0===s?void 0:s.getTime()),a=this.isDueDateEnforced!==(null===(i=null===(n=this.pristineDeployedAssessment)||void 0===n?void 0:n.deploymentSettings)||void 0===i?void 0:i.isDueDateEnforced);return this.isDueDateEnforced&&(o||a)&&this.hasResponses()?this.isDateValid(this.context.getServerTime(),null,e.INVALID_DUE_DATE_PER_ENFORCE_DUE_DATE_ERROR_KEY,e.INVALID_DUE_DATE_PER_ENFORCE_DUE_DATE_ERROR_KEY):(this.castAssessmentFormItem(V.a).$setValidity(e.INVALID_DUE_DATE_PER_ENFORCE_DUE_DATE_ERROR_KEY,!0),this.castAssessmentFormItem(V.b).$setValidity(e.INVALID_DUE_DATE_PER_ENFORCE_DUE_DATE_ERROR_KEY,!0),!0)}isDateValid(e,t,s,n){const{isValidDate:i,isValidTime:o}=D.a.testWithinDateRange(this.dueDate,{end:t,start:e},!1),a=i&&o;return this.castAssessmentFormItem(V.a).$setValidity(s,i),this.castAssessmentFormItem(V.b).$setValidity(n,o),(this.$scope.assessmentSettingsForm[V.a].$invalid||this.$scope.assessmentSettingsForm[V.b].$invalid)&&(this.$scope.assessmentSettingsForm[V.a].$setDirty(),this.$scope.assessmentSettingsForm[V.b].$setDirty(),this.$scope.assessmentSettingsForm[V.a].$setTouched(),this.$scope.assessmentSettingsForm[V.b].$setTouched()),a}getColumnSummary(){this.deployedAssessment&&this.deployedAssessment.gradingColumn&&(this.columnSummary=this.course.gradebook.columns.$buildRaw(this.deployedAssessment.gradingColumn).summary,this.columnSummary.$fetch())}setupMaxPointsInput(){this.contentPromise&&this.contentPromise.then((()=>{this.updateMaxPointsInput()}))}updateMaxPointsInput(){this.deployedAssessment&&null!=this.deployedAssessment.gradingColumn.possible?this.maxPointsInput=u.Utils.parseGradeValue(this.deployedAssessment.gradingColumn.possible):this.maxPointsInput=u.Utils.GRADE_DEFAULT_POINTS.toString()}setupContent(){this.contentPromise=this.content.$fetch({expand:e.ADDITIONAL_CONTENT_FIELDS.join(",")}).$then((()=>{this.originalDeploymentSettings=i.assign({},this.content&&this.pristineDeployedAssessment.deploymentSettings),this.content.$snapshot(),this.unsavedDeployedAssessment=i.cloneDeep(this.pristineDeployedAssessment),this.content.adaptiveReleaseRules&&(this.dateSelection=this.originalDateSelection={start:!!this.content.adaptiveReleaseRules.startDate,end:!!this.content.adaptiveReleaseRules.endDate}),this.canModifyGradebookContent&&(this.getColumnSummary(),this.setupMaxPointsInput()),this.content.$getPreviousVersion()&&(this.content.$getPreviousVersion().allowConversations=this.content.hasConversation()),this.getAdaptiveReleaseCriteria(),this._conversationService=this.$injector.instantiate(v.a,{currentCourse:this.course,coreContent:this.content}),this.$scope.$emit(S.b),this.calculateCategoryDependentLocaleKeys(),this.initAssessmentResultOptions(),this.originalityReportService.setCourseContent(this.content,!0),this.setOriginalityReportProvider()})).$asPromise()}getAdaptiveReleaseCriteria(){var e;const t=this.content&&this.content.adaptiveReleaseRules;if(null===(e=null==t?void 0:t.rules)||void 0===e?void 0:e.length){const e=t.rules[0].criteria;this.dateCriteria=e.find((e=>"Date_Range"===e.type)),this.dateCriteria&&(this.startDate=D.a.parseStringToDate(this.dateCriteria.start),this.endDate=D.a.parseStringToDate(this.dateCriteria.end)),this.aclCriteria=e.find((e=>"ACL"===e.type))}}get isImsProctoringSubpanelShowing(){return this.subpanelId===e.IMS_PROCTORING_SUBPANEL_ID}get isFeedbackSubpanelShowing(){return this.subpanelId===e.FEEDBACK_SUBPANEL_ID}get isGoalsSubpanelShowing(){return this.subpanelId===e.GOALS_SUBPANEL_ID}get isRubricsSubpanelShowing(){return this.subpanelId===e.RUBRICS_SUBPANEL_ID}hasTimeLimit(){return this.getDisplayTimeLimit()>0}get isTimeLimitSubpanelShowing(){return this.subpanelId===e.TIME_LIMIT_SUBPANEL_ID}get isPeerSettingsSubpanelShowing(){return this.subpanelId===e.PEER_SETTINGS_SUBPANEL_ID}showPeerSettingsPanel(t){this.showSubpanel(e.PEER_SETTINGS_SUBPANEL_ID),this.shouldFocusPeerReviewDueDate=t}openOriginalitySubPanel(){this.originalityReportService.isSafeAssignActiveOriginalityProvider()?this.showSubpanel(e.SAFE_ASSIGN_SUBPANEL_ID):this.originalityReportService.isIntegrationActiveOriginalityProvider()&&this.showSubpanel(e.ORIGINALITY_REPORT_SUBPANEL_ID)}get isAccessCodeSubpanelShowing(){return this.subpanelId===e.ACCESS_CODE_SUBPANEL_ID}get accessCodeEnabled(){var e;return null===(e=null==this?void 0:this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings.isPasswordRequired}set accessCodeEnabled(e){var t;(null===(t=null==this?void 0:this.deployedAssessment)||void 0===t?void 0:t.deploymentSettings).isPasswordRequired=e}get accessCode(){var e;return null===(e=null==this?void 0:this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings.password}set accessCode(e){var t;(null===(t=null==this?void 0:this.deployedAssessment)||void 0===t?void 0:t.deploymentSettings).password=e}hidePeerSettingsPanel(e){if(e){const{dueDate:t,peerGrading:s,...n}=e;null!=t&&(this.dueDate=t),this.deployedAssessment.peerSettings={...this.deployedAssessment.peerSettings,...n,allowLatePeerReviews:!0},this.deployedAssessment.peerSettings.evaluationColumnName=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:"course.content.assessment.test.settings.peerGrading.evaluationColumnTitle",params:{columnName:this.deployedAssessment.gradingColumn.columnName},noWrap:!0}),this.peerGrading=s,this.peerReviewDueDate=n.peerReviewDueDate}this.subpanelId=""}getExtraTime(){const e=this.deployedAssessment&&this.deployedAssessment.deploymentSettings;return e&&e.softTimeLimit&&e.timeLimit-e.softTimeLimit}getDisplayTimeLimit(){const e=this.deployedAssessment&&this.deployedAssessment.deploymentSettings;return e&&(e.softTimeLimit||e.timeLimit)}removeTimeLimit(){const e=this.deployedAssessment&&this.deployedAssessment.deploymentSettings;this.originalDeploymentSettings&&e&&(delete this.originalDeploymentSettings.timeLimit,delete this.originalDeploymentSettings.softTimeLimit,this.originalDeploymentSettings.timerCompletion=G.TimerCompletion.Continual,delete e.timeLimit,delete e.softTimeLimit,e.timerCompletion=G.TimerCompletion.Continual,this.content&&this.content.removeTimeLimit(this.originalDeploymentSettings))}hideTimeLimit(){this.subpanelId="",this.$scope.$root.$broadcast("bb-save-time-limit")}isUnlimitedTime(){const e=this.deployedAssessment&&this.deployedAssessment.deploymentSettings;return e&&e.timeLimit&&e.timerCompletion===G.TimerCompletion.Continual}isAutoSubmissionTimeLimit(){const e=this.deployedAssessment&&this.deployedAssessment.deploymentSettings;return e&&!e.softTimeLimit&&e.timerCompletion===G.TimerCompletion.HardStop}get isSafeAssignSubpanelShowing(){return this.subpanelId===e.SAFE_ASSIGN_SUBPANEL_ID}get isOriginalityReportSubpanelShowing(){return this.subpanelId===e.ORIGINALITY_REPORT_SUBPANEL_ID}setOriginalityReportProvider(){this.originalityReportService.retrieveOriginalityIntegration(this.content).then((e=>{if(e)return this.originalitySubmissionService=i.cloneDeep(e),this.isOriginalityIntegrationEnabled=e.capabilities.OriginalityReport.enabled,this.originalityReportService.isSafeAssignActiveOriginalityProvider()&&this.resetUnsavedSafeAssignSettings(),this.originalitySubmissionService}))}onCancelOriginalityReportSettings(){this.setOriginalityReportProvider(),this.hideSubpanel()}canConfigureOriginalityReport(){return this.canEdit()&&!z.a.isExternalSubmissionsAssessment(this.content)}get originalityButtonSwitchAnalyticsId(){var e;return`course.content.assessment.settings.originalityReport.${(null===(e=this.originalitySubmissionService)||void 0===e?void 0:e.uniqueHandle)||"unknown"}.attempts.${this.isOriginalityIntegrationEnabled?"disable":"enable"}.switch`}get originalityButtonSwitchLabel(){var e;return this.localize.translateSync({locale:this.localize.getAppLocale(),key:"course.content.originalityReport.settings.providerSwitchLabel",noWrap:!0,params:{originalityReportProvider:null===(e=this.originalitySubmissionService)||void 0===e?void 0:e.displayName},noEscape:!0})}get safeAssignButtonSwitchlabel(){var e;return this.localize.translateSync({locale:this.localize.getAppLocale(),key:"course.content.originalityReport.settings.enableProvider",noWrap:!0,params:{originalityProvider:null===(e=this.originalitySubmissionService)||void 0===e?void 0:e.displayName},noEscape:!0})}safeAssignCancelled(){this.resetUnsavedSafeAssignSettings(),this.hideSubpanel()}safeAssignSaved(){var e,t,s,n;const i=this.content.getSafeAssignAttrs();i.canStudentViewReports=null===(e=this.unsavedSafeAssignSettings)||void 0===e?void 0:e.canStudentViewReports,i.checkAttempts=null===(t=this.unsavedSafeAssignSettings)||void 0===t?void 0:t.checkAttempts,i.excludeSubmissions=null===(s=this.unsavedSafeAssignSettings)||void 0===s?void 0:s.excludeSubmissions,i.globalSearch=null===(n=this.unsavedSafeAssignSettings)||void 0===n?void 0:n.globalSearch,this.resetUnsavedSafeAssignSettings(),this.hideSubpanel()}resetUnsavedSafeAssignSettings(){this.unsavedSafeAssignSettings={...this.content.getSafeAssignAttrs()}}isMultipleAttempts(){return this.deployedAssessment&&1!==this.deployedAssessment.deploymentSettings.attemptCount}isActiveMultipleAttemptsAndGroupsRestriction(){return!this.multipleAttemptsAndGroupsFeatureFlag}setMultipleAttemptGroupsFeatureFlag(){const e=this.flagService.isFeatureEnabled(L.FeatureFlagKey.MultipleAttemptsAndGroups);this.multipleAttemptsAndGroupsFeatureFlag=e}getMultipleAttemptGroupsFeatureFlagValue(e){if(!e)return;const t=L.select.featureFlags.getFeatureFlagValue(e,L.FeatureFlagKey.MultipleAttemptsAndGroups);return"true"===(null==t?void 0:t.flagValue)}getQuestionOneAtATimeDisabledReason(){return this.deployedAssessment?this.canModifySettings?this.hasAnswerableQuestions()?this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions?l.ExternalSubmissions:this.hasResponses()?l.HasResponses:l.None:l.NoAnswerableQuestions:l.EntitlementRestriction:l.None}getQuestionRandomizationDisabledReason(){return this.deployedAssessment?this.peerGrading?l.PeerGrading:this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions?l.ExternalSubmissions:this.deployedAssessment.assessment.hasPresentationOnlyQuestions?l.PresentationOnlyQuestions:this.hasAnswerableQuestions()?this.hasResponses()?l.HasResponses:null:l.NoAnswerableQuestions:null}getAnswerRandomizationDisabledReason(){return this.deployedAssessment?this.peerGrading?"peerGrading":this.hasResponses()?"hasResponses":this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions?"externalSubmissions":this.hasAnswerableQuestions()?null:"noAnswerableQuestions":null}getImsProctoringDisabledReason(){return this.deployedAssessment&&this.proctoringServiceType!==H.a.IMS?this.collectExternalSubmissions?"imsProctoringSummary.restriction.externalSubmission":this.content.isGroupContent?"imsProctoringSummary.restriction.groups":void 0:null}getExternalSubmissionDisabledReason(){return!this.deployedAssessment||this.collectExternalSubmissions?null:this.hasResponses()?"hasResponses":this.hasAnswerableQuestions()?"answerableQuestions":this.anonymousGrading?"anonymousGrading":this.peerGrading?"peerGrading":this.isDueDateEnforced?"isDueDateEnforced":this.isLateAttemptCreationDisallowed?"isLateAttemptCreationDisallowed":this.isMultipleAttempts()?"multipleAttempts":this.usingSecureFeatures?"testSecurity":this.accessCodeEnabled?"accessCode":this.originalityReportService.isOriginalityReportEnabled()?"originalityReport":null}getAnonymousGradingDisabledReason(){return this.deployedAssessment?this.hasResponses()&&!this.anonymousGrading?"hasResponsesShowingNames":this.hasResponses()&&this.anonymousGrading?"hasResponsesHidingNames":this.hasAnswerableQuestions()?"answerableQuestions":this.content.allowConversations?"conversations":this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions?"externalSubmissions":this.content.isGroupContent?"groups":this.peerGrading?"peerGrading":null:null}shouldShowAutoPostGradesDescription(){return null===this.getAutoPostGradesDisabledReason()}getAutoPostGradesDisabledReason(){return this.deployedAssessment?this.canModifySettings?null:"entitlementRestriction":null}shouldShowAccessCodeSetting(){return this.canModifySettings}getAccessCodeDisabledReason(){var e,t;return(null===(t=null===(e=this.deployedAssessment)||void 0===e?void 0:e.deploymentSettings)||void 0===t?void 0:t.isCollectExternalSubmissions)?"externalSubmission":null}getDelegatedGradingDisabledReason(){return this.deployedAssessment?this.hasAnswerableQuestions()?"answerableQuestions":this.content.isGroupContent?"groups":this.peerGrading?"peerGrading":null:null}shouldShowEnforceDueDateDescription(){const e=this.getEnforceDueDateDisabledReason();return null===e||"notDueDate"===e}getEnforceDueDateDisabledReason(){return this.deployedAssessment?this.canModifySettings?this.dueDate?this.peerGrading?"peerGrading":this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions?"externalSubmissions":this.content.isGroupContent?"groupAssessment":null:"notDueDate":"entitlementRestriction":null}shouldShowProhibitNewAttemptsAfterDueDateDescription(){const e=this.getProhibitNewAttemptsAfterDueDateDisabledReason();return null===e||"isDueDateEnforced"===e||"notDueDate"===e}getProhibitNewAttemptsAfterDueDateDisabledReason(){return this.deployedAssessment?this.canModifySettings?this.isDueDateEnforced?"isDueDateEnforced":this.dueDate?this.peerGrading?"peerGrading":this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions?"externalSubmissions":null:"notDueDate":"entitlementRestriction":null}getPeerGradingDisabledReason(){return this.deployedAssessment?this.hasAnswerableQuestions()?"answerableQuestions":this.isMultipleAttempts()?"multipleAttempts":this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions?"externalSubmissions":this.anonymousGrading?"anonymousGrading":this.delegatedGrading?"delegatedGrading":this.content.isGroupContent?"groups":this.isDueDateEnforced?"isDueDateEnforced":this.isLateAttemptCreationDisallowed?"isLateAttemptCreationDisallowed":this.deployedAssessment.deploymentSettings.timeLimit?"timeLimit":this.hasResponses()&&!this.peerGrading?"hasSubmissionsNotPeer":this.hasResponses()&&this.peerGrading?"hasSubmissionsIsPeer":null:null}getGroupDisabledReason(){return this.deployedAssessment?this.isMultipleAttempts()&&this.isActiveMultipleAttemptsAndGroupsRestriction()?"course.content.groupRestriction.multipleAttempt":this.anonymousGrading?"course.content.groupRestriction.anonymousGrading":this.delegatedGrading?"course.content.groupRestriction.delegatedGrading":this.peerGrading?"course.content.groupRestriction.peerGrading":this.deployedAssessment.deploymentSettings.timeLimit?"course.content.groupRestriction.timedAssessment":this.usingSecureFeatures?"course.content.groupRestriction.testSecurity":this.hasACLCriteria()?"course.content.groupRestriction.conditionalRelease":this.isDueDateEnforced?"course.content.groupRestriction.enforceDueDate":null:null}getTimeLimitDisabledReason(){return this.deployedAssessment?this.peerGrading?"peerGrading":this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions?"externalSubmissions":null:null}getGroupsLinkKey(){return this.canCreateGroups?"course.content.assessment.settings.makeGroup":"course.content.assessment.settings.viewGroup"}getOriginalityReportDisabledReason(){return!this.deployedAssessment||this.originalityReportService.isOriginalityReportEnabled()?null:this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions?"externalSubmissions":null}associateRubric(e,t){i.isFinite(t)&&(this.rubricMaxPoints=t,this.isRubricMaxPointsUpdated=!0),this.$scope.$root.$broadcast("associate-rubric",e,t),this.subpanelId=""}addGoals(){this.ultraState.goPeekState("goal-picker-legacy",{goalAlignableContent:this.content})}hasAnswerableQuestions(){return this.content&&!this.content.isAssignment()&&this.pristineDeployedAssessment.assessment.hasAnswerableQuestions}hasAssignedGroups(){return this.content&&this.content.assignedGroups&&this.content.assignedGroups.length>0}hasTimeLimitRestrictions(){return null!=this.getTimeLimitDisabledReason()}editGroups(){this.persist().then((()=>{this.ultraState.goPeekState("course-group",{groupCourseId:this.content.courseId,groupContentId:this.content.id,groupColumnId:this.deployedAssessment.gradingColumn.id})}))}calculateCategoryDependentLocaleKeys(){const e=this.pristineDeployedAssessment.gradingColumn.gradebookCategory;this.gradebookCategoryTitle=e.title;const t=this.course.isOrganization?"organization":"course";e.isUserDefined?(this.panelTitle=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:"course.content.assessment.settings.header.custom",params:{title:this.gradebookCategoryTitle},noEscape:!0,noWrap:!0}),this.dueDateErrorKey="course.content.assessment.settings.dueDate.outOfShowHideRangeError.custom",this.groupDescriptionLocalizeId="course.content.assessment.settings.groupDescription.custom",this.cannotMakeGroupLocalizeId=`${t}.content.assessment.settings.cannotMakeGroup.custom`,this.cannotMakeGroupNoPermissionLocalizedId="course.content.assessment.settings.cannotMakeGroupNoPermission.custom",this.cannotMakeGroupPostedLocalizeId="course.content.assessment.settings.cannotMakeGroupPosted.custom"):(this.panelTitle=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:"course.content.assessment.settings.header."+this.gradebookCategoryTitle}),this.dueDateErrorKey="course.content.assessment.settings.dueDate.outOfShowHideRangeError."+this.gradebookCategoryTitle,this.groupDescriptionLocalizeId="course.content.assessment.settings.groupDescription."+this.gradebookCategoryTitle,this.cannotMakeGroupLocalizeId=`${t}.content.assessment.settings.cannotMakeGroup.${this.gradebookCategoryTitle}`,this.cannotMakeGroupNoPermissionLocalizedId="course.content.assessment.settings.cannotMakeGroupNoPermission."+this.gradebookCategoryTitle,this.cannotMakeGroupPostedLocalizeId="course.content.assessment.settings.cannotMakeGroupPosted."+this.gradebookCategoryTitle),this.dueDatePeerReviewErrorKey="course.content.assessment.settings.dueDate.notBeforePeerReviewStart",this.notifyMobileApp()}notifyMobileApp(){var e;const t={type:W.MessageType.AssessmentSettingsOpened,status:W.MessageStatus.Success,pageTitle:this.panelTitle,prevState:Object(W.fetchState)(null===(e=this.ultraState.prev)||void 0===e?void 0:e.name)};Object(W.sendMessageToMobile)(t)}clearGroups(){this.content&&this.contentSvc.clearContentGroups(this.content,this.course).then((()=>{this.$scope.$root.$broadcast(F.c,this.content)}))}hasResponses(){return this.deployedAssessment&&this.deployedAssessment.assessment.hasResponses}hasPostedGrades(){return this.columnSummary&&(this.columnSummary.numGroupsPosted||this.columnSummary.numPosted)}hasFeedbacks(){return this.hasResponses()||this.hasPostedGrades()}confirmToClose(){this.confirmedToClose=!0,this.ultraState.leavePeekState(this.ultraState.current.name)}checkDelegatedAssignment(){if(this.delegatedGrading){if(!this.areDelegatedGradersAssigned())return this.$scope.$broadcast(q.a,"assessment-settings-no-delegated-graders"),!1;if(!this.areReconcilersAssigned()&&this.hasCanConfigureReconcilersPermission())return this.$scope.$broadcast(q.a,"assessment-settings-no-reconcilers"),!1}return!0}areDelegatedGradersAssigned(){return 0!==this.delegatedGraders.filter((e=>!e.isUnassigned&&!e.canReconcile)).length}areReconcilersAssigned(){return!!this.delegatedGrading&&!!this.delegatedGraders.some((e=>e.canReconcile&&!e.isUnassigned))}confirmSave(){return this.saveAction()}openDelegatedGradingSettingsPanel(){this.ultraState.goPeekState("assign-graders")}setColorClass(){this.$scope.course?this.courseColorClass=this.$scope.course.courseColorClass:this.course.memberships.$search({userId:this.contextUser.userId}).$then((e=>{this.courseColorClass=e[0].getCourseColorClass()}))}getColorClass(){return this.courseColorClass}loadCategories(){this.categoryService.getFilteredCategoriesForCourse(this.course.id,(e=>e.title!==G.KnownGradebookCategoryTitle.Attendance)).then((e=>{e.forEach((e=>{const t=e.title,s={label:e.isUserDefined?t:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:"course.content.assessment.type."+t}),value:e.id};this.categoryOptions.push(s)}))}))}clearSafeAssignSetting(){this.unsavedSafeAssignSettings.canStudentViewReports=!1,this.unsavedSafeAssignSettings.excludeSubmissions=!1}automaticZeroConfirm(){this.originalDueDate=this.dueDate,this.saveAction()}automaticZeroCancel(){this.dueDate=this.originalDueDate}automaticZeroDismiss(){this.dueDate=this.originalDueDate}isPastDue(e){return!!e&&e<this.context.getServerTime()}shouldDisplayPastDueZero(){if(!1===this.isPastDueSettingTurnOn)return!1;let e=this.isPastDue(this.originalDueDate);this.pristineDeployedAssessment.gradingColumn.peerGrading&&(e=this.isPastDue(D.a.parseStringToDate(this.pristineDeployedAssessment.peerSettings.peerReviewDueDate)));let t=this.isPastDue(this.dueDate);return this.peerGrading&&(t=this.isPastDue(this.peerReviewDueDate)),this.pastDueStatus=e&&!t?"after":!e&&t?"before":null,null!==this.pastDueStatus}shouldDisplayDueDateChangedDialog(){return!this.isPastDue(this.originalDueDate)&&this.dueDate!==this.originalDueDate&&this.isDueDateEnforced&&this.hasResponses()}hasCanConfigureReconcilersPermission(){return!!(this.reduxColumn&&this.reduxColumn.permissions&&this.reduxColumn.permissions.canConfigureReconcilers)}checkPeerSettings(){return!(this.column.peerGrading&&!this.deployedAssessment.peerSettings)||(this.$scope.$broadcast(q.a,"assessment-settings-no-peer-grade-settings"),!1)}disablePeerAndConfirmSave(){return this.peerGrading=!1,this.confirmSave()}handlePeerSettingsClose(){this.$scope.$broadcast("close-peer-review-slide-panel")}getShowTestResultsDisabledReason(){return this.deployedAssessment?this.canModifySettings?this.anonymousGrading?(this.testResultsRestrictionKey="course.content.assessment.test.settings.testResults.restriction.anonymousGrading","anonymousGrading"):this.delegatedGrading?(this.testResultsRestrictionKey="course.content.assessment.test.settings.testResults.restriction.delegatedGrading","delegatedGrading"):this.deployedAssessment.deploymentSettings.isCollectExternalSubmissions?(this.testResultsRestrictionKey="course.content.assessment.test.settings.testResults.restriction.externalSubmissions","externalSubmissions"):this.peerGrading?(this.testResultsRestrictionKey="course.content.assessment.test.settings.testResults.restriction.peerGrading","peerGrading"):this.hasAnswerableQuestions()?null:(this.testResultsRestrictionKey="course.content.assessment.test.settings.testResults.restriction.noAnswerableQuestions","noAnswerableQuestions"):(this.testResultsRestrictionKey=ne,"entitlementRestriction"):null}displayHasDueDateExceptionsAlert(){if(!this.hasDueDateExceptions)return;const e=!function(e,t){Object(r.a)(2,arguments);var s=c(e),n=c(t);return s.getTime()===n.getTime()}(this.originalDueDate,this.dueDate);this.showHasDueDateExceptionsAlert=e}hideHasDueDateExceptionsAlert(){this.showHasDueDateExceptionsAlert=!1}};oe.INVALID_DUE_DATE_PER_START_END_RANGE_ERROR_KEY="dueDateNotWithinStartEndRange",oe.INVALID_DUE_DATE_PER_PEER_REVIEW_DATE_ERROR_KEY="dueDateNotBeforePeerReviewStart",oe.INVALID_DUE_DATE_PER_FEEDBACK_RELEASE_DATE_ERROR_KEY="dueDateNotBeforeOnFeedbackReleaseDate",oe.INVALID_DUE_DATE_PER_PEER_REVIEW_TIME_ERROR_KEY="dueTimeNotBeforePeerReviewStart",oe.INVALID_DUE_DATE_PER_ENFORCE_DUE_DATE_ERROR_KEY="dueDateNotAfterCurrentDate",oe.ADDITIONAL_CONTENT_FIELDS=["alignedGoals","assignedGroups","selfEnrollmentGroups.group","gradebookCategory","isGroupContent","permissions"],oe.DEFAULT_TIME_LIMIT=60,oe.DEFAULT_MAX_TIME_LIMIT=1440,oe.NUMBER_SMALL_KEY="numberSmall",oe.ACCESS_CODE_SUBPANEL_ID="accessCode",oe.FEEDBACK_SUBPANEL_ID="feedback",oe.GOALS_SUBPANEL_ID="goals",oe.RUBRICS_SUBPANEL_ID="rubrics",oe.TIME_LIMIT_SUBPANEL_ID="timeLimit",oe.SAFE_ASSIGN_SUBPANEL_ID="safeAssign",oe.ORIGINALITY_REPORT_SUBPANEL_ID="originalityReport",oe.PEER_SETTINGS_SUBPANEL_ID="peerSettings",oe.IMS_PROCTORING_SUBPANEL_ID="imsProctoring",Object(n.__decorate)([I.a],oe.prototype,"hidePeerSettingsPanel",null),oe=Object(n.__decorate)([Object(n.__param)(0,Object(N.b)("$injector")),Object(n.__param)(1,Object(N.b)("$log")),Object(n.__param)(2,Object(N.b)("$q")),Object(n.__param)(3,Object(N.b)("$rootScope")),Object(n.__param)(4,Object(N.b)("$scope")),Object(n.__param)(5,Object(N.b)("$ngRedux")),Object(n.__param)(6,Object(N.b)("currentCourse")),Object(n.__param)(7,Object(N.b)(m.serviceName)),Object(n.__param)(8,Object(N.b)(b.f)),Object(n.__param)(9,Object(N.b)(k.b)),Object(n.__param)(10,Object(N.b)(_.c)),Object(n.__param)(11,Object(N.b)(R.d)),Object(n.__param)(12,Object(N.b)(E.b)),Object(n.__param)(13,Object(N.b)(B.d)),Object(n.__param)(14,Object(N.b)(g.b)),Object(n.__param)(15,Object(N.b)(w.b)),Object(n.__param)(16,Object(N.b)(C.b)),Object(n.__param)(17,Object(N.b)(y.b)),Object(n.__param)(18,Object(N.b)(f.b)),Object(n.__param)(19,Object(N.b)(O.b)),Object(n.__param)(20,Object(N.b)(z.h)),Object(n.__param)(21,Object(N.b)(m.serviceName)),Object(n.__param)(22,Object(N.b)(x.b)),Object(n.__param)(23,Object(N.b)(T.m.serviceName)),Object(n.__param)(24,Object(N.b)(T.p.serviceName)),Object(n.__param)(25,Object(N.b)(j.b)),Object(n.__param)(26,Object(N.b)(P.d)),Object(n.__param)(27,Object(N.b)(Z.b)),Object(n.__param)(28,Object(N.b)(Q.b))],oe)},iViV:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return h}));var n=s("Llzl"),i=s("nsO7"),o=s("o5Lu"),a=s("3l3z"),r=s("LN5R"),c=s("TmUJ"),l=s("qH3X"),d=s("+4Px"),u=s("lEL+"),p=s("dF44"),m=s("lEWr");const h="ultra.components.directives.gradeGridCellEditorReborn";class b{constructor(e,t,s,n,i,o,a,r){this.$compile=e,this.window=t,this.scope=s,this.element=n,this.attrs=i,this.gradeGridRebornController=o,this.gradeService=a,this.timeout=r,this.initialize(),s.$on(l.a.REFRESH_CELL_EDITOR,(()=>{this.initialize(),this.scope.gradeGridColumnReborn.getIsOtherGroupMemberGraded()})),s.$on("$destroy",(()=>{this.removeErrorMessage()}))}initialize(){this.score=this.scope.gradeGridColumnReborn.score,this.element.find("input").focus(),this.element.addClass("purple-outline"),this.timeout((()=>{this.element.find("input").select()}),this.scope,0,!1),this.userName=this.scope.gradeGridColumnReborn.userName,this.checkValue(this.score).then((e=>{this.isValidated=e}))}removeErrorMessage(){this.element.removeClass("validation-alert"),i.isUndefined(this.messageElement)||(this.messageElement.remove(),this.messageElement=void 0),i.isUndefined(this.messageScope)||(this.messageScope.$destroy(),this.messageScope=void 0)}createErrorMessage(){if(this.messageElement&&this.removeErrorMessage(),i.isUndefined(this.messageElement)){this.element.addClass("validation-alert");const e=this.element.parent(".grade-grid-cell").offset();e.top+=80,this.messageScope=this.scope.$new(!1,this.scope),this.messageScope.adjustPosition=t=>{const s=e.left+t.width(),n=e.top+t.height(),i=this.gradeGridRebornController.getGradeGridContainerElementRight();n>this.gradeGridRebornController.getGradeGridContainerElementBottom()&&(e.top-=t.height()+80),s>i&&(e.left-=s-i+Object(c.a)()),this.messageElement.offset(e)},this.$compile(b.CELL_MESSAGE_TEMPLATE)(this.messageScope,(e=>{this.messageElement=e,this.element.parents("bb-grade-grid-reborn").append(this.messageElement)}))}}get isValidated(){return this._isValidated}set isValidated(e){this._isValidated=e,this.isValidated?this.removeErrorMessage():this.createErrorMessage(),this.scope.gradeGridColumnReborn.isReadyToPost=this.score&&this.isValidated}stopPropagation(e){e.preventDefault(),e.stopPropagation()}mousedown(){e(this.window).trigger("click")}onChange(){this.checkValue(this.score).then((e=>{this.isValidated=e}))}onInputBlur(e){this.scope.gradeGridColumnReborn.isPastDueZero&&""===this.score&&(this.score=this.scope.gradeGridColumnReborn.score),this.scope.gradeGridColumnReborn.onInputBlur(e,this.isValidated,this.score)}checkValue(e){const t=this.gradeGridRebornController.getGridData().getSchema()[this.scope.col.data.gradingSchemaId],s=this.gradeService.createGradeSubmission(this.scope.col.data,e,t);return this.gradeService.validateGrade(s,this.scope)}onKeydown(t){d.y(t)?(this.scope.gradeGridColumnReborn.gotoNextCell(),e(t.target).blur(),this.mousedown(),t.preventDefault(),t.stopPropagation()):t.keyCode===d.g?(e(t.target).blur(),this.mousedown(),this.scope.$emit(p.b.LEAVE_CELL)):d.x(t)&&(!this.score||t.keyCode!==d.j&&t.keyCode!==d.s?this.mousedown():t.stopPropagation())}}b.$inject=["$compile","$window","scope","element","attrs","gradeGridRebornController",o.k,u.b],b.CELL_MESSAGE_TEMPLATE='<div bb-grade-grid-message-reborn class="grade-grid-reborn-message" ng-mousedown="gradeGridMessageReborn.mousedown()"></div>';class g{constructor(e){this.$injector=e,this.restrict="A",this.template=m,this.require=`^${r.a}`,this.link=(e,t,s,n)=>{e.gradeGridCellEditorReborn=this.$injector.instantiate(b,{scope:e,element:t,attrs:s,gradeGridRebornController:n})}}}g.$inject=["$injector"],n.module(h,[a.a]).directive("bbGradeGridCellEditorReborn",["$injector",e=>e.instantiate(g)])}).call(this,s("71td"))},ifgA:function(e,t){e.exports='<div class="tests test-attempt assessment-attempt" ng-class="{\'late-attempt\': assessmentAttempt.isOverdue }"\n     bb-timed-test-indicator="assessmentAttempt.timedTestAttemptDetail">\n  <bb-assessment-attempt-view-manager\n    is-one-question-at-a-time="::assessmentAttempt.isOneQuestionAtATime"\n    is-prevent-backtracking="::assessmentAttempt.isPreventBacktracking"\n    attempt-id="::assessmentAttempt.attemptId"\n    course-id="::assessmentAttempt.course.id"\n    on-after-initialize-question-attempt-view="::assessmentAttempt.onAfterInitializeQuestionAttemptView"\n    on-after-async-view-action="::assessmentAttempt.onAfterAsyncViewAction"\n    on-before-question-attempts-initialized="::assessmentAttempt.onBeforeQuestionAttemptsInitialized"\n    on-after-question-attempts-initialized="::assessmentAttempt.onAfterQuestionAttemptsInitialized"\n  ></bb-assessment-attempt-view-manager>\n  <div class="panel-wrap panel-wrap-flex has-bb-panel-header assessment-attempt-panel" ng-class="{\'over-close-button-small\': assessmentAttempt.hideOverview, \'has-footer\': !assessmentAttempt.hideOverview}">\n    <header class="black-panel-header">\n      <div class="black-header-contents">\n        <button class="left-off-canvas-toggle menu-toggle standard-button dark-background" type="button" analytics-id="course.content.assessment.left.canvas.toggle.button">\n          <bb-svg-icon size="small" icon="main-menu"></bb-svg-icon>\n          <span class="sr-only" bb-translate>course.content.assessment.attempt.menu</span>\n        </button>\n        <h1 class="panel-title" bb-translate="{{::assessmentAttempt.headerKey}}" translate-values="{\'title\': assessmentAttempt.customCategory}"></h1>\n        <button bb-peek-sref="conversations({courseId: assessmentAttempt.content.courseId, contentId: assessmentAttempt.content.id})"\n                bb-translate-attrs="{\'aria-label\':\'components.directives.header.openAria\'}"\n                class="open-conversation standard-button dark-background" ng-show="assessmentAttempt.showConversations()"\n                analytics-id="course.content.assessment.conversation.button" ng-click="assessmentAttempt.canFilterOrNavigate($event)">\n          <bb-svg-icon size="small" icon="conversation" ng-class="{\'has-indicator\': assessmentAttempt.hasClassIndicator}"></bb-svg-icon>\n        </button>\n        <button class="standard-button dark-background" id="details-info-button" type="button" tabindex="0"\n                bb-translate-attrs="{\'aria-label\': \'course.content.assessment.overview.detailsAriaLabel\'}"\n                bb-peek-sref="assessment-details({courseId: assessmentAttempt.content.courseId, contentId: assessmentAttempt.content.id, submitToGRD: assessmentAttempt.submitToGRD})"\n                analytics-id="course.content.assessment.details.button" ng-click="assessmentAttempt.canFilterOrNavigate($event)">\n          <bb-svg-icon size="small" icon="information"></bb-svg-icon>\n        </button>\n      </div>\n    </header>\n    <header class="row panel-header show-for-small-only" ng-show="assessmentAttempt.hideOverview">\n      <div class="goal-small-panel">\n        <button class="button super-clear icon" ng-click="assessmentAttempt.hideGoals()" analytics-id="course.content.assessment.goals.button">\n          <bb-svg-icon size="small" icon="arrow-left"></bb-svg-icon>\n          <span class="sr-only" bb-translate>course.goal-alignment.goal.sr-only.closeGoals</span>\n        </button>\n        <div class="goal-head">\n          <span class="goal-title" bb-translate>course.goal-alignment.goal.header</span>\n        </div>\n      </div>\n    </header>\n    <section class="panel-content has-slide-up-section" ng-class="{\'section-slide\': assessmentAttempt.hideOverview}">\n      \x3c!-- do not hide header on small - it is needed --\x3e\n      <bb-panel-header\n        show-course="true"\n        show-conversations="assessmentAttempt.showConversations()"\n        ng-class="{\'has-indicator\': assessmentAttempt.hasClassIndicator}"\n        content="assessmentAttempt.content"\n        panel-title="assessmentAttempt.content.title"\n        can-edit="false"\n        on-navigate-to-conversation="assessmentAttempt.canFilterOrNavigate()">\n      </bb-panel-header>\n      <div ng-if="::assessmentAttempt.contentData.gradingColumn.anonymousGrading" class="assessment-attempt__anonymous-grading-info" bb-translate>course.content.assessment.overview.anonymousGrading</div>\n      <div class="panel-content-flex panel-content-inner assessment-overview-panel">\n        <div class="panel-content-full panel-content-separator">\n          <div class="assessment-progress-header"\n               ng-if="::assessmentAttempt.showProgressHeader">\n            <div class="assessment-progress-header-first-row" ng-if="::assessmentAttempt.hasAnswerableQuestions">\n              <bb-assessment-progress-bar\n                description-id="assessment-question-counts-description"\n                answerable-question-count="assessmentAttempt.questionAttemptView.answerableQuestionCount"\n                unanswered-question-count="assessmentAttempt.questionAttemptView.unansweredQuestionCount"\n              ></bb-assessment-progress-bar>\n            </div>\n            <div\n              class="assessment-progress-header-second-row"\n              ng-class="{\'has-time-limit\': assessmentAttempt.shouldShowTimedTestIndicator}"\n            >\n              <div ng-if="::assessmentAttempt.shouldShowTimedTestIndicator">\n                <span bb-timed-test-indicator-label></span>\n              </div>\n              <div ng-if="::assessmentAttempt.hasAnswerableQuestions">\n                <bb-assessment-question-counts\n                  description-id="assessment-question-counts-description"\n                  answerable-question-count="assessmentAttempt.questionAttemptView.answerableQuestionCount"\n                  unanswered-question-count="assessmentAttempt.questionAttemptView.unansweredQuestionCount"\n                ></bb-assessment-question-counts>\n              </div>\n            </div>\n            <div ng-if="assessmentAttempt.hasFilterApplied"\n                 class="assessment-progress-header-third-row">\n              <bb-assessment-applied-filters\n                filter="assessmentAttempt.questionAttemptView.filter"\n                on-filter-available="assessmentAttempt.canFilterOrNavigate"\n                on-filter-changed="assessmentAttempt.onFilterChanged"\n                question-types="assessmentAttempt.questionAttemptView.questionTypes"\n              ></bb-assessment-applied-filters>\n            </div>\n          </div>\n          <bb-attempt-canvas attempt="assessmentAttempt.attempt"\n                             canvas-type="assessmentAttempt.AssessmentCanvasMode.AttemptAuthoring"\n                             question-attempt-view="assessmentAttempt.questionAttemptView"\n                             gradebook-category="assessmentAttempt.contentData.gradingColumn.gradebookCategory"\n                             on-navigation-available="assessmentAttempt.canFilterOrNavigate()"\n                             ng-if="assessmentAttempt"></bb-attempt-canvas>\n          <div class="spinner bb-secondary-color-2"\n               ng-if="assessmentAttempt.questionAttemptView.isWaitingForQueuedNavigationOrFiltering()"\n               role="status">\n            <span class="sr-only" bb-translate>course.content.assessment.attempt.loadingQuestions</span>\n          </div>\n        </div>\n        <div class="panel-content-info assessment-summary">\n          <div class="row collapse">\n            <div class="small-10 columns">\n              <h2 bb-translate>course.content.assessment.overview.detailsHeader</h2>\n            </div>\n          </div>\n          <ul class="row assessment-features">\n            <li>\n              <bb-ui-icon-medium-calendar ng-class="{\'alert\': assessmentAttempt.shouldShowMarkedLateNotice}"></bb-ui-icon-medium-calendar>\n              <div class="js-date-box"\n                   ng-switch="assessmentAttempt.dueDate != null">\n                <span class="settings-label" bb-translate>course.content.assessment.overview.dueDate</span>\n                <span class="settings-link" ng-switch-when="true">\n                  <span class="settings-due-date-label" ng-if="assessmentAttempt.shouldShowMarkedLateNotice">\n                    <span bb-translate>course.content.assessment.overview.pastDue</span>\n                  </span>\n                  <bb-datetime class="js-due-date"\n                               value="::assessmentAttempt.assessmentDueDate"\n                               format="Short"\n                               timezone-format="Short"\n                  >\n                  </bb-datetime>\n                </span>\n                <ul class="due-date-options" ng-switch-when="true">\n                  <li ng-if="::assessmentAttempt.shouldShowMarkedLateNotice">\n                    <span class="late-attempts-description" bb-translate>course.content.assessment.attempt.pastDueDescription</span>\n                  </li>\n                  <li ng-if="::assessmentAttempt.isDueDateEnforced">\n                    <span bb-translate="course.content.assessment.overview.enforceDueDate"></span>\n                  </li>\n                  <li ng-if="::assessmentAttempt.isLateAttemptCreationDisallowed">\n                    <span bb-translate="course.content.assessment.overview.lateAttemptCreationDisallowed"></span>\n                  </li>\n                </ul>\n                <span class="settings-link" ng-switch-default bb-translate>course.content.assessment.overview.noDueDate</span>\n              </div>\n            </li>\n\n            \x3c!--Time Limit --\x3e\n            <li ng-if="assessmentAttempt.hasTimeLimit" class="js-time-limit-type">\n              <bb-ui-icon-medium-no-time-limit ng-if="::assessmentAttempt.willDueDateOverrideTimeLimit" class="assessment-attempt-item__icon time-limit-overridden grayed-out"></bb-ui-icon-medium-no-time-limit>\n              <bb-ui-icon-medium-time-limit ng-if="::(!assessmentAttempt.willDueDateOverrideTimeLimit)" class="assessment-attempt-item__icon"></bb-ui-icon-medium-time-limit>\n              <div>\n                <span ng-class="::{\'time-limit-overridden grayed-out\' : assessmentAttempt.willDueDateOverrideTimeLimit }"\n                      class="settings-label"\n                      bb-translate>course.content.assessment.test.settings.timeLimit.label</span>\n                <span class="settings-link">\n                  <span ng-class="::{\'time-limit-overridden grayed-out line-through\' : assessmentAttempt.willDueDateOverrideTimeLimit }"\n                        class="js-time-limit-info"\n                        ng-bind-html="assessmentAttempt.displayedTimeLimit * 60 | timeSpan: \'m\': this"></span>\n                  <span class="time-limit-description"\n                        ng-if="!assessmentAttempt.canContinue"\n                        bb-translate>course.content.assessment.test.settings.timeLimit.autoSubmission</span>\n                </span>\n              </div>\n            </li>\n\n            \x3c!--Rubric--\x3e\n            <li class="js-rubric-view" ng-if="assessmentAttempt.rubricViewIsVisible">\n              <bb-svg-icon size="medium" icon="rubric"></bb-svg-icon>\n              <div class="tool-text">\n                <span class="settings-label" bb-translate>course.content.assessment.overview.rubric</span>\n                <span class="settings-link">\n                  <button class="button button--text" ng-click="assessmentAttempt.openRubricView()" bb-translate analytics-id="course.content.assessment.overview.gradedWithRubric">course.content.assessment.overview.gradedWithRubric</button>\n                </span>\n              </div>\n            </li>\n\n            \x3c!--Goals--\x3e\n            <li class="goal-alignment-li" ng-if="assessmentAttempt.alignedGoalsCount">\n              <bb-svg-icon size="medium" icon="goal"></bb-svg-icon>\n              <div class="goal-text">\n                <span class="settings-label" bb-translate>course.goal-alignment.goal.header</span>\n                <span class="settings-link">\n                  <a class="show-for-large-up" role="button" tabindex="0" bb-peek-sref="content-goal-alignment-for-student" bb-translate\n                     translate-values="{number: assessmentAttempt.alignedGoalsCount}" analytics-id="course.goal-alignment.goal.alignedGoals.plural">\n                    course.goal-alignment.goal.alignedGoals.plural\n                  </a>\n                  <a href="javascript:void(0);" class="hide-for-large-up" role="button" ng-click="assessmentAttempt.showGoals()" bb-translate\n                     translate-values="{number: assessmentAttempt.alignedGoalsCount}" analytics-id="course.goal-alignment.goal.alignedGoals.plural">\n                    course.goal-alignment.goal.alignedGoals.plural\n                  </a>\n                </span>\n              </div>\n            </li>\n\n            \x3c!--Attempt Count--\x3e\n            <li>\n              <bb-svg-icon size="medium" icon="attempts"></bb-svg-icon>\n              <div ng-if="assessmentAttempt.showAttemptDescription()">\n                <span class="settings-label" bb-translate>course.content.assessment.overview.attempts</span>\n                <span class="settings-link">\n                  <span ng-class="{\'vertical-bar\' : assessmentAttempt.showAttemptsSubmittedDescription() }"\n                        bb-translate translate-values="{count: assessmentAttempt.unsubmittedAttemptsLeft}">\n                    {{::assessmentAttempt.attemptsRemainingDescriptionKey}}\n                  </span>\n                  <span ng-if="::assessmentAttempt.showAttemptsSubmittedDescription()">\n                    <span bb-translate translate-values="{submitted: assessmentAttempt.attemptCountSubmitted, late: assessmentAttempt.attemptCountSubmittedLate}">\n                      {{::assessmentAttempt.attemptsSubmittedDescriptionKey}}\n                    </span>\n                  </span>\n                </span>\n              </div>\n            </li>\n\n            \x3c!--Group--\x3e\n            <li ng-if="assessmentAttempt.content.isGroupContent">\n              <bb-svg-icon size="medium" icon="groups"></bb-svg-icon>\n              <div>\n                <span class="settings-label" bb-translate="{{::assessmentAttempt.groupAssessmentKey}}" translate-values="{title: assessmentAttempt.customCategory}"></span>\n                <span class="settings-link ellipsis" title="{{assessmentAttempt.content.assignedGroups[0].groupTitle}}">{{assessmentAttempt.content.assignedGroups[0].groupTitle}}</span>\n              </div>\n            </li>\n\n            \x3c!--Safe Assign--\x3e\n            <li ng-if="assessmentAttempt.originalityReportService.isOriginalityReportEnabled() &&\n                       assessmentAttempt.originalityReportService.isSafeAssignActiveOriginalityProvider()">\n              <bb-ui-icon-medium-safe-assign class="assessment-attempt-item__icon"></bb-ui-icon-medium-safe-assign>\n              <div class="tool-text">\n                <span class="settings-label" bb-translate>course.content.originalityReport.settings.label</span>\n                <span class="settings-link">\n                  \x3c!-- htmlhint:analytics-id:disable --\x3e\n                  <a href="javascript:void(0);"\n                    class="js-setting-safeAssign"\n                    ng-click="assessmentAttempt.openSafeAssignView()"\n                    role="button"\n                    tabindex="0"\n                    analytics-id="course.content.assessment.test.settings.safeAssign.enabled">\n                      {{assessmentAttempt.originalityReportService.getOriginalityReportLinkText(false)}}\n                  </a>\n                  \x3c!-- htmlhint:analytics-id:enable --\x3e\n                </span>\n              </div>\n            </li>\n\n            \x3c!--Originality Integration--\x3e\n            <li ng-if="assessmentAttempt.originalityReportService.isOriginalityReportEnabled() &&\n                       assessmentAttempt.originalityReportService.isIntegrationActiveOriginalityProvider()">\n              <bb-ui-icon-medium-safe-assign class="assessment-attempt-item__icon"></bb-ui-icon-medium-safe-assign>\n              <div class="tool-text">\n                <span class="settings-label" bb-translate>course.content.originalityReport.settings.label</span>\n                <span class="js-setting-originality-integration settings-link">\n                  {{assessmentAttempt.originalityReportService.getOriginalityReportLinkText(false)}}\n                </span>\n              </div>\n            </li>\n\n            \x3c!--Proctoring--\x3e\n            <li class="proctoring-summary" ng-if="::assessmentAttempt.content.isSecureBrowserRequiredToTake()">\n              <bb-svg-icon size="medium" icon="privacy-policy"></bb-svg-icon>\n              <div class="proctoring-peek-container">\n                <span class="settings-label" bb-translate>components.services.proctoring.overview.label</span>\n                <span class="settings-link">\n                  <span bb-translate>{{assessmentAttempt.getProctoringBrowserText()}}</span>\n                </span>\n              </div>\n            </li>\n\n            \x3c!--Peer review--\x3e\n            <li ng-if="assessmentAttempt.isPeerGradingConfigured">\n              <bb-svg-icon icon="peer-review" size="medium"></bb-svg-icon>\n              <div class="peer-review-container">\n                <span bb-translate class="settings-label">course.content.assessment.test.settings.peerGrading.summary.label</span>\n                <span class="settings-link">\n                  <span bb-translate\n                        translate-values="{numOfPeersToReview: assessmentAttempt.numOfPeerReviewsToComplete, datetime: assessmentAttempt.peerReviewDueDate}">\n                    course.content.assessment.test.settings.peerGrading.summary.formattedDate\n                  </span>\n                </span>\n              </div>\n            </li>\n          </ul>\n          <div class="row">\n            <span class="settings-label" bb-translate>course.content.assessment.overview.gradingHeader</span>\n            <div class="no-submission-card">\n              <bb-ui-content-icon class="no-submission-icon" icon="assessmentAttempt.iconClass" color="primary"></bb-ui-content-icon>\n              <div class="no-submission-text">\n                <span class="no-submission-label" bb-translate>course.content.assessment.overview.highestPossible</span>\n              </div>\n              <div class="no-submission-value" bb-translate translate-values="{point: assessmentAttempt.highestPossibleScore}">course.content.assessment.overview.maxPoint.plural</div>\n            </div>\n          </div>\n          \x3c!--Assigned Peer Reviews--\x3e\n          <bb-assigned-peer-grading ng-if="assessmentAttempt.isPeerGradingConfigured"\n                                    submission-due-date="::assessmentAttempt.dueDate"\n                                    peer-review-due-date="::assessmentAttempt.peerReviewDueDate"\n                                    peer-reviews-per-student="::assessmentAttempt.numOfPeerReviewsToComplete"\n                                    allow-late-peer-reviews="::assessmentAttempt.allowLatePeerReviews"\n                                    has-due-date-accommodation="::assessmentAttempt.hasDueDateAccommodation"\n                                    is-submission-complete="assessmentAttempt.isAssessmentSubmissionComplete"\n                                    is-submission-late="assessmentAttempt.isSubmissionLate"\n                                    content="assessmentAttempt.content">\n          </bb-assigned-peer-grading>\n\n          <div class="row" ng-if="assessmentAttempt.content.description">\n            <span class="settings-label" bb-translate>course.content.assessment.overview.descriptionHeader</span>\n            <span>\n              {{assessmentAttempt.content.description}}\n            </span>\n          </div>\n          \x3c!--Additional Notes --\x3e\n          <div class="proctoring-additional-notes" ng-if="::assessmentAttempt.content.isSecureBrowserRequiredToTake()">\n            <span class="settings-label" bb-translate>components.services.proctoring.delivery.attempt.additionalNotes.label</span>\n            <span class="desc-content" bb-translate>components.services.proctoring.delivery.attempt.additionalNotes.description</span>\n          </div>\n\n          <div class="row group-assignment-members" ng-if="assessmentAttempt.content.isGroupContent">\n            <h2 class="peek-title-h2">\n              <bb-translate translate-values="{number: assessmentAttempt.contentData.groupMembers.length}">course.content.assessment.test.group.assignmentGroupMembers.plural</bb-translate>\n              <div class="group-buttons">\n                <button ng-show="assessmentAttempt.shouldShowCollabLink" ng-click="assessmentAttempt.launchCollabSession()"\n                        bb-translate-attrs="{\'aria-label\':\'course.content.conversation.collaborate\', \'title\': \'course.content.conversation.collaborate\'}"\n                        class="button super-clear icon" analytics-id="course.content.conversation.collaborate.button">\n                  <bb-svg-icon size="medium" icon="collab-session"></bb-svg-icon>\n                </button>\n                <button ng-if="assessmentAttempt.showConversations()"\n                        bb-peek-sref="conversations({courseId: assessmentAttempt.content.courseId, contentId: assessmentAttempt.content.id, groupId: assessmentAttempt.groupId})"\n                        bb-translate-attrs="{\'aria-label\':\'components.directives.header.openAriaGroup\', \'title\': \'components.directives.header.openAriaGroup\'}"\n                        class="button super-clear icon" analytics-id="components.directives.header.openAriaGroup.button">\n                  <bb-svg-icon\n                    ng-class="{\'has-indicator\': assessmentAttempt.hasGroupIndicator}"\n                    size="medium"\n                    icon="group-conversation">\n                  </bb-svg-icon>\n                </button>\n              </div>\n            </h2>\n\n            <div class="member-container">\n              <div class="member" ng-repeat="member in assessmentAttempt.contentData.groupMembers track by member.id">\n                <bb-usercard usercard-show="avatar"\n                             user="member" course-id="{{assessmentAttempt.course.id}}"\n                             course-role="assessmentAttempt.getCourseRole(member)"\n                             can-send-message="assessmentAttempt.canSendMessage(member)"\n                             inactive="assessmentAttempt.isInactive(member)">\n                </bb-usercard>\n                <bb-username class="member-name" user="member" format="short" tabindex="-10" has-title-attr="false" show-pronouns="true" show-pronunciation="true"></bb-username>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="goals-panel slide-small-container slide-animation hide-for-large-up" ng-class="{slideUp: assessmentAttempt.hideOverview}">\n        <bb-goal-alignment contents="assessmentAttempt.goalAlignedContents"\n                           hide-goals="assessmentAttempt.hideGoals()"\n                           class="content-assessment-goal-peek"\n                           ng-show="assessmentAttempt.hideOverview"\n                           analytics-id="course.content.assessment.goalAlignedContents.goalAlignment">\n        </bb-goal-alignment>\n      </div>\n    </section>\n  </div>\n  <footer class="submit-footer panel-footer">\n    <div class="submit-footer-inner-container">\n      <div class="autosave-footer-left" ng-class="{\'last-saved-visible\': assessmentAttempt.lastSaved, \'navigation-visible\': assessmentAttempt.isNavAndFilterFooterVisible() }">\n        <div class="last-saved-status-message" ng-if="assessmentAttempt.lastSaved || assessmentAttempt.errorMessage">\n          <div role="status" aria-live="polite" class="last-saved-notice js-last-saved" ng-if="assessmentAttempt.lastSaved && !assessmentAttempt.errorMessage">\n            <span bb-translate>course.content.assessment.footer.lastSaved</span>\n            <span bb-time="{{assessmentAttempt.lastSaved}}" auto-update="true" format="Medium"></span>\n          </div>\n          <div class="error-message-notice js-error-message" ng-if="assessmentAttempt.errorMessage">\n            <bb-ui-icon-small-alert-error></bb-ui-icon-small-alert-error>\n            <span class="error-message-text">\n              <strong role="status" aria-live="assertive">{{assessmentAttempt.errorMessage}}</strong>\n              <span ng-if="assessmentAttempt.lastSaved"> |\n                <span bb-translate>course.content.assessment.footer.lastSaved</span>\n                <span bb-time="{{assessmentAttempt.lastSaved}}" auto-update="true" format="Medium"></span>\n              </span>\n            </span>\n          </div>\n        </div>\n        <bb-assessment-controls-container\n          show-navigation="::assessmentAttempt.showPageNavigation"\n          show-filter="assessmentAttempt.questionAttemptView.isFilterable()"\n          filter="assessmentAttempt.questionAttemptView.filter"\n          can-navigate-forward="assessmentAttempt.questionAttemptView.canNavigateForward"\n          can-navigate-backward="assessmentAttempt.questionAttemptView.canNavigateBackward"\n          on-filter-available="assessmentAttempt.canFilterOrNavigate"\n          is-backtracking-prohibited="assessmentAttempt.isBacktrackingProhibited"\n          questions-matching-filter-count="assessmentAttempt.questionAttemptView.questionsMatchingFilterCount"\n          question-types="assessmentAttempt.questionAttemptView.questionTypes"\n          on-filter-changed="assessmentAttempt.onFilterChanged"\n          on-navigation-changed="assessmentAttempt.onNavigationChanged"\n        ></bb-assessment-controls-container>\n      </div>\n      <div class="autosave-footer-right">\n        <div class="save-submit-buttons">\n          <div class="equal-buttons buttons-2">\n            <button\n              ng-click="assessmentAttempt.save($event)"\n              ng-class="{disabled: assessmentAttempt.shouldDisableSaveSubmitButtons()}"\n              ng-disabled="assessmentAttempt.shouldDisableSaveSubmitButtons()"\n              ng-attr-tabindex="{{assessmentAttempt.shouldDisableSaveSubmitButtons() ? -1 : undefined}}"\n              class="button button--secondary js-save-draft-button assessment-save-draft-button"\n              analytics-id="course.content.assessment.footer.buttons.saveAndClose"\n              bb-translate>course.content.assessment.footer.buttons.saveAndClose</button>\n            <button\n              ng-click="assessmentAttempt.submit($event)"\n              ng-class="{disabled: assessmentAttempt.shouldDisableSaveSubmitButtons()}"\n              ng-attr-tabindex="{{assessmentAttempt.shouldDisableSaveSubmitButtons() ? -1 : undefined}}"\n              ng-disabled="assessmentAttempt.shouldDisableSaveSubmitButtons()"\n              class="button js-send-draft-button assessment-send-draft-button"\n              analytics-id="{{!assessmentAttempt.isOverdue ? \'course.content.assessment.footer.buttons.submit\' : \'course.content.assessment.footer.buttons.submitLate\'}}">\n              <bb-translate ng-if="!assessmentAttempt.isOverdue">course.content.assessment.footer.buttons.submit</bb-translate>\n              <bb-translate ng-if="assessmentAttempt.isOverdue">course.content.assessment.footer.buttons.submitLate</bb-translate>\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  </footer>\n  <connection-lost-dialog\n    analytics-id="course.content.assessment.unsavedChanges"\n    on-dismiss="assessmentAttempt.connectionLostDialog.onDismiss"\n    is-visible="assessmentAttempt.connectionLostDialog.isVisible"\n  >\n  </connection-lost-dialog>\n</div>\n'},ihlU:function(e,t,s){"use strict";var n=s("D57K"),i=s("Llzl"),o=s("IbyE"),a=s("e0uO"),r=s("e6qG"),c=s("jWRJ"),l=s("Xq/A"),d=s("YHe3"),u=s("jbaE"),p=s("pjml"),m=s("lEL+"),h=s("e6jQ"),b=s("0JpG"),g=s("JNtI"),v=s("g66W"),f=s("QJ+g"),w=s("hG4E"),S=s("cH8o"),C=s("ERsv"),y=s("aHpC"),O=s("Y/dt"),A=s("bd9L");const I="ultra.components.directives.freeformResponseEditor";let D=class{constructor(e,t,s,n,i,o,a,r,c,l){this.$compile=e,this.element=t,this.$q=s,this.$rootScope=n,this.attrs=i,this.scope=o,this._bbMLEditorService=a,this.bbLocalize=r,this.timeout=c,this.proctoringService=l,this.isEditing=!1,this.isSaving=!1,this.isInitializing=!0,this.isRTELoaded=!1,this.isRetryPending=!1,this.isNewAttachmentSaving=!1,this.isDisabled=!1,this.textEditorPlaceholderKey="",this.onChange=e=>{this.toBbML=e},this.onNewAttachmentSaving=()=>{this.isNewAttachmentSaving=!0},this.insertDocumentEditorTemplate=e=>{this.element.find(".freeform-response-editor-template").prepend(this.$compile(this.template)(this.scope))},this.bbmlEditorId="BBML_Editor_ID_"+h.b(),this.toBbML=Object(C.generateToBbML)((()=>{var e;return"function"==typeof this.scope.bbml?this.scope.bbml().rawText:null!==(e=this.scope.bbml.rawText)&&void 0!==e?e:""})),o.textEditorPlaceholderKey=o.textEditorPlaceholderKey||"",this.template=o.isPrivileged()?w:S,this.insertDocumentEditorTemplate(t),this.overflowMenuItems=this.getOverflowMenuItems(),o.isPrivileged&&o.isPrivileged()&&this.setUpForPrivilegedUser(),o.$on(O.f,(()=>{this.isRetryPending&&this.scope.$broadcast(A.a)})),this.pluginOptions=this.proctoringService.getSecureBbEditorOptions({attachment:!0,image:!0,math:!0,video:!0,contentMarket:!0}),this.initializeAndSetUpBbMLWatchers()}initializeAndSetUpBbMLWatchers(){this.scope.$watch("bbml()",(e=>{null==e||this.bbML&&!this.scope.isPrivileged()||(this.isRTELoaded&&!this.isNewAttachmentSaving||(this.rawText=e.rawText,this.isRTELoaded=!0,this.isNewAttachmentSaving=!1),this.bbML=e)})),this.scope.$watch("bbmlEditor.rawText",(()=>{this.isInitializing||this.isSaving?this.isInitializing=!1:this.bbML.rawText=this.rawText}))}get truncatedViewValue(){return this._truncatedViewValue}set truncatedViewValue(e){const t=this.element.find(".bb-editor"),s=t.length?t.text():void 0;this._truncatedViewValue=v.f(s,100)}onBlur(){this.isEditing=!1}focusEditor(){this.isEditing=!0,this.timeout((()=>{this.element.find(".bb-editor").first().focus()}),this.scope,0)}activateEditor(){this.scope.editorForm.responseEditor.$setPristine(),this.focusEditor()}getOverflowMenuItems(){const e=[];e.push({labelKey:"global.edit",icon:"draw",show:()=>this.showEditButton(),onClick:()=>this.activateEditor(),ariaLabel:()=>this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.textEditor.overflowMenu.aria.edit",params:{truncatedText:this.truncatedViewValue},noWrap:!0})});const t={labelKey:"global.delete",icon:"trash",show:()=>this.showDeleteButton(),onClick:()=>this.onDelete(),ariaLabel:()=>this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.textEditor.overflowMenu.aria.delete",params:{truncatedText:this.truncatedViewValue},noWrap:!0})};return e.push(t),t.confirmationOptions={},t.confirmationOptions.lazyLoadTitleKeyAndInstructionsKey=()=>this.$q.when(g.a("content")),this.scope.choices&&(t.confirmationOptions.choices=this.scope.choices()),e}showOverflowMenu(){return!this.isEditing&&(!!this.showEditButton()||!!this.showDeleteButton())&&this.hasContent()}setUpForPrivilegedUser(){this.scope.$on(p.d.EVENT_BBML_EDITOR_FORCE_UPDATE,(()=>{this.save()})),this.scope.$watch("bbmlEditor.hasContent()",(e=>{this.scope.hasContent=e}))}matchesBbMLEditorId(e){return this.bbmlEditorId&&this.bbmlEditorId===e}save(e=!1){return!e&&this.isSaving||!this.scope.saveFunc?this.$q.resolve():(this.isNewAttachmentSaving&&(this.isDisabled=!0),this.isSaving=!0,this.$q.when(this.toBbML(!0)).then((e=>(this.bbML.rawText=e,this.scope.saveFunc()))).then((()=>{this.isRetryPending=!1,this.isSaving=!1,this.isDisabled=!1}),(e=>{throw this.isRetryPending=!0,this.isSaving=!1,this.isDisabled=!1,e})))}isValid(){return!0}hasContent(){var e,t;return(null===(t=null===(e=this.bbML)||void 0===e?void 0:e.rawText)||void 0===t?void 0:t.length)>0}onDelete(){this.rawText=""}showEditButton(){return this.scope.isPrivileged()}showDeleteButton(){return this.scope.isPrivileged()}};D=Object(n.__decorate)([Object(n.__param)(0,Object(y.b)("$compile")),Object(n.__param)(1,Object(y.b)("element")),Object(n.__param)(2,Object(y.b)("$q")),Object(n.__param)(3,Object(y.b)("$rootScope")),Object(n.__param)(4,Object(y.b)("attrs")),Object(n.__param)(5,Object(y.b)("scope")),Object(n.__param)(6,Object(y.b)(l.c)),Object(n.__param)(7,Object(y.b)(b.serviceName)),Object(n.__param)(8,Object(y.b)(m.b)),Object(n.__param)(9,Object(y.b)(d.b))],D);class k{constructor(e){this.$injector=e,this.restrict="E",this.template=f,this.scope={bbml:"&",hasContent:"=?",isPrivileged:"&",saveFunc:"&?",autoSaveContextArea:"@?",textEditorPlaceholderKey:"<?",expandInlineFilesOnLoad:"<?",supportsInlineDocumentRender:"<?"},this.link=(e,t,s)=>{e.bbmlEditor=this.$injector.instantiate(D,{scope:e,element:t,attrs:s})}}}k.$inject=["$injector"],i.module(I,["ngSanitize",A.g,l.b,d.a,u.a,m.a]).directive("bbFreeformResponseEditor",["$injector",e=>e.instantiate(k)]);var _=s("TnpK"),j=s("gkef"),T=s("fYJU"),$=s("Qbdf"),R=s("X455"),E=s("36CG"),x=s("Y+9S"),P=s("jhBu"),L=s("ZQFV"),G=s("5MwF"),M=s("Q/M7"),N=s("Fvsw"),F=s("DDBr"),B=s("n0bV"),q=s("yC9S"),z=s("oVrE"),U=s("9hUw"),V=s("R4kC"),H=s("jx5I"),Q=s("D57O");const K="ultra.course.assessment.feedback.peer.singleOwner";let W=class{constructor(e,t,s,n,i,o,a,r,c,l,d,u){this.$scope=e,this.$ngRedux=t,this.context=s,this.contextCourse=n,this.contextUser=i,this.entitlementService=o,this.localize=a,this.peerReviewService=r,this.submissionListService=c,this.ultraStateService=l,this.delegatedAttemptAdapter=d,this.fileUploadSettingsService=u,this.isLoading=!0}$onInit(){this.feedbackListPayload={configProps:this.getFeedbackConfigProps(),secondaryGradersFeedback:[],analyticsId:"course.assessment.attempt.peerFeedbackByStudent"},this.peerReviewService.getOrCreatePeerContentFromColumn(this.column).then((e=>{this.peerReviewContentObject=e})),this.delegatedAttemptAdapter.loadDelegatedGradesByGrader({courseId:this.column.courseId,columnId:this.column.id,userId:this.attempt.userId}).then((e=>{this.peerReviewsGiven=e,this.buildPayload(),this.isLoading=!1}))}get column(){return this.ultraStateService.getCurrentResolvedValues().currentColumn}get course(){return this.contextCourse.course}buildPayload(){this.peerReviewsGiven.forEach(((e,t)=>{const{attemptId:s,stagedAttemptId:n,grader:i,feedbackToUser:o,attemptLastGradedDate:a,hasGraderFeedback:r,userBeingGraded:c}=e;r&&this.feedbackListPayload.secondaryGradersFeedback.push({id:n,attemptId:s,grader:Object(z.a)(i),userBeingGraded:Object(z.a)(c),showAnonymousWhenNoUserData:!0,rawTextFeedback:null==o?void 0:o.rawText,attemptLastGradedDate:a,late:this.isFeedbackLate(a,i),isFeedbackFromCurrentStudent:!0,listIndex:t+1})}))}getFeedbackConfigProps(){const{xsrfToken:e}=this.context,t=this.buildSecondaryFeedbackConfigProps();return{isOrganization:this.contextCourse.course.isOrganization,isPeerGrading:!0,currentUserHasEnterFeedbackEntitlement:this.hasEnterFeedbackEntitlement,secondaryFeedbackConfigProps:t,editorConfigProps:{xsrfToken:e,courseId:this.contextCourse.courseId,apiBasePath:M.c(G.a.apiBasePath),locale:this.localize.getLocale(this.$scope),fileUploadSettings:this.fileUploadSettingsService.getSettings()}}}get hasEnterFeedbackEntitlement(){return this.entitlementService.isEntitled(L.GradebookEntitlement.EnterFeedback,this.course.id)}buildSecondaryFeedbackConfigProps(){if(this.hasEnterFeedbackEntitlement)return;return{title:this.localize.translateSync({locale:this.localize.getLocale(this.$scope),key:"course.content.assessment.attempt.feedback.peerReview.self"})}}isFeedbackLate(e,t){var s;if(!e||!this.hasEnterFeedbackEntitlement)return!1;return!this.submissionListService.submissionList.rows.find((e=>e.membership.userId===t.id)).hasDueDateException&&(null===(s=this.peerReviewContentObject)||void 0===s?void 0:s.isAfterPeerReviewDueDate(e))}};W=Object(n.__decorate)([Object(q.a)({moduleName:K,componentName:"bbPeerFeedbackByStudent",bindings:{attempt:"<"},template:Q,requireModules:[N.a,$.b,T.a,P.a,F.a,b.moduleName,U.a,V.a,_.b,B.a,H.a]}),Object(n.__param)(0,Object(y.b)("$scope")),Object(n.__param)(1,Object(y.b)("$ngRedux")),Object(n.__param)(2,Object(y.b)(N.b)),Object(n.__param)(3,Object(y.b)($.e)),Object(n.__param)(4,Object(y.b)(T.b)),Object(n.__param)(5,Object(y.b)(P.b)),Object(n.__param)(6,Object(y.b)(b.serviceName)),Object(n.__param)(7,Object(y.b)(U.b)),Object(n.__param)(8,Object(y.b)(V.b)),Object(n.__param)(9,Object(y.b)(_.d)),Object(n.__param)(10,Object(y.b)(B.b)),Object(n.__param)(11,Object(y.b)(H.b))],W);var J=s("IaSh"),Y=s("ohO4"),Z=s("1ZbL");const X="ultra.components.directives.assessment-page-counts",ee={Class:J.AssessmentPageCounts,bindingNames:["currentPage","totalPages"],renderLocalized:!0};i.module(X,[]).component("bbAssessmentPageCounts",Object(Z.a)(ee));var te=s("AuQm"),se=s("Y3OE"),ne=s("0V7O"),ie=s("HF29"),oe=s("FVIt");s.d(t,"a",(function(){return ae}));const ae="ultra.components.directives.assessment.attemptCanvas",re="components.directives.attempt-canvas.freeform-response.author.placeholder";var ce;!function(e){e.AssignmentContent="assignmentContent",e.SubmissionContent="submissionContent",e.PeerReviews="peerReviews"}(ce||(ce={}));let le=class{constructor(e,t,s,n,i,a,r,c,l,d,u,p,m){var h,b,g;this.scope=e,this.element=t,this.$q=s,this.$ngRedux=n,this.ultraState=i,this.windowSizeService=a,this.contextUser=r,this.contextContent=c,this.contextCourse=l,this.currentCourseMembership=d,this.entitlementService=u,this.featureFlagService=p,this.timeout=m,this.customCategory="",this.assessmentId="",this.attemptCanvasRegion=ce,this.accordionRegions={[ce.AssignmentContent]:!0,[ce.SubmissionContent]:!0,[ce.PeerReviews]:!0};const{currentContent:v}=this.ultraState.getCurrentResolvedValues();if(this.displayStudentSubmission=(null===(b=null===(h=null==v?void 0:v.getDeployedAssessment())||void 0===h?void 0:h.deploymentSettings)||void 0===b?void 0:b.allowStudentSubmission)||!1,this.canModifyGradebook&&!this.isCurrentCourseComplete){const e=c.content;e&&e.contentDetail&&(this.assessmentId=e.contentDetail[se.a.TestLink.toString()].test.assessment.id,this.$ngRedux.dispatch(o.actions.content.loadContents({courseId:e.courseId,contentId:i.params.contentId})))}if(this.isSmallBreakpoint=a.isSmallBreakpoint(),this.scope.$on("window-resize",(()=>{this.isSmallBreakpoint=a.isSmallBreakpoint()})),e.gradebookCategory()&&!e.gradebookCategory().isUserDefined?this.headerKey="components.directives.attempt-canvas.header."+e.gradebookCategory().title:(this.customCategory=e.gradebookCategory()&&e.gradebookCategory().title,this.headerKey="components.directives.attempt-canvas.header.custom"),this.scope.attempt&&!this.scope.attempt.studentSubmission&&this.displayStudentSubmission&&(this.scope.attempt.studentSubmission={}),this.scope.gradedQuestionAttempts&&this.scope.$watch("gradedQuestionAttempts()",(e=>{this.gradedQuestionAttempts=e})),null===(g=this.toolAttemptDetail)||void 0===g?void 0:g.questionAttempts){const e={};this.toolAttemptDetail.questionAttempts.forEach((t=>{const s=t.questionType.toString();s in e||(e[s]=0),null==t.question.ui&&(t.question.ui={}),t.question.ui.questionTypePosition=e[s],e[s]+=1}))}!this.currentCourseMembership.isStudentMembership()&&this.hasOnlyPresentationQuestions()&&(this.accordionRegions[ce.AssignmentContent]=!1)}get showPageCountHeader(){var e,t;return(null===(e=this.questionAttemptView)||void 0===e?void 0:e.totalPageCount)>0&&(null===(t=this.questionAttemptView)||void 0===t?void 0:t.currentPageCount)>0}get totalPagesCount(){var e;return null===(e=this.questionAttemptView)||void 0===e?void 0:e.totalPageCount}get currentPageCount(){var e;return null===(e=this.questionAttemptView)||void 0===e?void 0:e.currentPageCount}get isPeerReviewer(){var e,t;return null===(t=(e=this.scope).peerReviewer)||void 0===t?void 0:t.call(e)}get isCurrentCourseComplete(){return this.contextCourse.course.isComplete()}get questionAttemptView(){return this.scope.questionAttemptView}get toolAttemptDetail(){var e;const t=(null===(e=this.column)||void 0===e?void 0:e.scoreProviderHandle.toString())||o.ScoreProviderHandle.Test.toString();if(!this._toolAttemptDetail&&this.scope.attempt){const e=this.scope.attempt;e.attempts&&e.attempts.length>0?this._toolAttemptDetail=e.attempts[0].toolAttemptDetail[t]:this._toolAttemptDetail=e.getToolAttemptDetailItem(o.ScoreProviderHandle.parse(t))}return this._toolAttemptDetail}get column(){const{currentColumn:e}=this.ultraState.getCurrentResolvedValues();return e}get content(){const{currentContent:e}=this.ultraState.getCurrentResolvedValues();return e}get canShowPeerFeedbackByStudent(){var e;const{currentContent:t}=this.ultraState.getCurrentResolvedValues();if(!(null===(e=this.column)||void 0===e?void 0:e.peerGrading)||(null==t?void 0:t.isGroupContent))return!1;if(this.canEnterGrades)return!0;const s=this.scope.attempt;return this.contextUser.userId===s.userId}get autoSaveContextArea(){return te.AutoSaveContextArea.Assessments}get canModifyGradebook(){return this.entitlementService.isEntitled(L.GradebookEntitlement.ModifyGradebook)}get canEnterGrades(){return this.entitlementService.isEntitled(L.GradebookEntitlement.EnterItemGrades)}textEditorOptions(){return{placeholderKey:re}}fileEditorOptions(){return{showViewButton:()=>this.scope.canvasType().isEqualTo(this.GradingMode())||this.scope.canvasType().isEqualTo(this.ReviewMode())}}isAccordionRegionActive(e){return this.accordionRegions[e]}toggleAccordionRegions(e){this.accordionRegions[e]=!this.accordionRegions[e]}studentSubmission(){return this.scope.attempt.studentSubmission}navigateNext(){var e,t;!1!==(null===(t=(e=this.scope).onNavigationAvailable)||void 0===t?void 0:t.call(e))&&(this.scope.$broadcast(O.f),this.questionAttemptView.navigateNext())}save(){if(this.scope.attempt.$pk){const e=this.scope.attempt.toolAttemptDetail;return e&&e["resource/x-bb-assessment"]&&e["resource/x-bb-assessment"].questionAttempts&&e["resource/x-bb-assessment"].questionAttempts.forEach((e=>{e.question&&e.question.alignedGoals&&(e.question.alignedGoals=[])})),this.scope.attempt.$patch().$asPromise()}return this.$q.resolve(this.scope.attempt)}getFreeformResponseBundleKey(e="header"){if(!this.hasQuestions())return"";let t;switch(this.scope.canvasType()){case a.a.AttemptAuthoring:t="author";break;case a.a.AttemptGrading:t="grade";break;case a.a.AttemptReview:t="review"}return`components.directives.attempt-canvas.freeform-response.${t}.${e}.${this.hasOnlyPresentationQuestions()?"submission":"additional-content"}`}hasQuestions(){var e,t;return!!(null===(t=null===(e=this.toolAttemptDetail)||void 0===e?void 0:e.assessment)||void 0===t?void 0:t.questionCount)}hasOnlyPresentationQuestions(){var e;return!!(null===(e=this.toolAttemptDetail)||void 0===e?void 0:e.assessment)&&!this.toolAttemptDetail.assessment.hasAnswerableQuestions}get showQuestionFilterMessage(){var e,t;return!(!(null===(e=this.questionAttemptView)||void 0===e?void 0:e.isFilterable())||0!==(null===(t=this.questionAttemptView)||void 0===t?void 0:t.questionsMatchingFilterCount))}persist(){return this.scope.$broadcast(p.d.EVENT_BBML_EDITOR_FORCE_UPDATE),this.$q.when(this.scope.attempt)}get isBacktrackingProhibited(){var e,t,s,n,i;return null!==(i=null===(n=null===(s=null===(t=null===(e=this.content)||void 0===e?void 0:e.getDeployedAssessment)||void 0===t?void 0:t.call(e))||void 0===s?void 0:s.deploymentSettings)||void 0===n?void 0:n.isBacktrackingProhibited)&&void 0!==i&&i}get isContinueVisible(){var e,t,s;return null!==(s=(null===(e=this.questionAttemptView)||void 0===e?void 0:e.isPageable())&&!(null===(t=this.questionAttemptView)||void 0===t?void 0:t.isLastPage()))&&void 0!==s&&s}get isFilterToUnansweredVisible(){var e,t,s,n,i;return null!==(i=this.featureFlagService.isFeatureEnabled(J.filterFeatureFlag)&&(null===(e=this.questionAttemptView)||void 0===e?void 0:e.isPageable())&&(null===(t=this.questionAttemptView)||void 0===t?void 0:t.isLastPage())&&(null===(s=this.questionAttemptView)||void 0===s?void 0:s.unansweredQuestionCount)>0&&!(null===(n=this.questionAttemptView)||void 0===n?void 0:n.hasUnansweredFilterApplied())&&!this.isBacktrackingProhibited)&&void 0!==i&&i}filterToUnanswered(){var e,t,s;!1!==(null===(t=(e=this.scope).onNavigationAvailable)||void 0===t?void 0:t.call(e))&&(null===(s=this.questionAttemptView)||void 0===s||s.onFilterChanged({status:J.QuestionStatusFilter.Unanswered},!0))}GradingMode(){return a.a.AttemptGrading}ReviewMode(){return a.a.AttemptReview}AttemptMode(){return a.a.AttemptAuthoring}getFreeformPlaceholderBundleKey(){return re}displayFreeformResponse(){var e,t,s;return!!this.displayStudentSubmission&&(!(null===(e=this.questionAttemptView)||void 0===e?void 0:e.hasFilterApplied())&&(!(null===(t=this.questionAttemptView)||void 0===t?void 0:t.isPageable())||!!(null===(s=this.questionAttemptView)||void 0===s?void 0:s.isLastPage())))}};le=Object(n.__decorate)([Object(n.__param)(0,Object(y.b)("scope")),Object(n.__param)(1,Object(y.b)("element")),Object(n.__param)(2,Object(y.b)("$q")),Object(n.__param)(3,Object(y.b)("$ngRedux")),Object(n.__param)(4,Object(y.b)(_.d)),Object(n.__param)(5,Object(y.b)(j.b)),Object(n.__param)(6,Object(y.b)(T.b)),Object(n.__param)(7,Object(y.b)(E.g)),Object(n.__param)(8,Object(y.b)($.e)),Object(n.__param)(9,Object(y.b)(R.d)),Object(n.__param)(10,Object(y.b)(P.b)),Object(n.__param)(11,Object(y.b)(Y.b)),Object(n.__param)(12,Object(y.b)(m.b))],le);class de{constructor(e,t,s){this.$compile=e,this.$injector=t,this.timeout=s,this.restrict="E",this.scope={attempt:"=",canvasType:"&",gradebookCategory:"&",gradedQuestionAttempts:"&",isAnyQuestionEditing:"=",onNavigationAvailable:"&?",peerReviewer:"&?",questionAttemptView:"<?"},this.link=(e,t,s)=>{const n=this.getTemplate(e),i=this.$compile(n)(e);t.append(i),e.attemptCanvas=this.$injector.instantiate(le,{scope:e,element:t,attrs:s}),Object(x.isInMobileApp)()&&this.timeout((()=>{e.$digest()}),e,0)}}getTemplate(e){switch(e.canvasType()){case a.a.AttemptAuthoring:return ne;case a.a.AttemptGrading:return ie;case a.a.AttemptReview:return oe;default:throw new Error("Invalid canvas type provided")}}}de.$inject=["$compile","$injector",m.b],i.module(ae,[X,c.a,p.N,I,r.a,_.b,j.a,E.d,$.b,K,Y.a]).directive("bbAttemptCanvas",["$injector",e=>e.instantiate(de)])},iq5i:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("0ZnS");const o="ultra.components.directives.bbUiIcon.medium.SafeAssign";Object(n.a)(i.a,o,"bbUiIconMediumSafeAssign")},j3m2:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-chat",use:"icon-small-chat-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-chat"><path d="M15 8c0 3.866-3.134 7-7 7a6.983 6.983 0 01-2.528-.4704L1 15l.5-4.3969C1.1775 9.7984 1 8.9199 1 8c0-3.866 3.134-7 7-7s7 3.134 7 7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},jO50:function(e,t){e.exports='<div\n  class="slider-tab-navigation-desktop"\n  ng-style="{\'min-height\': sliderTabNavigation.desktopViewHeight}"\n>\n  <div\n    class="slider-tab-navigation-desktop__main-section slider-tab-navigation-desktop__main-section-scrollable"\n    ng-style="{\'max-height\': sliderTabNavigation.mainSectionHeight}">\n    <div ng-transclude></div>\n  </div>\n\n  <div\n    class="slider-tab-navigation-desktop__browsable-section"\n    id="slider-tab-browsable-section"\n    role="region"\n    aria-labelledby="slider-tab-browsable-section-toggle-button slider-tab-browsable-section-tabIcon-button"\n    ng-class="{\n      \'slider-tab-navigation-desktop__browsable-section--expanded\': sliderTabNavigation.isSliderTabExpanded,\n      \'slider-tab-navigation-desktop__browsable-section--collapsed\': !sliderTabNavigation.isSliderTabExpanded\n    }"\n  >\n    <div ng-if="sliderTabNavigation.shouldRenderTabs()">\n      <div bb-first-time-container>\n        <div class="guidance-wrapper">\n          <div bb-guidance-target component-key="components.directives.slider-tab-navigation.ftue.browsable-tabs">\n            <ul\n              class="slider-tab-navigation-desktop__browsable-tabs"\n              bb-arrow-key-navigation="{ tabDirection: \'vertical\', layout: \'rows\'}"\n            >\n              <li\n                class="slider-tab-navigation-desktop__tab-container"\n                ng-repeat="tab in sliderTabNavigation.scope.tabs.browsableSection.browsableTabs"\n                bb-arrow-key-container\n              >\n                <button\n                  id="{{\'slider-tab-\' + tab.nameId}}"\n                  class="slider-tab-navigation-desktop__tab"\n                  ng-class="{\n                    \'slider-tab-navigation-desktop__tab--collapsed\': !sliderTabNavigation.isSliderTabExpanded\n                  }"\n                  ng-click="sliderTabNavigation.goToTab(tab)"\n                  analytics-id="{{::tab.analyticsIdPrefix}}.li"\n                  bb-arrow-key-destination\n                  ng-keydown="sliderTabNavigation.handleTabKeyDown($event, tab)"\n                  bb-focus="tab.nameId === sliderTabNavigation.nextTabFocusNameId"\n                  aria-expanded="false"\n                  bb-translate-attrs="{\n                    \'aria-label\': !sliderTabNavigation.isSliderTabExpanded ? \'components.directives.slider-tab-navigation.ax-only.\' + tab.nameId : null\n                  }"\n                >\n                  <div class="slider-tab-navigation-desktop__tab-details"\n                    ng-class="{\n                      \'slider-tab-navigation-desktop__tab-details--collapsed\': !sliderTabNavigation.isSliderTabExpanded\n                    }"\n                  >\n                    <bb-slider-tab-item-icon icon-name="tab.iconName"></bb-slider-tab-item-icon>\n\n                    <div\n                      class="slider-tab-navigation-desktop__browsable-section-title"\n                      ng-class="{\n                        \'slider-tab-navigation-desktop__browsable-section-title--hidden\': !sliderTabNavigation.isSliderTabExpanded || sliderTabNavigation.isTransitioning\n                      }"\n                    >\n                      {{tab.title}}\n                    </div>\n                  </div>\n\n                  <i\n                    class="icon-chevron-right slider-tab-navigation-desktop__tab-navigation-icon"\n                    ng-class="{\n                      \'slider-tab-navigation-desktop__tab-navigation-icon--hidden\': !sliderTabNavigation.isSliderTabExpanded || sliderTabNavigation.isTransitioning\n                    }"\n                    role="presentation"\n                  >\n                  </i>\n                </button>\n              </li>\n            </ul>\n          </div>\n\n          <bb-guidance\n            class="guidance-element-overlay slider-tab-navigation-desktop__browsable-section-guidance"\n            component-key="components.directives.slider-tab-navigation.ftue.browsable-tabs"\n          >\n            <div ng-if="!sliderTabNavigation.isStudent">\n              <div class="slider-tab-navigation-desktop__browsable-section-guidance-title" bb-translate>\n                components.directives.slider-tab-navigation.ftue.instructor-title\n              </div>\n              <span class="slider-tab-navigation-desktop__browsable-section-guidance-message" bb-translate>\n                components.directives.slider-tab-navigation.ftue.instructor-message\n              </span>\n            </div>\n\n            <div ng-if="sliderTabNavigation.isStudent">\n              <div class="slider-tab-navigation-desktop__browsable-section-guidance-title" bb-translate>\n                components.directives.slider-tab-navigation.ftue.student-title\n              </div>\n              <span class="slider-tab-navigation-desktop__browsable-section-guidance-message" bb-translate>\n                components.directives.slider-tab-navigation.ftue.student-message\n              </span>\n            </div>\n          </bb-guidance>\n        </div>\n      </div>\n    </div>\n\n    <div class="slider-tab-navigation-desktop__browsable-main-section" ng-if="sliderTabNavigation.activeTab" ng-class="{\'-loading\': sliderTabNavigation.showLoader}">\n      <div\n        class="slider-tab-navigation-desktop__browsable-section-header"\n        ng-class="{\n          \'slider-tab-navigation-desktop__browsable-section-header--collapsed\': !sliderTabNavigation.isSliderTabExpanded\n        }"\n      >\n        <button\n          analytics-id="{{::sliderTabNavigation.activeTab.analyticsIdPrefix}}.activeTab.goBack.button"\n          ng-click="sliderTabNavigation.goBack()"\n          ng-if="sliderTabNavigation.activeTab.nameId !== sliderTabNavigation.scope.tabs.browsableSection.main.nameId"\n          class="slider-tab-navigation-desktop__browsable-section-go-back"\n          ng-class="{\n            \'slider-tab-navigation-desktop__browsable-section-go-back--hidden\': !sliderTabNavigation.isSliderTabExpanded\n          }"\n          ng-keydown="sliderTabNavigation.handleBackArrowKeyDown($event)"\n          bb-translate-attrs="{\'aria-label\': \'components.directives.slider-tab-navigation.ax-only.back-arrow\'}"\n          aria-expanded="true"\n        >\n          <bb-svg-icon\n            size="medium" icon="back-arrow"\n            class="slider-tab-navigation-desktop__browsable-section-go-back-arrow-icon"\n            ng-class="{\n              \'slider-tab-navigation-desktop__browsable-section-go-back-arrow-icon--hidden\': !sliderTabNavigation.isSliderTabExpanded || sliderTabNavigation.isTransitioning\n            }"\n          >\n          </bb-svg-icon>\n        </button>\n\n        <div\n          class="slider-tab-navigation-desktop__browsable-section-details"\n          ng-class="{\n            \'slider-tab-navigation-desktop__browsable-section-details--is-active\': sliderTabNavigation.activeTab.nameId !== sliderTabNavigation.scope.tabs.browsableSection.main.nameId,\n            \'slider-tab-navigation-desktop__browsable-section-details--collapsed\': !sliderTabNavigation.isSliderTabExpanded\n          }"\n        >\n          <button\n            analytics-id="{{::sliderTabNavigation.activeTab.analyticsIdPrefix}}.collapsed.button"\n            class="slider-tab-navigation-desktop__browsable-section-collapsed-button"\n            ng-class="{\n              \'slider-tab-navigation-desktop__browsable-section-collapsed-button--active\': !sliderTabNavigation.isSliderTabExpanded\n            }"\n            aria-controls="slider-tab-browsable-section"\n            aria-expanded="{{sliderTabNavigation.isSliderTabExpanded}}"\n            id="slider-tab-browsable-section-tabIcon-button"\n            ng-click="sliderTabNavigation.toggleVisibility()"\n            bb-translate-attrs="{\'aria-label\': \'components.directives.slider-tab-navigation.ax-only.\' + sliderTabNavigation.activeTab.nameId}"\n          >\n            <bb-slider-tab-item-icon icon-name="sliderTabNavigation.activeTab.iconName"></bb-slider-tab-item-icon>\n          </button>\n\n          <bb-slider-tab-item-icon\n            icon-name="sliderTabNavigation.activeTab.iconName"\n            class="slider-tab-navigation-desktop__browsable-section-icon"\n            ng-class="{\n              \'slider-tab-navigation-desktop__browsable-section-icon--active\': sliderTabNavigation.isSliderTabExpanded\n            }"\n          >\n          </bb-slider-tab-item-icon>\n\n          <h2\n            ng-if="sliderTabNavigation.activeTab.nameId === sliderTabNavigation.scope.tabs.browsableSection.main.nameId"\n            tabindex="-1"\n            class="slider-tab-navigation-desktop__browsable-section-title slider-tab-navigation-desktop__browsable-section-title_is-header"\n            ng-class="{\n              \'slider-tab-navigation-desktop__browsable-section-title--hidden\': !sliderTabNavigation.isSliderTabExpanded || sliderTabNavigation.isTransitioning\n            }"\n          >\n            {{sliderTabNavigation.activeTab.title}}\n          </h2>\n\n          <h1\n            ng-if="sliderTabNavigation.activeTab.nameId !== sliderTabNavigation.scope.tabs.browsableSection.main.nameId"\n            bb-focus\n            tabindex="-1"\n            class="slider-tab-navigation-desktop__browsable-section-title slider-tab-navigation-desktop__browsable-section-title_is-header"\n            ng-class="{\n              \'slider-tab-navigation-desktop__browsable-section-title--hidden\': !sliderTabNavigation.isSliderTabExpanded || sliderTabNavigation.isTransitioning\n            }"\n          >\n            {{sliderTabNavigation.activeTab.title}}\n          </h1>\n        </div>\n      </div>\n\n      <div ng-if="!sliderTabNavigation.showLoader" class="slider-tab-navigation-desktop__browsable-section-content">\n        <div ui-view="{{sliderTabNavigation.viewName}}"\n          ng-if="!sliderTabNavigation.shouldHideView"\n          class="slider-tab-navigation-desktop__view"\n          ng-class="{\n            \'slider-tab-navigation-desktop__view--hidden\': !sliderTabNavigation.isSliderTabExpanded || sliderTabNavigation.isTransitioning\n          }"\n        >\n        </div>\n      </div>\n      <div ng-if="sliderTabNavigation.showLoader" class="spinner bb-secondary-color-2"></div>\n    </div>\n    <div\n      class="slider-tab-navigation-desktop__collapsible-menu"\n      ng-class="{\n        \'slider-tab-navigation-desktop__collapsible-menu--collapsed\': !sliderTabNavigation.isSliderTabExpanded\n      }"\n    >\n      <div bb-first-time-container>\n        <div class="guidance-wrapper">\n          <button\n            bb-tooltip\n            enhanced-tooltip="true"\n            tooltip-class-names="slider-tab-navigation-desktop__collapsible-button-tooltip"\n            tooltip-position="left-center"\n            tooltip-left-adjust-percent="-5"\n            tooltip-top-adjust-percent="50"\n            tooltip-disable-on-medium-down-breakpoint="true"\n            title="{{sliderTabNavigation.getTooltipText()}}"\n            tooltip-hide-on-activation="true"\n            tooltip-disable-on-focus="true"\n            bb-guidance-target\n            component-key="components.directives.slider-tab-navigation.ftue.collapsible-button"\n            class="slider-tab-navigation-desktop__collapsible-button"\n            analytics-id="sliderTab.toggleVisibility.button"\n            aria-controls="slider-tab-browsable-section"\n            aria-expanded="{{sliderTabNavigation.isSliderTabExpanded}}"\n            id="slider-tab-browsable-section-toggle-button"\n            ng-class="{\n              \'slider-tab-navigation-desktop__collapsible-button--collapsed\': !sliderTabNavigation.isSliderTabExpanded\n            }"\n            ng-click="sliderTabNavigation.toggleVisibility()"\n          >\n            <span\n              class="slider-tab-navigation-desktop__collapsible-arrow"\n              ng-class="{\'slider-tab-navigation-desktop__collapsible-arrow--collapsed\': !sliderTabNavigation.isSliderTabExpanded}"\n            >\n              <bb-svg-icon class="slider-tab-navigation-desktop__collapsible-arrow-icon" size="small" icon="arrow-left"></bb-svg-icon>\n            </span>\n          </button>\n          <div\n            ng-if="sliderTabNavigation.activeTab.nameId !== sliderTabNavigation.scope.tabs.browsableSection.main.nameId && sliderTabNavigation.isSliderTabExpanded"\n            tabindex="0"\n            ng-focus="sliderTabNavigation.handleLastElementFocus()"\n          >\n          </div>\n\n          <bb-guidance\n            class="guidance-element-overlay slider-tab-navigation-desktop__collapsible-section-guidance"\n            ng-if="sliderTabNavigation.tabsHasBeenSet"\n            component-key="components.directives.slider-tab-navigation.ftue.collapsible-button"\n          >\n            <div class="slider-tab-navigation-desktop__collapsible-section-guidance-content">\n              <div class="slider-tab-navigation-desktop__collapsible-section-guidance-header">\n                <span class="slider-tab-navigation-desktop__collapsible-section-guidance-title" bb-translate>\n                  components.directives.slider-tab-navigation.ftue.collapsible-panel-title\n                </span>\n                <button\n                  analytics-id="sliderTab.collapseAndExpand.ftue.close.button"\n                  aria-controls="slider-tab-navigation-desktop__collapsible-section-guidance"\n                  class="slider-tab-navigation-desktop__collapsible-section-guidance-close"\n                  tabindex="-1"\n                >\n                  <bb-svg-icon size="small" icon="close"></bb-svg-icon>\n                </button>\n              </div>\n              <span class="slider-tab-navigation-desktop__collapsible-section-guidance-message" bb-translate>\n                components.directives.slider-tab-navigation.ftue.collapsible-panel-message\n              </span>\n              <button\n                analytics-id="sliderTab.collapseAndExpand.ftue.button"\n                aria-controls="slider-tab-navigation-desktop__collapsible-section-guidance"\n                class="slider-tab-navigation-desktop__collapsible-section-guidance-button"\n                tabindex="-1"\n                bb-translate\n              >\n                components.directives.slider-tab-navigation.ftue.collapsible-panel-button\n              </button>\n            </div>\n          </bb-guidance>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},jSqS:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("Llzl"),i=s("0JpG"),o=s("1ZbL"),a=s("ZQFV");const r="ultra.components.directives.grade.filterChips",c={Class:a.ConnectedFilterChips,renderLocalized:!0,withProvider:!0,attributes:["analyticsId"]};n.module(r,[i.moduleName]).component("bbFilterChips",Object(o.a)(c))},jWRJ:function(e,t,s){"use strict";var n=s("D57K"),i=s("Llzl"),o=s("e6qG"),a=s("0JpG"),r=s("1ZbL"),c=s("K9sL");const l="ultra.components.directives.assessment.asessmentQuestion.automatedQuestionFeedback",d={Class:c.AutomatedQuestionFeedbackAttemptReview,bindingNames:["feedback","isCollapsible","editorPluginsOptions"],renderLocalized:!0};i.module(l,[a.moduleName]).component("bbAutomatedQuestionFeedback",Object(r.a)(d));var u=s("jbaE"),p=s("JNtI"),m=s("/qpZ"),h=(s("dY8P"),s("ZzYr")),b=s("o5Lu"),g=s("dd1C"),v=s("12mu"),f=s("nthy"),w=s("36CG"),S=s("fYJU"),C=s("kQ1d"),y=s("Y3OE");const O="ultra.components.directives.grade.pill",A={Class:s("ZQFV").QuestionGradePill,renderLocalized:!0,withProvider:!0,bindingNames:["grade","pointsPossible","isDisabled","save"]};i.module(O,[a.moduleName]).component("bbUiQuestionGradePill",Object(r.a)(A));const I="ultra.components.directives.grade.questionGrade";class D{constructor(e,t,s,n,i,o){this.scope=e,this.$modal=t,this._gradeService=s,this.bbLocalize=n,this.contextUser=i,this.contextContent=o,this.bbLocalize.loadBundle("components/directives/grade/question-grade"),e.questionGrade=this,this.gradebookSettings=this._gradeService.loadDefaultGradebookSettings(),this.isStudent=this.contextUser.userModel.isStudent(),this.isAutoPostGrades=this.contextContent.content.contentDetail[y.a.TestLink.toString()].test.gradingColumn.autoPostGrades,this.pointsPossible=this.scope.gradedQuestionAttempt.questionAttempt.question.points,!this.isStudent&&this.scope.hideGrade()||e.$watch("gradedQuestionAttempt",(()=>{this.afterModelChange()})),this.save=this.save.bind(this)}inputChanged(e){return(!Number.isNaN(Number(this.initValue))||null!=e)&&((null!=this.initValue||!Number.isNaN(Number(e)))&&this.initValue!==e)}isGradeModified(e){return null!==this.initValue&&!i.equals(this.initValue,e)}isDisabled(){return!this.scope.isPrivileged()||this.scope.gradedQuestionAttempt.questionAttempt.question.fullCredit}sanitizeToModel(e){return null==e||Number.isNaN(Number(e))?"":e}save(e){this.inputChanged(e)&&(this.scope.gradedQuestionAttempt.ui&&this.scope.gradedQuestionAttempt.ui.isPosted&&!this.isAutoPostGrades?this.$modal.open({template:f,scope:this.scope}).result.then((()=>{this.scope.gradedQuestionAttempt.manualPoints=this.sanitizeToModel(e),this.doSave(e)}),(()=>{})):(this.scope.gradedQuestionAttempt.manualPoints=this.sanitizeToModel(e),this.doSave(e)))}doSave(e){this.scope.gradedQuestionAttempt.withParams({groupAttemptId:this.scope.gradedQuestionAttempt.ui.groupAttemptId}).$patch().$then((()=>{this.scope.$emit("bb-update-question-grade",this.scope.gradedQuestionAttempt),this.isGradeModified(e)&&this.scope.$root.$broadcast("QUESTION-GRADE-PILL-EDITED",this.contextContent.content.contentDetail[y.a.TestLink.toString()].test.gradingColumn.id,e),this.afterModelChange()}))}afterModelChange(){this.scope.gradedQuestionAttempt&&(this.isAutoGraded=this.scope.gradedQuestionAttempt.questionAttempt.question.isAutoGraded,this.initValue=this.scope.gradedQuestionAttempt.points)}}D.$inject=["scope","$modal",b.k,a.serviceName,S.b,w.g];class k{constructor(e,t){this.$compile=e,this.$injector=t,this.restrict="E",this.scope={gradedQuestionAttempt:"=",hideGrade:"&",inputId:"@",isPrivileged:"&"},this.link=(e,t,s)=>{t.append(this.$compile(C)(e)),e.questionGrade=this.$injector.instantiate(D,{scope:e,element:t,attrs:s})}}}k.$inject=["$compile","$injector"],i.module(I,["puElasticInput",h.a,b.j,g.a,v.a,O]).directive("bbQuestionGrade",["$injector",e=>e.instantiate(k)]);s("2MQt"),s("uEsA"),s("LRgG"),s("SHbF");var _=s("IaSh"),j=s("3Uvi");const T="ultraUi.components.directives.grade.questionAnswerStatus";class ${constructor(e){this.scope=e}getCorrectnessIcon(){const e=this.scope.correctness&&this.scope.correctness();return this.scope.wasLate&&this.scope.wasLate()?"attention":_.QuestionAnswerResult.Correct===e||_.QuestionAnswerResult.FullCredit===e?"check-circle":_.QuestionAnswerResult.Partial===e?"partial-credit":"close-circle"}shouldShowText(){return!(this.scope.hideCorrectnessText&&this.scope.hideCorrectnessText())}getCorrectnessTextKey(){if(this.scope.correctness){const e=this.scope.correctness&&this.scope.correctness();return _.QuestionAnswerResult.Correct===e?"components.directives.assessment-question.status.correct":_.QuestionAnswerResult.Partial===e?"components.directives.assessment-question.status.partial":_.QuestionAnswerResult.FullCredit===e?"components.directives.assessment-question.status.full-credit":"components.directives.assessment-question.status.incorrect"}}getBackgroundClass(){const e=this.scope.correctness&&this.scope.correctness();return this.scope.wasLate&&this.scope.wasLate()?"question-answer-status--attention":_.QuestionAnswerResult.Correct===e||_.QuestionAnswerResult.FullCredit===e?"question-answer-status--correct":_.QuestionAnswerResult.Partial===e?"question-answer-status--partial":"question-answer-status--incorrect"}}$.$inject=["scope"];class R{constructor(e){this.$injector=e,this.restrict="E",this.template=j,this.transclude=!0,this.replace=!0,this.scope={hideCorrectnessText:"&?",wasLate:"&?",correctness:"&?",alignIconToTop:"&?"},this.link=e=>{e.questionAnswerStatus=this.$injector.instantiate($,{scope:e})}}}R.$inject=["$injector"],i.module(T,[]).directive("bbQuestionAnswerStatus",["$injector",e=>e.instantiate(R)]);var E=s("lEL+"),x=s("TnpK"),P=s("cs5G"),L=s("ERkP"),G=s("zGdY"),M=s("4vxQ"),N=s("Agfx");const F=Object(N.makeStyles)((e=>Object(N.createStyles)({root:{},questionText:{marginBottom:"10px"},questionAnswerInputRoot:{"& input":{marginBottom:0,border:"none"}}})));var B=s("SToD"),q=s("b2gR"),z=s.n(q),U=s("UJ5P"),V=s("GuFu");const H=Object(B.a)((e=>{const{question:t,givenAnswer:s,localize:n,onAnswerChange:i,questionNumber:o}=e,a=F(),r=n.translate("components.directives.assessment-question.placeholder.question",{questionIdentifier:o}),c=L.useCallback((e=>{i(e.target.value)}),[i]),l=Object(V.useFeatureFlag)("feature.course.content.inline-render");return L.createElement("div",{className:a.root},L.createElement("div",{className:a.questionText},L.createElement(z.a,{editMode:U.EditModeEnum.INACTIVE,question:t,disableFocus:!1,ariaLabelledBy:"",placeholderText:"",supportsInlineDocumentRender:l})),L.createElement(M.AnalyticsTextField,{placeholder:n.translate("components.directives.assessment-question.calculated-numeric.placeholder.attempt"),analyticsId:"components.directives.assessment-question.calculated-numeric.calculated-numeric-attempt.answer-input",value:s,onChange:c,InputProps:{classes:{root:a.questionAnswerInputRoot},inputProps:{"aria-label":r,className:"js-calculated-numeric-attempt-answer-input"}}}))})),Q=Object(N.makeStyles)((e=>Object(N.createStyles)({questionText:{marginBottom:"10px"}})));var K=e=>{const{question:t,givenAnswers:s,onAnswerChange:n}=e,i=Q(),o=Object(V.useFeatureFlag)("feature.course.content.inline-render");return L.createElement("div",null,L.createElement("div",{className:i.questionText},L.createElement(_.QuestionText,{editMode:_.EditModeEnum.INACTIVE,question:t,disableFocus:!1,ariaLabelledBy:"",placeholderText:"",supportsInlineDocumentRender:o})),L.createElement(_.HotspotCanvasAttempt,{question:t,givenAnswers:s,onAnswerChange:n}))};const W="ultra.components.directives.assessment.assessmentQuestion.questionAttempt",J={Class:e=>{const{question:t,givenAnswer:s,onAnswerChange:n,questionNumber:i}=e;if(void 0===s)return null;const o=(()=>{switch(t.questionType){case G.QuestionType.CalculatedNumeric:return L.createElement(H,{question:t,givenAnswer:s,onAnswerChange:n,questionNumber:i});case G.QuestionType.Hotspot:return L.createElement(K,{question:t,givenAnswers:s,onAnswerChange:n,questionNumber:i});default:return null}})();return o?L.createElement(_.AllyProvider,{allyService:e.allyService,contentId:e.contentId},o):null},bindingNames:["question","questionNumber","givenAnswer","allyService","contentId","onAnswerChange"],renderLocalized:!0,withProvider:!0};i.module(W,[a.moduleName]).component("bbQuestionAttempt",Object(r.a)(J));var Y=s("7O4Y"),Z=s("bJi+"),X=s.n(Z),ee=s("G52d");const te=Object(N.makeStyles)((e=>Object(N.createStyles)({questionText:{marginBottom:"16px"},givenAnswer:{marginBottom:"16px"},givenAnswerLabel:{fontWeight:e.typography.fontWeightBold},correctnessWrapper:{padding:"8px 10px",backgroundColor:t=>t.attempt.correct?e.palette.success.light:e.palette.error.light},correctnessText:{fontWeight:e.typography.fontWeightBold},correctAnswerNumericValue:{fontWeight:e.typography.fontWeightBold}}))),se=Object(B.a)((e=>{var t;const{currentLocale:s,localize:n,attempt:i,automatedFeedbackEditorPluginOptions:o,isAutomatedFeedbackCollapsible:a,babelfishFormatInstance:r}=e,l=te(e),d=Object(V.useFeatureFlag)("feature.course.content.inline-render"),u=L.createElement("span",{className:l.givenAnswerLabel},n.translate("components.directives.assessment-question.calculated-numeric.yourAnswer.prefix")),p=n.translate("components.directives.assessment-question.calculated-numeric.yourAnswer.full",{prefix:u,answer:i.givenAnswer}),m=Object(ee.getAnswerOrToleranceDisplayValue)(s,i.question.answerValue,r),h=Object(ee.getAnswerOrToleranceDisplayValue)(s,i.question.toleranceValue,r),b=i.correct?n.translate("components.directives.assessment-question.status.correct"):n.translate("components.directives.assessment-question.status.incorrect");let g;if(Object(ee.isToleranceSet)(i.question)){const e=L.createElement("span",{className:l.correctAnswerNumericValue},n.translate("components.directives.assessment-question.calculated-numeric.review.correctAnswerWithTolerance.answerWithTolerance",{answer:m,tolerance:h}));g=n.translate("components.directives.assessment-question.calculated-numeric.review.correctAnswerWithTolerance.full",{answerWithTolerance:e})}else{const e=L.createElement("span",{className:l.correctAnswerNumericValue},m);g=n.translate("components.directives.assessment-question.calculated-numeric.review.correctAnswerWithoutTolerance",{answer:e})}return L.createElement("div",null,L.createElement("div",{className:l.questionText},L.createElement(X.a,{editMode:U.EditModeEnum.INACTIVE,question:i.question,disableFocus:!1,ariaLabelledBy:"",placeholderText:"",supportsInlineDocumentRender:d})),L.createElement("div",{className:l.givenAnswer},p),i.isCorrectAnswersVisible&&L.createElement("div",{className:Object(Y.default)(l.correctnessWrapper,"js-calculated-numeric-attempt-review-correctness-wrapper")},L.createElement("div",{className:Object(Y.default)(l.correctnessText,"js-calculated-numeric-attempt-review-correctness-text")},b),L.createElement("div",{className:"js-calculated-numeric-attempt-review-correct-answer-text"},g)),i.automatedFeedback&&L.createElement(c.AutomatedQuestionFeedbackAttemptReview,{feedback:null===(t=i.automatedFeedback)||void 0===t?void 0:t.rawText,editorPluginsOptions:o,isCollapsible:a}))}));var ne=s("YK4x");const ie=Object(N.makeStyles)((e=>Object(N.createStyles)({questionText:{marginBottom:"16px"},optionsContainer:{paddingTop:"10px"},questionAnswerStatus:{marginTop:"12px",marginBottom:"2px"},explanatoryText:{marginTop:"16px",marginBottom:"6px"}})));var oe=s("tN4z");const ae=e=>{var t;const{attempt:s,isAutomatedFeedbackCollapsible:n,automatedFeedbackEditorPluginOptions:i,wasAnsweredLate:o,isAttemptGradingView:a,canShowCorrectAnswerRelatedDetail:r}=e,c=ie(e),l=Object(ne.a)(),d=Object(V.useFeatureFlag)("feature.course.content.inline-render");return L.createElement("div",null,L.createElement("div",{className:c.questionText},L.createElement(_.QuestionText,{editMode:_.EditModeEnum.INACTIVE,question:s.question,disableFocus:!1,ariaLabelledBy:"",placeholderText:"",supportsInlineDocumentRender:d})),L.createElement(_.HotspotCanvasAttemptReview,{question:s.question,givenAnswers:s.givenAnswers,isCorrectAnswersVisible:r}),a&&!s.question.displayShapesToStudents&&L.createElement(oe.AnalyticsTypography,{component:"label",variant:"body1",className:c.explanatoryText},l("components.directives.assessment-question.hotspot.explanatory-text.content")),L.createElement(_.QuestionAnswerStatus,{wasAnsweredLate:o,rootClassName:c.questionAnswerStatus}),r&&L.createElement("div",{className:c.optionsContainer},L.createElement(_.HotspotAnswerOptionsRead,{question:s.question,givenAnswers:s.givenAnswers})),s.automatedFeedback&&L.createElement(_.AutomatedQuestionFeedbackAttemptReview,{feedback:null===(t=s.automatedFeedback)||void 0===t?void 0:t.rawText,editorPluginsOptions:i,isCollapsible:n}))},re="ultra.components.directives.assessment.assessmentQuestion.questionAttemptReview",ce={Class:e=>{const{attempt:t,automatedFeedbackEditorPluginOptions:s,isAutomatedFeedbackCollapsible:n,wasAnsweredLate:i,isAttemptGradingView:o,canShowCorrectAnswerRelatedDetail:a}=e,r=(()=>{switch(t.question.questionType){case G.QuestionType.CalculatedNumeric:return L.createElement(se,{attempt:t,automatedFeedbackEditorPluginOptions:s,isAutomatedFeedbackCollapsible:n});case G.QuestionType.Hotspot:return L.createElement(ae,{attempt:t,automatedFeedbackEditorPluginOptions:s,canShowCorrectAnswerRelatedDetail:a,isAttemptGradingView:o,isAutomatedFeedbackCollapsible:n,wasAnsweredLate:i});default:return null}})();return r?L.createElement(_.AllyProvider,{allyService:e.allyService,contentId:e.contentId},r):null},bindingNames:["allyService","contentId","attempt","automatedFeedbackEditorPluginOptions","isAutomatedFeedbackCollapsible","isAttemptGradingView","wasAnsweredLate","answerResult","canShowCorrectAnswerRelatedDetail"],renderLocalized:!0,withProvider:!0};i.module(re,[a.moduleName]).component("bbQuestionAttemptReview",Object(r.a)(ce));var le=s("vhkR"),de=s("X8JP"),ue=s("6fZB"),pe=s("aHpC");s.d(t,"a",(function(){return me}));const me="ultra.components.directives.assessment.assessment-question";let he=class{constructor(e,t,s,n){this.QuestionFactory=e,this.BbLtiService=t,this.cloudStorageIntegrationModalService=s,this.$q=n,this.restrict="E",this.scope={attempt:"=?",question:"=?",questionAttempt:"=?",gradedQuestionAttempt:"=?",mode:"&",index:"&",assessmentId:"&?",contentId:"<",isAnyQuestionEditing:"&?",isSmallBreakpoint:"=?"},this.link=(e,t,s)=>{if(e.question&&(e.questionAttempt||e.gradedQuestionAttempt)||!e.question&&!e.questionAttempt&&!e.gradedQuestionAttempt||e.gradedQuestionAttempt&&e.questionAttempt)throw new Error("Please provide a question or question attempt/graded question attempt");this.setEditorPluginOptions(e),this.setAutomatedFeedbackEditorPluginOptions(e),this.setAssessmentAndCloudEditorPluginOptions(e,t,s)}}setEditorPluginOptions(e){e.editorPluginOptions={attachment:!0,math:!0}}setAutomatedFeedbackEditorPluginOptions(e){e.automatedFeedbackEditorPluginOptions={contentMarket:this.BbLtiService.getEditorPluginOptions(e),insertYoutubeVideo:this.BbLtiService.getYoutubeEditorPluginOptions()}}setAssessmentAndCloudEditorPluginOptions(e,t,s){this.$q.all([this.QuestionFactory.getQuestionHandler(e,t,s),this.cloudStorageIntegrationModalService.initialize()]).then((([t])=>{if(e.assessmentQuestion=t,this.cloudStorageIntegrationModalService.isCloudServiceAvailable){const t=this.cloudStorageIntegrationModalService.getModalCallback(e);e.automatedFeedbackEditorPluginOptions.insertCloudStorageIntegrationFile={openCloudStorageIntegrationModal:()=>Object(ue.a)(t())}}}))}};he=Object(n.__decorate)([Object(n.__param)(0,Object(pe.b)(o.b)),Object(n.__param)(1,Object(pe.b)(le.b)),Object(n.__param)(2,Object(pe.b)(de.b)),Object(n.__param)(3,Object(pe.b)("$q"))],he),i.module(me,[l,u.a,p.b,m.a,a.moduleName,p.b,I,T,o.a,E.a,x.b,le.a,de.a,P.a,W,re]).directive("bbAssessmentQuestion",["$q","$injector",(e,t)=>t.instantiate(he)])},jbaE:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return y}));var n=s("D57K"),i=(s("ph44"),s("vhkR")),o=s("cs5G"),a=s("Llzl"),r=s("Fvsw"),c=s("Qbdf"),l=s("0JpG"),d=s("X8JP"),u=s("9hVN"),p=s("TnpK"),m=s("ohO4"),h=s("jx5I"),b=s("5MwF"),g=s("ERsv"),v=s("Q/M7"),f=s("pjml"),w=s("Y+9S"),S=s("aHpC"),C=s("6PRJ");const y="ultraUi.components.directives.editor.richTextEditor";let O=class{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g){this.$q=e,this.$scope=t,this.element=s,this.attrs=n,this.controllers=i,this.bbEditorFactory=o,this.bbLocalize=a,this.bbContext=r,this.ltiService=c,this.CloudStorageIntegrationModalService=l,this.ContentCollectionService=d,this.AnnotationsModel=u,this.contextCourse=p,this.allyService=m,this.ultraState=h,this.featureFlagService=b,this.fileUploadSettingsService=g;const v=this.$scope.$watch("pluginOptions",(e=>{e&&(v(),this.initEditor())}));this.reactAllyService=this.allyService.getReactService(this.$scope),t.$on("$destroy",(()=>{t.editor&&t.editor.destroy()}))}initEditor(){let e=null,t=!1,s=null;const n=this.controllers.ngModel,i=n.$setPristine.bind(n);n.$viewChangeListeners.push((()=>{t||i()})),n.$setPristine=()=>{i(),s&&s(n.$modelValue)};const o=e=>{this.$scope.editor&&this.$scope.editor.update(e)};this.$scope.$watch((()=>n.$modelValue),(t=>{t!==e&&o({bbml:t})})),this.$scope.$watchGroup(["isDisabled","isReadOnly","isToolbarHidden","allyIndexMap"],(([e,t,s,n])=>{this.$scope.editor&&o({isDisabled:e,isReadOnly:t,isToolbarHidden:s,ally:{service:this.reactAllyService,indexMap:n}})}));const a=(e,t)=>void 0!==e?e:t,r=e=>{this.$scope.fileLocation=e.data?e.data.fileLocation:e.fileLocation,this.$scope.webLocation=e.data?e.data.webLocation:e.webLocation},c=i=>{var o,a;t=i.isDirty,s=i.setPristine;const r=i.toBbML();e!==r&&(e=r,null===(a=(o=this.$scope).onChange)||void 0===a||a.call(o,i.toBbML),n.$setViewValue(r))},l={placeholderText:this.bbLocalize.translate({locale:this.bbLocalize.getLocale(this.$scope),key:this.$scope.placeholder})};this.$scope.pluginOptions&&this.$scope.pluginOptions.attachment&&(l.cloudStorageIntegration=this.CloudStorageIntegrationModalService.initialize()),l.inlineRenderFfEnabled=this.featureFlagService.createWaiter("feature.course.content.inline-render"),this.$q.all(l).then((e=>{const t=[Object(g.customClass)()],{locale:s,babelfishInstance:i,babelfishFormatter:o,isRtl:l}=this.bbLocalize.getReactBabelfishParams(this.$scope);if(this.$scope.pluginOptions){!1!==this.$scope.pluginOptions.link&&t.push(Object(g.link)()),!1!==this.$scope.pluginOptions.image&&t.push(Object(g.image)()),!1!==this.$scope.pluginOptions.video&&t.push(Object(g.video)()),this.$scope.pluginOptions.math&&t.push(Object(g.math)({apiBasePath:Object(v.c)(b.a.apiBasePath),courseId:this.contextCourse.courseId,xsrfToken:this.bbContext.xsrfToken,locale:s})),this.$scope.pluginOptions.attachment&&t.push(Object(g.insertLocalFile)({apiBasePath:Object(v.c)(b.a.apiBasePath),xsrfToken:this.bbContext.xsrfToken,webLocation:this.$scope.webLocation||"",fileLocation:this.$scope.fileLocation||"",onUploadSuccess:r,buttonId:Object(w.isInMobileApp)()?"insertFile":"",supportsInlineDocumentRender:this.$scope.supportsInlineDocumentRender&&e.inlineRenderFfEnabled,fileUploadSettings:this.fileUploadSettingsService.getSettings(),onNewAttachmentSavePressed:this.$scope.onNewAttachmentSavePressed,courseId:this.contextCourse.courseId}));let n=!0;!1===this.$scope.pluginOptions.youtubeVideo&&(n=!1),n&&t.push(Object(g.insertYoutubeVideo)({apiBasePath:Object(v.c)(b.a.apiBasePath),getEmbedSrc:this.ltiService.configureAndInitInlineLaunch.bind(this.ltiService),xsrfToken:this.bbContext.xsrfToken,courseId:this.contextCourse.courseId})),this.$scope.pluginOptions.demoMashup&&t.push(Object(g.demoMashup)()),this.$scope.pluginOptions.attachment&&this.CloudStorageIntegrationModalService.isCloudServiceAvailable&&!Object(w.isInMobileApp)()&&t.push(Object(g.insertCloudStorageIntegrationFile)({openCloudStorageIntegrationModal:this.CloudStorageIntegrationModalService.getModalCallback(this.$scope),apiBasePath:Object(v.c)(b.a.apiBasePath),xsrfToken:this.bbContext.xsrfToken,webLocation:this.$scope.webLocation||"",fileLocation:this.$scope.fileLocation||"",fileUploadSettings:this.fileUploadSettingsService.getSettings(),onNewAttachmentSavePressed:this.$scope.onNewAttachmentSavePressed})),this.$scope.pluginOptions.contentCollection&&t.push(Object(g.contentCollection)({getOpenContentCollectionFunction:this.ContentCollectionService.getOpenContentCollectionFunction(this.$scope)})),this.$scope.pluginOptions.contentMarket&&t.push(Object(g.contentMarket)({apiBasePath:Object(v.c)(b.a.apiBasePath),getEmbedSrc:this.ltiService.configureAndInitInlineLaunch.bind(this.ltiService),noInsert:this.$scope.contentMarketIsReadOnly,openContentMarket:this.ltiService.getOpenContentMarketConf(this.$scope),xsrfToken:this.bbContext.xsrfToken}))}let d=this.$scope.rootContentId;!d&&this.ultraState&&this.ultraState.getCurrentResolvedValues&&this.ultraState.getCurrentResolvedValues().currentContent&&(d=this.ultraState.getCurrentResolvedValues().currentContent.id);const u={bbml:n.$modelValue||"",isDisabled:a(this.$scope.isDisabled,!1),isReadOnly:a(this.$scope.isReadOnly,!1),isToolbarHidden:a(this.$scope.isToolbarHidden,!1),isRtl:l,locale:s,expandInlineFilesOnLoad:this.$scope.expandInlineFilesOnLoad,supportsInlineDocumentRender:this.$scope.supportsInlineDocumentRender&&e.inlineRenderFfEnabled,babelfishInstance:i,babelfishFormatInstance:o,onChange:c,placeholder:e.placeholderText,plugins:t,editorId:this.$scope.editorId,ariaLabelledBy:this.$scope.editorAriaLabelledBy,ariaDescribedBy:this.$scope.editorAriaDescribedBy,showWordCount:this.$scope.showWordCount,ally:{service:this.reactAllyService,indexMap:this.$scope.allyIndexMap||new Map},rootContentId:d,...this.$scope.onFocus?{onFocus:()=>this.$scope.$applyAsync(this.$scope.onFocus)}:null,...this.$scope.onBlur?{onBlur:()=>this.$scope.$applyAsync(this.$scope.onBlur)}:null,...b.a.unitTesting?{mockLocalize:Object(C.a)()}:null};this.$scope.onBlur&&n.$setTouched(),this.$scope.editor=this.bbEditorFactory(this.element[0],u)}))}getOnDownloadWithAnnotations(){return t=>{const s=!!t.groupAttemptFileId,n=t.attemptFileId||t.groupAttemptFileId,i={systemInfo:this.bbContext.getSystemInfo().$asPromise(),annotations:this.AnnotationsModel.downloadWithAnnotations(n,s,this.contextCourse.courseId).$asPromise()};return this.$q.all(i).then((t=>{const s=t.systemInfo.annotationRendererUrl;if(!(s&&s.length>0))throw new Error("Annotation Service url is not defined.");{const n=e("#annotationIframe");null!==n&&n.remove();const i=e("#annotationForm");null!==i&&i.remove();const o=e(document.createElement("iframe"));o.attr("src","about:blank"),o.attr("id","annotationIframe"),o.attr("name","annotationIframe"),o.css("display","none");const a=e(document.createElement("form"));a.attr("target","annotationIframe"),a.attr("method","POST"),a.attr("action",s+"/annotation/token"),a.attr("id","annotationForm"),a.attr("name","annotationForm");const r=e(document.createElement("input"));r.attr("type","hidden"),r.attr("name","jwt"),r.attr("value",t.annotations.jwt),r.appendTo(a);const c=e("body");a.appendTo(c),o.appendTo(c),a.submit()}}))}}};O=Object(n.__decorate)([Object(n.__param)(0,Object(S.b)("$q")),Object(n.__param)(1,Object(S.b)("scope")),Object(n.__param)(2,Object(S.b)("element")),Object(n.__param)(3,Object(S.b)("attrs")),Object(n.__param)(4,Object(S.b)("controllers")),Object(n.__param)(5,Object(S.b)("BbEditorFactory")),Object(n.__param)(6,Object(S.b)(l.serviceName)),Object(n.__param)(7,Object(S.b)(r.b)),Object(n.__param)(8,Object(S.b)(i.b)),Object(n.__param)(9,Object(S.b)(d.b)),Object(n.__param)(10,Object(S.b)(u.b)),Object(n.__param)(11,Object(S.b)(f.c.serviceName)),Object(n.__param)(12,Object(S.b)(c.e)),Object(n.__param)(13,Object(S.b)(o.b)),Object(n.__param)(14,Object(S.b)(p.d)),Object(n.__param)(15,Object(S.b)(m.b)),Object(n.__param)(16,Object(S.b)(h.b))],O);class A{constructor(e){this.$injector=e,this.link=(e,t,s,n)=>{t.addClass("rich-text-editor"),e.richTextEditor=this.$injector.instantiate(O,{scope:e,element:t,attrs:s,controllers:n})},this.require={ngModel:"ngModel"},this.restrict="E",this.scope={contentMarketIsReadOnly:"<?",fileLocation:"=?",isDisabled:"<?",isReadOnly:"<?",isToolbarHidden:"<?",onChange:"<?",onBlur:"&?",onNewAttachmentSavePressed:"&?",onFocus:"&?",placeholder:"@?editorPlaceholderKey",pluginOptions:"<?",webLocation:"=?",editorId:"@?",editorAriaLabelledBy:"@?",editorAriaDescribedBy:"@?",showWordCount:"<?",allyIndexMap:"=?",rootContentId:"@?",expandInlineFilesOnLoad:"<?",supportsInlineDocumentRender:"<?"}}}A.$inject=["$injector"],a.module(y,[l.moduleName,r.a,d.a,u.a,i.a,o.a,h.a]).value("BbEditorFactory",g.BbEditorFactory).directive("bbRichTextEditor",["$injector",e=>e.instantiate(A)])}).call(this,s("71td"))},jciN:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return h}));var n=s("D57K"),i=(s("SSV0"),s("Llzl")),o=s("oVrE"),a=s("g66W"),r=s("5MwF"),c=s("0JpG"),l=s("NMEb"),d=s("4J8k"),u=s("aHpC"),p=s("9Ss5"),m=s("VdDF");const h="ultra.directives.avatar";class b{constructor(e,t,s,n,i){this.scope=e,this.$element=t,this.attributes=s,this.bbLocalize=n,this.$timeout=i,this.backgroundColors=12;const o=this.scope.$watchGroup(["user.givenName","user.familyName","user.ui.displayName","user.avatar.permanentUrl","user","inactive()"],(()=>{void 0!==this.scope.user&&(this.renderAvatars(),this.scope.autoUpdate&&this.scope.autoUpdate()||o())})),a=this.scope.$watchCollection("users",(()=>{this.scope.users&&(this.renderAvatars(),this.scope.autoUpdate&&this.scope.autoUpdate()||a())}))}getAvatarBG(e){return"default-avatar-"+(parseInt((e&&e.id||"0").replace(/[^\d]/g,""),10)%this.backgroundColors+1)}avatarParticipantsClass(e){switch(e){case 0:return"no-participants";case 1:return"one-participant";case 2:return"two-participants";default:return"two-plus-participants"}}canDisplayAvatarForUser(e){return!!e&&(!!(e.givenName||e.familyName||this.isAnonymousStudent(e))||!(!e.avatar||!e.avatar.permanentUrl||"default"===e.avatar.permanentUrl))}getInitials(e){return!e||this.isAnonymousStudent(e)||!e.givenName||!e.familyName||Object(a.g)(e.givenName)||Object(a.g)(e.familyName)||Object(a.h)(e.givenName)||Object(a.h)(e.familyName)?null:(e.givenName.charAt(0)+e.familyName.charAt(0)).toLowerCase()}buildAvatarData(e){const t={};if(!this.canDisplayAvatarForUser(e))return null;if(t.avatarBg=this.getAvatarBG(e),t.userInitials=this.getInitials(e),e.ui&&e.ui.displayName?t.username=e.ui.displayName:e.givenName||e.familyName||this.isAnonymousStudent(e)?this.bbLocalize.formatUsername(e,c.ILocaleUsernameFormat.Long,this.scope,{noWrap:!0,noEscape:!0}).then((e=>{t.username=e})):t.username=null,e.avatar&&e.avatar.permanentUrl&&"default"!==e.avatar.permanentUrl){if(/^https?/.test(e.avatar.permanentUrl)&&-1===e.avatar.permanentUrl.indexOf("ts=")){const t=(m.a.isValidDate(e.lastModifiedAt)?e.lastModifiedAt:new Date).getTime();e.avatar.permanentUrl=e.avatar.permanentUrl+(e.avatar.permanentUrl.indexOf("?")>=0?"&ts=":"?ts=")+encodeURIComponent(t)}t.avatarUrl=e.avatar.permanentUrl}return t.isAllMembers=Object(o.f)(e),t}isAnonymousStudent(e){if(e.isAnonymousStudent)return e.isAnonymousStudent()}renderAvatars(){let e=this.scope.users;if(!e&&this.scope.user&&(e=this.scope.user),i.isArray(e)||(e=null!=e?[e]:[]),0===e.length)return this.scope.first=null,this.scope.second=null,this.scope.participants=0,void(this.scope.isAvatarRender=!0);this.scope.participants=e.length,this.scope.avatarsClasses={},i.isDefined(this.scope.inactive)&&(this.scope.avatarsClasses.inactive=this.scope.inactive()),!this.scope.avatarsClasses.inactive&&i.isDefined(this.scope.customizedActiveStyle)&&(this.scope.avatarsClasses.outline=!0,this.scope.avatarsClasses[this.scope.customizedActiveStyle]=!0),this.scope.avatarsClasses[this.avatarParticipantsClass(e.length)]=!0,this.scope.first=this.buildAvatarData(e[0]),2===e.length?this.scope.second=this.buildAvatarData(e[1]):e.length>2&&(this.scope.second={}),this.scope.isAvatarRender=!0}}let g=class{constructor(e,t){this.bbLocalize=e,this.$timeout=t,this.restrict="E",this.template=p,this.scope={user:"=?",inactive:"&?",users:"=?",autoUpdate:"&?",isGray:"&?",hasException:"&?",customizedActiveStyle:"@?",analyticsIdTagPrefix:"@"},this.link=(e,t,s)=>new b(e,t,s,this.bbLocalize,this.$timeout)}};g=Object(n.__decorate)([Object(n.__param)(0,Object(u.b)(c.serviceName)),Object(n.__param)(1,Object(u.b)("$timeout"))],g),r.a.features.newAvatar?i.module(h,[d.a]).directive("bbAvatar",["$compile",t=>({restrict:"E",scope:!1,priority:Number.MAX_VALUE,terminal:!0,link(s,n,i){const o=Object.prototype.hasOwnProperty.call(i,"users")?"bb-user-avatar-group":"bb-user-avatar",a=e(n[0].outerHTML.replace(/bb\-avatar/g,o));n.replaceWith(a),t(a)(s)}})]):i.module(h,[l.a,d.a]).directive("bbAvatar",["$injector",e=>e.instantiate(g)])}).call(this,s("71td"))},jcim:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("9eyz");const o="ultra.components.directives.bbUiIcon.medium.TimeLimit";Object(n.a)(i.a,o,"bbUiIconMediumTimeLimit")},jlIo:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-code",use:"icon-small-code-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-code"><path d="M4 3L1 8l3 5M12 3l3 5-3 5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},k12r:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("SBxA");const o="ultra.components.directives.bbUiIcon.large.Survey";Object(n.a)(i.Survey,o,"bbUiIconLargeSurvey")},kC07:function(e,t,s){"use strict";(function(e){s.d(t,"b",(function(){return ce})),s.d(t,"a",(function(){return le}));var n=s("D57K"),i=(s("DXZ4"),s("Ne7M"),s("yiTm"),s("UEFj"),s("j3m2"),s("qDdO"),s("ueuW"),s("85nY"),s("hKQ4"),s("/9iQ"),s("7XaY"),s("Mnbc"),s("NEyJ"),s("p/lC"),s("nsO7")),o=s("Llzl"),a=s("yC9S"),r=s("+O05"),c=s("FpRh"),l=s("laCM"),d=s("cs5G"),u=s("nYZ0"),p=s("bhWV"),m=s("xAaQ"),h=s("ga7A"),b=s("z+6U"),g=s("LFd7"),v=s("Fvsw"),f=s("Et3n"),w=s("5Tom"),S=s("Qbdf"),C=s("X455"),y=s("bF8R"),O=s("UioO"),A=s("jhBu"),I=s("Oyr+"),D=s("ujI6"),k=s("0JpG"),_=s("vhkR"),j=s("w9Zy"),T=s("r6lH"),$=s("lEL+"),R=s("Tn43"),E=s("lmMM"),x=s("4nF1"),P=s("IWgv"),L=s("LecS"),G=s("aCck"),M=s("Ocaa"),N=s("Sa5G"),F=s("ZQFV"),B=s("oi1r"),q=s("pjml"),z=s("JNtI"),U=s("0rzL"),V=s("nmzr"),H=s("TnpK"),Q=s("a2qY"),K=s("aTRN"),W=s("+4Px"),J=s("agzH"),Y=s("BLb8"),Z=s("aHpC"),X=s("/5AG"),ee=s("Htol"),te=s("IbyE"),se=s("zGdY"),ne=s("kcGO"),ie=s("9OUN"),oe=s("CY5M"),ae=s("Y+9S"),re=s("m5Qz");const ce="ultra.directives.contentItemBase",le="base-content-item";let de=class{constructor(e,t,s,n,o,r,c,l,d,u,p,m,h,b,g,v,f,w,S,C){this.$q=t,this.$rootScope=s,this.$ngRedux=n,this.element=o,this.scope=r,this.CourseModel=c,this.schemaService=l,this.contentService=d,this.contextService=u,this.contextCourse=p,this.contextCourseMembership=m,this.courseContentService=h,this.entitlementService=b,this.localizeService=g,this.ltiService=v,this.telemetryService=f,this.timeoutService=w,this.ultraState=S,this.allyService=C,this.courseLinkContentHandler=q.p.ContentHandler.CourseLink,this.disableRestricted=!1,this.displayTelemetryUserActivity=!1,this.displayTelemetryDiscussionActivity=!1,this.entitledToDesignAssessment=!1,this.isModifyPermissionLoaded=!1,this.isGettingConfirmationOptions=!1,this.getNextReviewState=()=>se.ContentReviewState.Started===this.contentReviewState?se.ContentReviewState.Completed:se.ContentReviewState.Completed===this.contentReviewState?se.ContentReviewState.Started:null,this.onReviewStateIconClick=()=>{const e=this.getNextReviewState();if(!this.scope.content.canUpdateReviewState()||this.scope.content.inSequence||!e||!this.scope.content.courseId||!this.scope.content.id)return this.$q.resolve();const t=this.updateContentReviewState(this.scope.content.courseId,this.scope.content.id,e);return this.$q.when(t).then((()=>{}))},this.showEditButtonFromLTILink=()=>!this.isExcludedOrDeletedLtiToolProvider()&&!!this.ltiService.placementExists(this.scope.content),this.displayGradeInfo=!1,this.isLate=!1,this.scope.shouldShowContent=!0,this.canViewGroups=this.entitlementService.isEntitled(N.n.ViewGroups),this.hasViewGroupsAsAdmin=this.entitlementService.isEntitled(N.n.ViewGroupsAsAdmin),this.courseId=p.courseId?p.courseId:this.ultraState.params.courseId,this.conditionalRelease=e.instantiate(K.a,{scope:r}),this.subscribeToReduxChanges(),!this.courseProgressConfiguration&&this.retrieveCourseProgressConfiguration&&this.retrieveCourseProgressConfiguration({courseId:this.courseId}),this.scope.content.$then((e=>{this.entitlementService.hasAnyCourseEntitlement([N.i.ModifyAssessment,N.i.ViewAssessment],e.courseId).then((t=>{if(this.entitledToDesignAssessment=t,this.isModifyPermissionLoaded=!0,e.canHaveAttempts()&&!this.entitledToDesignAssessment&&e.contentDetail){const t=e.getAssociatedGradingColumn(),s=c.$new(e.courseId).gradebook.columns.$buildRaw(t);let n;this.scope.gradingColumn=s,n=this.displayGradeInfo?this.courseContentService.loadContentAndGrades({course:this.CourseModel.$buildRaw({id:e.courseId}),content:e,column:s}):this.$q.when({courseContent:e,gradingColumn:s}),n.then((e=>{this.displayGradeInfo&&this.scope.gradingColumn.isLate()&&(!e.gradeDetail||e.gradeDetail.ui.attempt.isInProgress())&&(this.isLate=!0),this.isGradeLoaded=!0,e.gradeDetail&&e.gradeDetail.column.id===s.id&&(this.scope.gradeDetail=e.gradeDetail)}))}else this.isLate=!1,this.isGradeLoaded=!0})),this.entitlementService.hasAnyCourseEntitlement([F.GradebookEntitlement.ViewGrades],e.courseId).then((e=>{this.canViewQuestionAnalysis=e})),this.contextService.getSystemInfo().$asPromise().then((e=>{e.telemetryEnabled&&(this.telemetryService.determineContentSupportsActivityData(this.scope.content).then((e=>{this.displayTelemetryUserActivity=e&&!this.contextCourseMembership.isStudentMembership()})),this.displayTelemetryDiscussionActivity=this.shouldShowDiscussionAnalytics()&&!this.contextCourseMembership.isStudentMembership())})),this.allyService.isAvailable().then((e=>{e&&this.allyService.isAllySupportedContentItem(this.scope.content)?(this.canShowAlly=!0,this.updateAlly()):this.canShowAlly=!1;const t=this.getOverflowMenu();this.isAllyInstructor=this.allyService.isAllyInstructor(),this.$rootScope.$broadcast("menuItems.update",this.scope.content.id,t)})),r.content.title||q.p.ContentHandler.UltraAssignment.isEqualTo(this.scope.content.contentHandler)||q.p.ContentHandler.TestLink.isEqualTo(this.scope.content.contentHandler)||this.localizeService.loadBundle("features/course/content/course-content").then((()=>{r.content.title=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"course.content.contentTitlePlaceholder"})}));const t=e=>{e.getLinkContentSource().$then((e=>{this.targetContent=e,this.contentHandler=e.contentHandler&&e.contentHandler.toString()}),(t=>{403===t.$response.status&&i.remove(this.scope.contents,(t=>t.$pk===e.$pk))}))};this.scope.$watch("::content.id",(()=>{if(q.p.ContentHandler.CourseLink.isEqualTo(this.scope.content.contentHandler))if(this.scope.content.contentDetail)t(this.scope.content);else{const e=this.scope.$watch("content.isConditionalReleaseUnlocked()",(s=>{s&&(t(this.scope.content),e())}))}})),Object(Y.b)(this.scope,((e,t)=>{this.scope.content.isConditionalReleaseLocked()&&this.scope.content.containsCriteriaWithGradeColumnId(t)&&Object(Y.c)(this.scope,t)})),Object(Y.a)(this.scope,(()=>{this.scope.content.isConditionalReleaseLocked()&&Object(Y.c)(this.scope)})),a.b.OnRootScope(this.scope,"grade-attempt",((e,t,s)=>{this.scope.content.id===t&&(this.scope.gradeDetail=s)})),r.content.contentHandler?r.content.isBbPage()?this.contentHandler=q.p.ContentHandler.Document.toString():this.contentHandler=r.content.contentHandler.toString():this.contentHandler=q.p.ContentHandler.Document.toString(),this.disableRestricted=q.p.ContentHandler.PartnerCloud.isEqualTo(this.contentHandler),this.conditionalRelease.getConditions(this.scope.content),this.hasViewB2Entitlement()})),this.scope.$on("refresh-conditional-release-rules",((e,t)=>{this.scope.content.id===t.id&&this.conditionalRelease.getConditions(t)})),this.scope.$on("content-update",((e,t)=>{this.scope.content.id!==t.id||this.scope.content.ui.linkSource||(this.scope.content=t),this.scope.content.ui.linkSource&&this.scope.content.ui.linkSource.id===t.id&&(this.scope.content.ui.linkSource=t);const s=this.scope.content.getDueDate();this.scope.dueDate=s&&new Date(s)})),this.scope.$on("bb-update-CR-tooltip",((e,t,s,n)=>{t&&(this.conditionalRelease.gradeCriteria&&this.conditionalRelease.gradeCriteria.gradeColumnId)===t.id&&this.conditionalRelease.getConditions(this.scope.content,s,n)})),this.scope.$on("show-override-message",((e,t,s)=>{this.scope.content&&this.scope.content.id===s&&(t?(this.scope.shouldShowContent=!1,this.overrideMessage=t):this.scope.shouldShowContent=!0)}));const y=i.once((()=>{this.scope.$watch((()=>this.scope.content.getDueDate()),(e=>{this.scope.dueDate=e&&new Date(e)}))}));this.scope.$watch("content.contentHandler",(()=>{r.content.ui.importPlaceholder||y()})),this.scope.$on("discussion-group-content-update",((e,t)=>{this.scope.content&&q.p.ContentHandler.CourseLink.isEqualTo(this.scope.content.contentHandler)&&this.scope.content.contentDetail&&this.scope.content.getLinkContentSource().$then((e=>{e.id===t.id&&this.scope.content.applyGroupSettings(t)}))}))}get canDownload(){return this.scope.content.getContentDisplay().canDownload()}get contentReviewState(){return this.scope.content.state}set contentReviewState(e){e&&this.scope.content&&(this.scope.content.state=e)}subscribeToReduxChanges(){const e=this.$ngRedux.connect((e=>({contentReviewState:te.select.contentReviewState.getContentReviewStateForContextUser(e,this.scope.content.id),courseProgressConfiguration:te.select.courseProgress.getCourseProgressConfiguration(e,this.courseId)})),(e=>Object(ie.bindActionCreators)({updateContentReviewState:te.actions.contentReviewState.persistContentReviewState,retrieveCourseProgressConfiguration:te.actions.courseProgress.loadCourseProgressConfiguration},e)))(this);this.scope.$on("$destroy",e)}isEngagementOutline(){return"discussions"===this.scope.contextArea}getDescription(){return this.scope.content.systemGeneratedLocalizableDescription?this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:this.scope.content.systemGeneratedLocalizableDescription.languageKey}):this.scope.content.description}getAriaDescribedBy(){let e="content-item-icon-"+this.scope.content.id;return this.scope.content.ui.hasIndicator&&(e+=" activity-indicator-"+this.scope.content.id),e}getDeleteConfirmationKeyAndShowType(){return this.contentService.generateDeleteConfirmationKey(this.scope.content,this.scope.contextArea).then((e=>({confirmationKey:this.scope.content.ui.deleteConfirmationKey,showType:this.scope.content.ui.modalShowType})))}deleteContent(){q.p.ContentHandler.CourseLink.isEqualTo(this.scope.content.contentHandler)?this.scope.content.getLinkContentSource().$then((e=>{var t;const s=null===(t=null==e?void 0:e.contentHandler)||void 0===t?void 0:t.toString();se.ContentHandlerHandle.Discussion===s?this._deleteContent(e):this._deleteContentAndBroadcastUpdateCRTooltip()})):this._deleteContentAndBroadcastUpdateCRTooltip()}_deleteContentAndBroadcastUpdateCRTooltip(){this._deleteContent(this.scope.content),this.$rootScope.$broadcast("bb-update-CR-tooltip",this.scope.content.getAssociatedGradingColumn(),"",!0)}_deleteContent(t){t.hasCourseLinks()?t.getSoftLinks().$asPromise().then((e=>{e.length?this.$q.all(e.map((e=>this.CourseModel.$new(t.courseId).contents.$new(e.courseContent).$fetch().$asPromise().then((e=>{this.$rootScope.$broadcast("deleteContent",e,!1)}))))).then((()=>{this.$rootScope.$broadcast("deleteContent",t)})):this.$rootScope.$broadcast("deleteContent",t)})):this.$rootScope.$broadcast("deleteContent",t);const s=this.element.closest(".js-content-div"),n=s.next(".js-content-div");if(n.length>0)n.find(".js-content-item-base").first().find(".content-title").focus();else{const t=s.prev(".js-content-div");if(t.length>0)t.find(".js-content-item-base").first().find(".content-title").focus();else{const t=s.closest(".folder");t.length>0?t.find(".js-content-item-base").first().find(".content-title").focus():this.timeoutService((()=>{e(".js-create").focus()}),this.scope.$root,0,!1)}}}hasSupportedConversation(){return!!this.scope.content.hasConversation()&&x.a.create(this.scope.content).supportsConversations()}shouldShowAlertIcon(){return this.isLate||this.scope.content.canViewAsInstructor()&&this.isUnlaunchableLtiLink()}shouldShowDiscussionAnalytics(){return this.scope.content.contentHandler&&N.f.Discussion.isEqualTo(x.a.create(this.scope.content).viewHandler())}shouldShowScormAnalysisReport(){return this.scope.content&&this.entitlementService.isEntitled(F.GradebookEntitlement.FullGradebookAccess,this.scope.content.courseId||this.courseId)&&this.scope.content.isScorm()&&this.scope.content.hasReport()}getContentProgressRoute(){var e;if(!!(null===(e=this.courseProgressConfiguration)||void 0===e?void 0:e.progressTrackingEnabled)&&this.entitlementService.isEntitled(X.CourseProgressEntitlements.ViewProgressInformation,this.scope.content.courseId||this.courseId))return x.a.create(this.scope.content).getContentProgressRoute()}isUnlaunchableLtiLink(){return this.scope.content.id&&this.scope.content.getContentDisplay().isLtiLink()&&(!this.scope.content.getContentDisplay().isXplorLtiLink()&&!this.ltiService.getLaunchLinkFromContent(this.scope.content)||void 0!==this.ltiService.placementExists(this.scope.content)&&!this.ltiService.placementExists(this.scope.content))}hasViewB2Entitlement(){this.entitlementService.hasSystemEntitlement(N.s.ViewBuildingBlock).then((e=>this.canViewB2=e))}hasLTIToolConfigurationEntitlement(){return this.canViewB2}isExcludedOrDeletedLtiToolProvider(){const e=this.ltiService.getDomainConfigStatusType(this.scope.content);return this.scope.content.id&&this.scope.content.getContentDisplay().isLtiLink()&&(void 0!==this.ltiService.ltiToolProviderExists(this.scope.content)&&!this.ltiService.ltiToolProviderExists(this.scope.content)||q.K.LTIStatusType.Excluded.isEqualTo(e))}showVisibility(){return!this.isUnlaunchableLtiLink()&&!this.scope.hideVisibilitySelector}usesEditButton(){const e=this.scope.content.getContentDisplay();return e.usesEditButton()&&e.canUseEditButton()}openEditContentPanel(){this.ultraState.goPeekState(this.scope.content.getContentDisplay().getEditState(),this.scope.content.getContentDisplay().getEditStateParams())}updateContentVisibility(){return this.targetContent&&this.scope.content?(this.targetContent.applyAvailabilitySettings(this.scope.content),this.updateVisibilityImpl(this.targetContent).then((()=>this.updateVisibilityImpl(this.scope.content)))):this.scope.content?this.updateVisibilityImpl(this.scope.content):this.$q.resolve()}updateVisibilityImpl(e){e.visibility=this.contentService.determineVisibility(e.isAvailable);const t=["isAvailable","isPartiallyVisible","adaptiveReleaseRules"],s=e.getAssociatedGradingColumn();return s&&(s.visible=e.isAvailable,t.push("contentDetail")),e.withParams({fields:"id"}).$save(t).$asPromise().then((()=>{this.$rootScope.$broadcast("content-update",e)}))}updateAlly(){this.canShowAlly&&this.allyService.update(this.scope,this.scope.content.id,this.allyService.getXythosIdFromContentItem(this.scope.content))}getOverflowMenu(){return[{icon:"draw",labelKey:"global.edit",show:()=>{var e,t;let s=this.isGettingConfirmationOptions?this.lastIsEditButtonShow:this.usesEditButton();return this.scope.content.isLtiLink()&&(null===(t=null===(e=this.scope.content.contentDetail)||void 0===e?void 0:e[this.contentHandler])||void 0===t?void 0:t.itemOrigin)===oe.LtiItemOrigin.CloudDocument&&(s=this.showEditButtonFromLTILink()&&this.scope.content.canViewAsInstructor()),this.lastIsEditButtonShow=s,s},onClick:this.openEditContentPanel.bind(this)},{icon:"conversation",labelKey:"components.directives.content-item-base.overflow-menu.open-conversation",show:this.hasSupportedConversation.bind(this),onClick:()=>{this.ultraState.goPeekState("conversations",{courseId:this.scope.content.courseId,contentId:this.scope.content.id})}},{icon:"beast-analytics",labelKey:"components.directives.content-item-base.overflow-menu.student-activity",show:()=>this.displayTelemetryUserActivity&&!this.isAnonymouslyGraded(),onClick:()=>{this.ultraState.goPeekState(V.TelemetryRoutes.CONTENT_ACTIVITY_IN_DETAIL,{contentId:this.scope.content.id})}},{icon:"beast-analytics",uniqueId:"scorm-analytics-report",labelKey:"components.directives.content-item-base.overflow-menu.view-analytics",show:()=>this.shouldShowScormAnalysisReport()&&!this.contextCourseMembership.isStudentMembership(),onClick:()=>{this.ultraState.goPeekState("scorm-analytics-report",{courseId:this.scope.content.courseId,contentId:this.scope.content.id})}},{icon:"beast-analytics",uniqueId:"discussion-insights",labelKey:"components.directives.content-item-base.overflow-menu.view-analytics",show:()=>this.displayTelemetryDiscussionActivity,onClick:()=>{const e=this.scope.content.contentDetail["resource/x-bb-courselink"]?this.scope.content.contentDetail["resource/x-bb-courselink"].linkSourceId:this.scope.content.id;this.ultraState.goPeekState(V.TelemetryRoutes.DISCUSSION_FORUM_INSIGHTS,{contentId:e,forumContentId:this.scope.content.id})}},{icon:"question-analysis",labelKey:"components.directives.content-item-base.overflow-menu.question-analysis",show:()=>this.canViewQuestionAnalysis&&this.scope.content.isQuestionAnalysisAvailable(),onClick:()=>{this.ultraState.goPeekState("question-analysis.report",{qaContentId:this.scope.content.id})}},{icon:"class-pulse-future",uniqueId:"content-progress",labelKey:this.contextCourse.course.isOrganization?"components.directives.content-item-base.overflow-menu.content-progress-org":"components.directives.content-item-base.overflow-menu.content-progress",show:()=>void 0!==this.getContentProgressRoute(),onClick:()=>{const e=this.getContentProgressRoute();void 0!==e&&this.ultraState.goPeekState(e.stateName,e.args)}},{icon:"trash",labelKey:"global.delete",show:()=>this.scope.content.canDelete(),onClick:this.deleteContent.bind(this),confirmationOptions:{lazyLoadTitleKeyAndInstructionsKey:()=>(this.isGettingConfirmationOptions=!0,this.getDeleteConfirmationKeyAndShowType().then((e=>{const t=e.confirmationKey.replace(/^resource\//,"");return this.isGettingConfirmationOptions=!1,this.$q.when(z.a(t))})))}},{icon:"download",labelKey:this.canShowAlly?"ally.context_menu.download_original_file":"global.download",show:()=>this.canDownload,onClick:()=>{Object(ae.notifyMobileApp)(ae.MessageType.DownloadLinkClicked),window.open(this.scope.content.getContentDisplay().contentUrl(),"_blank")}},{labelKey:"ally.context_menu.view_accessibility_score",icon:"ally-indicator-unscored",show:()=>this.canShowAlly&&this.isAllyInstructor,onClick:()=>{},additionalAttributes:{"data-ally-show":"instructorfeedback","data-ally-content-ref":this.scope.content.id,"data-ally-invoke":"instructorfeedback",style:"display:none;",onkeydown:`(function(e) {\n              if (e.keyCode === ${W.f} || e.keyCode === ${W.t}) {\n                $(e.target).closest("li").click();\n              }\n              })(event)`}},{icon:"ally-alt-formats",labelKey:"ally.context_menu.download_alternative_formats",show:()=>this.canShowAlly&&this.canDownload,onClick:()=>{},additionalAttributes:{"data-ally-show":"alternativeformats","data-ally-content-ref":this.scope.content.id,"data-ally-invoke":"alternativeformats",style:"display:none;",onkeydown:`(function(e) {\n                if (e.keyCode === ${W.f} || e.keyCode === ${W.t}) {\n                 $(e.target).closest("li").click();\n                }\n              })(event)`}}]}overflowMenuIsAllyConditional(){var e;return!(!(null===(e=this.scope.content)||void 0===e?void 0:e.isFile())||0===this.getOverflowMenu().length)&&this.getOverflowMenu().filter((e=>{var t;return null===(t=e.show)||void 0===t?void 0:t.call(e)})).every((e=>{var t;return void 0!==(null===(t=e.additionalAttributes)||void 0===t?void 0:t["data-ally-show"])}))}canShowAllyAlternativeFormats(){var e,t,s,n;return(null===(e=this.scope.content)||void 0===e?void 0:e.isFile())&&Object(se.fileAssociationModeAllowsDownload)(null===(n=null===(s=null===(t=this.scope.content)||void 0===t?void 0:t.contentDetail)||void 0===s?void 0:s[se.ContentHandlerHandle.File])||void 0===n?void 0:n.fileAssociationMode)}get deployedAssessment(){return this.scope.content&&this.scope.content.getDeployedAssessment()}isAnonymouslyGraded(){const e=this.scope.content.getAssociatedGradingColumn();return e&&e.anonymousGrading}async editGroups(){let e,t=this.scope.content.id;if(this.scope.content.isAssignment()||this.scope.content.isTest())e=this.deployedAssessment.gradingColumn.id;else if(e=this.scope.gradeColumn&&this.scope.gradeColumn.id,q.p.ContentHandler.CourseLink.isEqualTo(this.scope.content.contentHandler)&&this.scope.content.contentDetail){t=(await this.scope.content.getLinkContentSource().$asPromise()).id}this.ultraState.goPeekState("course-group",{groupCourseId:this.scope.content.courseId||this.ultraState.params.courseId,groupContentId:t,groupColumnId:e})}showOverflowMenu(){const e=this.scope.content;return e.canDelete()||e.canViewAsInstructor()||this.usesEditButton()||e.hasConversation()||this.canDownload||this.canShowAlly&&!e.isConditionalReleaseLocked()}openAssessmentItem(){r.a.isExternalSubmissionsAssessment(this.scope.content)?this.ultraState.goPeekState(V.AssessmentRoutes.ASSESSMENT_EXTERNAL_OVERVIEW,{contentId:this.scope.content.id}):this.ultraState.goPeekState(V.AssessmentRoutes.ASSESSMENT_OVERVIEW,{contentId:this.scope.content.id})}onExternalLinkClick(){var e;if(this.notifyMobileAppOnItemClick(),!(null===(e=this.scope.content.permissions)||void 0===e?void 0:e.canHaveReviewState))return;const t=Object(ne.getAutomaticReviewStateForContentLaunched)(this.scope.content);t&&this.updateContentReviewState(this.scope.content.courseId,this.scope.content.id,t).then((()=>{this.$rootScope.$broadcast(ee.b,this.scope.content,t)}))}notifyMobileAppOnItemClick(){let e,t;if(q.p.ContentHandler.File.isEqualTo(this.scope.content.contentHandler)?(e=ae.MessageType.FileOpened,t=ae.MobileContentType.Document):q.p.ContentHandler.ExternalLink.isEqualTo(this.scope.content.contentHandler)&&(e=ae.MessageType.LinkOpened,t=ae.MobileContentType.Link),q.p.ContentHandler.File.isEqualTo(this.scope.content.contentHandler)||q.p.ContentHandler.ExternalLink.isEqualTo(this.scope.content.contentHandler)){const s={type:e,status:ae.MessageStatus.Success,contentId:this.scope.content.id,contentTitle:this.scope.content.title,contentType:t};Object(ae.sendMessageToMobile)(s)}}getRootClassName(){return le}shouldShowReviewStateIcon(){var e,t;const s=null===(e=this.scope.showReviewStateIcon)||void 0===e||e,n=!!(null===(t=this.courseProgressConfiguration)||void 0===t?void 0:t.progressTrackingEnabled)||this.scope.content.inSequence;return s&&n&&this.contextCourseMembership.isStudentMembership()}getNeighborReviewState(e){return this.scope.content.inSequence&&e&&!e.isUiFolder()?e.state===se.ContentReviewState.Completed?X.NeighborContentReviewState.Completed:X.NeighborContentReviewState.Incomplete:X.NeighborContentReviewState.None}setForcedSequenceLearningModuleAttributes(){return te.ContentHelper.isNotAccessibleButVisibleForcedSequenceItem(this.scope.content)}};de=Object(n.__decorate)([Object(n.__param)(0,Object(Z.b)("$injector")),Object(n.__param)(1,Object(Z.b)("$q")),Object(n.__param)(2,Object(Z.b)("$rootScope")),Object(n.__param)(3,Object(Z.b)("$ngRedux")),Object(n.__param)(4,Object(Z.b)("element")),Object(n.__param)(5,Object(Z.b)("scope")),Object(n.__param)(6,Object(Z.b)(q.m.serviceName)),Object(n.__param)(7,Object(Z.b)(B.b)),Object(n.__param)(8,Object(Z.b)(u.f)),Object(n.__param)(9,Object(Z.b)(v.b)),Object(n.__param)(10,Object(Z.b)(S.e)),Object(n.__param)(11,Object(Z.b)(C.d)),Object(n.__param)(12,Object(Z.b)(y.b)),Object(n.__param)(13,Object(Z.b)(A.b)),Object(n.__param)(14,Object(Z.b)(k.serviceName)),Object(n.__param)(15,Object(Z.b)(_.b)),Object(n.__param)(16,Object(Z.b)(T.b)),Object(n.__param)(17,Object(Z.b)($.b)),Object(n.__param)(18,Object(Z.b)(H.d)),Object(n.__param)(19,Object(Z.b)(d.b))],de);class ue{constructor(e){this.$injector=e,this.restrict="E",this.scope={content:"=",contents:"=",contextArea:"=",canMove:"=",itemBefore:"<",itemAfter:"<",showReviewStateIcon:"<?",hideVisibilitySelector:"<?"},this.template=Q,this.link=(e,t)=>{e.contentItemBase=this.$injector.instantiate(de,{scope:e,element:t}),e.$on(I.e,((s,n,i,o)=>{o===I.c.FileDrop&&e.content===i.content&&(i.targetElement=t.find(".bb-progress"),e.$root.$broadcast(I.e,n,i,e.content.ui.fileUploadId,i.targetElement,I.c.LinkProgress))}))}}}ue.$inject=["$injector"],o.module(ce,[p.a,m.a,h.a,b.a,g.a,O.a,f.a,w.b,_.a,j.d,J.a,E.d,P.a,G.a,L.a,M.a,D.c,k.moduleName,u.d,y.a,B.a,z.b,U.a,R.a,c.a,l.a,re.a]).directive("bbContentItemBase",["$injector",e=>e.instantiate(ue)])}).call(this,s("71td"))},kN1T:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return y}));var n=s("D57K"),i=s("Llzl"),o=s("nsO7"),a=s("0JpG"),r=s("LN5R"),c=s("BMpZ"),l=s("o5Lu"),d=s("lEL+"),u=s("jhBu"),p=s("dF44"),m=s("+4Px"),h=s("qH3X"),b=s("s1u2"),g=s("6PP7"),v=s("cbVV"),f=s("TmUJ"),w=s("LTOG"),S=s("aHpC"),C=s("Sa5G");const y="ultra.components.directives.gradeGridColumnHeaderReborn";class O extends w.a{constructor(t,s,n,i,a,r,c,l,d,u){super(s,l),this.rootScope=t,this.element=n,this.attrs=i,this.$compile=a,this.gradeGridRebornController=r,this.grade=c,this.bbLocalize=d,this.entitlementService=u,this.initializeEventHandler(),this.toolAvailable=!0,this.menuScope=s.$new(!0),Object.defineProperty(s,"possible",{get:()=>this.possible}),s.$watch("col",(e=>{s.columnMetadata=e.data,this.col=e,o.debounce((()=>this.highlight(this.col)),1e3)(),this.element.data("col",this.col),s.isGroupTest=this.col instanceof v.h,s.showAlertIcon=()=>s.columnMetadata.getNumMissingIfLate()>0,this.element.find(".content").removeClass("is-active"),r.activeColumnId===e.id&&this.element.find(".content").addClass("is-active"),s.columnMetadata.isAttendance()&&!r.attendanceIsAvailable&&(this.toolAvailable=!1)})),s.$on(h.a.FOCUSIN_CELL,((e,t)=>{t.columnId===this.col.id&&(this.gradeGridRebornController.getElement().find(".is-active").removeClass("is-active"),this.toolAvailable&&this.element.find(".content").addClass("is-active"))})),s.$on(h.a.FOCUSOUT_CELL,((e,t)=>{t.columnId===this.col.id&&this.element.find(".content").removeClass("is-active")})),s.$on(p.b.CELL_FOCUSED,(()=>{n.find(".content").focus()})),n.find(".content").on("keydown",(t=>{if(t.keyCode===m.g)this.scope.$emit(p.b.LEAVE_GRID);else{if(!m.y(t))return;e(t.target).click()}t.preventDefault(),t.stopPropagation()})),n.find(".content").on("keyup",(e=>{m.y(e)&&(e.preventDefault(),e.stopPropagation())}))}initializeEventHandler(){this.element.find(".content-header-bg").focusin((()=>{this.focusin()})).focusout((()=>{this.focusout()}))}focusin(){this.rootScope.$broadcast(h.a.FOCUSIN_CELL,{columnId:this.col.id})}focusout(){this.rootScope.$broadcast(h.a.FOCUSOUT_CELL,{columnId:this.col.id})}get possible(){if(this.scope.columnMetadata&&!o.isUndefined(this.scope.columnMetadata.possible))return Math.round(100*this.scope.columnMetadata.possible)/100}popupMenu(t){const s=`grade-grid-column-header-menu-reborn-${this.col.id}`,n=this.grade.canPostGrades(this.col.gridData.course,this.col.data);if((!this.isGroupContent()||this.hasEntitlementsToViewGroups())&&!this.gradeGridRebornController.isMenuExisting(s)&&this.toolAvailable){const i=e(t.target).closest(".grade-grid-header-cell").offset();i.top+=87,this.menuScope.col=this.col,this.menuScope.grade=this.grade,this.menuScope.canPostGrades=n,this.menuScope.autoDestroy=!1,this.menuScope.adjustPosition=e=>{const t=i.left+e.width(),s=this.gradeGridRebornController.getGradeGridContainerElementRight();t>s&&(i.left-=t-s+Object(f.a)()),e.offset(i)},this.gradeGridRebornController.popupMenu(s,g,this.menuScope),this.timeout((()=>{const e=this.gradeGridRebornController.getPopupMenu();e.on("keydown",(t=>{t.keyCode===m.g||t.keyCode===m.u?(e.data("destroy")(),this.scope.$emit(p.b.CELL_FOCUSED),t.preventDefault(),t.stopPropagation()):m.y(t)&&this.scope.$emit(p.b.CELL_FOCUSED)})),this.gradeGridRebornController.getMenuitems().first().focus()}),this.menuScope,0,!1),t.preventDefault(),t.stopPropagation()}}hasEntitlementsToViewGroups(){return this.col&&this.entitlementService.isEntitled(C.n.ViewGroups,this.col.getCourse().id)}isGroupContent(){return this.col&&this.col instanceof v.g&&null!==this.col.groups||this.col.data&&this.col.data.groupContent}isRestricted(){return!!this.isGroupContent()&&!this.hasEntitlementsToViewGroups()}getToolTipTemplate(){return'<ul class="complex-tooltip-list conditional-release-tooltip"> <li bb-translate>components.directives.grade.grader-column.restrictedInfo</li> </ul>'}getSchemaText(){let e="components.directives.grade.grid.points.plural";if(this.scope.columnMetadata&&this.scope.columnMetadata.isScorm()){const t=this.scope.columnMetadata.ui&&this.scope.columnMetadata.ui.content||null,s=t&&t.getScormGradebookItems()||[],n=s&&s.find((e=>e.columnId===this.scope.columnMetadata.id));e=`course.content.scorm.settings.gradeSchema.${n&&n.scoringMethod&&n.scoringMethod.toString().toLowerCase()||"score"}Overview.plural`}return this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:e,params:{point:this.possible,count:this.possible},noWrap:!0})}}O.$inject=["$rootScope","scope","element","attrs","$compile","gradeGridRebornController",l.k,d.b,a.serviceName,u.b],Object(n.__decorate)([Object(S.d)("possible","locale","columnMetadata.scoreProviderHandle")],O.prototype,"getSchemaText",null);class A{constructor(e){this.$injector=e,this.restrict="E",this.template=b,this.scope=!0,this.require=`^${r.a}`,this.link=(e,t,s,n)=>{e.gradeGridColumnHeaderReborn=this.$injector.instantiate(O,{scope:e,element:t,attrs:s,gradeGridRebornController:n})}}}A.$inject=["$injector"],i.module(y,[c.a]).directive("bbGradeGridColumnHeaderReborn",["$injector",e=>e.instantiate(A)])}).call(this,s("71td"))},kQ1d:function(e,t){e.exports='<bb-ui-question-grade-pill\n  grade="questionGrade.initValue"\n  points-possible="questionGrade.pointsPossible"\n  is-disabled="questionGrade.isDisabled()"\n  save="questionGrade.save"\n  id="questionGrade.scope.inputId"\n>\n</bb-ui-question-grade-pill>\n'},kjyA:function(e,t,s){"use strict";s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return r}));var n=s("D57K"),i=(s("Llzl"),s("aHpC")),o=s("lEL+");const a="debounceServiceModule",r="debounceService";let c=class{constructor(e){this.$timeout=e}asDebounced(e,t,s){let n;return(...i)=>{n&&this.$timeout.cancel(n),n=this.$timeout((()=>{n=null,e(...i)}),t,s)}}};c=Object(n.__decorate)([Object(n.__param)(0,Object(i.b)(o.b))],c);angular.module(a,[o.a]).service(r,class extends c{})},kkz3:function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu student-card" tabindex="-1">\n  <div class="student-info">\n    <bb-user-avatar class="avatar" user="user"></bb-user-avatar>\n    <div class="info">\n      <bb-username class="ellipse username" user="user" auto-update="true" title="{{fullName}}" ng-class="{ inactive: !isUserCourseAvailable }"></bb-username>\n      <div class="profile ellipse" ng-if="user.userName && !user.studentId" title="{{user.userName}}">{{user.userName}}</div>\n      <div class="profile ellipse" ng-if="!user.userName && user.studentId" title="{{user.studentId}}" bb-translate translate-values="{ studentId: user.studentId }">components.directives.usercard.studentId</div>\n      <div class="profile ellipse" ng-if="user.userName && user.studentId" title="{{user.studentId}}" bb-translate translate-values="{ username: user.userName, studentId: user.studentId }">components.directives.usercard.usernameAndId</div>\n      <div class="profile" ng-bind="courseRole"></div>\n    </div>\n  </div>\n</div>\n'},"kp/p":function(e,t,s){"use strict";(function(e){s.d(t,"c",(function(){return v})),s.d(t,"b",(function(){return f})),s.d(t,"a",(function(){return w}));var n=s("Llzl"),i=s("0JpG"),o=s("TnpK"),a=s("hkqm"),r=s("sgjL"),c=s("lEL+"),l=s("g66W"),d=s("12mu"),u=s("Oyr+"),p=s("o5Lu"),m=s("WAgA"),h=s("o9hD"),b=s("NZ4S"),g=s("0BVo");const v="ultra.features.course.grades.gradesUploadSettings.controller",f="refresh-after-upload";class w{constructor(t,s,n,i,o,a,r,c,d,p,m){this.$scope=t,this.$rootScope=s,this.postMessageDispatcher=n,this.timeoutService=i,this.course=o,this.ultraState=a,this.toast=r,this.modalService=c,this.contentCollectionAvailability=d,this.bbLocalize=p,this.grade=m,this.confirmedToClose=!1,this.fileName="",this.hasDroppedClass=!1,this.selectAll=!1,this.showErrorDetail=!1,this.afterImported=!1,this.showContentCollection=!1,this.uploadErrorFileTypeTemplate=b,this.invalidUserNames="",this.invalidUserNamesCount=0,this.failedItems="",this.failedItemsCount=0,t.gradesUploadSettings=this,this.showContentCollection=this.contentCollectionAvailability.toolEnabledSetting.isAvailable,this.modalScope=this.$rootScope.$new(),t.$on(u.e,((t,s,n,i)=>{if(i===u.c.Uploaded){this.source="LOCAL";const t={source:this.source,name:n.fileName,location:n.fileLocation};this.parseUploadGradebook(t),e(".upload-gradebook-panel .help-link").focus()}})),this.postMessageDispatcher.registerEventHandler("classic-picker-submit",(e=>{const t=e.items[0];if(!/(\.xls|\.csv)$/i.exec(t.linkTitle))return this.showErrorModal(b),!1;this.source="CONTENT_COLLECTION";const s=t&&t.url||"",n=s.substr(s.lastIndexOf("/")),i={source:this.source,name:t.linkTitle||"",location:n};this.parseUploadGradebook(i)}),this.$scope),this.postMessageDispatcher.registerEventHandler("classic-picker-cancel",((e,t)=>{this.timeoutService((()=>{l.d(this.ultraState.current.name,"peek.content-collection-picker")&&this.closePanel(),window!==t&&t.close()}),this.$scope,0)}),this.$scope),this.uploadAction=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:"course.grades.grades-upload-settings.upload"}),this.completedModalTitleKey=(this.course.isOrganization?"course":"organization")+".grades.grades-upload-settings.courseComplete.title",this.registerStateChangeListener()}parseUploadGradebook(e){this.course.gradebook.parseUploadedGradebook(e).then((t=>{if(400===t.$response.status)return this.showErrorModal(m),!1;this.timeoutService((()=>{l.d(this.ultraState.current.name,"peek.content-collection-picker")&&this.closePanel()}),this.$scope,0),this.hasDroppedClass=!0,this.invalidUserNames=t.invalidUserNames,this.invalidUserNamesCount=this.invalidUserNames&&this.invalidUserNames.split(",").filter((e=>e.trim())).length,this.fileName=e.name,this.changedList=t.changedList,this.selectAll=!0,this.checkAll(!0)}))}checkAll(e){this.columnList=[],this.errorColumnList=[],n.forEach(this.changedList,(t=>{if(!t.columnTitle)return!1;t.isError?(t.message.languageKey=t.message.languageKey.replace(/\./g,"_"),t.message.params&&this.getColumnErrorMessage(t.message),t.message.translatedLanguageKey=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.$scope),key:t.message.languageKey,params:{data:t.message.detailErrorMessageKey},noWrap:!0,noEscape:!0}),this.errorColumnList.push(t)):(t.checked=e,t.clearGradeOption=t.needOverrideAndAttemptsChoices?"OVERRIDE":"DO_NOTHING",this.updateColumnList(t,t.checked))}))}updateColumnList(e,t){t?this.columnList.push(e):this.columnList.splice(this.columnList.indexOf(e),1)}validate(){return this.columnList&&this.columnList.length>0}cancelClicked(){this.closePanel()}chooseDestination(){this.ultraState.goPeekState("content-collection-picker",{pickerType:"File",multi:"false"})}closePanel(){this.ultraState.leavePeekState(this.ultraState.current.name)}deleteFile(){this.hasDroppedClass=!1,this.columnList=[],this.changedList=[],this.errorColumnList=[],this.selectAll=!1}showErrorModal(e){this.modalService.open({scope:this.modalScope,template:e})}confirmToClose(){this.confirmedToClose=!0,this.ultraState.leavePeekState(this.ultraState.current.name)}registerStateChangeListener(){this.stateChangeListener=this.$scope.$on("$stateChangeStart",((e,t,s,n,i)=>{t.name.indexOf("grade-upload-setting")<0&&this.hasDroppedClass&&!this.afterImported&&(this.confirmedToClose||(e.preventDefault(),this.$scope.$broadcast("show-confirmation","grades-upload-setting")))}))}importGradebook(e){if(this.invalidUserNames&&!e)return this.$scope.$broadcast("show-confirmation","grades-upload-continue-with-errors"),!1;const t={changedList:this.columnList};this.course.gradebook.importGradebook(t).then((e=>{if(this.afterImported=!0,"bb-rest-course-is-closed"===e.$response.data.code)return this.showErrorModal(h),!1;e.errorItem?(this.modalScope.failedItems=e.errorItem,this.modalScope.failedItemsCount=e.errorItem&&e.errorItem.split(",").filter((e=>e.trim())).length,this.showErrorModal(g),this.ultraState.leavePeekState(this.ultraState.current.name)):(this.$rootScope.$broadcast(f,e.savedItemsIds),this.ultraState.leavePeekState(this.ultraState.current.name),this.toast.show({messageKey:"course.grades.grades-upload-settings.complete",icon:"icon-check",toastStatus:"success"}))}))}getColumnErrorMessage(e){e.params[0].rawValue?e.detailErrorMessageKey=e.params[0].rawValue:e.params.forEach((t=>{e.languageKey===t.localizableMessage.languageKey.replace(/\./g,"_")&&(e.detailErrorMessageKey=t.localizableMessage.params?t.localizableMessage.params[0].rawValue:"")}))}}w.$inject=["$scope","$rootScope",r.b,c.b,"currentCourse",o.d,a.b,d.b,"contentCollectionAvailability",i.serviceName,p.k]}).call(this,s("71td"))},lEWr:function(e,t){e.exports='<div class="input-wrapper">\n  <input translate-attrs-values="{userName: gradeGridCellEditorReborn.userName}"\n        bb-translate-attrs="{\'aria-label\': \'components.directives.grade.grid.scoreInputAriaLabel\'}"\n        ng-blur="gradeGridCellEditorReborn.onInputBlur($event)" \n        placeholder="--" ng-model="gradeGridCellEditorReborn.score"\n        ng-click="gradeGridCellEditorReborn.stopPropagation($event)"\n        ng-change="gradeGridCellEditorReborn.onChange()"\n        aria-describedby="totalPoints"\n        ng-keydown="gradeGridCellEditorReborn.onKeydown($event)" spellcheck="false" autocomplete="off"\n        analytics-id="components.directives.grade.gradeGridCellEditorReborn.input.text" />\n</div>\n<div class="possible-wrapper" ng-mousedown="gradeGridCellEditorReborn.mousedown()">\n  <span class="slash"></span><span id="totalPoints" class="possible" ng-bind="col.data.possible"></span>\n</div>'},lwNT:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-lock",use:"icon-small-lock-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-lock"><path d="M3 8h10v7H3V8zM5 8V4c0-1.5 1-3 3-3m0 0c.5 0-.5 0 0 0zm0 0c2 0 3 1.5 3 3v4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},lx16:function(e,t,s){"use strict";s("zhNR"),s("JzsJ"),s("VCKY"),s("BiyI"),s("jlIo"),s("qzMN"),s("2i58"),s("Ybms"),s("wKTs"),s("vgq2");var n=s("Llzl"),i=s("dCrD");class o extends i.a{}class a extends i.a{}var r=s("D57K"),c=s("ERkP"),l=s("Sa5G"),d=s("aHpC"),u=s("c7N/"),p=s("9hVN"),m=s("0x+l");let h=class extends i.a{constructor(e,t,s){super(e,t,s),this.canEditUnsafeHtml=!1,this.isCloudServiceAvailable=!1,this.initializeItems=()=>{this.items=[{key:"addText",className:"js-add-content",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button.addContent"}),icon:c.createElement(m.Notes,null),onClick:this.addTextBlock}],this.canEditUnsafeHtml&&this.items.push({key:"addHtml",className:"js-add-html",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button.addHtml"}),icon:c.createElement(m.Editor,null),onClick:this.addHtmlBlock}),this.items.push({key:"addLocalFile",className:"js-add-local-file",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button."+(this.isMobile?"uploadFromDevice":"uploadFromComputer")}),icon:c.createElement(m.UploadFile,null),onClick:this.uploadLocalFile}),this.items.push({key:"browseContentCollectionFile",className:"js-browse-content-collection-file",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"course.contentCollection.browseContentCollection"}),icon:c.createElement(m.ContentCollection,null),onClick:this.browseContentCollection}),this.isCloudServiceAvailable&&this.items.push({key:"addCloudFile",className:"js-add-cloud-file",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.add-content-button.uploadFromCloudStorage"}),icon:c.createElement(m.UploadCloud,null),onClick:this.uploadCloudFile})},this.addTextBlock=()=>{this.scope.$emit("bb-bbml-editor-add-block",l.c.Text,this.getInsertLocationData())},this.addHtmlBlock=()=>{this.scope.$emit("bb-bbml-editor-add-block",l.c.Html,this.getInsertLocationData())},this.uploadLocalFile=()=>{this.element.find(".file-upload-button").click()},this.uploadCloudFile=()=>{this.element.find(".js-upload-from-cloud-storage-integration").click()},this.browseContentCollection=()=>{this.rteCollectionService.handleContentCollectionResponse(this.scope,this.getInsertLocationData()),this.ultraState.goPeekState("content-collection-picker",{pickerType:"File",multi:"true"})},this.focusAddButton=()=>{this.element.find("button").focus()},this.$q=e.get("$q"),this.unsafeHtmlService=e.get(u.b),this.rteCollectionService=e.get(p.b),this.initialize()}initialize(){return this.$q.all({canEditUnsafeHtml:this.unsafeHtmlService.canEditUnsafeHtml(),isCloudServiceAvailable:this.isCloudServiceAvailablePromise}).then((({canEditUnsafeHtml:e,isCloudServiceAvailable:t})=>{this.canEditUnsafeHtml=e,this.isCloudServiceAvailable=t})).finally(this.initializeItems)}};h.$inject=[],h=Object(r.__decorate)([Object(r.__param)(0,Object(d.b)("$injector")),Object(r.__param)(1,Object(d.b)("scope")),Object(r.__param)(2,Object(d.b)("element"))],h);var b=s("HjsN");class g extends i.a{addGroup(){this.toggleMenu();const e=this.scope.positionBefore?this.scope.positionBefore():this.scope.positionAfter()+1;this.scope.createFunction(e),this.closeMenu()}}var v=s("tfx2");const f="addAttendance";let w=class extends i.a{constructor(e,t,s){super(e,t,s),this.scope=t,this.element=s;const n=s.closest("[data-base-state-name]").data("baseStateName");this.$q.all([this.ultraState.peekHref("grade-item.create",this.getInsertLocationData(),n),this.ultraState.peekHref("gradebook-item.calculation",this.getInsertLocationData(),n),this.ultraState.peekHref("attendance",null,n)]).then((e=>{this.attendanceHref=e[2],this.items=[{key:"addGradebookItem",href:e[0],className:"doc-add-grade",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.actions.addItem"}),icon:c.createElement(m.Add,null)},{key:"addCalculation",href:e[1],className:"doc-add-calc",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.actions.addCalculation"}),icon:c.createElement(m.Calculation,null)}],this.addOrRemoveAddAttendanceMenuItem()})),t.$on("always-show-time-expires",(()=>{t.addContentButton.alwaysShow=!1})),t.$on("update-content-menu",(()=>{this.items&&this.addOrRemoveAddAttendanceMenuItem()}))}addOrRemoveAddAttendanceMenuItem(){const e=null==this.scope.showAddAttendance||!this.scope.showAddAttendance(),t=this.doesMenuItemExistByKey(f);e?this.removeMenuItemByKey(f):t||this.addAttendanceMenuItem()}doesMenuItemExistByKey(e){return this.items.some((t=>t.key===e))}removeMenuItemByKey(e){this.items=this.items.filter((t=>t.key!==e))}addAttendanceMenuItem(){this.items.push({key:f,href:this.attendanceHref,className:"doc-add-attendance",name:this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.actions.addAttendance"}),icon:c.createElement(m.Attendance,null)})}};w.$inject=[],w=Object(r.__decorate)([Object(r.__param)(0,Object(d.b)("$injector")),Object(r.__param)(1,Object(d.b)("scope")),Object(r.__param)(2,Object(d.b)("element"))],w);var S=s("J8YL"),C=s("tTiy"),y=s("1Niw"),O=s("UeHE"),A=s("9hp7"),I=s("SE1T"),D=s("6xt4"),k=s("07HN");class _{constructor(e){this.$injector=e,this.handlersAndTemplateTexts={assignment:{handler:o,templateText:S},attempts:{handler:a,templateText:C},"bbml-editor":{handler:h,templateText:y},"cloud-upload":{handler:b.b,templateText:O},"course-group":{handler:g,templateText:I},"course-outline":{handler:v.a,templateText:D},grades:{handler:w,templateText:k}}}getTemplateText(e){if(null==e||!(e in this.handlersAndTemplateTexts))throw new Error("valid contextArea must be provided");if(null==this.handlersAndTemplateTexts[e].templateText)throw new Error("No template for context area: "+e);return A.replace("<template></template>",this.handlersAndTemplateTexts[e].templateText)}getHandler(e,t,s){if(null==e||!(e in this.handlersAndTemplateTexts))throw new Error("valid contextArea must be provided");return this.$injector.instantiate(this.handlersAndTemplateTexts[e].handler,{scope:t,element:s})}}_.$inject=["$injector"];var j=s("2E9T"),T=s("+e2k");const $="ultra.components.directives.content.buttonAddContent";class R{constructor(){this.restrict="C",this.template=j}}R.$inject=["$injector"],n.module($,[T.a]).directive("buttonAddContent",["$injector",e=>e.instantiate(R)]);var E=s("0JpG"),x=s("/z4E"),P=s("H/mg"),L=s("nYZ0"),G=s("jx5I"),M=s("3Jgm"),N=s("TnpK"),F=s("zYa8"),B=s("wtdm");const q="ultra.components.directives.bbUiIcon.small.ContentMarket";Object(F.a)(B.ContentMarket,q,"bbUiIconSmallContentMarket"),s.d(t,"a",(function(){return z}));const z="ultra.directives.addContentButton";class U{constructor(e,t,s){this.$injector=e,this.$rootScope=t,this.ultraState=s,this.compiled=Object.create(null),this.restrict="E",this.scope={attachHandler:"=?",disableDrag:"&?",content:"=",createFunction:"=?",hideDividerLines:"&?",rootContent:"&?",contextArea:"=",alwaysShow:"=",showAddAttendance:"&?",showBothButtons:"&?",isDocumentSaved:"&?",showMenuOverride:"=",positionBefore:"&?",positionAfter:"&?",parentId:"&",depth:"&",canCreateAllContents:"=?",canCopyImport:"=?",folderNestedButton:"&?",fileLocation:"@?",webLocation:"@?",initialUpload:"&?",primaryKey:"&?",ignoredStates:"&?",itemName:"&?",itemType:"&?",itemIndex:"&?",isButtonLocationChangable:"<?",isRenderByDefault:"&?"},this.compile=()=>(e,t)=>{let s;s=e.contextArea?e.contextArea:e.$parent.contextArea?e.$parent.contextArea:"course-outline";const n=this.$injector.instantiate(_,{});null==this.compiled[s]&&(this.compiled[s]=this.$injector.get("$compile")(n.getTemplateText(s))),e.addContentButton=n.getHandler(s,e,t),e.fileListViewId="fileListView-"+Math.floor(1e4*Math.random())+"-"+Math.floor(1e4*Math.random()),e.fileListViewLocalId=e.fileListViewId+"Local",this.compiled[s](e,(function(e,s){t.append(e)})),this.$rootScope.$broadcast("add-content-button-ready")}}}U.$inject=["$injector","$rootScope",N.d,L.f,p.b],n.module(z,["ngAnimate",$,x.a,E.moduleName,P.a,L.d,p.a,G.a,M.a,N.b,u.a,q]).directive("bbAddContentButton",["$injector",e=>e.instantiate(U)])},m2KQ:function(e,t){e.exports='<div class="grade-input-wrapper" ng-class="{\'has-validation-error\': !!gradeInput.form[gradeInput.id].$invalid}">\n  <div ng-attr-id="{{hasRubricClearConfirmationCallout ? \'grade-input-container-callout\' : \'\'}}" ng-class="{\'grade-input-align\': gradeInput.shouldShowPastDueZeroIndicator(), \'left\': !gradeInput.shouldShowPastDueZeroIndicator()}">\n    <bb-inline-validation\n      show-error="!!gradeInput.form[gradeInput.id].$invalid"\n      bb-translate-attrs="{ \'error-message\': errorMessageKey }"\n      ng-show="gradeInput.shouldShowInput()">\n      <div ng-class="{\'show-total\': gradeInput.shouldShowTotalPoints(), \'is-multiple\': gradeInput.isMultipleShown(), \'is-in-progress\': gradeInput.isInProgressShown(), \'group-grade-input\': !!forGroup}"\n           class="wrapping-input-style" data-dropdown="performanceCodes-{{gradeInput.id}}">\n        <div bb-foundation-defer>\n          <div class="wrapping-editable-input">\n            <bb-svg-icon size="small" icon="rubric" ng-if="gradeInput.isRubricEvalMode() && gradeInput.shouldShowInput()"></bb-svg-icon>\n\n            <input name="{{gradeInput.id}}" autocomplete="off" ng-class="{\'group-multiple\': gradeInput.isMultipleShown(), \'group-in-progress\': gradeInput.isInProgressShown()}"\n                pu-elastic-input pu-elastic-input-minwidth="10px" pu-elastic-input-maxwidth="180px"  pu-elastic-input-width-delta="8"\n                type="text" placeholder="--"\n                bb-translate-attrs="{ \'aria-label\': gradeInput.getGradeInputAriaLabelKey() }"\n                translate-attrs-values="{ user: forUser, group_name: forGroup && forGroup.title, grade: gradeInput.gradeDisplayItem.displayValue, total: gradeDetail.pointsPossible || (column.isCalculated() ? 100 : column.possible)}"\n                ng-model="gradeInput.gradeDisplayItem.displayValue" ng-readonly="gradeInput.isReadOnly()"\n                title="{{gradeInput.gradeDisplayItem.perfCodeDesc}}"\n                ng-blur="gradeInput.onBlur($event)" ng-change="gradeInput.gradeValueOnChange()" ng-focus="gradeInput.onFocus()"\n                class="js-grade-input" analytics-id="directives.grade-input.grade.display.item.input"\n                aria-invalid="{{!!gradeInput.form[gradeInput.id].$invalid ? \'true\' : \'false\'}}"\n                aria-describedby="{{!!gradeInput.form[gradeInput.id].$invalid ? gradeInput.getAriaDescribeById(): undefined}}">\n\n            <bb-confirmation-callout-dialog\n              ng-if="hasRubricClearConfirmationCallout"\n              analytics-id="directives.grade-input.grade.clearRubricConfirmation"\n              target="\'#grade-input-container-callout\'"\n              is-visible="gradeInput.gradeDialog.isVisible"\n              text-content="gradeInput.gradeDialog.textContent"\n              on-dismiss="gradeInput.gradeDialog.onDismiss"\n              on-success="gradeInput.gradeDialog.onSuccess"\n            >\n            </bb-confirmation-callout-dialog>\n         </div>\n\n        </div>\n\n        \x3c!--TOTAL POINTS--\x3e\n        \x3c!-- Fix ULTRA-15280.\n        If there is gradeDetail, we should use its pointsPossible as the total.\n        If there is no gradeDetail, which means it is not graded yet, there are tow cases:\n         for overall grade (and calculations), we use the default value 100, unless the overall grade schema is ScoreBased\n         for common column, assignment, etc. we use column.possible. --\x3e\n        <span ng-if="gradeInput.shouldShowTotalPoints()" class="points-text" bb-translate\n              translate-values="{total: gradeInput.getTruncatedPointsPossible()}">\n        components.directives.grade.grade-input.points\n        </span>\n      </div>\n      <div class="alert-icon" ng-if="!!gradeInput.form[gradeInput.id].$invalid">\n        <bb-svg-icon size="small" icon="attention" status="alert"></bb-svg-icon>\n      </div>\n    </bb-inline-validation>\n    <a ng-show="!gradeInput.shouldShowInput()" class="button super-clear has-rubric wrapping-input-style"\n       ng-class="{\'show-total\': gradeInput.shouldShowTotalPoints(), \'is-multiple\': gradeInput.isMultipleShown(), \'is-in-progress\': gradeInput.isInProgressShown(), \'group-grade-input\': !!forGroup, \'disable-click\': disableRubricEvalClick()}"\n       ng-click="gradeInput.openRubricEvaluation()"\n       aria-disabled="{{disableRubricEvalClick()}}"\n       href="javascript:void(0);" analytics-id="directives.grade-input.rubric.evaluation.link">\n      <span class="sr-only" bb-translate translate-values="{user: forUser}">components.directives.grade.grade-input.rubricButtonAlt</span>\n      <bb-svg-icon size="small" icon="rubric"></bb-svg-icon>\n      <span name="{{gradeInput.id}}" class="grade-point-value" ng-class="{\'group-multiple\': gradeInput.isMultipleShown(), \'group-in-progress\': gradeInput.isInProgressShown()}">\n        {{gradeInput.gradeDisplayItem.displayValue || \'--\'}}&nbsp;\n      </span>\n\n      \x3c!--TOTAL POINTS--\x3e\n      <span ng-if="gradeInput.shouldShowTotalPoints()" class="points-text" bb-translate\n            translate-values="{total: gradeDetail.pointsPossible || (column.isCalculated() ? 100 : column.possible)}">\n        components.directives.grade.grade-input.points\n      </span>\n    </a>\n  </div>\n\n  <div ng-if="gradeInput.shouldShowOverrideIndicator()" class="left">\n    <span class="override-indicator" bb-translate>components.directives.grade.grade-input.overrideIndicator</span>\n  </div>\n\n  <div ng-if="gradeInput.shouldShowPastDueZeroIndicator()" ng-class="{\'grade-input-align left\': gradeInput.shouldShowPastDueZeroIndicator(), \'left\': !gradeInput.shouldShowPastDueZeroIndicator()}">\n    <span class="override-indicator" bb-translate>components.directives.grade.grade-input.pastDueZero</span>\n  </div>\n\n  <div ng-if="gradeInput.alertScreenReaderNewGrade"\n        bb-ax-alert\n        id="gradeInput.getAriaDescribeById()"\n        class="sr-only"\n        bb-translate translate-values="{grade: gradeInput.gradeDisplayItem.displayValue}">\n    components.directives.grade.grade-input.screenReaderEnteredGrade\n  </div>\n</div>\n'},m5Qz:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("Llzl"),i=s("1ZbL"),o=s("0JpG"),a=s("/5AG");const r="ultra.course.content.outline.react.contentitem.description",c={Class:a.ContentItemDescription,renderLocalized:!0,withProvider:!0,bindingNames:["description"]};n.module(r,[o.moduleName]).component("bbCourseContentItemDescription",Object(i.a)(c))},mCEN:function(e,t,s){"use strict";var n=s("D57K"),i=s("yC9S"),o=s("aHpC"),a=s("0JpG"),r=s("ckcj"),c=s("zYa8"),l=s("me+T");const d="ultra.components.directives.bbUiIcon.large.Attendance";Object(c.a)(l.Attendance,d,"bbUiIconLargeAttendance");var u=s("pWJj"),p=s("cXGx");const m="ultra.components.directives.bbUiIcon.large.Calculation";Object(c.a)(p.Calculation,m,"bbUiIconLargeCalculation");var h=s("o/Pg"),b=s("MlM1");const g="ultra.components.directives.bbUiIcon.large.DocumentBlank";Object(c.a)(b.DocumentBlank,g,"bbUiIconLargeDocumentBlank");var v=s("06yj"),f=s("xMZ0"),w=s("rRc3"),S=s("K16Q");const C="ultra.components.directives.bbUiIcon.large.Homework";Object(c.a)(S.Homework,C,"bbUiIconLargeHomework");var y=s("r7jL");const O="ultra.components.directives.bbUiIcon.large.Photo";Object(c.a)(y.Photo,O,"bbUiIconLargePhoto");var A=s("F2PN"),I=s("9V5A"),D=s("P/1j"),k=s("dha+"),_=s("y8aX");const j="ultra.components.directives.bbUiIcon.large.OverallGrade";Object(c.a)(_.OverallGrade,j,"bbUiIconLargeOverallGrade");var T=s("i+uu");const $="ultra.components.directives.bbUiIcon.large.Pdf";Object(c.a)(T.Pdf,$,"bbUiIconLargePdf");var R=s("k6dK");const E="ultra.components.directives.bbUiIcon.large.Presentation";Object(c.a)(R.Presentation,E,"bbUiIconLargePresentation");var x=s("7zkF"),P=s("X4V6"),L=s("4uUs"),G=s("59Vg"),M=s("Uw7Y");const N="ultra.components.directives.bbUiIcon.large.Video";Object(c.a)(M.Video,N,"bbUiIconLargeVideo");var F=s("FvSu");const B="ultra.components.directives.bbUiIcon.large.Audio";Object(c.a)(F.Audio,B,"bbUiIconLargeAudio");var q=s("jT78"),z=s("k12r"),U=s("FH9J");s.d(t,"a",(function(){return V}));const V="ultra.components.directives.bbUiContentIcon";let H=class{constructor(e,t){this.$scope=e,this.localize=t}$onChanges(){this.setTitleAccess()}setTitleAccess(){this.notDecorative&&this.icon&&(this.titleAccess=this.localize.translateSync({key:`components.directives.element-image.element-image-accessibility.img-icon-${this.icon}`,locale:this.localize.getLocale(this.$scope)}))}};H=Object(n.__decorate)([Object(i.a)({moduleName:V,componentName:"bbUiContentIcon",bindings:{icon:"<",color:"@?",notDecorative:"<?"},template:U,requireModules:[a.moduleName,h.a,r.a,d,B,u.a,m,h.a,g,v.a,f.a,w.a,C,A.a,I.a,D.a,k.a,j,$,O,E,x.a,P.a,L.a,G.a,N,q.a,z.a]}),Object(n.__param)(0,Object(o.b)("$scope")),Object(n.__param)(1,Object(o.b)(a.serviceName))],H)},mJUP:function(e,t,s){"use strict";s.r(t),s.d(t,"controllerName",(function(){return u})),s.d(t,"AssessmentAttemptController",(function(){return p})),s.d(t,"Controller",(function(){return m}));var n=s("D57K"),i=(s("s5UK"),s("xjJw"),s("ZKRZ"),s("dpCN"),s("JbSi"),s("TR8k"),s("D1Wg"),s("sZYy"),s("v0wN"),s("QhTW"),s("w9Zy")),o=s("TnpK"),a=s("Y+9S"),r=s("rNTV");s.d(t,"template",(function(){return r}));var c=s("nmzr"),l=s("0JpG"),d=s("aHpC");const u="ultra.features.course.content.assessment.attempt.assessmentAttempt.controller";let p=class{constructor(e,t,s,n,i,o,r,c){this.$rootScope=e,this.$scope=t,this.attempt=s,this.contentData=n,this.course=i,this.bbOffcanvas=o,this.ultraState=r,this.bbLocalize=c,t.assessmentAttempt=this,Object(a.isInMobileApp)()&&this.notifyMobileApp()}notifyMobileApp(){const e=this.bbLocalize.getLocale(this.$scope),t=this.bbLocalize.translateSync({key:this.contentData.gradingColumn.gradebookCategory.title,locale:e}),s={type:a.MessageType.AttemptOpened,status:a.MessageStatus.Success,contentId:this.contentData.courseContent.id,pageTitle:t,permission:{showDetail:!0}},n=Object(a.registerMobileEventHandler)(s);n.response.subscribe((e=>{e.event===a.EventType.GotoDetail&&this.ultraState.goPeekState(c.AssessmentRoutes.ASSESSMENT_DETAILS)})),this.$scope.$on("$destroy",(()=>{Object(a.clearMobileEventHandler)(n.correlationId)}))}returnToOverview(){return this.ultraState.goPeekState("assessment.overview").then((()=>{this.bbOffcanvas.shrinkTopPanel(),this.$rootScope.$broadcast("bb-assessment-attempt-save",this.attempt,this.contentData.gradingColumn.id,!!this.contentData.courseContent.isGroupContent)}))}};p=Object(n.__decorate)([Object(n.__param)(0,Object(d.b)("$rootScope")),Object(n.__param)(1,Object(d.b)("$scope")),Object(n.__param)(2,Object(d.b)("attempt")),Object(n.__param)(3,Object(d.b)("contentData")),Object(n.__param)(4,Object(d.b)("currentCourse")),Object(n.__param)(5,Object(d.b)(i.e)),Object(n.__param)(6,Object(d.b)(o.d)),Object(n.__param)(7,Object(d.b)(l.serviceName))],p);class m extends p{}},mWXo:function(e,t){e.exports='\n<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu">\n  <ul ng-if="gradeGridColumnOverallReborn.gradeDetail.displayGrade.isOverride || col.gradeNotations.length" class="f-dropdown f-dropdown-overflow-menu reborn-dropdown performance-code-options show notation-no-border notation-max-height " role="menu">\n\n    <li ng-if="col.gradeNotations.length" class="performance-option-header">\n        <span bb-translate>components.directives.grade.grade-input.selectPerformanceCode</span>\n    </li>\n    <li ng-repeat="notation in col.gradeNotations" class="performance-code-option">\n      <a role="menuitem"\n         ng-click="gradeGridColumnOverallReborn.selectNotation(notation)"\n         href="javascript:void(0);"\n         analytics-id="components.directives.grade.grid.notation.link">\n        <span class="code" aria-label="{{notation.code}}">{{notation.code}}</span>\n        <span class="description notation-description-max-width" aria-label="{{notation.description}}">{{notation.description}}</span>\n      </a>\n    </li>\n    <li ng-if="gradeGridColumnOverallReborn.gradeDetail.displayGrade.isOverride" class="undo-override">\n      <a role="menuitem"\n         ng-click="gradeGridColumnOverallReborn.undoOverride()"\n         href="javascript:void(0);"\n         analytics-id="components.directives.grade.grade-input.undoOverride">\n        <bb-svg-icon size="small" icon="undo"></bb-svg-icon>\n        <bb-translate>components.directives.grade.grade-input.undoOverride</bb-translate>\n      </a>\n    </li>\n  </ul>\n</div>\n'},mnBQ:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("Llzl"),i=s("0JpG"),o=s("kwLz"),a=s("1ZbL");const r="ultra.components.directives.feedback.feedbackAuthoring",c={Class:o.FeedbackAuthoring,bindingNames:["analyticsId","panelTitle","panelSubtitle","primaryGraderFeedback","secondaryGradersFeedback","configProps","isInlineMode"],renderLocalized:!0};n.module(r,[i.moduleName]).component("bbFeedbackAuthoring",Object(a.a)(c))},mrqE:function(e,t,s){"use strict";function n(e,t){if(t.length<e)throw new TypeError(e+" argument"+(e>1?"s":"")+" required, but only "+t.length+" present")}s.d(t,"a",(function(){return n}))},n0bV:function(e,t,s){"use strict";s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return c}));var n=s("D57K"),i=s("aHpC"),o=s("IbyE"),a=s("9OUN");const r="ultra.components.services.grade",c="delegatedAttemptGradeAdapter";let l=class{constructor(e,t){this.$ngRedux=e,this.$q=t,this.subscribeToReduxStore()}subscribeToReduxStore(){this.$ngRedux.connect(null,(e=>Object(a.bindActionCreators)({loadGradesOnAttempt:o.actions.delegatedAttemptGrade.loadDelegatedAttemptGradesOnAttempt,loadCompletedGradesByGrader:o.actions.delegatedAttemptGrade.loadCompletedDelegatedAttemptGradesByGrader,patchGrade:o.actions.delegatedAttemptGrade.patchDelegatedAttemptGrade,toggleGradeVisibility:o.actions.delegatedAttemptGrade.toggleVisibilityOfDelegatedAttemptGrade},e)))(this)}getDelegatedAttemptGradesByGrader(e,t){return o.select.delegatedAttemptGrade.getCompletedDelegatedAttemptGradesByGrader(this.$ngRedux.getState(),e,t)}getDelegatedAttemptGradesOnAttempt(e){return o.select.delegatedAttemptGrade.getCompletedDelegatedAttemptGradesOnAttempt(this.$ngRedux.getState(),e)}getDelegatedAttemptByStagedAttemptId(e){return o.select.delegatedAttemptGrade.getDelegatedAttemptByStagedAttemptId(this.$ngRedux.getState(),e)}loadDelegatedGradesByGrader(e){return this.$q.when(this.loadCompletedGradesByGrader(e)).then((()=>this.getDelegatedAttemptGradesByGrader(e.userId,e.columnId)))}loadDelegatedGradesOnAttempt(e){return this.$q.when(this.loadGradesOnAttempt(e)).then((()=>this.getDelegatedAttemptGradesOnAttempt(e.attemptId)))}patchDelegatedGradeAttempt(e){return this.$q.when(this.patchGrade(e)).then((()=>this.getDelegatedAttemptByStagedAttemptId(e.stagedAttemptId)))}toggleDelegatedGradeVisibility(e){return this.$q.when(this.toggleGradeVisibility(e)).then((()=>this.getDelegatedAttemptByStagedAttemptId(e)))}};l=Object(n.__decorate)([Object(n.__param)(0,Object(i.b)("$ngRedux")),Object(n.__param)(1,Object(i.b)("$q"))],l);angular.module(r,[]).service(c,l)},nYkW:function(e,t){e.exports='<div class="row collapse due-date" bb-load-bundle="components/directives/due-date">\n  <div class="inline-form-row row collapse">\n    <div class="columns small-12">\n      <label bb-form-label-decorator="{required:dueDate.isMandatory}" class="date-time-label due-date-label settings-subheader" bb-translate>\n        {{::dueDate.getLabelToken()}}\n      </label>\n    </div>\n    <div class="columns small-12 date-time-inputs">\n      <div class="columns small-6">\n        <div class="due-date-input {{dueDate.container}}">\n          <input ng-model="model"\n                id="{{dueDate.dueDateId}}"\n                name="{{::dueDate.dueDateFieldName}}"\n                ng-disabled="dueDate.isDisabled"\n                ng-readonly="dueDate.isReadOnly"\n                aria-invalid="{{!dueDate.isDueDateValid}}"\n                aria-describedby="{{dueDate.dueDateId}}-date-from-error"\n                bb-translate-attrs="{\'aria-label\': \'components.directives.due-date.aria-label.dueDateDate\', \'placeholder\': \'components.directives.due-date.datePlaceholder\'}"\n                ng-attr-bb-focus="dueDate.shouldFocus()"\n                bb-validate-date\n                bb-date-picker\n                container=".{{dueDate.container}}"\n                orientation="auto left"\n                first-day-of-week="dueDate.localeSettings.calendar.firstDayOfWeek"\n                analytics-id="{{::analyticsIdTagPrefix}}.dateTime.input.date"\n                class="show-calendar-icon">\n        </div>\n      </div>\n      <div class="columns small-6">\n        <div class="time-input">\n          <bb-time-picker name="{{::dueDate.dueTimeFieldName}}"\n                               analytics-id="{{::analyticsIdTagPrefix}}.time.input.text"\n                               current-date="model"\n                               ng-model="model"\n                               on-view-value-cleared="dueDate.onViewValueCleared"\n                               disabled="dueDate.isDisabled"\n                               readonly="dueDate.isReadOnly"\n                               aria-invalid="{{!dueDate.isTimeDueDateValid}}"\n                               aria-describedby="{{dueDate.dueDateId}}-time-from-error"\n                               bb-translate-attrs="{\'aria-label\': \'components.directives.due-date.aria-label.dueDateTime\',\n                                    \'placeholder\': \'components.directives.due-date.timePlaceholder\'}">\n          </bb-time-picker>\n        </div>\n      </div>\n    </div>\n  </div>\n  \x3c!-- It appears the html renders before the dueDateFieldName is defined. If the validation messages are in the DOM\n      before the field names are present then an error is thrown and nothing renders. The ng-if is used to remove the\n      validation messages until the field name is defined allowing everything to render correctly. --\x3e\n  <div ng-if="dueDate.dueDateFieldName && dueDate.dueTimeFieldName" class="due-date-error-messages row collapse">\n    <div class="columns small-12">\n      <div bb-validation-messages id="{{dueDate.dueDateId}}-date-from-error" for="{{::dueDate.dueDateFieldName}}" immediate="true">\n        <span ng-message="date"><span bb-translate>components.directives.validation.messages.errors.date</span></span>\n        <span ng-message="overdue"><span bb-translate>components.directives.due-date.validation.dateInPast</span></span>\n        <span ng-message="overdueOnsubmit"><span bb-translate>components.directives.due-date.validation.dateInPast</span></span>\n        <span ng-transclude="customValidationMessages"></span>\n      </div>\n      <div bb-validation-messages id="{{dueDate.dueDateId}}-time-from-error" for="{{::dueDate.dueTimeFieldName}}" immediate="true">\n        <span ng-message="overdue"><span bb-translate>components.directives.due-date.validation.dateInPast</span></span>\n        <span ng-message="overdueOnsubmit"><span bb-translate>components.directives.due-date.validation.dateInPast</span></span>\n        <span ng-message="tooSoon"><span bb-translate>components.directives.due-date.validation.dateTooSoon</span></span>\n        <span ng-message="tooSoonOnsubmit"><span bb-translate>components.directives.due-date.validation.dateTooSoon</span></span>\n        <span ng-transclude="customValidationMessages"></span>\n      </div>\n    </div>\n  </div>\n</div>\n'},nfUd:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-visible",use:"icon-medium-visible-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-visible"><circle cx="12" cy="12" r="2" stroke-width="2" /><path d="M12 6C7.1067 6 1 12 1 12s6.1067 6 11 6 11-6 11-6-6.1067-6-11-6z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},nfhp:function(e,t){e.exports='<div bb-cache-compilation="assessment-feedback">\n  <div id="react-assessment-feedback-target">\n    <div ng-class="{\'panel-wrap\': !assessmentFeedback.isInlineMode}">\n      <div ng-if="assessmentFeedback.isFeedbackAuthoringPayloadLoaded">\n        <bb-feedback-authoring\n          ng-if="!assessmentFeedback.isLoading"\n          panel-title="assessmentFeedback.feedbackAuthoringPayload.panelTitle"\n          panel-subtitle="assessmentFeedback.feedbackAuthoringPayload.panelSubtitle"\n          primary-grader-feedback="assessmentFeedback.feedbackAuthoringPayload.primaryGraderFeedback"\n          secondary-graders-feedback="assessmentFeedback.feedbackAuthoringPayload.secondaryGradersFeedback"\n          config-props="assessmentFeedback.feedbackAuthoringPayload.configProps"\n          analytics-id="assessmentFeedback.feedbackAuthoringPayload.analyticsId"\n          is-inline-mode="assessmentFeedback.isInlineMode"\n        ></bb-feedback-authoring>\n      </div>\n      <div ng-if="assessmentFeedback.isLoading && !assessmentFeedback.isInlineMode" class=\'spinner bb-secondary-color-2\'></div>\n    </div>\n  </div>\n\n  <div\n    class="hide"\n    bb-confirmation-needed="x-bb-save-feedback"\n    modal-name="assessment-feedback"\n    show-type="always"\n    ng-click="assessmentFeedback.onClickSave(true, false);"\n    dismiss-callback="assessmentFeedback.closeConfirmationModalDismissed()"\n    other-choice-action="assessmentFeedback.dontSaveAction()"\n    analytics-id="course.content.assessment.assessmentFeedback.saveChanges"\n  ></div>\n</div>\n'},nsQ1:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-timer",use:"icon-small-timer-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-timer"><path d="M8 4V1c4 0 7 3.134 7 7s-3.134 7-7 7-7-3.134-7-7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M8.5 8.5l-1 1L3 4l5.5 4.5z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},nthy:function(e,t){e.exports='<bb-modal id="confirm-question-grade-save-modal"\n          class="notification"\n          modal-title-key="course.content.assessment.test.modal.repostSubmissionGradeAlert.title"\n          analytics-id-tag-prefix="course.content.assessment.test.modal.repostSubmissionGradeAlert">\n  <div name="modal-contents">\n    <p bb-translate course-org-token-resolver>course.content.assessment.test.modal.repostSubmissionGradeAlert.body</p>\n  </div>\n  <button name="modal-footer-button-primary" \n          class="button confirm-ok js-primary-button" \n          ng-click="$parent.$close()" \n          analytics-id="global.continue"\n          bb-translate>global.continue</button>\n  <button name="modal-footer-button-secondary" \n          class="button button--secondary confirm-cancel js-secondary-button" \n          ng-click="$parent.$dismiss()" \n          analytics-id="global.cancel"\n          bb-translate>global.cancel</button>\n</bb-modal>'},nvgb:function(e,t){e.exports='<div class="question-container">\n  <bb-rich-text-editor\n    ng-model="questionAttempt.question.questionText.rawText"\n    is-read-only="true"\n    supports-inline-document-render="true"\n    plugin-options="editorPluginOptions">\n  </bb-rich-text-editor>\n</div>\n'},"o/Pg":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("4iFr");const o="ultra.components.directives.bbUiIcon.large.Discussion";Object(n.a)(i.Discussion,o,"bbUiIconLargeDiscussion")},o9hD:function(e,t){e.exports='<bb-modal role="alertdialog" class="notification gradebook-upload-failed-modal upload-failed-button" bb-translate-attrs="{\'aria-label\': {{::gradesUploadSettings.completedModalTitleKey}}}"\n          modal-title-key="{{::gradesUploadSettings.completedModalTitleKey}}" aria-describedby="course-is-complete"\n          analytics-id-tag-prefix="course.grades.grades-upload-settings">\n    <div name="modal-contents">\n        <p id="course-is-complete" bb-translate="course.grades.grades-upload-settings.courseComplete.content" course-org-token-resolver></p>\n    </div>\n    <a name="modal-footer-help-link" \n       href="" \n       bb-translate-attrs="{\'href\': \'course.grades.grades-upload-settings.helpLinkCourseComplete\'}" \n       target="_blank" \n       bb-translate="course.grades.grades-upload-settings.helpButton" \n       rel="noopener noreferrer"\n       analytics-id="course.grades.grades-upload-settings.helpButton">\n    </a>\n    <button name="modal-footer-button-primary" \n            class="button js-discard-changes js-primary-button" \n            ng-click="$dismiss()"\n            analytics-id="course.grades.gradesUploadSettings.closeButton.button">\n        <span bb-translate="course.grades.grades-upload-settings.closeButton"></span>\n    </button>\n</bb-modal>'},oXbF:function(e,t){e.exports='<div class="calculated-numeric-question-container calculated-numeric-attempt-review">\n  <bb-question-attempt-review\n    ng-if="assessmentQuestion.questionAttempt.question && !assessmentQuestion.isEditing"\n    ally-service="::allyService"\n    content-id="::contentId"\n    attempt="::assessmentQuestion.questionAttempt"\n    automated-feedback-editor-plugin-options="::automatedFeedbackEditorPluginOptions"\n    is-automated-feedback-collapsible="::assessmentQuestion.allowCollapsingOfAutomatedFeedbackIfShown()"\n  ></bb-question-attempt-review>\n</div>\n'},ol3u:function(e,t){e.exports='<bb-modal class="notification"\n          modal-title-key="components.directives.cloudStorageIntegration.modal.authorizationRequiredTitle"\n          analytics-id-tag-prefix="components.directives.cloudStorageIntegration.authorizationRequired">\n  <div name="modal-contents">\n    <p bb-translate>components.directives.cloudStorageIntegration.modal.authorizationRequiredMessage</p>\n  </div>\n  <button name="modal-footer-button-primary" class="button dismiss-button js-primary-button" ng-click="$parent.$dismiss()" analytics-id="global.close">\n    <bb-translate>global.close</bb-translate>\n  </button>\n</bb-modal>\n'},ooAF:function(e,t){e.exports='<div class="grade-color">\n    <div class="wrapping-input-style readonly pill-style {{displayGradePill.colorCss}} {{displayGradePill.cursorClass}}">\n      <div ng-if="!displayGradePill.shouldShowRubricButton()">\n        <span class="grade-input-display grade-ellipsis"><bdi>{{displayGradePill.displayValue}}</bdi></span>\n      </div>\n      <div ng-if="displayGradePill.shouldShowRubricButton()">\n        <a ng-click="displayGradePill.openRubricEvaluation($event)"\n           ng-class="{\'disable-click\': !!disableRubricEvalClick()}"\n           class="grade-rubric-detail"\n           aria-disabled="{{!!disableRubricEvalClick()}}"\n           href=""\n           analytics-id="components.directives.grade.gradePill.showRubric.link">\n          <bb-svg-icon size="small" icon="rubric"></bb-svg-icon>\n          <span class="grade-input-display ready grade-ellipsis">{{displayGradePill.displayValue}}</span>\n        </a>\n      </div>\n    </div>\n</div>\n'},"p/lC":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-question-analysis",use:"icon-small-question-analysis-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-question-analysis"><path d="M11 1H5l1 2v4l-5 8h14l-5-8V3l1-2zM4.125 10h7.75" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},pF15:function(e,t){e.exports='\n<div class="filter-list-content">\n  <div class="filter-panel-container">\n    <div class="filter-panel-header">\n      <div class="filter-panel-title-wrapper">\n        <h3 class="filter-panel-title" bb-translate>components.directives.grade.filter-panel.title</h3>\n        <button type="button"\n          class="filter-panel-close-button"\n          data-is-visible="true"\n          bb-translate-attrs="{\'aria-label\': \'components.directives.grade.filter-panel.closeFilterPanel\'}"\n          ng-click="gradeGridSearchFilterReborn.closeFilterCriteria()"\n          analytics-id="components.directives.grade.filterPanel.close.button"\n        >\n          <div>\n            <bb-svg-icon size="small" icon="close"></bb-svg-icon>\n          </div>\n        </button>\n      </div>\n      <button class="filter-panel-clear-all is-disabled"\n              ng-disabled= "!gradeGridSearchFilterReborn.getCheckedMergedCourse() > 0"\n              ng-class="{\'filter-panel-clear-all-active\': gradeGridSearchFilterReborn.getCheckedMergedCourse() > 0}"\n              ng-click="gradeGridSearchFilterReborn.clearAll()"\n              analytics-id="components.directives.grade.filter-panel.clearAll"\n              bb-translate>\n              components.directives.grade.filter-panel.clearAll\n      </button>\n    </div>\n    \x3c!-- TODO Container(style protoType) for search-box, enable in furture\n    <div class="filter-panel-block" id="keyword-block">\n        <div class="filter-panel-block-header">\n          <h4 class="filter-panel-block-title">Keyword Search</h4>\n          <button type="button filter-panel-toggle-button">\n            <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon>\n          </button>\n        </div>\n        <div class="filter-panel-search-box">\n            <bb-typeahead-search-box id="student-search-box"\n                                     input-placeholder="components.directives.grade.search-box.placeholder"\n                                     sr-empty-results="components.directives.grade.search-box.emptyResults"\n                                     sr-results-found="components.directives.grade.search-box.resultsFound"\n                                     sr-no-results-found="components.directives.grade.search-box.noResultsFound"\n                                     sr-label="components.directives.grade.search-box.placeholder"\n                                     clear-aria-label="components.directives.grade.search-box.clear"\n                                     icon="search">\n            </bb-typeahead-search-box>\n        </div>\n    </div>\n    --\x3e\n    <div class="filter-panel-block" id="sources-block" ng-repeat="criteriaBlock in gradeGridSearchFilterReborn.criteriaBlocks ">\n        <div class="filter-panel-block-header" id ={{::criteriaBlock.id}}>\n            <h4 class="filter-panel-block-title" course-org-token-resolver bb-translate>components.directives.grade.filter-panel.mergedCourseTitle</h4>\n            <button type="button" class="filter-panel-toggle-button"\n                    ng-class="{\'filter-panel-block-toggle-close\': !criteriaBlock.expanded }"\n                    ng-click="gradeGridSearchFilterReborn.collapseMergedCourse(criteriaBlock)"\n                    aria-label="{{gradeGridSearchFilterReborn.getToggleButtonLabel(criteriaBlock)}}"\n                    analytics-id="components.directives.grade.filterPanel.mergedCourse.collapse.button"\n            >\n            <bb-svg-icon size="small" icon="arrow-down"></bb-svg-icon>\n            </button>\n          </div>\n        <div class="filter-panel-groups" ng-show="criteriaBlock.expanded">\n          <div class="filter-panel-group">\n            <div class="filter-panel-item" ng-repeat="criteriaDetail in criteriaBlock.criteriaDetails track by $index" >\n              <div class="is-enabled filter-panel-item-checkbox" ng-show="!criteriaDetail.ui.hidden">\n                <input type="checkbox" id={{::criteriaDetail.id}}\n                  class="bb-Checkbox-checkboxInput foundation-overrides"\n                  ng-model="criteriaDetail.ui.checked"\n                  ng-change="gradeGridSearchFilterReborn.filterMergedCourse(criteriaDetail)"\n                  analytics-id="components.directives.grade.filterPanel.mergedCourse.input.checkbox">\n                  <label class="foundation-overrides" for={{::criteriaDetail.id}}>\n                    <div class="check-box-label">\n                      <span>{{::criteriaDetail.childCourse.name}}</span>\n                      <bb-svg-icon icon="check" size="inline"></bb-svg-icon>\n                    </div>\n                </label>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n  </div>\n</div>'},pKNj:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return R}));s("towz"),s("zAxy"),s("s4xR"),s("KXuk"),s("gORw"),s("TOu5");var n=s("Llzl"),i=s("yC9S"),o=s("9zo4"),a=s("vhkR"),r=s("tqR7"),c=s("ZzN+"),l=s("lmMM"),d=s("e7Kn"),u=s("nYZ0"),p=s("dJ97"),m=s("Ocaa"),h=s("r133"),b=s("BMpZ"),g=s("Sa5G"),v=s("ujI6"),f=s("jhBu"),w=s("X/qj"),S=s("o5Lu"),C=s("0JpG"),y=s("pjml"),O=s("JNtI"),A=s("u4ux"),I=s("e6jQ"),D=s("8jzW"),k=s("hkqm"),_=s("TnpK"),j=s("W6wm"),T=s("EGJL"),$=s("nmzr");const R="ultra.directives.grade.graderColumn";class E{constructor(e,t,s,n,o,a,r,c,l,d,u,p,m,h){this.scope=e,this.$q=t,this.ContentService=s,this.courseConversionService=n,this.CourseModel=o,this.entitlementService=a,this.grade=r,this.gradebookPermissionService=c,this.bbLocalize=l,this.ultraState=d,this.accessibility=u,this.scoreProviderHelper=p,this.ltiService=m,this.toast=h,this.hasDesignerViewEntitlement=!1,this.hasViewAssessmentEntitlement=!1,this.hasViewAttendanceEntitlement=!1,this.isRestrictedGroupContent=!1,this.numMissingStudents=0,this.showConversionMessage=!1,this.attendanceAriaLabel=void 0,this.canModify=this.gradebookPermissionService.canModify(e.course().id),this.canPostGrades=this.gradebookPermissionService.canPostGrades(e.course().id),this.canViewAttempts=this.gradebookPermissionService.canViewAttempts(e.course().id),this.canViewGrades=this.gradebookPermissionService.canViewGrades(e.course().id),this.column=e.column,this.course=e.course(),this.isCourseView=e.isCourseView,this.contextArea="grades",this.index=e.$parent.$index+1,this.column.isGroupContent()&&(this.isRestrictedGroupContent=!this.entitlementService.isEntitled(g.n.ViewGroups,this.course.id)),this.bbLocalize.loadBundle("components/directives/grade/grader-column").then((()=>{this.column.externalGrade&&(e.column.columnName=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.actions.overall.label"}))})),this.entitlementService.hasAnyCourseEntitlement([g.i.ViewAssessment,g.i.ModifyAssessment],this.course.id).then((e=>{this.hasViewAssessmentEntitlement=e})),this.entitlementService.hasCourseEntitlement(g.i.ViewAttendance,this.course.id).then((e=>{this.hasViewAttendanceEntitlement=e})),this.entitlementService.hasCourseEntitlement(g.e.ViewAsDesigner,this.course.id).then((e=>{this.hasDesignerViewEntitlement=e})),this.column.$resolve().$then((e=>{this.grade.setDeleteConfirmationHandle(this.column),this.overflowMenuId="grader-column-open-button-"+I.a(),this.checkIfAttendanceRecordsExist()}));const b=e.$watch("column.summary.$resolved",(()=>{this.column.summary&&this.column.summary.$resolved&&(this.updateNumMissingStudents(),b(),this.isRestrictedGroupContent&&(this.column.summary.restricted=!0,this.column.restricted=!0))}));i.b.OnRootScope(e,"bb-grade-input-save",((e,t,s,n)=>{this.column.id===n&&this.column.summary.$fetch()})),i.b.OnRootScope(e,"bb-update-category-icon",((e,t)=>{this.column.id===t.id&&(this.scope.categoryMap&&t.gradebookCategoryId&&(this.column.gradebookCategory=this.scope.categoryMap[t.gradebookCategoryId],this.column.categoryTitle=this.column.gradebookCategory&&this.column.gradebookCategory.title),(null===t.dueDate||t.dueDate&&t.dueDate instanceof Date)&&(this.column.dueDate=t.dueDate),this.column.visible=t.visible,this.updateNumMissingStudents())})),"Attendance"===this.column.effectiveColumnName&&(this.attendanceAriaLabel=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grader-column.attendance.course-attendance",params:{courseName:this.course.name},noWrap:!0,noEscape:!0})),this.scope.column.isAttendance()&&i.b.OnRootScope(e,"$stateChangeSuccess",((e,t,s,n)=>{n.name.indexOf("attendance")>=0&&this.checkIfAttendanceRecordsExist()})),e.$watch("column",(e=>{this.column=e})),this.registerPostGradesWatchers()}updateNumMissingStudents(){this.numMissingStudents=this.column.getNumMissingIfLate()}openAddItemPanel(t){this.whichAddItemPanelOpen=t,e(t).addClass("is-active").find(".element-list-add-menu").slideToggle(300)}closeAddItemPanel(t){this.whichAddItemPanelOpen===t&&(this.whichAddItemPanelOpen=null),e(t).removeClass("is-active").find(".element-list-add-menu").slideUp(300)}toggleAddItemPanel(e){this.whichAddItemPanelOpen===e?this.closeAddItemPanel(e):this.openAddItemPanel(e)}registerPostGradesWatchers(){this.scope.$watchGroup([()=>this.column.summary.hasGradesToPost(),()=>this.course.isComplete()],(()=>{this.canPostGrades=this.grade.canPostGrades(this.course,this.column)}))}postGrades(){this.column.postReadyGrades().then((e=>{this.toast.show({messageKey:"components.directives.grade.grader-column.actions.gradesPosted",icon:"icon-check",toastStatus:"success"}),this.column.summary.$fetch().$asPromise().then((e=>{this.scope.$emit(S.c,this.column),this.scope.$root.$broadcast("bb-update-summary")}))}))}deleteColumn(){return this.column.forceDelete()}deleteContent(){this.column.courseId&&this.column.contentId&&this.CourseModel.$new(this.column.courseId).contents.$new(this.column.contentId).$fetch().$asPromise().then((e=>{this.ContentService.deleteContent(e).then((()=>{this.deleteContentCallback()}))}))}deleteContentCallback(){this.scope.$root.$broadcast("bb-delete-column",this.column)}viewEditColumn(){this.accessibility.setFocusOverrideOnPanel("#"+this.overflowMenuId,".grades-list");const e=this.column.scoreProviderHandle;e&&!this.scoreProviderHelper.supportsOverall(e)||(y.p.ContentHandler.PartnerCloud.isEqualTo(e)||y.p.ContentHandler.LtiLink.isEqualTo(e)?this.ltiService.ltiEditColumn(this.column):this.openViewEditState())}openViewEditState(){const{contentId:e,courseId:t,externalGrade:s,id:n,linkId:i,scoreProviderHandle:o}=this.column,a=!this.column.isAssignment()&&!this.column.isTest();if(s)this.ultraState.goPeekState("gradebook-item.overall-grade",{columnId:n,gradeitemView:"details"});else if(this.column.isCalculated())this.ultraState.goPeekState("gradebook-item.calculation",{columnId:n,gradeitemView:"details"});else if(o&&this.column.seemsAttemptBased()&&(this.hasViewAssessmentEntitlement||a)){const s={courseId:t,contentId:e,linkRefId:i};this.scoreProviderHelper.editStateRef(o,s,D.a.GoToState)}else if(o&&this.column.isAttendance()){const s={courseId:t,contentId:e};this.scoreProviderHelper.editStateRef(o,s,D.a.GoToState)}else this.ultraState.goPeekState("grade-item.edit",{id:this.column.id})}_openColumn(){let e,t;const{contentId:s,courseId:i,id:o,linkId:a,scoreProviderHandle:r}=this.column;if(this.course.isUltra()){const c=this.hasViewAssessmentEntitlement&&(this.column.isTest()||this.column.isAssignment());if(this.isLTILink())return void this.launchLti();if(this.column.isAttendance()){const c={contentId:s,courseId:i,columnId:o,linkRefId:a};({state:e,args:t}=n.fromJson(this.scoreProviderHelper.getSubmissionListStateRef(r,c,D.a.GenerateStateParams)))}else if(this.column.externalGrade)e="gradebook-item.overall-grade",t={columnId:o};else if(this.column.isCalculated())e="gradebook-item.calculation",t={columnId:o,courseId:i};else if(r&&!this.column.isOffline()&&(this.canViewGrades||this.canViewAttempts)){const r={contentId:s,courseId:i,columnId:o,linkRefId:a};({state:e,args:t}=n.fromJson(this.scoreProviderHelper.getSubmissionListStateRef(this.column.scoreProviderHandle,r,D.a.GenerateStateParams)))}else if(r&&(this.column.isDiscussion()||this.column.isScorm()||this.column.isScormSCO()||c)){const o={courseId:i,contentId:s,linkRefId:a};({state:e,args:t}=n.fromJson(this.scoreProviderHelper.editStateRef(this.column.scoreProviderHandle,o,D.a.GenerateStateParams)))}else this.canViewGrades?(e="gradebook-item.offline",t={columnId:o,courseId:i,gradeitemView:"students"}):(e="grade-item.edit",t={id:o})}else e="course.outline",t={courseId:i,legacyUrl:this.getLegacyUrl()};this.ultraState.goPeekState(e,t)}handleColumnClick(){this.itemLinkIsClickable&&!this.isRestrictedGroupContent&&(this.isCourseView?this._openColumn():this.course.refreshConvertToUltraStatus().then((()=>{this.courseConversionService.isConversionComplete(this.course.ui.convertToUltraTaskStatus)?this._openColumn():this.showConversionTooltip()})))}showConversionTooltip(){this.showConversionMessage=!0}closeConversionTooltip(){this.showConversionMessage=!1}getAlertType(){return g.h.ConversionInProgress}launchLti(){this.ltiService.ltiLaunch({courseId:this.column.courseId,contentId:this.column.contentId,linkType:g.f.parse(this.column.scoreProviderHandle.toString()),linkRefId:this.column.linkId})}showAlertIcon(){return this.column.getNumMissingIfLate()>0}getLegacyUrl(){return"/webapps/gradebook/do/instructor/enterGradeCenter?course_id="+this.column.courseId}isLTILink(){return this.ltiService.isLTILink(this.column)}showMarkAttendance(){return this.column.isAttendance()&&this.hasViewAttendanceEntitlement}showDelete(){return this.column.isAttendance()?this.canModify&&this.showAttendanceDeleteOption:this.canModify}openAttendance(){this.ultraState.goPeekState("attendance")}showQuestionAnalysis(){return this.column.isQuestionAnalysisAvailable()&&this.canViewGrades}showDownloadTestResults(){return!this.column.isAnonymousGrading()&&(this.canViewGrades&&this.column.isTest()&&this.column.summary.numSubmissionsTotal>0)}showViewEdit(){return!(!this.column.isOffline()&&null!=this.column.scoreProviderHandle&&!this.scoreProviderHelper.supportsEdit(this.column.scoreProviderHandle))&&(!(!this.column.isOffline()&&!this.column.isCalculated())||(this.hasDesignerViewEntitlement||this.canModify))}hasContentId(){return!!this.column.contentId}getConfirmationKeyAndShowType(){let e;return this.ultraState.includes("**.outline.**")?e=j.a.CourseOutline:this.ultraState.includes("**.engagement.**")&&(e=j.a.Discussions),this.CourseModel.$new(this.column.courseId).contents.$new(this.column.contentId).$fetch().$asPromise().then((t=>this.ContentService.generateDeleteConfirmationKey(t,e).then((e=>({confirmationKey:e.ui.deleteConfirmationKey,showType:e.ui.modalShowType})))))}getOverflowMenuItems(){return[{icon:this.canModify?"draw":"visible",labelKey:this.canModify?"global.edit":"global.view",show:()=>this.showViewEdit(),onClick:()=>this.viewEditColumn()},{icon:"attendance",labelKey:"components.directives.grade.grader-column.attendance.markAttendance",show:()=>this.showMarkAttendance(),onClick:()=>this.openAttendance()},{icon:"question-analysis",labelKey:"components.directives.grade.grader-column.questionAnalysisOverflowMenuLabel",show:()=>this.showQuestionAnalysis(),onClick:()=>{this.ultraState.goPeekState("question-analysis.report",{qaContentId:this.column.contentId})}},{icon:"download",labelKey:"components.directives.grade.grader-column.downloadResults.overflowMenuLabel",show:()=>this.showDownloadTestResults(),onClick:()=>{this.ultraState.goPeekState($.Routes.Grade.DOWNLOAD_TEST_RESULTS,{columnId:this.column.id})}},{icon:"trash",labelKey:"global.delete",onClick:()=>{this.hasContentId()?this.deleteContent():this.deleteColumn()},show:()=>this.showDelete(),confirmationOptions:{lazyLoadTitleKeyAndInstructionsKey:()=>{let e;return this.hasContentId()?this.getConfirmationKeyAndShowType().then((t=>(e=t.confirmationKey.replace(/^resource\//,""),this.$q.when(O.a(e))))):this.column&&this.column.ui&&this.column.ui.deleteConfirmationHandle?(e=this.column.ui.deleteConfirmationHandle.replace(/^resource\//,""),this.$q.when(O.a(e))):(e="generic-content",this.$q.when(O.a(e)))}}}]}get itemLinkIsClickable(){return this.isActionable&&(!this.column.isAttendance()||this.hasViewAttendanceEntitlement)&&(!this.isLTILink()||this.hasDesignerViewEntitlement)&&!this.isRestrictedGroupContent}get isActionable(){return!this.column.isAttendance()||this.scope.attendanceIsAvailable()}get showOverflowMenu(){return this.isCourseView&&!this.course.isComplete()&&this.isActionable&&(this.showViewEdit()||this.showDelete()||this.showMarkAttendance()||this.showQuestionAnalysis()||this.showDownloadTestResults())}get showDragControls(){return this.isCourseView&&!this.course.isComplete()&&this.isActionable&&this.canModify}checkIfAttendanceIsAvailable(){return!(!this.scope.attendanceIsAvailable||!this.scope.attendanceIsAvailable())}checkIfAttendanceRecordsExist(){this.showAttendanceDeleteOption=!1,this.column.isAttendance()&&this.checkIfAttendanceIsAvailable()&&this.CourseModel.$new(this.column.courseId).attendanceRecordsExist().then((e=>{this.showAttendanceDeleteOption=!e}))}getNumberEligibleToBeGradedExternalSubmissions(){return n.isUndefined(this.column.summary.numGroupsNeedsGrading)?this.column.summary.numStudentsEligibleToBeGradedExternalSubmission:this.column.summary.numGroupsEligibleToBeGradedExternalSubmission}getNumberOfSubmissionsNeedsGrading(){return null==this.column.summary.numSubmissionsNeedsGrading?this.column.summary.numSubmissionsNeedsReconciling:this.column.summary.numSubmissionsNeedsGrading}getToolTipTemplate(){return'<ul class="complex-tooltip-list conditional-release-tooltip"> <li bb-translate>components.directives.grade.grader-column.restrictedInfo</li> </ul>'}}E.$inject=["scope","$q",u.f,c.b,y.m.serviceName,f.b,S.k,w.b,C.serviceName,_.d,o.c,D.c,a.b,k.b];class x{constructor(e){this.$injector=e,this.restrict="E",this.template=T,this.scope={assessment:"<?",column:"=",course:"&",isCourseView:"=",categoryMap:"=?",attendanceColumnExists:"&?",attendanceIsAvailable:"&"},this.link=(e,t,s)=>{e.graderColumn=this.$injector.instantiate(E,{scope:e})}}}x.$inject=["$injector"],n.module(R,[r.a,u.d,d.a,l.d,c.a,p.a,h.a,m.a,v.c,C.moduleName,D.b,_.b,A.b,a.a,O.b,k.a,b.a]).directive("bbGraderColumn",["$injector",C.serviceName,(e,t)=>(t.loadBundle("components/directives/grade/grader-column"),e.instantiate(x))])}).call(this,s("71td"))},pWJj:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("5ikY");const o="ultra.components.directives.bbUiIcon.large.Blog";Object(n.a)(i.Blog,o,"bbUiIconLargeBlog")},ph44:function(e,t,s){},"po/h":function(e,t){e.exports='<div class="base-grades course-grades-instructor" ng-class="{\'grades-list-view\': courseGradesGrader.isGradableItemsListView}">\n  <div ng-if="courseGradesGrader.isDesktop && !courseGradesGrader.isSmallScreen" class="guidance-wrapper"\n    aria-describedby="guidance-moment-grade-settings">\n\n    <div class="row collapse course-grades-header-buttons-wrapper js-course-skip-link-target" tabindex="-1">\n      <div class="gradebook-toolbar group-filters">\n        <bb-square-toggle one-icon-class="toggle-table"\n                          one-aria-label="components.directives.grade.course-grades-grader.views.list-button"\n                          one-view-value="list"\n                          two-icon-class="toggle-grid"\n                          two-aria-label="components.directives.grade.course-grades-grader.views.grid-button"\n                          two-view-value="grid"\n                          property="courseGradesGrader.squareToggleValue"\n                          analytics-id-tag-prefix="components.directives.grade.view.courseGrader"\n                          class="toggle-group-filters-enabled">\n        </bb-square-toggle>\n\n        <div class="gradebook-options">\n          <div class="grade-grid-search-box group-filters" ng-if="courseGradesGrader.isGridView">\n            <bb-typeahead-search-box id="student-search-box"\n                                    item-selected="courseGradesGrader.itemSelected(item)"\n                                    type-ahead-search="courseGradesGrader.typeAheadSearch(searchText)"\n                                    clear-search="courseGradesGrader.clearSelection()"\n                                    input-placeholder="components.directives.grade.search-box.placeholder"\n                                    sr-empty-results="components.directives.grade.search-box.emptyResults"\n                                    sr-results-found="components.directives.grade.search-box.resultsFound"\n                                    sr-no-results-found="components.directives.grade.search-box.noResultsFound"\n                                    sr-label="components.directives.grade.search-box.placeholder"\n                                    clear-aria-label="components.directives.grade.search-box.clear"\n                                    icon="search">\n\n                  <ng-switch on="item.type">\n                    <div ng-switch-when="user" class="element-card">\n                      <bb-user-avatar class="typeahead-user-avatar" user="::item.data.user"></bb-user-avatar>\n                      <div class="typeahead-student-name-id">\n                        <bb-username class="typeahead-name ellipse" user="item.data.user" has-title-attr="true"></bb-username>\n                        <div class="typeahead-id ellipse">{{::item.data.user.userName}}</div>\n                      </div>\n                    </div>\n                    <div ng-switch-when="column" class="element-card">\n                      <div bb-content-item-icon content-column="item.data.getMetadata()" show-alert-icon="item.data.getMetadata().getNumMissingIfLate() > 0" class="element-image" ng-if="item.data.getMetadata()"></div>\n                      <div class="typehead-title column-title ellipse">\n                        <div class="ellipse grade-title">{{::item.data.getMetadata().columnName}}</div>\n                        <div class="ellipse grade-type" bb-translate>components.directives.grade.search-box.columnName</div>\n                      </div>\n                    </div>\n                    <div ng-switch-when="category" class="element-card">\n                        <bb-ui-icon-large-document-multiple color="primary"></bb-ui-icon-large-document-multiple>\n                        <div class="typehead-title category-title ellipse">\n                          <div bb-translate class="ellipse grade-title" ng-if="::!item.data.getMetadata().gradebookCategory.isUserDefined">{{::item.data.getMetadata().gradebookCategory.localizableTitle.languageKey}}</div>\n                          <div bb-translate class="ellipse grade-title" ng-if="::item.data.getMetadata().gradebookCategory.isUserDefined">{{::item.data.getMetadata().gradebookCategory.title.split(\'.\')[0]}}</div>\n                          <div class="ellipse grade-type" bb-translate>components.directives.grade.search-box.category</div>\n                        </div>\n                    </div>\n                    <div ng-switch-default="noResult" class="element-card">\n                      <div class="no-result" bb-translate>components.directives.grade.search-box.noResultsFound</div>\n                  </div>\n                </ng-switch>\n            </bb-typeahead-search-box>\n          </div>\n          <bb-gradebook-advanced-filters-ftue ng-if="courseGradesGrader.isGridView && courseGradesGrader.showGradeListContainer()">\n          </bb-gradebook-advanced-filters-ftue>\n          <div ng-if="courseGradesGrader.isGridView && courseGradesGrader.showGradeListContainer()">\n            <a class="filter-panel-button super-clear button" bb-guidance-target component-key="grades.grader.search.filter"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.actions.openAdvancedFilters\'}"\n              bb-peek-sref="gradebook-grid-advanced-filters" analytics-id="components.directives.grade.search.filter.button">\n              <bb-ui-icon-small-filter-options class="group-filters-icon"></bb-ui-icon-small-filter-options>\n              <span bb-translate>components.directives.grade.course-grades-grader.actions.filter</span>\n            </a>\n          </div>\n\n          <div ng-if="courseGradesGrader.userHasViewGradebookPermission">\n            <a class="open-attempt-receipt-search button super-clear"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.actions.attemptReceiptSearch\', \'title\':\'components.directives.grade.course-grades-grader.actions.attemptReceiptSearch\'}"\n              bb-peek-sref="attempt-receipt-search"\n              analytics-id="components.directives.grade.actions.openAttemptReceiptSearch.link">\n              <bb-ui-icon-medium-content-view></bb-ui-icon-medium-content-view>\n            </a>\n          </div>\n\n          <div ng-if="courseGradesGrader.canUploadGradebook">\n            <a class="open-upload-settings button super-clear"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.actions.upload\', \'title\': \'components.directives.grade.course-grades-grader.actions.upload\'}"\n              bb-peek-sref="grade-upload-setting"\n              ng-if="!courseGradesGrader.course.isComplete()"\n              analytics-id="components.directives.grade.actions.upload.link">\n              <bb-ui-icon-small-upload></bb-ui-icon-small-upload>\n            </a>\n          </div>\n\n          <div ng-if="courseGradesGrader.canDownloadGradebook">\n            <a class="open-downLoad-settings button super-clear"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.actions.download\', \'title\': \'components.directives.grade.course-grades-grader.actions.download\'}"\n              bb-peek-sref="grade-download-setting"\n              ng-if="!courseGradesGrader.course.isComplete()"\n              analytics-id="components.directives.grade.actions.download.link">\n              <bb-ui-icon-small-download></bb-ui-icon-small-download>\n            </a>\n          </div>\n\n          <div ng-if="courseGradesGrader.userHasViewGradebookPermission" course-id="course.model.id">\n            <a class="open-gradebook-settings button super-clear js-open-settings"\n              bb-guidance-target component-key="grades.grader.course.settings"\n              bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.actions.openSettings\', \'title\': \'components.directives.grade.course-grades-grader.actions.openSettings\'}"\n              bb-peek-sref="grade-setting"\n              analytics-id="components.directives.grade.actions.openSettings.link">\n              <bb-ui-icon-medium-settings></bb-ui-icon-medium-settings>\n            </a>\n          </div>\n        </div>\n      </div>\n      <bb-filter-chips\n        ng-if="courseGradesGrader.isGridView && courseGradesGrader.hasUrlFilters"\n        analytics-id="gradebook.grid.filters">\n      </bb-filter-chips>\n    </div>\n    <bb-guidance id="guidance-moment-grade-settings" component-key="grades.grader.course.settings" class="guidance-element-overlay push-bottom"\n      role="tooltip">\n      <p>\n        <bb-translate>components.directives.grade.course-grades-grader.ftue.setting</bb-translate>\n      </p>\n    </bb-guidance>\n\n  </div>\n  <bb-gradebook-list-view-tabs\n    on-tab-changed="courseGradesGrader.changeListViewType"\n    selected-tab="courseGradesGrader.currentTabId"\n    ng-if="!courseGradesGrader.isGridView"\n  ></bb-gradebook-list-view-tabs>\n\n  <div ng-if="courseGradesGrader.isGridView || courseGradesGrader.isGradableItemsListView">\n    \x3c!-- Empty state template: this section of the page will be displayed when there is no content, and will invite users to create content --\x3e\n    <div class="is-empty-page js-course-skip-link-target"\n         ng-if="courseGradesGrader.columns.$resolved && courseGradesGrader.columns.length === 0 && !courseGradesGrader.hasUrlFilters">\n      <div class="is-empty-wrapper">\n        <div class="is-empty-explanation">\n          <img src="./static/images/ftue/course-grades-instructor.svg" bb-translate-attrs="{alt: \'components.directives.grade.course-grades-grader.empty.addItems\'}" />\n          <h1 class="is-empty-heading" bb-translate>components.directives.grade.course-grades-grader.empty.header</h1>\n          <p bb-translate>components.directives.grade.course-grades-grader.empty.description</p>\n        </div>\n        <div class="add-element">\n          <ul role="menu" class="element-list-add-menu small-block-grid-1 medium-block-grid-3 large-block-grid-4">\n            <li>\n              <a role="menuitem" bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.empty.addCalculation\'}"\n                 bb-peek-sref="gradebook-item.calculation" analytics-id="components.directives.grade.addCalculation.link">\n                <div>\n                  <bb-svg-icon size="small" icon="add"></bb-svg-icon>\n                  <span bb-translate>components.directives.grade.course-grades-grader.empty.addCalculation</span>\n                </div>\n              </a>\n            </li>\n            <li>\n              <a role="menuitem" class="js-empty-add-item" bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.empty.addItem\'}"\n                 bb-peek-sref="grade-item.create" analytics-id="components.directives.addItem.link">\n                <div>\n                  <bb-svg-icon size="small" icon="add"></bb-svg-icon>\n                  <span bb-translate>components.directives.grade.course-grades-grader.empty.addItem</span>\n                </div>\n              </a>\n            </li>\n            <li ng-if="courseGradesGrader.attendanceIsAvailable">\n              <a role="menuitem" bb-translate-attrs="{\'aria-label\': \'components.directives.grade.course-grades-grader.empty.addAttendance\'}"\n                 bb-peek-sref="attendance" analytics-id="components.directives.grade.addAttendance.link">\n                <div>\n                  <bb-svg-icon size="small" icon="add"></bb-svg-icon>\n                  <span bb-translate>components.directives.grade.course-grades-grader.empty.addAttendance</span>\n                </div>\n              </a>\n            </li>\n          </ul>\n        </div>\n      </div>\n    </div>\n\n\n    <div class="grade-list-container"\n         ng-if="courseGradesGrader.isGradableItemsListView && courseGradesGrader.showGradeListContainer()">\n      <div class="spinner bb-secondary-color-2" ng-if="!courseGradesGrader.columns" aria-hidden="true"></div>\n      <div bb-infinite-scroll="courseGradesGrader.renderMoreColumns()"\n           infinite-scroll-container="\'.bb-offcanvas-panel-wrap .panel-wrap\'"\n           infinite-scroll-current-count="courseGradesGrader.columns.length"\n           infinite-scroll-focusable-children-selector=".grader-column .name a, .floating-headers .item-headers .grade-grid-header-content-wrapper"\n           infinite-scroll-load-limit="courseGradesGrader.GRADE_COLUMN_LOAD_LIMIT"\n           infinite-scroll-localization-keys-prefix="components.directives.grade.course-grades-grader.infiniteScroll"\n           infinite-scroll-total-count="courseGradesGrader.totalColumnCount"\n           infinite-scroll-tray-id="course-grades-grader">\n        <bb-course-grades-grader-list course="courseGrades.course"\n                                      is-first="true"\n                                      columns="courseGradesGrader.columns"\n                                      show-setup-overall-column="courseGradesGrader.showSetupOverallColumn"\n                                      attendance-is-available="courseGradesGrader.attendanceIsAvailable">\n        </bb-course-grades-grader-list>\n      </div>\n    </div>\n\n    <div class="grade-grid-content"\n         ng-if="courseGradesGrader.isGridView && courseGradesGrader.showGradeListContainer()">\n      <div>\n        <bb-grade-grid-reborn course="courseGrades.course"\n                              columns="courseGradesGrader.visibleColumns"\n                              attendance-is-available="courseGradesGrader.attendanceIsAvailable"\n                              merged-courses="courseGradesGrader.mergedCourses"\n                              ng-show="!courseGradesGrader.areFilterResultsEmpty">\n        </bb-grade-grid-reborn>\n        <div class="is-empty-page advanced-filters"\n            ng-if="courseGradesGrader.areFilterResultsEmpty">\n          <div class="is-empty-wrapper">\n            <div class="is-empty-explanation">\n              <h1 class="is-empty-heading" bb-translate>components.directives.grade.course-grades-grader.empty.advancedFilters.header</h1>\n              <p bb-translate>components.directives.grade.course-grades-grader.empty.advancedFilters.description</p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  \x3c!-- Student List View handles its own loading indicator and empty state --\x3e\n  <div ng-if="courseGradesGrader.isStudentListView" class="student-list-view-container">\n    <bb-student-list-view class="react-container"\n                          course-id="courseGrades.course.id">\n    </bb-student-list-view>\n  </div>\n</div>\n'},px9Z:function(e,t,s){},q1bP:function(e,t,s){s("Llzl");s("SY8P"),e.exports="dibari.angular-ellipsis"},qDdO:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-class-pulse-future",use:"icon-small-class-pulse-future-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-class-pulse-future"><path d="M9 14c0 .5523-.4477 1-1 1s-1-.4477-1-1 .4477-1 1-1 1 .4477 1 1zM11 6.5a.5.5 0 11-1 0 .5.5 0 011 0zM5.5 9.5a.5.5 0 11-1 0 .5.5 0 011 0z" stroke-width="2" /><path d="M15 11l-4.5-4.5-5.5 3-4-2.357" stroke-width="2" /><path d="M9 2c0 .5523-.4477 1-1 1s-1-.4477-1-1 .4477-1 1-1 1 .4477 1 1z" stroke-width="2" /><path d="M15 2H1v12h14V2z" stroke-width="2" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},qH3X:function(e,t,s){"use strict";s.d(t,"a",(function(){return i}));const n="rb_grade_grid_",i={REFRESH_OVERALL_EDITOR:`${n}refresh_overall_editor`,REFRESH_CELL_EDITOR:`${n}refresh_cell_editor`,SELECT_GROUP:`${n}select_group`,REFRESH:`${n}refresh`,FOCUSIN_CELL:`${n}focusin`,FOCUSOUT_CELL:`${n}focusout`,ENTER_EDITOR:`${n}enter_editor`,CLOSE_EDITOR:`${n}close_editor`,ADVANCED_FILTERS_COLUMNS:`${n}advanced-filter-columns`,ADVANCED_FILTERS_ROWS:`${n}advanced-filter-rows`,GRADEBOOK_CLEAR_SEARCHBOX_SELECTION:`${n}gradebook-clear-searchbox-selection`,GRADEBOOK_USER_SELECTED:`${n}gradebook-user-selected`,GRADEBOOK_COLUMN_SELECTED:`${n}gradebook-column-selected`,GRADEBOOK_CATEGORY_SELECTED:`${n}gradebook-category-selected`}},qzMN:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-content-collection",use:"icon-small-content-collection-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-content-collection"><path d="M14 15H2V9h3v1h6V9h3v6zM13 9V4H3v5M4 4V1h8v3" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"r+pC":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-back-arrow",use:"icon-medium-back-arrow-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-back-arrow"><path d="M11 23L1 12 11 1M1 12h22" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},r133:function(e,t,s){"use strict";s.d(t,"a",(function(){return c})),s.d(t,"b",(function(){return l}));var n=s("Llzl"),i=s("Fvsw"),o=s("0JpG"),a=s("0+Qs"),r=s("BXQP");const c="ultra.directives.bbDuration",l="refresh.relative.dates";class d{constructor(e,t,s,n){this.scope=e,this.bbContext=t,this.bbLocalize=s,this.interval=n,this.date="",this.time="",this.lessThanOneDay=!1;const i=e.$watch("date",(()=>{this._localizeRelativeDate(),e.autoUpdate&&!e.autoUpdate()&&e.date&&i()}));e.$on(l,(()=>{this._localizeRelativeDate()})),this.interval((()=>{this._localizeRelativeDate()}),this.scope,d.DEFAULT_REFRESH_INTERVAL)}needAgo(){return!!(this.scope.hasAgo&&this.scope.hasAgo()&&this.lessThanOneDay)}separateDatetime(){return!(!this.scope.separateDatetime||!this.scope.separateDatetime())}_localizeRelativeDate(){if(this.scope.date){let e={},t=new Date;const s=this.scope.isRelativeToServerDate&&this.scope.isRelativeToServerDate();(null==s||s)&&(e={relativeTo:this.bbContext.getServerTime()},t=this.bbContext.getServerTime());const n=t.getTime()-this.scope.date.getTime();if(n>=6e4&&this.scope.date.setSeconds(30),this.lessThanOneDay=n<=864e5,this.needAgo()||this.separateDatetime()){const t=this.bbLocalize.getFormatEnum(o.ILocaleDateFormat,this.scope.dateFormat)||o.ILocaleDateFormat.Short;this.bbLocalize.formatDuration(this.scope.date,this.scope,e,t).then((e=>{this.date=e.date||"",this.time=e.time||""}))}}}}d.DEFAULT_REFRESH_INTERVAL=18e4,d.$inject=["scope",i.b,o.serviceName,a.b];class u{constructor(e){this.$injector=e,this.restrict="E",this.replace=!0,this.template=r,this.scope={date:"=",autoUpdate:"&?",isRelativeToServerDate:"&?",dateFormat:"@?",hasAgo:"&?",separateDatetime:"&?"},this.link=e=>{e.duration=this.$injector.instantiate(d,{scope:e})}}}u.$inject=["$injector"],n.module(c,[i.a,o.moduleName,a.a]).directive("bbDuration",["$injector",e=>e.instantiate(u)])},r6lH:function(e,t,s){"use strict";s.d(t,"a",(function(){return m})),s.d(t,"b",(function(){return h}));var n=s("nsO7"),i=s("Llzl"),o=s("jhBu"),a=s("Sa5G"),r=s("ZQFV"),c=s("0JpG"),l=s("pjml"),d=s("wgY5"),u=s("nmzr"),p=s("+O05");const m="ultra.service.telemetry",h="telemetry";class b{constructor(e,t,s,n,i,o,a,r,c,l,d,u,p,m,h,b,g){this.cacheFactory=e,this.$q=t,this.entitlement=s,this.bbLocalize=n,this.ActivityVsGradeModel=i,this.ContentActivityInDetailModel=o,this.CourseActivityModel=a,this.CourseGradesModel=r,this.CourseNotificationsModel=c,this.MultimediaActivityInDetailModel=l,this.MultimediaStatisticsModel=d,this.NotificationUsers=u,this.StudentActivityModel=p,this.StudentGradesModel=m,this.SufficientDataModel=h,this.TelemetryDiscussionActivityModel=b,this.TelemetryDiscussionXrayModel=g,this.SUFFICIENT_DATA_KEY="SufficientData",this.sufficientDataCache=e.createCache("sufficientTelemetryData"),this.notificationsCache=e.createCache("notifications")}loadActivityVsGradeData(e){return this.ActivityVsGradeModel.$find(e).$allow([404]).$asPromise()}loadStudentGradeData(e,t){return this.StudentGradesModel.$find(e,t?{userId:t}:{}).$allow([404,400]).$asPromise()}loadCourseGradeData(e){return this.CourseGradesModel.$find(e).$allow([404,400]).$asPromise()}loadStudentActivityData(e,t){return this.StudentActivityModel.$find(e,t?{userId:t}:{}).$allow([400]).$asPromise()}loadContentActivityInDetailData(e,t){return this.ContentActivityInDetailModel.$collection().getContentActivityInDetail(e,t).$asPromise()}loadMultimediaActivityInDetailData(e,t){return this.MultimediaActivityInDetailModel.$collection().getMultimediaActivityInDetail(e,t).$asPromise()}loadMultimediaStatisticsData(e,t){return this.MultimediaStatisticsModel.getMultimediaStatistics(e,t).$asPromise()}loadCourseActivityData(e){return this.CourseActivityModel.$find(e).$allow([400]).$asPromise()}loadNotificationUsers(e,t,s){const i={};return t&&(i.limit=t),s&&(i.offset=s),this.NotificationUsers.$find(e,i).$asPromise().then((e=>n.keyBy(e.users,"userId")))}loadNotifications(e,t,s,n){return this.getNotificationsPromise(e,t,s,n).promise}loadDiscussionActivityData(e,t,s){return s?this.TelemetryDiscussionActivityModel.getDiscussionActivityReport(e,t,s).$asPromise():this.TelemetryDiscussionActivityModel.getDiscussionActivityReport(e,t).$asPromise()}loadDiscussionXrayReport(e,t,s){return this.TelemetryDiscussionXrayModel.getDiscussionXrayReport(e,t,s).$asPromise()}hasSufficientActivityData(e){return this.getSufficientDataPromise().promise.then((t=>!(!t||!t.coursesWithActivity)&&n.includes(t.coursesWithActivity,e)))}hasSufficientGradeData(e){return this.getSufficientDataPromise().promise.then((t=>!(!t||!t.coursesWithGrades)&&n.includes(t.coursesWithGrades,e)))}canViewAllUserData(e){return this.entitlement.hasCourseEntitlement(r.GradebookEntitlement.ViewGrades,e)}formatMessageRecipients(e){return(e||[]).map((e=>e.id)).join(",")}determineContentSupportsActivityData(e){const t=this.$q.defer();return p.a.isExternalSubmissionsAssessment(e)?t.resolve(!1):this.contentSupportsActivityData(e)?this.canViewAllUserData(e.courseId).then((e=>{t.resolve(e)})).catch((e=>{t.reject(e)})):t.resolve(!1),t.promise}contentSupportsActivityData(e){return(a.f.TestLink.isEqualTo(e.contentHandler)||a.f.UltraAssignment.isEqualTo(e.contentHandler))&&e.hasGradingColumn()}determinePanelSref(e,t){return this.canViewAllUserData(e).then((s=>s?this.createPanelSref(u.TelemetryViewType.INSTRUCTOR_CLASS,e,t):this.createPanelSref(u.TelemetryViewType.STUDENT_PROGRESS,e,t)))}createPanelSref(e,t,s){let n='({ courseId: "'+t+'"';return s&&(n+=', notificationId: "'+s+'"'),n+=" })",e.toString()+n}exportFilename(e,t,s,n,i){let o="";e&&(o=e.courseId+"_");const a=this.bbLocalize.formatDateSync(new Date,c.ILocaleDateFormat.ISO).replace(/[^0-9]/g,"");let r="";t&&s&&t.id!==s.id&&(r=t.userName+"_");const l=n?"_"+n:"";let d="";return i&&(d=i.replace(/\s+/g,"_")+"_"),o+r+d+a+l}getSufficientDataPromise(){let e=this.sufficientDataCache.get(this.SUFFICIENT_DATA_KEY);return e||(e={promise:this.SufficientDataModel.$new().$fetch().$allow([404,400]).$asPromise()},this.sufficientDataCache.put(this.SUFFICIENT_DATA_KEY,e)),e}getNotificationsPromise(e,t,s,n){const i=e+t+s+n;let o=this.notificationsCache.get(i);if(!o){const a={};t&&(a.userId=t),s&&(a.includeDismissed=s),n&&(a.notificationType=n),o={promise:this.CourseNotificationsModel.$find(e,a).$asPromise()},o.promise.then((e=>(e.currentStudent.forEach((e=>{e.ui={createdDay:d.utc(e.created).startOf("day").toDate()}})),e))),this.notificationsCache.put(i,o)}return o}}b.$inject=["DSCacheFactory","$q",o.b,c.serviceName,l.sb.serviceName,l.tb.serviceName,l.ub.serviceName,l.vb.serviceName,l.wb.serviceName,l.zb.serviceName,l.Ab.serviceName,l.Cb.serviceName,l.Db.serviceName,l.Eb.serviceName,l.Fb.serviceName,l.xb.serviceName,l.yb.serviceName];i.module(m,[l.N,o.a]).service(h,b)},r8DE:function(e,t){e.exports='<div class="question-container">\n  <bb-rich-text-editor\n    ng-model="question.questionText.rawText"\n    supports-inline-document-render="true"\n    is-read-only="true"\n    plugin-options="editorPluginOptions">\n  </bb-rich-text-editor>\n</div>\n'},rNTV:function(e,t){e.exports='<div>\n  <bb-assessment-attempt\n    attempt="assessmentAttempt.attempt"\n    content-data="assessmentAttempt.contentData"\n    course="assessmentAttempt.course"\n    redirect="assessmentAttempt.returnToOverview()"\n  ></bb-assessment-attempt>\n\n  <div ui-view="assessment-attempt-peek"></div>\n</div>\n'},rRc3:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("xQgz");const o="ultra.components.directives.bbUiIcon.large.Folder";Object(n.a)(i.Folder,o,"bbUiIconLargeFolder")},rtZE:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return a}));var n=s("nsO7"),i=s("Llzl");
/*
 * An Angular service which helps with creating recursive directives.
 * @author Mark Lagendijk
 * @license MIT
 */
const o="ultra.service.RecursionHelper",a="recursionHelper";
/**
 * An Angular service which helps with creating recursive directives.
 * @author Mark Lagendijk
 * @license MIT
 *
 * Sample usage:
 * ```typescript
 *
 * var link = (scope: IScope, element: JQuery) => {
 *   // do stuff
 * };
 *
 * var compile = (element: JQuery) => {
 *   return recursiveHelper.compile(element, link);
 * };
 *
 * ```
 *
 */
class r{constructor(e){this.$compile=e,this.compileContents=n.memoize(this.compileContents)}compileContents(e,t){return this.$compile(t)}compile(e,t,s){i.isFunction(s)&&(s={post:s});const n=t.contents();return t.empty(),{pre:s&&s.pre?s.pre:null,post:(t,i,...o)=>{this.compileContents(e,n)(t,(function(e){i.append(e)})),s&&s.post&&s.post.apply(null,[t,i,...o])}}}}r.$inject=["$compile"];i.module(o,[]).service(a,r)},"s+Z7":function(e,t,s){"use strict";s("st/R");var n=s("71td"),i=s("Llzl"),o=s("+wu9");s.d(t,"a",(function(){return a}));const a="ultra.components.directives.typeahead-selected-options";class r{constructor(e){this.scope=e}removeOption(e){this.scope.removeOption({item:e}),this.scope.focusElementId&&n("#typeahead-search-box-"+this.scope.focusElementId).focus()}}r.$inject=["scope"];class c{constructor(e){this.$injector=e,this.restrict="E",this.replace=!0,this.template=o,this.scope={selectedOptions:"=",removeOption:"&",selectedOptionsListLabel:"@",focusElementId:"@?"},this.link=e=>{e.typeaheadSelectedOptions=this.$injector.instantiate(r,{scope:e})}}}c.$inject=["$injector"],i.module(a,[]).directive("bbTypeaheadSelectedOptions",["$injector",e=>e.instantiate(c)])},s1u2:function(e,t){e.exports='<div class="grade-grid-cell grade-grid-header-cell">\n  <div class="content content-header-bg" tabindex="0" role="columnheader"\n       ng-class="{\'is-restricted\': columnMetadata.isHiddenFromStudents(), \'is-unavailable\': !gradeGridColumnHeaderReborn.toolAvailable || !col.hasContextMenuOptions()}"\n       ng-click="gradeGridColumnHeaderReborn.popupMenu($event)"\n       analytics-id="components.directives.grade.grid.gradeGridColumnHeaderReborn.popupMenu">\n    <div bb-content-item-icon content-column="columnMetadata" show-alert-icon="showAlertIcon()" class="element-image" role="presentation"></div>\n    <div class="ellipse grade-name" title="{{columnMetadata.columnName}}" aria-labelledby="summary-info-{{columnMetadata.id}}">{{columnMetadata.columnName}}</div>\n  </div>\n\n  <div class="grade-grid-header-summary" tabindex="0" id="summary-points-{{columnMetadata.id}}">\n    <span class="sr-only">{{columnMetadata.columnName}}</span>\n    <span class="ellipse points" title="{{gradeGridColumnHeaderReborn.getSchemaText()}}">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n  </div>\n\n  <div ng-if="col.isShowSummary() && columnMetadata.isVisibleToStudents() && !columnMetadata.summary.isAllGradedAndPosted() && !columnMetadata.isCalculated()"\n    class="grade-grid-header-summary"\n    tabindex="0"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grid.groupAriaLabel</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <span class="ellipse grade-count"\n            bb-translate-attrs="{\'title\': \'components.directives.grade.grid.gradedTip\'}" translate-attrs-values="{count: isGroupTest ? columnMetadata.summary.numStudentsGradedNeedsPosting + columnMetadata.summary.numStudentsPosted + columnMetadata.summary.numberOfStudentsOverriddenGradesToPost : columnMetadata.summary.numStudentsGraded()}"\n            bb-translate translate-values="{count: isGroupTest ? columnMetadata.summary.numStudentsGradedNeedsPosting + columnMetadata.summary.numStudentsPosted + columnMetadata.summary.numberOfStudentsOverriddenGradesToPost : columnMetadata.summary.numStudentsGraded()}">components.directives.grade.grid.graded</span>\n      <span class="grade-pipe"></span>\n      <span class="ellipse grade-posted-count"\n            bb-translate-attrs="{\'title\': \'components.directives.grade.grid.postedTip\'}" translate-attrs-values="{count: isGroupTest ? columnMetadata.summary.numStudentsPosted : columnMetadata.summary.numPosted}"\n            bb-translate translate-values="{count: isGroupTest ? columnMetadata.summary.numStudentsPosted : columnMetadata.summary.numPosted}">components.directives.grade.grid.posted</span>\n    </div>\n  </div>\n\n  <div ng-if="col.isShowSummary() && columnMetadata.isVisibleToStudents() && columnMetadata.summary.isAllGradedAndPosted() && !columnMetadata.isCalculated()"\n    class="grade-grid-header-summary"\n    ng-class="{\'grade-complete-status\': !gradeGridColumnHeaderReborn.isRestricted()}"\n    tabindex="0"\n    bb-translate-attrs="{\'title\': \'components.directives.grade.grader-column.statuses.restricted\'}"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grid.groupAriaLabel</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grid.completeLabel</span>\n    </div>\n  </div>\n\n  <div ng-if="col.isShowSummary() && columnMetadata.isVisibleToStudents() && columnMetadata.summary.isAllGradedAndPosted() && !columnMetadata.isCalculated()" class="grade-grid-header-summary"\n    tabindex="0"\n    bb-translate-attrs="{\'title\': \'components.directives.grade.grader-column.statuses.restricted\'}"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grid.groupAriaLabel</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grid.completeLabel</span>\n    </div>\n  </div>\n\n  <div ng-if="col.isShowSummary() && columnMetadata.isVisibleToStudents() && columnMetadata.summary.isAllGradedAndPosted() && !columnMetadata.isCalculated()"\n    class="grade-grid-header-summary"\n    tabindex="0"\n    bb-translate-attrs="{\'title\': \'components.directives.grade.grid.completeLabel\'}"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grid.groupAriaLabel</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-svg-icon size="small" icon="complete" status="success"></bb-svg-icon>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grid.completeLabel</span>\n    </div>\n  </div>\n\n  <div ng-if="(!col.isShowSummary() || !columnMetadata.isVisibleToStudents()) && !columnMetadata.isCalculated()"\n    class="grade-grid-header-summary"\n    tabindex="0"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grid.groupAriaLabel</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <span class="ellipse grade-status"></span>\n    </div>\n  </div>\n\n  <div ng-if="columnMetadata.isCalculated()"\n    class="grade-grid-header-summary"\n    tabindex="0"\n    id="summary-info-{{columnMetadata.id}}">\n    <div ng-if="gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span ng-if="isGroupTest" class="sr-only" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <bb-button-complex-tooltip></bb-button-complex-tooltip>\n      <span class="ellipse grade-status" bb-translate>components.directives.grade.grader-column.statuses.restricted</span>\n    </div>\n\n    <div ng-if="!gradeGridColumnHeaderReborn.isRestricted()">\n      <span class="sr-only">{{columnMetadata.columnName}}</span>\n      <span class="sr-only">{{gradeGridColumnHeaderReborn.getSchemaText()}}</span>\n      <span class="ellipse items-count" ng-if="columnMetadata.itemsCount !== undefined"\n        bb-translate-attrs="{\'title\': \'components.directives.grade.grid.itemsTip\'}"\n        translate-attrs-values="{count: columnMetadata.itemsCount}" bb-translate\n        translate-values="{count: columnMetadata.itemsCount}">components.directives.grade.grid.items.plural</span>\n    </div>\n  </div>\n</div>\n'},s4xR:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-attendance",use:"icon-small-attendance-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-attendance"><path d="M15 15V2H1v13h14zM4.5 1v1h7V1h-7z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M5 9l2 2 4-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},s52B:function(e,t){e.exports='<div class="rb-grid-container" ng-style="container.getContainerStyle()" role="grid">\n  <div class="rb-ax-focus-placeholder sr-only" tabindex="-1"></div>\n  <div class="rb-grid-header-wrapper">\n    <div class="rb-grid-header">\n      <div class="rb-grid-canvas" ng-style="container.getHeaderCanvasStyle()" role="rowgroup">\n        <div class="rb-row rb-header-row" ng-class="::container && {\'rb-row-border\': container.headerBorder} || undefined" role="row">\n          <div rb-grid-cell="col.headerTemplate"\n               class="rb-cell rb-header-cell"\n               ng-class="[\'rb-col-\' + col.id, \'rb-column-position-\' + col.id, {\'rb-cell-border\': col.border}]"\n               role="columnheader"\n               ng-repeat="col in container.renderedColumns track by $index"\n               ng-click="container.callbacks.header($event)"\n               analytics-id="components.directives.gridContainer.header.{{::col.id}}.button">\n            <div class="rb-add-column-placeholder" ng-if="::container.canAddColumn()" ng-mouseenter="container.columnAdder.enter($event, col)"></div>\n          </div>\n          <div class="rb-add-column-placeholder first" ng-if="::container.canAddColumn()" ng-mouseenter="container.columnAdder.enter($event)"></div>\n        </div>\n      </div>\n    </div>\n    <div ng-if="container.hasVScrollbar" class="rb-grid-scrollbar-placeholder-y"></div>\n  </div>\n  <div class="rb-grid-body" ng-style="container.getBodyStyle()">\n    <div class="rb-grid-canvas" ng-style="container.getBodyCanvasStyle()" role="rowgroup">\n      <div class="rb-row rb-cell-row" ng-repeat="row in container.renderedRows track by $index" role="row"\n          ng-class="[\'rb-row-position-\' + row.id, container && {\'rb-row-border\': container.rowBorder} || undefined]">\n        <div rb-grid-cell="col.cellTemplate"\n             class="rb-cell"\n             ng-class="[\'rb-col-\' + col.id, \'rb-row-\' + row.id, \'rb-column-position-\' + col.id, {\'rb-cell-border\': col.border}]"\n             role="gridcell"\n             ng-repeat="col in container.renderedColumns track by $index"\n             ng-click="container.callbacks.cell($event)"\n             analytics-id="components.directives.gridContainer.callback"\n        ></div>\n      </div>\n    </div>\n  </div>\n  <div ng-if="!container.hasHScrollbar" class="rb-grid-scrollbar-placeholder-x"></div>\n  <div class="rb-add-column" ng-if="::container && container.canAddColumn()">\n    <div class="column-header-button-wrapper" ng-mouseleave="container.columnAdder.leave()">\n      <a class="small button clear icon button-add-content hide"\n         href="javascript:void(0);"\n         ng-click="container.columnAdder.onClick($event)"\n         role="button"\n         aria-haspopup="true"\n         analytics-id="components.directives.grade.grid.addBtuAriaLabel.link">\n        <span class="sr-only" bb-translate>components.directives.grade.grid.addBtuAriaLabel</span>\n      </a>\n    </div>\n  </div>\n</div>\n'},s5UK:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-arrow-left",use:"icon-small-arrow-left-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-arrow-left"><path d="M11 1L4 8l7 7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},sB2Z:function(e,t){e.exports='<div class="content-wrapper" ng-class="{\'nocontent\': !content.canViewAsInstructor()}">\n  <div class="name">\n    <ng-switch on="content.getContentDisplay().viewHandler()" ng-class="{\'has-indicator\': content.ui.hasIndicator}">\n      <div ng-switch-when="resource/x-bb-folder" class="engagement-folder">\n        <bb-content-item-folder></bb-content-item-folder>\n      </div>\n      <a ng-switch-when="resource/x-bb-forumlink"\n         bb-peek-sref="discussion.view.with-grading({contentId:content.id})"\n         bb-prevent-click-if="content.isConditionalReleaseLocked()"\n         ng-attr-tabindex="{{ content.isConditionalReleaseLocked() ? -1 : 0 }}"\n         class="content-title"\n         analytics-id="content.item.engagement.outline.forumLink.link"\n         aria-describedby="activity-indicator-{{::content.id}}"\n      >\n        <span>{{ content.title }}</span>\n      </a>\n      <div ng-switch-default class="content-title">{{ content.title }}</div>\n      <bb-svg-icon role="img" aria-hidden="false" bb-translate-attrs="::{\'aria-label\':\'components.directives.content-item-base.aria-label.indicator\'}" ng-if="content.ui.hasIndicator" id="activity-indicator-{{::content.id}}" class="indicator" size="small" icon="activity-indicator" status="active"></bb-svg-icon>\n    </ng-switch>\n  </div>\n  <div ng-if="content.canViewAsInstructor() && content.canHaveAttempts() && content.hasDueDate()" class="due-date">\n    \x3c!-- no due date --\x3e\n    <span bb-translate ng-if="!dueDate" class="content-no-due-date-label">components.directives.content-item-base.no-due-date</span>\n    \x3c!-- due date --\x3e\n    <span bb-translate ng-if="dueDate && !gradeDetail" class="content-due-date-label">components.directives.content-item-base.due-date</span>\n    <bb-datetime format="Short" value="dueDate" ng-if="dueDate && !gradeDetail" class="content-due-date"></bb-datetime>\n  </div>\n  <div ng-if="!content.canViewAsInstructor() && content.canHaveAttempts() && content.hasDueDate()" class="due-date"\n       ng-class="{\'is-late\': contentItemBase.isLate}" ng-switch="dueDate != null">\n    \x3c!-- submission card --\x3e\n    \x3c!--  TODO: submissionCard is disabled until LRN-101279 is fixed --\x3e\n    \x3c!-- <bb-submission-card ng-if="gradeDetail"  grade-detail="gradeDetail" inline="true"></bb-submission-card>\n    <bb-submission-card ng-if="!gradeDetail" grading-column="gradingColumn" inline="true"></bb-submission-card> --\x3e\n    \x3c!-- no due date --\x3e\n    <span bb-translate ng-switch-default class="content-no-due-date-label">components.directives.content-item-base.no-due-date</span>\n    \x3c!-- due date --\x3e\n    <span bb-translate ng-switch-when="true" class="content-due-date-label">components.directives.content-item-base.due-date</span>\n    <bb-datetime format="Short" value="dueDate" ng-switch-when="true" class="content-due-date"></bb-datetime>\n  </div>\n  <div ng-if="contentItemBase.isModifyPermissionLoaded && content.canHaveAttempts() && content.isGroupContent" class="group-info">\n    <div class="group-name">\n      <span><bb-svg-icon size="small" icon="groups"></bb-svg-icon></span>\n      <a href="javascript:void(0);"\n         ng-if="contentItemBase.hasViewGroupsAsAdmin"\n         ng-click="contentItemBase.editGroups()"\n         analytics-id="content.item.engagement.outline.contentItemBase.editGroups.link"\n      >\n        <bb-group-count content="content"></bb-group-count>\n      </a>\n      <span ng-if="contentItemBase.canViewGroups && !contentItemBase.hasViewGroupsAsAdmin">\n        <bb-group-count content="content"></bb-group-count>\n      </span>\n      <div ng-if="!contentItemBase.canViewGroups && !contentItemBase.hasViewGroupsAsAdmin" class="title">\n        <bb-group-student-enrollment content="content"></bb-group-student-enrollment>\n      </div>\n    </div>\n  </div>\n  <div ng-if="!content.canViewAsInstructor() && content.isConditionalReleaseLocked()"\n    role="tooltip"\n    class="lock-info"\n    tabindex="0"\n    bb-complex-tooltip\n    enhanced-tooltip="true"\n    tooltip-position="bottom"\n    tooltip-open-on-activation="true"\n    tooltip-disable-on-mouse-over="true"\n    tooltip-scope="contentItemBase.conditionalRelease.tooltipScope"\n    tooltip-template="{{::contentItemBase.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}">\n    <span bb-translate="components.directives.content-item-base.conditionalRelease.lock-info"></span>\n    <span class="sr-only">{{contentItemBase.conditionalRelease.tooltips}}</span>\n  </div>\n  <div class="student-created-info" ng-if="::contentItemEngagementOutline.isDiscussionCreatedByStudent()">\n    <span bb-translate="components.directives.content-item-base.content.discussionAuthorship.student"></span>\n  </div>\n  <div class="name-controls stop-click-propagation"\n    ng-class="{\n      \'name-conditional-release\': !content.canViewAsInstructor() && content.isConditionalReleaseLocked(),\n      \'selector-disabled\': content.isInForcedSequenceModule()\n    }"\n    ng-if="contentItemBase.showVisibility()">\n    <bb-content-visibility-selector content="content"\n                                    link-content="contentItemBase.targetContent"\n                                    onchange-func="contentItemBase.updateContentVisibility()"\n                                    disable-restricted="contentItemBase.disableRestricted"\n                                    open-panel-on-restricted="true"\n                                    verbose-restricted-label="true"></bb-content-visibility-selector>\n  </div>\n  <div ng-if="content.canViewAsInstructor() && content.isConditionalRelease()" class="conditional-release-control">\n    <div class="rules">\n      <a href="javascript:void(0);"\n        ng-click="contentItemEngagementOutline.openConditionalRelease()"\n        bb-complex-tooltip\n        enhanced-tooltip="true"\n        tooltip-position="bottom"\n        tooltip-enable-on-mouse-over-for-all-breakpoints="true"\n        tooltip-enable-on-mouse-leave-for-all-breakpoints="true"\n        tooltip-auto-update="true"\n        tooltip-scope="contentItemBase.conditionalRelease.tooltipScope"\n        tooltip-template="{{::contentItemBase.conditionalRelease.getConditionalReleaseComplexTooltipTemplate()}}"\n        analytics-id="components.directives.content-item-base.conditionalRelease.link">\n        <span>{{contentItemBase.conditionalRelease.getConditionDescription()}}</span>\n        <span class="sr-only">{{contentItemBase.conditionalRelease.tooltips}}</span>\n      </a>\n    </div>\n  </div>\n</div>\n'},sZYy:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-goal",use:"icon-medium-goal-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-goal"><path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M1 1h22v4H1zM6 20h12v3H6z" /><path d="M10 14v6M14 14v6" stroke-width="2" /><path d="M4 5c0 6 3 9 8 9s8-3 8-9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M4 8H1c0 9.5 9 9 9 9M20 8h3c0 9.5-9 9-9 9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},sa5q:function(e,t){e.exports='<div ng-switch on="content.canViewAsInstructor() || !content.shouldRestrict()">\n  \x3c!-- Center content title when it is only one line of text (without edit capability, description, or date restrictions). --\x3e\n  <a class="content-title"\n     bb-peek-sref="content-manage.edit.document({id:content.id})"\n     ng-switch-when="true"\n     ng-class="{\'name-middle\': contentItemBase.shouldAlignMiddle()}"\n     aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n     analytics-id="content.item.page.edit.document.link"\n     aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n     tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}">\n     <span>{{ content.title }}</span>\n  </a>\n  <span class="content-title"\n        ng-switch-default\n        ng-class="{\'name-middle\': contentItemBase.shouldAlignMiddle()}"\n        aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n        tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}">{{ content.title }}</span>\n</div>\n'},seHs:function(e,t,s){"use strict";s.d(t,"d",(function(){return n})),s.d(t,"b",(function(){return i})),s.d(t,"a",(function(){return o})),s.d(t,"c",(function(){return a}));const n=25,i=50,o=100,a=[n,i,o]},smDF:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-add-circle",use:"icon-medium-add-circle-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-add-circle"><circle cx="12" cy="12" r="11" stroke-width="2" /><path d="M12 7v10M7 12h10" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"st/R":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-clear",use:"icon-small-clear-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-clear"><path d="M1 8c0-3.866 3.134-7 7-7v0c3.866 0 7 3.134 7 7v0c0 3.866-3.134 7-7 7v0c-3.866 0-7-3.134-7-7v0zM10 6l-4 4M6 6l4 4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},suMx:function(e,t,s){"use strict";s("q1bP");var n=s("Llzl"),i=s("Nyb7");const o="ultra.components.directives.statistics.complexStatistic";class a{constructor(e,t,s){this.scope=e,this.element=t,this.$compile=s;const n=this.$compile(this.scope.item().complexTemplate)(this.scope.item().complexScope);t.append(n)}}a.$inject=["scope","element","$compile"];class r{constructor(e){this.$injector=e,this.replace=!0,this.restrict="A",this.template=i,this.scope={item:"&"},this.link=(e,t)=>{e.complexStatistic=this.$injector.instantiate(a,{scope:e,element:t})}}}r.$inject=["$injector"],n.module(o,[]).directive("bbComplexStatistic",["$injector",e=>e.instantiate(r)]);var c=s("zphb");const l="ultra.components.directives.statistics.simpleStatistic";class d{constructor(e,t){this.scope=e,this.$sce=t,this.scope.item().trusted=t.trustAsHtml(this.scope.item().data)}}d.$inject=["scope","$sce"];class u{constructor(e){this.$injector=e,this.replace=!0,this.restrict="A",this.template=c,this.scope={item:"&"},this.link=e=>{e.simpleStatistic=this.$injector.instantiate(d,{scope:e})}}}u.$inject=["$injector"],n.module(l,[]).directive("bbSimpleStatistic",["$injector",e=>e.instantiate(u)]);var p=s("c2Z8");s.d(t,"a",(function(){return m}));const m="ultra.components.directives.statistics";class h{constructor(e){this.scope=e,this.smallPerRow=e.smallPerRow()||1,this.largePerRow=e.largePerRow()||4,this.scope.$watch("config()",(e=>{e&&(this.config=e.length>10?e.slice(0,10):e,this.total=this.config.length)}))}}h.$inject=["scope"];class b{constructor(e){this.$injector=e,this.replace=!0,this.restrict="AE",this.template=p,this.scope={config:"&",smallPerRow:"&",largePerRow:"&"},this.link=e=>{e.statistics=this.$injector.instantiate(h,{scope:e})}}}b.$inject=["$injector"],n.module(m,["dibari.angular-ellipsis",o,l]).directive("bbStatistics",["$injector",e=>e.instantiate(b)])},"tA/q":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("sY4P");const o="ultra.components.directives.bbUiIcon.small.Unlocked";Object(n.a)(i.Unlocked,o,"bbUiIconSmallUnlocked")},tTiy:function(e,t){e.exports='<div class="discussion-assignment">\n  <button class="button-add-content js-show-add-options"\n          data-show-add-options ng-click="addContentButton.toggleMenu()"\n          ng-class="{hide: !(addContentButton.isButtonVisible || addContentButton.alwaysShow || addContentButton.isMenuVisible)}"\n          aria-expanded="{{addContentButton.isMenuVisible}}"\n          aria-controls="{{::\'add-content-menu-\' + addMenuId}}"\n          aria-label="{{addContentButton.addButtonAriaLabel}}"\n          ng-focus="addContentButton.showButton()"\n          ng-blur="addContentButton.hideButton()"\n          analytics-id="components.directives.add-content-button.attempts.button">\n  </button>\n  \x3c!-- use ng-show to keep the element when close add buttons, make sure the upload directive handlers will not be lost --\x3e\n  <ul role="menu" class="element-list-add-menu outline-menu angular-animate"\n      aria-expanded="{{addContentButton.isMenuVisible}}"\n      ng-attr-id="{{::\'add-content-menu-\' + addMenuId}}"\n      ng-if="::addContentButton.isMenuVisible || undefined"\n      ng-show="addContentButton.isMenuVisible">\n    <li>\n      <bb-file-upload\n        url="/v1/files"\n        data="{}"\n        monitor-leave="true"\n        allow-multiple="true"\n        target-div="{{\'#\' + fileListViewId}}"\n        disable-drag="disableDrag && disableDrag()"\n        hide-transclude-during-upload="false"  is-third-party-upload="false"\n        third-party-download-handler="addContentButton.downloadFile"\n        skip-zip-file-check="true">\n        <div class="columns medium-12" ng-class="{\'medium-center\': attempt.isMobile}">\n          <a href="javascript:void(0);"\n             role="menuitem"\n             bb-translate-attrs="{\'aria-label\':\'course.content.buildContentArea.addFiles\'}"\n             ng-click="addContentButton.toggleMenu()"\n             analytics-id="components.directives.add-content-button.attempts.fileUpload.link">\n            <bb-svg-icon size="small" icon="upload"></bb-svg-icon>\n            <span bb-translate>course.content.fileUpload.addFiles</span>\n          </a>\n        </div>\n      </bb-file-upload>\n    </li>\n  </ul>\n</div>\n'},tecA:function(e,t,s){"use strict";s.d(t,"b",(function(){return d})),s.d(t,"a",(function(){return u}));var n=s("D57K"),i=s("Llzl"),o=s("0JpG"),a=s("TnpK"),r=s("+4Px"),c=s("g66W"),l=s("aHpC");const d="text-editor-update-original-value";let u=class{constructor(e,t,s,n,i){this.scope=e,this.element=t,this.ctrl=s,this.bbLocalize=n,this.bbUltraState=i,this.focusOnAuthorControls=!1,this.isTextTouched=!1,this.myDirection="down",this.preventBlur=!1,this.currentStateName=i.current.name,e.disableInlineEditing=null!=e.disableInlineEditing&&e.disableInlineEditing,this.scope.$stopDigestPropagation=!0,this.originalNgModel=this.scope.ngModel,e.direction&&null!=e.direction()&&(this.myDirection=e.direction());const o=!(this.scope.ngModel&&this.scope.ngModel.length);e.$emit("text-editor-empty",{textEditor:this,isEmpty:o}),e.$root.$on("bb-bbml-editor-bbml-pre-redraw",(()=>{this.updateOriginalValues()})),e.$on("text-editor-set-pristine",(()=>{this.isTextTouched=!1})),e.$on("text-editor-viewValue-initialized",(()=>{this.truncatedViewValue=this.ctrl.$viewValue})),e.$on("text-editor-reset-to-original-value",(()=>{this.isDirty()&&this.updateOriginalValues(),this.resetEditor(!1)})),e.$on(d,(()=>{this.updateOriginalValues(),this.isTextTouched=!1})),e.$on("$destroy",(()=>{this.isTextTouched=!1}))}isEditorDirty(){return this.isTextTouched}getContentLabel(){const e=this.getPlaceholderKey();return this.truncatedViewValue||e}getPlaceholderKey(){return this.scope.placeholderAttrsValues===this.originalPlaceholderAttrValues&&null!=this.placeholderText||(this.placeholderText=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:this.scope.placeholderKey,params:this.scope.$eval(this.scope.placeholderAttrsValues)}),this.originalPlaceholderAttrValues=this.scope.placeholderAttrsValues),this.placeholderText}get truncatedViewValue(){return this._truncatedViewValue}set truncatedViewValue(e){const t=this.element.find(".editor-element"),s=t.length?t.text():void 0;this._truncatedViewValue=c.f(s,100)}onChange(e){e&&e.keyCode===r.u||this.scope.hasFocus&&(this.isTextTouched=!0,this.scope.onchangeFunc&&this.scope.onchangeFunc({event:e}))}onKeydown(e){}isUploadProgressModalOpen(){const e=i.element(".progress-indicator-modal");return e&&e.length>0}isAddContentSelectorOpened(){return this.bbUltraState.current.name.length>this.currentStateName.length&&c.i(this.bbUltraState.current.name,this.currentStateName)}onBeforeBlur(){return!this.preventBlur&&!this.scope.disableInlineEditing}onBlur(){return this.scope.hasFocus=!1,this.ctrl.$focused=!1,this.scope.onblurFunc&&this.scope.onblurFunc(),!0}onFocus(){this.focusOnAuthorControls=!1,this.scope.readonly()||this.scope.hasFocus||(this.scope.hasFocus=!0,this.ctrl.$focused=!0,this.scope.onFocusFunc&&this.scope.onFocusFunc(),this.scope.$emit("entering-edit-state"))}isDirty(){return!(this.originalText||this.isTextTouched)}updateOriginalValues(){this.scope.ngModel===this.originalNgModel&&(this.originalText=this.scope.ngModel,this.originalPlainText=this.scope.plainText)}restoreFromOriginalValues(){this.originalText||(this.originalText="",this.originalPlainText=""),this.scope.ngModel=this.originalText,this.scope.plainText=this.originalPlainText}resetEditor(e){this.restoreFromOriginalValues()}isValidInputLength(){let e=null;if(null!=this.scope.getInputMaxLength&&(e=this.scope.getInputMaxLength()),null==e)return!0;if(e){const t=this.scope.plainText;return!!t&&t.trim().length<=e}return!0}};u=Object(n.__decorate)([Object(n.__param)(0,Object(l.b)("scope")),Object(n.__param)(1,Object(l.b)("element")),Object(n.__param)(2,Object(l.b)("ctrl")),Object(n.__param)(3,Object(l.b)(o.serviceName)),Object(n.__param)(4,Object(l.b)(a.d))],u)},tfx2:function(e,t,s){"use strict";s.d(t,"b",(function(){return p})),s.d(t,"a",(function(){return m}));var n=s("D57K"),i=s("ERkP"),o=(s("FwJ5"),s("nsO7")),a=s("dCrD"),r=s("Oyr+"),c=s("0x+l"),l=s("nmzr"),d=s("aHpC"),u=s("Y+9S");const p="show-cloud-upload-progress";let m=class extends a.a{constructor(e,t,s){if(super(e,t,s),this.scope=t,this.element=s,this.uploadFile=()=>{this.saveLocationForFileUpload(),this.element.find(".file-upload").click()},this.uploadCloudFile=()=>{this.saveLocationForFileUpload(),this.scope.isButtonLocationChangable&&this.scope.$emit(p,this.positionForFiles.positionAfter),this.element.find(".doc-add-media").click(),Object(u.notifyMobileApp)(u.MessageType.CloudStorageOpened)},this.openContentMarket=()=>this.getLocationData().then((e=>{this.ultraState.goPeekState(l.ContentMarketRoutes.CONTENT_MARKET,e)})),this.initContextMenuItems(),t.$on("always-show-time-expires",(()=>{this.turnOffAlwaysShow()})),t.isButtonLocationChangable&&t.$on("change-add-content-button-position",((e,t)=>{t.reopen&&!this.isMenuVisible&&this.toggleOverflowMenu()})),t.$on(r.e,((e,s,n)=>{if(n===r.c.OutlineAddContentButtonFileSelected&&s===t.fileListViewLocalId){const e=this.positionForFiles||this.getInsertLocationData();this.closeMenu(),t.$emit(r.e,e.parentId,e.positionBefore,e.positionAfter,e.depth,s,t.content,r.c.AssignDropTarget),this.assignPosition()}})),this.scope.isRenderByDefault&&this.scope.isRenderByDefault()){const e=this.scope.$watch("addContentButton.isMenuVisible",(t=>{t&&(this.scope.addContentButton.removeDefaultRenderClass=!0,e())}))}this.scope.$watch("parentId()",((e,t)=>{e!==t&&this.initContextMenuItems()}))}toggleOverflowMenu(){this.initContextMenuItems().then((()=>{this.toggleMenu()})).catch((()=>{}))}initContextMenuItems(){const e=this.element.closest("[data-base-state-name]").data("baseStateName"),t=this.getInsertLocationData();return this.$q.all({isCloudServiceAvailable:this.isCloudServiceAvailablePromise,createHref:this.ultraState.peekHref(l.ContentRoutes.CREATE_CONTENT_PEEK_PANEL,t,e),copyHref:this.ultraState.peekHref(l.ContentRoutes.COPY_CONTENT_PEEK_PANEL,t,e),contentCollectionHref:this.ultraState.peekHref(l.ContentCollectionRoutes.CONTENT_COLLECTION,t,e)}).then((e=>{const t=this.bbLocalize.getLocale(this.scope);this.items=[{key:"create",className:"js-create",href:e.createHref,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.create"}),icon:i.createElement(c.Add,null)},{key:"copy",className:"js-copy",href:e.copyHref,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.copy"}),icon:i.createElement(c.Duplicate,null)},{key:"upload-file",className:"js-upload-file",onClick:this.uploadFile,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.upload"}),icon:i.createElement(c.Upload,null)},{key:"upload-cloud-file",className:"js-upload-cloud-file",onClick:this.uploadCloudFile,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.importContentFromCloudStorage.title"}),icon:i.createElement(c.UploadCloud,null)},{key:"content-market",className:"js-content-market",onClick:this.openContentMarket,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.contentMarket"}),icon:i.createElement(c.ContentMarket,null)},{key:"content-collection",className:"js-content-collection",href:e.contentCollectionHref,name:this.bbLocalize.translateSync({locale:t,key:"components.directives.add-content-button.contentCollection"}),icon:i.createElement(c.ContentCollection,null)}],this.isCloudServiceAvailable||Object(o.remove)(this.items,(e=>"upload-cloud-file"===e.key)),this.currentCourse.canCopy()||Object(o.remove)(this.items,(e=>"copy"===e.key))}))}saveLocationForFileUpload(){this.scope.isButtonLocationChangable&&(this.positionForFiles=this.getInsertLocationData())}getLocationData(){const e=this.scope.rootContent(),t=this.getInsertLocationData();return this.contentSvc.getParentFolder(t.parentId,this.contextCourse.courseId,e).$asPromise().then((e=>{if(e.children){return{position:""+e.children.getInsertionIndex(t.positionBefore,t.positionAfter,!0,e.hasMoreChildren),parentId:t.parentId,positionBefore:t.positionBefore,positionAfter:t.positionAfter,depth:t.depth}}}))}};m.$inject=[],m=Object(n.__decorate)([Object(n.__param)(0,Object(d.b)("$injector")),Object(n.__param)(1,Object(d.b)("scope")),Object(n.__param)(2,Object(d.b)("element"))],m)},tka7:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("nbDY"),i=s.n(n);class o extends i.a{}o.Assign=new o("assign"),o.Unassign=new o("unassign"),o.Delete=new o("delete"),o.Retain=new o("retain")},tmbA:function(e,t){e.exports='<bb-modal class="notification automatic-zero-setting-confirmation"\n          modal-translate-options="modalTranslateOptions"\n          modal-aria-type="alertdialog"\n          analytics-id-tag-prefix="components.directives.pastDueZeroSettings">\n  <div name="modal-contents">\n    \x3c!-- Instructions --\x3e\n    <p bb-translate>{{ modalTranslateOptions.instructions.key }}</p>\n    \x3c!-- Past due zero: Unassign zero --\x3e\n    <div ng-if="!pastDueZero.isPastZeroAssigned">\n      <fieldset ng-if="modalTranslateOptions.choices && modalTranslateOptions.choices.length > 0"\n                class="fieldset-options">\n        <legend class="sr-only" bb-translate="{{ modalTranslateOptions.title.key }}"></legend>\n        <div class="option-item" ng-repeat="option in modalTranslateOptions.choices">\n          <input type="radio" \n                 name="{{ ::option.name }}" \n                 id="{{ ::option.id }}"\n                 ng-model="modalTranslateOptions.choiceModal"\n                 ng-value="option.value"\n                 analytics-id="components.directives.grade.pastDueZero.option.input.radio">\n          <label for="{{ ::option.id }}" bb-translate>{{ ::option.localizedKey }}</label>\n          <p ng-if="!!option.descriptionKey"\n             class="past-due-unassign-description"\n             bb-translate>\n            {{ ::option.descriptionKey }}\n          </p>\n        </div>\n      </fieldset>\n    </div>\n  </div>\n  <button name="modal-footer-button-primary" \n          type="button" \n          class="button confirm-ok js-primary-button" \n          ng-click="okAction()" \n          analytics-id="{{modalTranslateOptions.confirm.key}}"\n          bb-translate>\n    {{modalTranslateOptions.confirm.key}}\n  </button>\n  <button name="modal-footer-button-secondary" \n          type="button" \n          class="button button--secondary confirm-cancel js-secondary-button" \n          ng-click="cancelAction()" \n          analytics-id="{{modalTranslateOptions.cancel.key}}"\n          bb-translate>\n    {{modalTranslateOptions.cancel.key}}\n  </button>\n</bb-modal>'},towz:function(e,t,s){},tqR7:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("Llzl"),i=s("lEL+");const o="ultra.components.directives.clickOutside";class a{constructor(e,t,s,n,i){this.scope=e,this.element=t,this.attrs=s,this.$document=n,this.timeout=i;const o=e=>this.applyExpression(e),a=this.getContainer()||n;this.scope.$watch(this.attrs.isActive,((e,t)=>{e?this.timeout((()=>{a.on("click",o)}),this.scope,0,!1):a.off("click",o)})),this.scope.$on("$destroy",(()=>{a.off("click",o)}))}applyExpression(e){const t=this.element.is(e.target),s=this.element.has(e.target).length>0;t||s||this.scope.$apply(this.attrs.bbClickOutside)}getContainer(){if("currentPanelOnly"in this.attrs){let e=this.element;for(;e.parent().length;)if(e=e.parent(),e.is(".bb-offcanvas-panel,#main-content-inner"))return e}}}a.$inject=["scope","element","attrs","$document",i.b];class r{constructor(e){this.$injector=e,this.priority=100,this.restrict="A",this.compile=(e,t)=>({pre:(e,t,s)=>this.$injector.instantiate(a,{scope:e,element:t,attrs:s})})}}r.$inject=["$injector"],n.module(o,[]).directive("bbClickOutside",["$injector",e=>e.instantiate(r)])},trPQ:function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu">\n  <ul class="f-dropdown f-dropdown-overflow-menu reborn-dropdown cell-dropdown" role="menu">\n    <li ng-if="cell.canBeView" \n        role="presentation">\n        <button role="menuitem" \n                class="js-view-submission button clear"  \n                ng-click="cell.view()"\n                analytics-id="components.directives.grade.grid.viewItem">\n          <bb-svg-icon size="small" icon="visible"></bb-svg-icon>\n          <bb-translate  class="ellipse">components.directives.grade.grid.viewItem</bb-translate>\n        </button>\n    </li>\n    <li ng-class="{disable: !isReadyToPost()}"\n        ng-if="cell.canPost()"\n        role="presentation">\n        <button role="menuitem" \n                class="js-post-grade button clear" \n                ng-click="post()" \n                ng-disabled="!isReadyToPost()"\n                analytics-id="components.directives.grade.grid.post">\n          <bb-svg-icon size="small" icon="post"></bb-svg-icon>\n          <bb-translate class="ellipse" bb-translate>components.directives.grade.grid.post</bb-translate>\n        </button>\n    </li>\n  </ul>\n</div>'},u3gM:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var n=s("Llzl"),i=s("0JpG"),o=s("AuQm"),a=s("1ZbL");const r="ultra.components.directives.paging.panel",c={Class:o.LocalizedPagination,attributes:["analyticsId","className"],bindingNames:["page","compact","numberOfPages","onPageChange","elementSelectorToFocus"],renderLocalized:!0};n.module(r,[i.moduleName]).component("bbPagingSelector",Object(a.a)(c))},uAJz:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-peer-review",use:"icon-small-peer-review-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-peer-review"><path d="M6.5 10C7.8807 10 9 8.8807 9 7.5S7.8807 5 6.5 5 4 6.1193 4 7.5 5.1193 10 6.5 10zM6.5 10C3.2288 10 1 12.5 1 15M11.5 6C12.8807 6 14 4.8807 14 3.5S12.8807 1 11.5 1 9 2.1193 9 3.5 10.1193 6 11.5 6zM12 6c.7226 0 1.4451.464 2 1.0569M10 13l2 2 3-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},uEsA:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-close-circle",use:"icon-medium-close-circle-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-close-circle"><circle cx="12" cy="12" r="11" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M16 8l-8.005 7.9949M8 8l8 8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},uFkY:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return a})),s.d(t,"d",(function(){return r})),s.d(t,"c",(function(){return c})),s.d(t,"e",(function(){return l}));const n="assessment:reload-on-attempt-feedback-save",i="single-attempt-grading-list:reload-on-feedback-save",o="grade-comment-update";function a(e,t,s){return e.$broadcast(n,t,s)}function r(e,t){return e.$on(n,t)}function c(e,t){return e.$broadcast(i,t)}function l(e,t){return e.$on(i,t)}},ujI6:function(e,t,s){"use strict";s("RB+a");var n=s("Llzl"),i=s("71td"),o=s("tqR7"),a=s("H8CZ"),r=s("lEL+"),c=s("+4Px"),l=s("ytQ2");s.d(t,"c",(function(){return d})),s.d(t,"a",(function(){return u})),s.d(t,"b",(function(){return p}));const d="ultra.components.directives.foundationOffcanvas",u="OFFCANVASE-TOGGLE-CLOSE",p="OFFCANVAS-TOGGLE-OPEN";class m{constructor(e,t,s,n,o,a,r){this.scope=e,this.element=t,this.attrs=s,this.$compile=n,this.$parse=o,this.$q=a,this.timeout=r,this.overrideButtonClass=!1,this.isPanelOpen=!1,this.justOpenedPanel=!1,this.isFromKeyBoard=!1,this.wiredup=!1,this.position="right",this.dialogModel=!1,this.initialProperties(),r((()=>{if(this.openButtonElement=i("#"+this.attrs.bbFoundationOffcanvasOpenButton),0===this.openButtonElement.length)throw new Error('The bbFoundationOffcanvas directive couldn\'t find an "Open Menu" button with an ID of '+this.attrs.bbFoundationOffcanvasOpenButton);this.openButtonElement.on("click.bbFoundationOffcanvas",(()=>{this.scope.$apply((()=>{this.togglePanel()}))})),this.openButtonElement.on("keydown.bbFoundationOffcanvas",(e=>{e.keyCode===c.f&&(this.isFromKeyBoard=!0)}))}),e,0,!1)}initialProperties(){this.attrs.bbFoundationOffcanvasPosition&&(this.position=this.attrs.bbFoundationOffcanvasPosition),this.attrs.bbFoundationOffcanvasEventDelegate&&(this.scope.$on(p,(()=>{this.openPanel()})),this.scope.$on(u,(()=>{this.closePanel()}))),this.attrs.bbFoundationOffcanvasDialogModel&&(this.dialogModel=this.attrs.bbFoundationOffcanvasDialogModel)}wireup(){return this.wiredup=!0,this.timeout((()=>{if(this.closeButtonElement=i("#"+this.attrs.bbFoundationOffcanvasCloseButton),0===this.closeButtonElement.length)throw new Error('The bbFoundationOffcanvas directive couldn\'t find a "Close Menu" button with an ID of '+this.attrs.bbFoundationOffcanvasCloseButton);if(this.wrapperElement=this.element,this.offcanvasPanelElement=this.element.children().children(),1!==this.offcanvasPanelElement.length)throw new Error("bbFoundationOffcanvas directive must have exactly one child element. Fix the usage in the html template.");if(this.offcanvasPanelElement.addClass(this.position+"-off-canvas-menu"),this.attrs.bbFoundationOffcanvasOverrideButtonClass&&(this.overrideButtonClass=this.$parse(this.attrs.bbFoundationOffcanvasOverrideButtonClass)(this.scope)),this.offcanvasPanelElement.find("a, button").attr("tabindex","-1"),this.closeButtonElement.addClass("exit-off-canvas-overlay").on("click.bbFoundationOffcanvas",(()=>{this.scope.$apply((()=>{this.closePanel()}))})),this.offcanvasPanelElement.find("a, button").last().on("keydown.bbFoundationOffcanvas",(e=>{e.keyCode!==c.u||e.shiftKey||(e.preventDefault(),this.scope.$apply((()=>{this.closePanel()})))})),this.offcanvasPanelElement.find("a, button").first().on("keydown.bbFoundationOffcanvas",(e=>{e.keyCode===c.u&&e.shiftKey&&(e.preventDefault(),this.scope.$apply((()=>{this.closePanel()})))})),this.scope.$on("foundation-offcanvas-close-panel",(()=>{this.closePanel()})),null!=this.attrs.bbFoundationOffcanvasCommonParent){if(this.commonParent=i("#"+this.attrs.bbFoundationOffcanvasCommonParent),0===this.commonParent.length)throw new Error("The bbFoundationOffcanvas directive couldn't find a common parent element with an ID of "+this.attrs.bbFoundationOffcanvasCommonParent)}else this.commonParent=i(this.wrapperElement).parents().has(this.closeButtonElement).first();if(this.commonParent.hasClass("group-list")||this.commonParent.addClass("off-canvas-wrap off-canvas-overlay"),!this.overrideButtonClass){const e=this.offcanvasPanelElement.find("li").not(".ng-hide").length;this.commonParent.addClass("buttons-"+e)}a.b(this.commonParent,(e=>(this.isPanelOpen&&(e.data.noTransitions||"right"===e.originalEvent.propertyName)&&(this.isFromKeyBoard?this.offcanvasPanelElement.find("a, button").first().focus():(this.offcanvasPanelElement.parent().attr("tabindex",0),this.offcanvasPanelElement.parent().focus())),!1))),this.element.foundation(),this.scope.$on("$destroy",(()=>{this.element.off("click.bbFoundationOffcanvas"),this.closeButtonElement.off("click.bbFoundationOffcanvas"),this.offcanvasPanelElement.find("a, button").last().off("keydown.bbFoundationOffcanvas"),this.offcanvasPanelElement.find("a, button").first().off("keydown.bbFoundationOffcanvas"),this.commonParent.removeClass("off-canvas-wrap off-canvas-overlay")}))}),this.scope,0,!1)}getPosition(){switch(this.position){case"right":return"left";case"top":return"bottom";case"bottom":return"top";default:return"right"}}_openPanel(){this.offcanvasPanelElement.css("display","block"),this.justOpenedPanel=!0,this.timeout((()=>{this.offcanvasPanelElement.foundation("offcanvas","show","move-"+this.getPosition()),this.isPanelOpen=!0,this.offcanvasPanelElement.find("a, button").attr("tabindex","0"),this.justOpenedPanel=!1}),this.scope,0,!1)}openPanel(){if(this.wiredup)this._openPanel();else{const e=this.$q.defer();this.scope.$watch("::foundationOffcanvas.wiredup",(t=>{t&&e.resolve()})),this.$q.all([this.wireup(),e.promise]).then((()=>{this._openPanel()}))}}closePanel(){this.offcanvasPanelElement.foundation("offcanvas","hide","move-"+this.getPosition()),this.isPanelOpen=!1,this.isFromKeyBoard=!1,this.offcanvasPanelElement.parent().removeAttr("tabindex"),this.offcanvasPanelElement.find("a, button").attr("tabindex","-1"),this.openButtonElement.focus(),this.timeout((()=>{this.isPanelOpen||this.offcanvasPanelElement.css("display","none")}),this.scope,300,!1)}handleClickOutside(){this.dialogModel||i("body").hasClass("modal-open")||this.justOpenedPanel||this.closePanel()}togglePanel(){this.isPanelOpen?this.closePanel():this.openPanel()}}m.$inject=["scope","element","attrs","$compile","$parse","$q",r.b];class h{constructor(e){this.$injector=e,this.transclude=!0,this.restrict="E",this.link=(e,t,s)=>{if(null==s.bbFoundationOffcanvasOpenButton||null==s.bbFoundationOffcanvasCloseButton)throw new Error('Please provide jQuery selectors for both the "Open Menu" and "Close Menu" buttons');const n=s.$observe("bbFoundationOffcanvasCloseButton",(i=>{i&&(e.foundationOffcanvas=this.$injector.instantiate(m,{scope:e,element:t,attrs:s}),n())}))},this.template=l}}h.$inject=["$injector"],n.module(d,[o.a,r.a]).directive("bbFoundationOffcanvas",["$injector",e=>e.instantiate(h)])},vDpp:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("QACz");const o="ultra.components.directives.bbUiIcon.medium.ProctorShield";Object(n.a)(i.a,o,"bbUiIconMediumProctorShield")},vcLy:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-started",use:"icon-small-started-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-started"><circle cx="8" cy="8" r="7" transform="rotate(-90 8 8)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M12 8H4s0 4 4 4 4-4 4-4z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M10.8247 9a3.594 3.594 0 01-.2191.5528c-.1907.3814-.461.7323-.8478.9901C9.3773 10.7966 8.825 11 8 11c-.825 0-1.3773-.2034-1.7578-.4571-.3868-.2578-.657-.6087-.8478-.9901A3.5857 3.5857 0 015.1754 9h5.6493z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},viYV:function(e,t){e.exports='<div bb-grade-grid-menu-reborn id="{{id}}" class="reborn-dropdown-menu">\n  <ul class="f-dropdown f-dropdown-overflow-menu reborn-dropdown cell-dropdown" role="menu">\n    <li role=“presentation”>\n        <button role="menuitem" \n                class="js-view-submission button clear" \n                ng-click="cell.view()" \n                ng-disabled="!cell.canBeView"\n                analytics-id="components.directives.grade.grid.viewItemRecord" >\n          <bb-svg-icon size="small" icon="visible"></bb-svg-icon>\n          <bb-translate  course-org-token-resolver class="ellipse">components.directives.grade.grid.viewItemRecord</bb-translate>\n        </button>\n    </li>\n  </ul>\n</div>'},"w/V/":function(e,t,s){"use strict";s("HApu"),s("dV61");var n=s("Llzl"),i=s("ZQFV"),o=s("jhBu"),a=s("8W6D"),r=s("X6r5"),c=s("lEL+"),l=s("TnpK"),d=s("MYrX"),u=s("zGdY");s.d(t,"d",(function(){return p})),s.d(t,"a",(function(){return m})),s.d(t,"c",(function(){return h})),s.d(t,"b",(function(){return b}));const p="ultra.components.directives.rubric.rubricSettings",m="associated-rubric-updated",h="bb-rubric-settings-save",b="bb-rubric-settings-gradecolumn-refresh";class g{constructor(e,t,s,n,i,o){this.scope=e,this.element=t,this.attrs=s,this.ultraState=n,this.timeout=i,this.entitlement=o,this.contextArea="rubrics",this.hasRubricPermissions=!0,this.setAssociatedRubric=(e,t)=>{this.rubric=null!=e?e:null,this.saveRubricAssociations(t),this.broadcastRubricChanges(),this.scope.$emit("rubric-settings-rubric-updated",this.originalRubric&&this.rubric&&this.originalRubric.id===this.rubric.id)},e.rubricSettings=this,this.setGradeColumn(e.gradeColumnId()),e.$watch(e.gradeColumnId,(e=>{null===this.gradeColumn&&this.gradeColumn.id===e||this.setGradeColumn(e)})),e.$on(h,((e,t)=>{t&&(this.gradeColumn=t),this.saveRubricAssociations()})),e.$on("associate-rubric",((e,t,s)=>{this.setAssociatedRubric(t,s),this.timeout((()=>{this.element.find(".rubric-title a").focus()}),this.scope)})),e.$on("rubric-save",((e,t)=>{this.rubric&&this.rubric.id===t.id&&(this.rubric=t)})),e.$on("$stateChangeStart",((e,t,s,i,o)=>{i.name.indexOf("rubric.mode")>1&&a.a.CREATE.isEqualTo(a.a.parse(n.params.mode))&&(t.name.indexOf("assignment.peek.rubric-list")>1||t.name.indexOf("assignment-create.peek.rubric-list")>1)&&null!=this.rubric&&(e.preventDefault(),n.leavePeekState(t.name))}))}saveRubricAssociations(e){if(this.gradeColumn){if(this.originalRubric&&this.rubric&&this.originalRubric.id===this.rubric.id)this.scope.$root.$broadcast(b,this.gradeColumn,this.rubric);else{this.rubric?(this.gradeColumn.setRubricAssociation(this.rubric.id),this.rubric.associated=!0,Number.isFinite(e)&&!this.ultraState.includes("**.discussion.**")&&this.gradeColumn.setMaxPossiblePoints(e)):this.gradeColumn.setRubricAssociation(null);const t={expand:"associatedRubrics"};this.originalRubric&&this.originalRubric.readOnly&&(t.cascade=this.originalRubric.readOnly),this.gradeColumn.withParams(t).$patch().$then((e=>{this.gradeColumn.rubricAssociations=e.rubricAssociations,this.scope.$root.$broadcast(b,this.gradeColumn,this.rubric)}))}this.originalRubric=this.rubric}}broadcastRubricChanges(){this.shouldBroadcastRubricChanges()&&this.scope.$root.$broadcast(m,this.gradeColumn,this.rubric)}toggleRubricList(){this.scope.$root.$broadcast("open-rubric-list-panel")}removeActiveRubric(e){e&&e.stopPropagation(),this.rubric=null,this.saveRubricAssociations(),this.scope.$emit("rubric-settings-rubric-updated",this.originalRubric&&this.rubric&&this.originalRubric.id===this.rubric.id),this.broadcastRubricChanges()}setGradeColumn(e){e&&(this.gradeColumn?this.gradeColumn.$then(this.doSetGradeColumn.bind(this)):this.doSetGradeColumn())}doSetGradeColumn(){this.scope.course.gradebook.columns.$find(this.scope.gradeColumnId(),{expand:"associatedRubrics",_:(new Date).getTime()}).$then((e=>{this.gradeColumn=e,this.gradeColumn&&this.gradeColumn.hasRubricAssociation()?this.scope.course.rubrics.$find(this.gradeColumn.getAssociatedRubricId()).$allow(["403"]).$asPromise().then((e=>{403!==e.$response.status?(this.originalRubric=e,this.rubric=e,this.hasRubricPermissions=!0):this.hasRubricPermissions=!1})):(this.originalRubric=null,this.rubric=null),this.entitlement.hasCourseEntitlement(i.GradebookEntitlement.ModifyGradebook,this.gradeColumn.courseId).then((e=>{e&&this.hasEvaluations()}))}))}hasEvaluations(){this.gradeColumn.hasEvaluations().then((e=>{this.hasRubricEvals=e}))}shouldBroadcastRubricChanges(){return this.scope.broadcastRubricChanges&&this.scope.broadcastRubricChanges()}columnIsAssignmentCategory(){var e,t;return(null===(t=null===(e=this.gradeColumn)||void 0===e?void 0:e.gradebookCategory)||void 0===t?void 0:t.title)===u.KnownGradebookCategoryTitle.Assignment}getPeerGradingInfo(){return this.scope.peerGradingEnabled?"peerGrading":null}}g.$inject=["scope","element","attrs",l.d,c.b,o.b];class v{constructor(e,t){this.$compile=e,this.$injector=t,this.restrict="E",this.template=d,this.scope={course:"=",gradeColumnId:"&",contentHasQuestions:"&?",peerGradingEnabled:"<",broadcastRubricChanges:"&?",isDisabled:"&?"},this.link=(e,t,s)=>{e.rubricSettings=this.$injector.instantiate(g,{scope:e,element:t,attrs:s})}}}v.$inject=["$compile","$injector"],n.module(p,[r.a,l.b]).directive("bbRubricSettings",["$injector",e=>e.instantiate(v)])},wAfT:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("GAfu");const o="ultra.components.directives.bbUiIcon.small.Lock";Object(n.a)(i.Lock,o,"bbUiIconSmallLock")},wAzH:function(e,t,s){},wJOA:function(e,t){e.exports='<div class="grade-grid-cell grade-grid-body-cell"\n     tabindex="0"\n     ng-click="gradeGridColumnOverallReborn.enterEditor($event)"\n     analytics-id="components.directives.grade.grid.gradeGridColumnOverallReborn.enterEdit"\n>\n  <div class="overall-display-grade" ng-class="{\'editor-disable\': gradeGridColumnOverallReborn.disabledEditor}"\n       aria-label="{{gradeGridColumnOverallReborn.ariaLabelContent}}">\n    \x3c!--<bb-display-grade column="col.data" display-type="GradeColor" grade-detail="gradeGridColumnOverallReborn.gradeDetail"></bb-display-grade>--\x3e\n    <bb-display-grade-pill column="col.data" grade="gradeGridColumnOverallReborn.gradeDetail"></bb-display-grade-pill>\n  </div>\n</div>'},wKTs:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-upload",use:"icon-small-upload-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-upload"><path d="M14 5h1v9H1V5h1M6 4l2-2 2 2M8 10V2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},wNBd:function(e,t){e.exports='<bb-modal id="confirm-submit-attempt-modal" class="notification success"\n          modal-title-key="{{assessmentAttempt.submitModalHeaderKey}}"\n          modal-translate-options="assessmentAttempt.submitModalTranslateOptions"\n          analytics-id-tag-prefix="course.content.assessment.test.modal.confirmSubmitAttemptAlert">\n  <div name="modal-contents">\n    <span ng-if="assessmentAttempt.shouldShowInProgressWarning" bb-translate translate-values="{number: assessmentAttempt.questionAttemptView.unansweredQuestionCount}">\n      course.content.assessment.modal.confirmSubmitAttemptAlert.inProgressWarning.plural\n    </span>\n    <span bb-translate="{{::assessmentAttempt.submitModalBodyKey}}" translate-values="{\'title\': assessmentAttempt.customCategory}"></span>\n  </div>\n  <button name="modal-footer-button-primary" class="button confirm-ok js-primary-button" ng-click="$parent.$close()" bb-translate course-org-token-resolver analytics-id="course.content.assessment.test.modal.confirmSubmitAttemptAlert.submit">\n    course.content.assessment.test.modal.confirmSubmitAttemptAlert.submit\n  </button>\n  <button name="modal-footer-button-secondary" class="button button--secondary confirm-cancel js-secondary-button" ng-click="$parent.$dismiss()" bb-translate analytics-id="global.cancel">\n    {{assessmentAttempt.shouldShowInProgressWarning ? \'course.content.assessment.modal.confirmSubmitAttemptAlert.keepWorking\' : \'global.cancel\'}}\n  </button>\n</bb-modal>\n'},wtKk:function(e,t,s){"use strict";(function(e){s.d(t,"c",(function(){return y})),s.d(t,"a",(function(){return O})),s.d(t,"b",(function(){return A}));var n=s("D57K"),i=(s("dkOF"),s("r+pC"),s("Llzl")),o=s("jO50"),a=s("+fEV"),r=s("0JpG"),c=s("+e2k"),l=s("TnpK"),d=s("QaOk"),u=s("+4Px"),p=s("X455"),m=s("lEL+"),h=s("en1n"),b=s("oQrK"),g=s("XQ/u"),v=s("7cYF"),f=s("aHpC"),w=s("yC9S"),S=s("nsO7"),C=s("ZzR9");const y="ultra.components.directives.sliderTabNavigation",O="consultTabStatus",A="hideCurrentActiveSliderTabContent";let I=class{constructor(e,t,s,n,i,o,a,r){this.scope=e,this.$rootScope=t,this.tabElement=s,this.$q=n,this.ultraState=i,this.timeout=o,this.membership=a,this.localizeService=r,this.isDesktop=b.a.detect().desktop(),this.tabsHasBeenSet=!1,this.isSliderTabExpanded=!0,this.isTransitioning=!1,this.navigationBlocker={navigationPromise:null},this.closeParentPeek=!1,this.navigationBlockedWasHandled=!1,this.showLoader=!1,this.nextTabFocusNameId="",this.desktopViewHeight="initial",this.shouldHideView=!1,this.isStudent=this.membership.isStudentMembership(),this.registerStateListener(),this.largeStartBreakpoint=h.e().large.start,this.translatedCollapsedKey=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.slider-tab-navigation.collapsible-tooltip.collapse-message"}),this.translatedExpandedKey=this.localizeService.translateSync({locale:this.localizeService.getLocale(this.scope),key:"components.directives.slider-tab-navigation.collapsible-tooltip.expand-message"}),this.scope.$watch("tabs",(()=>{o((()=>{this.initTemplateView()}),this.scope)}),!0),this.timeout((()=>{this.calculateDesktopHeights(),this.scope.$apply()}),this.scope)}initTemplateView(){const e=this.getTabFromState();if(!e)return this.activeTab=this.isDesktop?this.scope.tabs.browsableSection.main:this.scope.tabs.transcludedSection,void(this.tabsHasBeenSet=!0);this.isDesktop&&e.nameId===this.scope.tabs.transcludedSection.nameId?this.ultraState.goPeekState(this.scope.tabs.browsableSection.main.stateRoute,this.scope.tabs.browsableSection.main.stateArgs).then((()=>{this.tabsHasBeenSet=!0})):(this.activeTab=e,this.tabsHasBeenSet=!0)}getTabFromState(e){const t=e?e.name:this.ultraState.current.name;return this.stateMatches(this.scope.tabs.transcludedSection.stateRoute,t)?this.scope.tabs.transcludedSection:this.stateMatches(this.scope.tabs.browsableSection.main.stateRoute,t)?this.scope.tabs.browsableSection.main:this.scope.tabs.browsableSection.browsableTabs.find((e=>this.stateMatches(e.stateRoute,t)))}stateMatches(e,t){return new RegExp(`${e}$`).test(t)}registerStateListener(){this.scope.$on(v.b,((e,t)=>{var s;(null===(s=this.activeTab)||void 0===s?void 0:s.enableModalBlockNavigation)&&(this.$rootScope.$broadcast(O,this.activeTab.nameId,t),t.navigationPromise&&!this.isSliderTabExpanded&&this.toggleVisibility())})),this.scope.$on("$stateChangeStart",((e,t,s,n)=>this.getTabFromState(n)?this.navigationBlockedWasHandled&&this.isDesktop&&this.activeTab.nameId===this.scope.tabs.transcludedSection.nameId?void this.ultraState.goPeekState(this.scope.tabs.browsableSection.main.stateRoute,this.scope.tabs.browsableSection.main.stateArgs):this.isClosingParent(t)||this.getTabFromState(t)?this.isDesktop&&this.stateMatches(this.scope.tabs.browsableSection.main.stateRoute,n.name)&&this.stateMatches(this.scope.tabs.transcludedSection.stateRoute,t.name)||this.isClosingParent(t)&&this.activeTab.enableModalBlockNavigation?(this.closeParentPeek=!0,this.checkTabStatusAndBlockNavigation(e)):!this.isClosingParent(t)&&this.isChangingTab(t)&&(this.closeParentPeek=!1,this.activeTab.enableModalBlockNavigation&&this.getTabFromState(n))?(this.nextTab=this.getTabFromState(t),this.checkTabStatusAndBlockNavigation(e)):(this.activeTab=this.getTabFromState(t),this.showLoader=!0,this.$q.resolve(void 0)):this.$q.resolve(void 0):this.$q.resolve(void 0))),this.scope.$on("$stateChangeSuccess",((e,t,s,n)=>{if(!this.getTabFromState(n))return this.$q.resolve(void 0);this.navigationBlockedWasHandled=!1,this.showLoader=!1})),this.scope.$on(C.a.$locationChangeSuccess,(()=>{this.shouldHideView=!1,this.isSliderTabExpanded||this.toggleVisibility()})),w.b.OnWindow("resize",(()=>{this.calculateDesktopHeights(),this.scope.$apply()}),this.scope),w.b.OnRootScope(this.scope,A,(()=>{this.shouldHideView=!0})),this.isDesktop&&this.subscribeScrollListener(),this.scope.$on("$destroy",(()=>{i.element(this.scope.scrollContainer).unbind("scroll")}))}isLargeBreakpoint(){return h.g()>this.largeStartBreakpoint}calculateDesktopHeights(){if(!this.isDesktop)return;if(!this.isLargeBreakpoint())return this.mainSectionHeight="initial",void(this.desktopViewHeight="initial");const e=window.innerHeight,t=this.getSelectorHeightAndOffset(".slider-tab-navigation-desktop__main-section"),s=Math.max(t.offset,0);this.mainSectionHeight=e-s+"px",this.desktopViewHeight=`${window.innerHeight}px`}getSelectorHeightAndOffset(e){let t,s;const n=document.querySelector(e);if(n instanceof HTMLElement){const e=parseFloat(getComputedStyle(n).paddingBottom),i=parseFloat(getComputedStyle(n).paddingTop);t=n.clientHeight-i-e,s=n.getBoundingClientRect().top}return{height:t,offset:s}}subscribeScrollListener(){const e=Object(S.throttle)((()=>{this.calculateDesktopHeights(),this.scope.$apply()}),90);i.element(this.scope.scrollContainer).scroll(e)}isClosingParent(e){return!this.navigationBlockedWasHandled&&e.name.indexOf(this.scope.tabs.transcludedSection.stateRoute)<0}isChangingTab(e){return!this.navigationBlockedWasHandled&&this.activeTab&&!this.stateMatches(this.activeTab.stateRoute,e.name)}checkTabStatusAndBlockNavigation(e){return e.preventDefault(),this.navigationBlocker={navigationPromise:null},this.$rootScope.$broadcast(O,this.activeTab.nameId,this.navigationBlocker),this.navigationBlocker.navigationPromise?(this.isSliderTabExpanded||this.toggleVisibility(),this.navigationBlocker.navigationPromise.then((()=>{this.resumeNavigation()}))):(this.resumeNavigation(),this.$q.resolve(void 0))}resumeNavigation(){this.navigationBlockedWasHandled=!0,this.closeParentPeek?this.ultraState.leavePeekState(this.ultraState.current.name):(this.activeTab=this.nextTab,this.showLoader=!0,this.ultraState.goPeekState(this.activeTab.stateRoute,this.activeTab.stateArgs))}getTooltipText(){return this.isSliderTabExpanded?this.translatedCollapsedKey:this.translatedExpandedKey}goToTab(e){this.isSliderTabExpanded?this.ultraState.goPeekState(e.stateRoute,e.stateArgs):this.toggleVisibility().then((()=>{this.ultraState.goPeekState(e.stateRoute,e.stateArgs)}))}goBack(){this.nextTabFocusNameId=this.activeTab.nameId,this.ultraState.goPeekState(this.scope.tabs.browsableSection.main.stateRoute,this.scope.tabs.browsableSection.main.stateArgs)}get viewName(){return`${this.scope.tabs.transcludedSection.stateRoute}@`}shouldRenderTranscludedElement(){return this.activeTab&&this.activeTab.title===this.scope.tabs.transcludedSection.title}shouldRenderPeekRoutedElement(){return this.activeTab&&this.activeTab.title!==this.scope.tabs.transcludedSection.title}shouldRenderTabs(){return this.activeTab&&this.activeTab.nameId===this.scope.tabs.browsableSection.main.nameId&&this.scope.tabs.browsableSection.browsableTabs.length>0}toggleVisibility(){return this.isSliderTabExpanded=!this.isSliderTabExpanded,this.isTransitioning=!0,this.timeout((()=>{this.isTransitioning=!1}),this.scope,500)}handleTabKeyDown(t,s){if(t.keyCode===u.t)return t.preventDefault(),void this.goToTab(s);if(t.keyCode!==u.i){if(t.keyCode===u.e){t.preventDefault();const s=this.scope.tabs.browsableSection.browsableTabs.length;if(s>0)return void e(`#slider-tab-${this.scope.tabs.browsableSection.browsableTabs[s-1].nameId}`).focus();e(`#slider-tab-${this.scope.tabs.browsableSection.main.nameId}`).focus()}}else{t.preventDefault();const s=this.isDesktop?this.scope.tabs.browsableSection.browsableTabs[0].nameId:this.scope.tabs.transcludedSection.nameId;e(`#slider-tab-${s}`).focus()}}handleBackArrowKeyDown(e){e.keyCode===u.u&&e.shiftKey&&e.preventDefault()}handleLastElementFocus(){this.tabElement.find(".slider-tab-navigation-desktop__browsable-section-go-back").focus()}};I=Object(n.__decorate)([Object(n.__param)(0,Object(f.b)("$scope")),Object(n.__param)(1,Object(f.b)("$rootScope")),Object(n.__param)(2,Object(f.b)("$element")),Object(n.__param)(3,Object(f.b)("$q")),Object(n.__param)(4,Object(f.b)(l.d)),Object(n.__param)(5,Object(f.b)(m.b)),Object(n.__param)(6,Object(f.b)(p.d)),Object(n.__param)(7,Object(f.b)(r.serviceName))],I);class D{constructor(){this.controller=I,this.controllerAs="sliderTabNavigation",this.template=b.a.detect().desktop()?o:a,this.transclude=!0,this.scope={tabs:"=",scrollContainer:"@"}}}i.module(y,[c.a,d.a,g.a]).directive("bbSliderTabNavigation",["$injector",e=>e.instantiate(D)])}).call(this,s("71td"))},wy9x:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var n=s("Llzl"),i=s("Jwnl"),o=s("Y+9S");const a="ultra.components.directives.content.contentItem.contentItemType.contentItemFolder";class r{constructor(e,t,s){this.scope=e,this.element=t,this.attrs=s}toggleFolder(){if(!this.scope.content.ui.isOpen){const e={type:o.MessageType.FolderOpened,status:o.MessageStatus.Success,contentId:this.scope.content.id};Object(o.sendMessageToMobile)(e)}this.scope.$emit("toggle-folder",this.scope.content)}shouldAlignMiddle(){const e=this.scope.content;return!e.canViewAsInstructor()&&(!e.description&&(!e.isVisible()||!e.adaptiveReleaseRules))}}r.$inject=["scope","element","attrs"];class c{constructor(e){this.$injector=e,this.restrict="E",this.template=i,this.scope=!1,this.link=(e,t,s)=>{e.contentItemFolder=this.$injector.instantiate(r,{scope:e,element:t,attrs:s})}}}c.$inject=["$injector"],n.module(a,[]).directive("bbContentItemFolder",["$injector",e=>e.instantiate(c)])},xAaQ:function(e,t,s){"use strict";s.d(t,"a",(function(){return d}));var n=s("Llzl"),i=s("wy9x"),o=s("jhBu"),a=s("Sa5G"),r=s("TnpK"),c=s("sB2Z"),l=s("nmzr");const d="ultra.components.directives.content.contentItem.contentItemEngagementOutline";class u{constructor(e,t,s){this.scope=e,this.entitlementService=t,this.ultraState=s,this.entitlementService.hasCourseEntitlement(a.e.ModifyContent,this.scope.content.courseId).then((e=>{this.entitledToModifyContent=e}))}get canOpenConditionalRelease(){return!!(this.scope.content&&this.scope.content.permissions&&this.scope.content.permissions.adaptiveRelease&&this.scope.content.permissions.adaptiveRelease.view)}openConditionalRelease(){this.isCourseCompletedAndInInstructorView()||this.ultraState.goPeekState(l.ContentRoutes.CONDITIONAL_RELEASE_PEEK_PANEL,{contentId:this.scope.content.id})}isCourseCompletedAndInInstructorView(){return!this.scope.content.canEdit()&&this.scope.content.canViewAsInstructor()}isDiscussionCreatedByStudent(){var e;let t=!1;const s=null===(e=this.scope.content.contentDetail)||void 0===e?void 0:e["resource/x-bb-forumlink"];return s&&(t=s.isDiscussionCreatedByStudent),!!t}}u.$inject=["scope",o.b,r.d];class p{constructor(e){this.$injector=e,this.restrict="E",this.template=c,this.scope=!1,this.link=e=>{e.contentItemEngagementOutline=this.$injector.instantiate(u,{scope:e})}}}p.$inject=["$injector"],n.module(d,[i.a,r.b]).directive("bbContentItemEngagementOutline",["$injector",e=>e.instantiate(p)])},xMZ0:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("OhrW");const o="ultra.components.directives.bbUiIcon.large.DocumentText";Object(n.a)(i.DocumentText,o,"bbUiIconLargeDocumentText")},xXFZ:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-custom-arrow-up",use:"icon-custom-arrow-up-usage",viewBox:"0 0 9 9",content:'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 9 9" id="icon-custom-arrow-up"><path fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke-miterlimit="10" d="M8 6.09L4.476 2.91 1 6.09" /></symbol>'});i.add(o);e.exports=o},xcel:function(e,t,s){"use strict";(function(e){s.d(t,"a",(function(){return O}));var n=s("Llzl"),i=s("nsO7"),o=s("LN5R"),a=s("o5Lu"),r=s("lEL+"),c=s("0JpG"),l=s("jhBu"),d=s("iViV"),u=s("pjml"),p=s("+4Px"),m=s("cbVV"),h=s("TmUJ"),b=s("C2vp"),g=s("Sa5G"),v=s("dF44"),f=s("qH3X"),w=s("Ui4O"),S=s("trPQ"),C=s("viYV"),y=s("E7GM");const O="ultra.components.directives.gradeGridColumnReborn";class A{constructor(e,t,s,n,o,a,r,c,l,d,u,p,h){this.rootScope=e,this.window=t,this.$q=s,this.CourseModel=n,this.gradeService=o,this.$compile=a,this.scope=r,this.element=c,this.attrs=l,this.gradeGridRebornController=d,this.timeout=u,this.bbLocalize=p,this.entitlementService=h,this.isRestrictedGroupContent=!1,this.hasEntitlementsToGradeCell=()=>{if(this.isRestrictedGroupContent)return!1;if(!this.cell.canBeEdited)return!1;const e=this.cell;return e.data&&e.data.grade?this.gradeService.canGrade(e.data.grade.gradeScoreDesignation):!(!e.column||!e.column.data)&&this.gradeService.canGrade(e.column.data.gradeScoreDesignation)},this.isCellGradeable=e=>!this.isRestrictedGroupContent&&(!i.isUndefined(e)&&(!this.gridData.course.isComplete()&&(!(i.isUndefined(this.group)&&e.column instanceof m.g)&&e.canBeEdited))),this.canGradeCell=()=>this.isCellGradeable(this.cell)&&this.hasEntitlementsToGradeCell(),this._isUpdating=!1,this.initializeEventHandler(),this.gridData=this.gradeGridRebornController.getGridData(),r.$watchGroup(["row","col"],(e=>{const[t,s]=e;this.initializeCell(t.id,s.id),this.initializeState(),this.initializeUI()})),r.$on(f.a.REFRESH,((e,t)=>{this._isUpdating=!1;const s=t.rowId,n=t.columnIds;i.forEach(n,(e=>{this.scope.row.id===s&&this.cell.column.id===e&&(this.initializeCell(s,e,!1),this.initializeUI(),this.scope.$broadcast(f.a.REFRESH_CELL_EDITOR))}))})),r.$on(v.b.ENTER_CELL,((e,t)=>t.find(".grade-grid-cell").click())),r.$on("$destroy",(()=>{})),r.$on(f.a.ENTER_EDITOR,((e,t)=>{i.isUndefined(t.group)||i.isUndefined(this.group)||t.group.groupId!==this.group.groupId||this.cell.column.id!==t.columnId||(this._freezeGroup=!0)})),r.$on(f.a.CLOSE_EDITOR,((e,t)=>{this.group&&this._freezeGroup&&(this._freezeGroup=!1)}))}initializeState(){this._isEditing=!1,this.resetGradePost()}initializeCell(e,t,s=!0){this.cell=this.gridData.getCell(e,t),this.setUpScreenReader(this.cell,this.score),this._oldScore=this._score=void 0,this.group&&s&&this.element.children(".grade-grid-cell").removeClass(`group-id-${this.group.groupId} group-grade-cell selected`),this._group=void 0,this._isOtherGroupMemberGraded=void 0,this.cell instanceof b.e&&(this._group=this.cell.group,this.element.children(".grade-grid-cell").addClass(`group-id-${this.group.groupId} group-grade-cell`)),this.setSelectEventListener()}setSelectEventListener(){this.group&&i.isUndefined(this.unbindSelectEvent)&&!this.isRestrictedGroupContent?this.unbindSelectEvent=this.scope.$on(f.a.SELECT_GROUP,((e,t)=>{this.group.groupId===t.groupId&&this.cell.column.id===t.columnId&&t.enter?this.element.children(".group-grade-cell").addClass("selected"):this.element.children(".group-grade-cell").removeClass("selected")})):i.isUndefined(this.group)&&!i.isUndefined(this.unbindSelectEvent)&&(this.unbindSelectEvent(),this.unbindSelectEvent=void 0)}initializeEventHandler(){this.element.parents(".rb-cell").mouseenter((()=>this.mouseEnterHandler())).mouseleave((()=>this.mouseLeaveHandler())).focus((()=>this.keyEnterHandler())).blur((()=>this.keyLeaveHandler())).focusin((()=>{this.focusin(),this.mouseEnterHandler(),this.showPointsPossible()})).focusout((()=>{this.focusout(),this.mouseLeaveHandler(),this.hidePointsPossible()})).click((()=>{this.showPointsPossible()}))}focusin(){this.isRestrictedGroupContent||this.rootScope.$broadcast(f.a.FOCUSIN_CELL,{rowId:this.scope.row.id,columnId:this.cell.column.id})}focusout(){this.isRestrictedGroupContent||this.rootScope.$broadcast(f.a.FOCUSOUT_CELL,{rowId:this.scope.row.id,columnId:this.cell.column.id})}showElement(e){e.removeClass("hide")}hideElement(e){e.addClass("hide")}initializeUI(){const e=this.element.constructor.fn,t=e.show,s=e.hide;e.show=function(){return this.removeClass("hide")},e.hide=function(){return this.addClass("hide")},(this.group||this.cell.column.data&&this.cell.column.data.groupContent)&&(this.isRestrictedGroupContent=!this.entitlementService.isEntitled(g.n.ViewGroups,this.gridData.course.id));const n=this.element.children(".grade-grid-cell");if(this.isLoading)n.removeClass("grade-now-bg").find(".score, .ungraded, .anonymous").hide();else{if(!this.gridData.canViewGrades||this.isRestrictedGroupContent)if(this.cell.data)n.addClass("grade-now-bg"),n.find(".score").show().find("#displayedScore").show().find("#display").text("--").show();else{const e=n.find("#displayedScore");e.children("#display").text("").hide(),e.hide()}else{const e=this.displayedScore;if(this.cell.isAnonymousGrading||e?n.removeClass("grade-now-bg"):n.addClass("grade-now-bg"),this.isEditing||this.cell.isAnonymousGrading?n.children(".score").hide():n.children(".score").show(),e){const t=n.find("#displayedScore");t.children("#display").text(e).show(),t.show()}else{const e=n.find("#displayedScore");e.children("#display").text("").hide(),e.hide()}if(this.isPastDueZero?n.find("#pastDueZero").show():n.find("#pastDueZero").hide(),this.isPosted&&!this.isPastDueZero?n.find("#posted").show():n.find("#posted").hide(),this.canGradeCell()&&!e?n.find("#gradeNow").show():n.find("#gradeNow").hide(),this.hasNewSubmission?n.find("#newSubmission").show():n.find("#newSubmission").hide(),this.canGradeCell()?n.find("#blank").hide():n.find("#blank").show(),this.cell instanceof b.c&&this.ungradedItemCount&&this.ungradedItemCount>0?(this.ungraded=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grid.ungraded",params:{count:this.ungradedItemCount},noWrap:!0,noEscape:!0}),n.find("#ungraded").show()):n.find("#ungraded").hide(),this.cell instanceof b.c){const e=this.pointsPossible;n.find("#pointsPossible").text(i.isUndefined(e)?"":e.toString())}this.cell.isAnonymousGrading?n.find(".anonymous").show():n.find(".anonymous").hide()}}e.show=t,e.hide=s}showPointsPossible(){if(this.cell instanceof b.c){const e=this.element.children(".grade-grid-cell");e.addClass("purple-outline"),e.find("#displayedScore").children("#display").text(this.score),this.showElement(e.find("#displayedScore")),this.showElement(e.find("#slash")),this.showElement(e.find("#pointsPossible")),this.timeout((()=>{const e=this.scope.$on(v.b.SCROLL_H,(()=>{this.hidePointsPossible(),e(),t()})),t=this.scope.$on(v.b.SCROLL_V,(()=>{this.hidePointsPossible(),t(),e()}))}),this.scope,200)}}hidePointsPossible(){if(this.cell instanceof b.c){const e=this.element.children(".grade-grid-cell");e.removeClass("purple-outline"),e.find("#displayedScore").children("#display").text(this.displayedScore),this.hideElement(e.find("#slash")),this.hideElement(e.find("#pointsPossible"))}}resetGradePost(){this._isReadyToPost=void 0}get isReady(){return!i.isUndefined(this.cell)}get isLoading(){return!this.isReady||!this.cell.isLoaded}get isPosted(){return!i.isUndefined(this.cell)&&this.cell.isPosted}get hasNewSubmission(){return!i.isUndefined(this.cell)&&this.cell.hasNewSubmission}get isPastDueZero(){return!i.isUndefined(this.cell)&&this.cell.isPastDueZero}get displayedScore(){if(!this.isLoading)return this.formatScore()}get ungradedItemCount(){if(this.isReady){if(this.cell.data)return this.cell.data.grade.ungradedItemCount;if(this.gridData.getColumnMetadata(this.cell.column.id))return this.gridData.getColumnMetadata(this.cell.column.id).itemsCount}}get pointsPossible(){if(this.isReady&&this.cell.data&&this.displayedScore){const e=this.cell.data.grade.pointsPossible;return i.isUndefined(e)?e:Math.round(100*e)/100}}get score(){if(this.isReady){if(i.isUndefined(this._score)){const e=this.cell.getScore(this.scope);this._oldScore=this._score=e}return this._score}}set score(e){this._score=e}get isReadonly(){if(this.isReady)return!1}get isEditing(){return this._isEditing}get group(){return this._group}mouseEnterHandler(){this.group&&!this.isRestrictedGroupContent&&this.rootScope.$broadcast(f.a.SELECT_GROUP,{groupId:this.group.groupId,columnId:this.cell.column.id,enter:!0})}mouseLeaveHandler(){!this.group||this._freezeGroup||this.isRestrictedGroupContent||this.rootScope.$broadcast(f.a.SELECT_GROUP,{groupId:this.group.groupId,columnId:this.cell.column.id,enter:!1})}keyEnterHandler(){if(!this.cell.isAnonymousGrading)return;const e=this.element.find(".anonymous").children();e&&e.focus()}keyLeaveHandler(){if(!this.cell.isAnonymousGrading)return;const e=this.element.find(".anonymous").children();e&&e.blur()}insertCellEditor(){this.editorScope=this.scope.$new(!1,this.scope),this.$compile(A.CELL_EDITOR_TEMPLATE)(this.editorScope,(e=>this.element.children(".grade-grid-body-cell").append(e))),this.timeout((()=>{this.addInputKeyEventListeners();const e=this.scope.$on(v.b.SCROLL_H,(()=>{i.isEmpty(this.score)&&this.element.children(".grade-grid-cell").addClass("grade-now-bg"),this.closeEditor(),e(),t()})),t=this.scope.$on(v.b.SCROLL_V,(()=>{i.isEmpty(this.score)&&this.element.children(".grade-grid-cell").addClass("grade-now-bg"),this.closeEditor(),t(),e()}))}),this.scope,200)}removeCellEditor(){this.element.find("#bb-grade-grid-cell-editor-reborn").remove()}isConfirmDialogExisting(){return!!e(".grade-grid-group-confirm-dialog").length}enterEditor(e){if(!this.isConfirmDialogExisting()&&this.isCellGradeable(this.cell)&&!this.isLoading&&!this._isEditing){if(this.cell.column.data.isAttendance())this.gradeGridRebornController.attendanceIsAvailable&&(this.cell.canBeView&&this.popupMenu(e,!1),this.rootScope.$broadcast(f.a.SELECT_GROUP,{groupId:void 0,columnId:this.cell.column.id,enter:!1}));else{const t=this.hasEntitlementsToGradeCell();(this.cell.canBeView||this.cell.canPost())&&(t||(this.isReadyToPost=!!this.score),this.popupMenu(e,!0)),t&&(this._isEditing=!0,this.hideElement(this.element.find(".score")),this.element.children(".grade-grid-cell").removeClass("grade-now-bg"),this.insertCellEditor(),this.group?this.rootScope.$broadcast(f.a.ENTER_EDITOR,{group:this.group,columnId:this.cell.column.id}):this.rootScope.$broadcast(f.a.SELECT_GROUP,{groupId:void 0,columnId:this.cell.column.id,enter:!1}))}this.getIsOtherGroupMemberGraded()}}getIsOtherGroupMemberGraded(){this.group&&this.getGroupGrades(this.cell.column.id).then((()=>{this.isOtherGroupMemberGraded()}))}set isReadyToPost(e){this._isReadyToPost=e}get isReadyToPost(){return this._isReadyToPost}post(e,t){return t?this.cell.column.data.postReadyGroupAttempts({groupAssociationId:this.group.groupAssociationId}):this.cell.column.data.grades.$new(e.id).postReadyGrades()}fetchSummary(e){return this.cell.column.data.summary.$fetch(e).$asPromise()}popupMenu(t,s){const n=`grade-grid-cell-menu-reborn-${this.scope.row.id}-${this.scope.col.id}`;if(!this.gradeGridRebornController.isMenuExisting(n)){const i=e(t.target).closest(".grade-grid-cell").offset(),o=80;i.top+=o;const a=this.scope.$new(!0);a.cell=this.cell,a.post=()=>{(this.savePromise||this.$q.when()).then(((e=this.cell.getGrade())=>{this.postDefer&&(this.postDefer.resolve(!0),this.timeout.cancel(this.postDeferTimeout)),e&&(this.isGroupAssessment()?this.post(e,!0).then((()=>this.fetchSummary({timestamp:Date.now()}))).then((()=>{this.gridData.getGroupIdUserIdMap()[this.group.groupId].forEach((e=>{this.gridData.refreshDataCell(this.gridData.getRowByUserId(e),this.cell.column)})),this.rootScope.$broadcast(v.b.DATA_UPDATE),this.resetGradePost()})):this.post(e,!1).then((()=>this.fetchSummary({timestamp:Date.now()}))).then((()=>{this.gridData.refreshDataCell(this.cell.row,this.cell.column),this.rootScope.$broadcast(v.b.DATA_UPDATE),this.resetGradePost()})))}))},a.isReadyToPost=()=>!this._isUpdating&&this.cell.isReadyToPost&&this.isReadyToPost&&(!this.isGroupAssessment()||this._isOtherGroupMemberGraded),a.adjustPosition=e=>{i.top+e.height()>this.gradeGridRebornController.getGradeGridContainerElementBottom()&&(i.top-=o+e.height()),e.offset(i)},s?this.gradeGridRebornController.popupMenu(n,S,a):this.gradeGridRebornController.popupMenu(n,C,a),this.addMenuKeyEventListeners(),t.preventDefault(),t.stopPropagation()}}popupConfirmDialog(t){const s=`group-cell-confirm-dialog-reborn-${this.scope.row.id}-${this.scope.col.id}`,n=this.$q.defer();if(!this.gradeGridRebornController.isMenuExisting(s)){const i=this.scope.$new(!0);i.waiting=200,i.onBeforeDestroy=e=>{n.resolve(!0)},i.saveGroup=()=>{n.resolve(!0)},i.saveOne=()=>{n.resolve(!1)},i.isSaveOneDisabled=""===this.score,t.top+=80,i.adjustPosition=e=>{const s=t.left+e.width(),n=t.top+e.height(),i=this.gradeGridRebornController.getGradeGridContainerElementRight(),o=this.gradeGridRebornController.getGradeGridContainerElementBottom();s>i&&(t.left-=s-i+Object(h.a)()),n>o&&(t.top-=e.height()+80),e.offset(t)},i.$on("$destroy",(()=>{this.scope.$emit(v.b.LEAVE_CELL)})),this.gradeGridRebornController.popupMenu(s,y,i),this.timeout((()=>{const t=e(`#${s}`).find("button");t.on("keydown",(function(s){if(p.A(s))t.eq((t.index(this)+1)%t.length).focus();else if(p.z(s))t.eq((t.index(this)-1+t.length)%t.length).focus();else{if(s.keyCode!==p.g)return;e(window).click()}s.preventDefault(),s.stopPropagation()})),t.first().focus()}),this.scope,0,!1)}return n.promise}isOtherGroupMemberGraded(){this._isOtherGroupMemberGraded=i.isUndefined(i.findKey(this.studentIdGradeMap,((e,t)=>{const s=e.getScore();return this.cell.row.metadata.user.id!==t&&(""===s||i.isNull(s)||i.isUndefined(s))})))}addInputKeyEventListeners(){this.element.find("#bb-grade-grid-cell-editor-reborn input").on("keydown",(e=>{const t=this.gradeGridRebornController.getMenuitems();if(p.A(e))t.first().focus();else{if(!p.z(e))return;t.last().focus()}e.preventDefault(),e.stopPropagation()}))}addMenuKeyEventListeners(){this.timeout((()=>{const t=this.gradeGridRebornController.getPopupMenu();t.on("keydown",(s=>{const n=this.gradeGridRebornController.getMenuitems();if(p.A(s)){const t=n.index(e(s.target))+1;t<n.length?n.eq(t).focus():this.element.find(".grade-grid-cell").trigger("click",!0)}else if(p.z(s)){const t=n.index(e(s.target))-1;t>=0?n.eq(t).focus():this.element.find(".grade-grid-cell").trigger("click",!0)}else if(p.y(s))this.scope.$emit(v.b.LEAVE_CELL);else{if(s.keyCode!==p.g)return;t.data("destroy")(),this.scope.$emit(v.b.LEAVE_CELL)}s.preventDefault(),s.stopPropagation()}))}),this.scope,0,!1)}gotoNextCell(){this.nextDeferred=this.$q.defer(),this.nextDeferred.promise.then((()=>{this.scope.$emit(v.b.ENTER_NEXT_CELL)}))}onInputBlur(t,s,n){if(!this.isLoading&&this._isEditing)if(this.savePromise=this.$q.when(),this.postDefer=this.$q.defer(),this.postPromise=this.postDefer.promise,s){let s;this.score=n,i.isEmpty(this.score)&&this.element.children(".grade-grid-cell").addClass("grade-now-bg"),this.isDirty()?(s=this.$q.defer(),this.savePromise=s.promise):this.nextDeferred&&(this.nextDeferred.resolve(),this.nextDeferred=void 0);let o=this.$q.when(!1);this.isGroupAssessment()&&this.isDirty()&&(o=this.popupConfirmDialog(e(t.target).closest(".grade-grid-cell").offset())),o.then((e=>{this.showScoreTemporarily(),this.saveGrade(e,s),this.closeEditor()}))}else i.isEmpty(this.score)&&this.element.children(".grade-grid-cell").addClass("grade-now-bg"),this.closeEditor(),this.nextDeferred&&(this.nextDeferred.resolve(),this.nextDeferred=void 0)}showScoreTemporarily(){if(this.isDirty()){const e=this.element.find("#display");e.text(this.score);const t=this.element.find("#posted");i.isEmpty(this.score)?(this.hideElement(t),this.hideElement(this.element.find("#displayedScore")),this.showElement(this.element.find("#gradeNow"))):(this.hideElement(this.element.find("#gradeNow")),this.showElement(this.element.find("#displayedScore")),this.showElement(e))}}closeEditor(){!this.isLoading&&this._isEditing&&(this._isEditing=!1,this.removeCellEditor(),this.editorScope.$destroy(),this.showElement(this.element.find(".score")),this.rootScope.$broadcast(f.a.CLOSE_EDITOR,{group:this.group,columnId:this.cell.column.id}))}formatScore(){const e=this.cell.data;let t;return!i.isNull(e)&&e.grade&&e.grade.displayGrade&&(t=this.gradeService.getGradeToDisplay(e.grade.displayGrade,this.scope,this.gridData.getSchema()[this.cell.column.data.gradingSchemaId].scaleType),this.setUpScreenReader(this.cell,t)),t}isDirty(){return i.isUndefined(this._oldScore)&&!i.isEmpty(this.score)||!i.isUndefined(this._oldScore)&&this.bbLocalize.parseNumberSync(this._oldScore,this.scope).toString()!==this.bbLocalize.parseNumberSync(this.score,this.scope).toString()}createGradeSubmission(){const e=this.gridData.getSchema()[this.cell.column.data.gradingSchemaId],t=this.gradeService.createGradeSubmission(this.cell.column.data,this.gradeService.parseGrade(this.score,e,this.scope),e);return t.clearGrade=this.gradeService.wasGradeCleared(this._oldScore,this.score),t}getGroupGrades(e){this.studentIdGradeMap={};const t=this.gridData.getGroupIdUserIdMap()[this.group.groupId].map((e=>this.gridData.getRowByUserId(e).metadata.id));return this.CourseModel.$new(this.gridData.course.id).gradebook.bulkView.$fetch({membershipIds:t,columnIds:[e]}).$asPromise().then((e=>{e.bulkViewUsers.forEach((e=>{this.studentIdGradeMap[e.studentId]=e.grades[0].grade}))}))}prepareSaveGroupGrade(){return this.$q.when().then((()=>{this.gridData.getGroupById(this.group.groupId).memberships.forEach((e=>{e.ui={gradeDetail:this.studentIdGradeMap[e.userId]}}))}))}saveGrade(e,t){if(this.isDirty()){this._oldScore=this._score,i.isUndefined(t)&&(t=this.$q.defer(),this.savePromise=t.promise);const s=this.createGradeSubmission();let n=this.$q.when();s.clearGrade&&this.cell.isCleanAttemptGrade&&(n=this.CourseModel.$new(this.gridData.course.id).gradebook.columns.$new(this.cell.column.id).grades.$new(this.cell.data.grade.id).attempts.$fetch().$asPromise().then((e=>e[0]))),n.then((t=>(e?this.prepareSaveGroupGrade():this.$q.when()).then((()=>this.gradeService.saveGrade(s,this.cell.data&&this.cell.data.grade,t,e?{group:this.gridData.getGroupById(this.group.groupId)}:{userId:this.cell.row.metadata.user.id}))))).then((n=>{!s.clearGrade&&this.cell.isPosted&&this.cell.isNeedAutoPost?this.post(n,e):t.resolve(n)})).then((()=>(this.postDeferTimeout=this.timeout((()=>{this.postDefer.resolve(!1)}),this.scope,100,!1),this.postPromise.then((e=>e?void 0:this.fetchSummary()))))).then((()=>{this.refresh(e),this.nextDeferred&&(this.nextDeferred.resolve(),this.nextDeferred=void 0)}))}}refresh(e){const t=this.getAffectedColumns().concat([this.cell.column]),s=this.getOverallColumn();s&&t.push(s);const n=[this.cell.row];e&&this.gridData.getGroupIdUserIdMap()[this.group.groupId].forEach((e=>{const t=this.gridData.getRowByUserId(e);t!==this.cell.row&&n.push(t)})),i.forEach(n,(e=>{i.forEach(t,(t=>{this.gridData.refreshDataCell(e,t)}))})),this._isUpdating=!0,this.rootScope.$broadcast(v.b.DATA_UPDATE)}getAffectedColumns(){return this.cell.column instanceof m.c?this.cell.column.findAffectedColumns():[]}getOverallColumn(){return i.find(this.gridData.getColumns(),(e=>e instanceof m.k))}setUpScreenReader(e,t){this.userName=`${e.row.metadata.user.givenName} ${e.row.metadata.user.familyName}`;const s=e.column.data.columnName;if(this.ariaLabelContent=t?this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:this.canGradeCell()?"components.directives.grade.grid.tableCellAriaLabel":"components.directives.grade.grid.tableCellAriaLabelReadOnly",params:{userName:this.userName,assignmentName:s,grade:t},noWrap:!0,noEscape:!0}):this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:this.canGradeCell()?"components.directives.grade.grid.tableCellAriaLabelEmpty":"components.directives.grade.grid.tableCellAriaLabelEmptyReadOnly",params:{userName:this.userName,assignmentName:s},noWrap:!0,noEscape:!0}),this.isPosted){const e=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grid.postedLabel",noWrap:!0,noEscape:!0});this.ariaLabelContent=`${this.ariaLabelContent} ${e}`}if(this.isPastDueZero){const e=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grid.pastDueZero",noWrap:!0,noEscape:!0});this.ariaLabelContent=`${this.ariaLabelContent} ${e}`}if(this.group&&(this.ariaLabelContent=`${this.ariaLabelContent} ${this.group.groupTitle}`),this.hasNewSubmission){const e=this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.grid.newSubmissionLabel",noWrap:!0,noEscape:!0});this.ariaLabelContent=`${e} ${this.ariaLabelContent}`}}isGroupAssessment(){return this.group&&this.cell instanceof b.e&&!(this.cell instanceof b.f)}}A.CELL_EDITOR_TEMPLATE='<div bb-grade-grid-cell-editor-reborn id="bb-grade-grid-cell-editor-reborn" class="editor"></div>',A.$inject=["$rootScope","$window","$q",u.m.serviceName,a.k,"$compile","scope","element","attrs","gradeGridRebornController",r.b,c.serviceName,l.b];class I{constructor(e){this.$injector=e,this.restrict="E",this.template=w,this.scope=!0,this.require=`^${o.a}`,this.link=(e,t,s,n)=>{e.gradeGridColumnReborn=this.$injector.instantiate(A,{scope:e,element:t,attrs:s,gradeGridRebornController:n})}}}I.$inject=["$injector"],n.module(O,[d.a]).directive("bbGradeGridColumnReborn",["$injector",e=>e.instantiate(I)])}).call(this,s("71td"))},xiEu:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("fWA+");const o="ultra.components.directives.bbUiIcon.large.DocumentMultiple";Object(n.a)(i.a,o,"bbUiIconLargeDocumentMultiple")},xoIb:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-feedback",use:"icon-medium-feedback-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-feedback"><path d="M1 1h22v19h-8l-3 3-3-3H1V1zM6 6h12M6 9h12M6 12h12M6 15h7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},"y+vt":function(e,t,s){"use strict";s("67oV");var n=s("Llzl"),i=s("qH3X"),o=s("0JpG"),a=s("pF15");s.d(t,"a",(function(){return r}));const r="ultra.components.directives.gradeSearchFilterReborn";class c{constructor(e,t,s){this.scope=e,this.$rootScope=t,this.bbLocalize=s,this.initial()}initial(){this.getCheckedMergedCourse()||this.clearAll(),this.criteriaBlocks=[{id:"merged_course",expanded:!0,name:"merged_course",criteriaDetails:this.scope.mergedCourses}]}clearAll(){this.$rootScope.$broadcast(i.a.GRADEBOOK_CLEAR_SEARCHBOX_SELECTION,!0)}collapseMergedCourse(e){this.criteriaBlocks.some((t=>t.id===e.id))&&(e.expanded=!e.expanded)}getCheckedMergedCourse(){return this.scope.mergedCourses&&this.scope.mergedCourses.filter((e=>!0===e.ui.checked)).length}getToggleButtonLabel(e){return e.expanded?this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.filter-panel.collapse"}):this.bbLocalize.translateSync({locale:this.bbLocalize.getLocale(this.scope),key:"components.directives.grade.filter-panel.expand"})}}c.$inject=["scope","$rootScope",o.serviceName];class l{constructor(e){this.$injector=e,this.restrict="E",this.template=a,this.scope={mergedCourses:"<"},this.link=(e,t,s)=>{e.gradeGridSearchFilterReborn=this.$injector.instantiate(c,{scope:e,element:t,attrs:s})}}}l.$inject=["$injector"],n.module(r,[]).directive("bbGradeGridSearchFilterReborn",["$injector",e=>e.instantiate(l)])},y0xW:function(e,t){e.exports='<div class="assessment-question">\n  <fieldset ng-show="!assessmentQuestion.isEditing">\n    <div class="question-header question-header-grading"\n         ng-class="{\'has-question-title\': assessmentQuestion.questionConfig.hasQuestionCountTitle, \'is-read-only\': !isPrivileged() || readOnly()}"\n         ng-if="assessmentQuestion.questionConfig.hasPoints || assessmentQuestion.questionConfig.hasQuestionCountTitle"\n         ng-switch="assessmentQuestion.questionAttempt.question.fullCredit"\n    >\n      <div bb-foundation-defer ng-if="isSmallBreakpoint" ng-switch-default>\n        <bb-svg-icon ng-if="assessmentQuestion.canShowQuestionScoreRelatedDetail()"\n                     class="question-indicator {{::assessmentQuestion.getCorrectnessColor()}}"\n                     aria-label="{{::assessmentQuestion.getCorrectnessName()}}"\n                     size="medium"\n                     icon="{{::assessmentQuestion.getCorrectnessIcon()}}"></bb-svg-icon>\n        <legend class="question-label" ng-if="assessmentQuestion.questionConfig.hasQuestionCountTitle">{{::assessmentQuestion.questionTitle}}</legend>\n        <bb-question-grade graded-question-attempt="gradedQuestionAttempt"\n                           hide-grade="!assessmentQuestion.canViewGrades"\n                           input-id="{{::assessmentQuestion.elementId}}"\n                           is-privileged="assessmentQuestion.canEnterGrades"\n                           ng-if="assessmentQuestion.questionConfig.hasPoints"\n                           >\n        </bb-question-grade>\n        <bb-overflow-menu ng-show="!isAnyQuestionEditing() && !assessmentQuestion.isCurrentCourseComplete"\n                          element-id="{{::assessmentQuestion.elementId}}"\n                          element-name="{{::assessmentQuestion.questionTitle}}"\n                          menu-items="assessmentQuestion.getQuestionRegradingOverflowMenu()"\n                          ignore-accordion="true"\n                          analytics-id-tag-prefix="components.directives.attempt-canvas.getQuestionRegradingOverflowMenu"\n                          >\n        </bb-overflow-menu>\n      </div>\n      <div bb-foundation-defer ng-if="isSmallBreakpoint" ng-switch-when="true">\n        <div class="question-header-column question-header-first-column">\n          <bb-svg-icon ng-if="assessmentQuestion.canShowQuestionScoreRelatedDetail()"\n                       class="question-indicator {{::assessmentQuestion.getCorrectnessColor()}}"\n                       aria-label="{{::assessmentQuestion.getCorrectnessName()}}"\n                       size="medium"\n                       icon="{{::assessmentQuestion.getCorrectnessIcon()}}"></bb-svg-icon>\n          <legend class="question-label" ng-if="assessmentQuestion.questionConfig.hasQuestionCountTitle">{{::assessmentQuestion.questionTitle}}</legend>\n          <bb-question-grade graded-question-attempt="gradedQuestionAttempt"\n                    hide-grade="!assessmentQuestion.canViewGrades"\n                    input-id="{{::assessmentQuestion.elementId}}"\n                    is-privileged="assessmentQuestion.canEnterGrades"\n                    ng-if="assessmentQuestion.questionConfig.hasPoints">\n          </bb-question-grade>\n          <bb-overflow-menu ng-show="!isAnyQuestionEditing() && !assessmentQuestion.isCurrentCourseComplete"\n                            element-id="{{::assessmentQuestion.elementId}}"\n                            element-name="{{::assessmentQuestion.questionTitle}}"\n                            menu-items="assessmentQuestion.getQuestionRegradingOverflowMenu()"\n                            ignore-accordion="true"\n                            analytics-id-tag-prefix="components.directives.attempt-canvas.getQuestionRegradingOverflowMenu"\n          >\n          </bb-overflow-menu>\n        </div>\n        <div class="question-header-column question-header-secondary-column">\n          <span class="question-full-credit-label"\n                bb-translate>\n            components.directives.attempt-canvas.freeform-response.grade.question.full-credit-given\n          </span>\n        </div>\n      </div>\n      <div bb-foundation-defer ng-if="!isSmallBreakpoint">\n        <bb-svg-icon ng-if="assessmentQuestion.canShowQuestionScoreRelatedDetail()"\n                     class="question-indicator {{::assessmentQuestion.getCorrectnessColor()}}"\n                     aria-label="{{::assessmentQuestion.getCorrectnessName()}}"\n                     size="medium"\n                     icon="{{::assessmentQuestion.getCorrectnessIcon()}}"></bb-svg-icon>\n        <legend class="question-label" ng-if="assessmentQuestion.questionConfig.hasQuestionCountTitle">{{::assessmentQuestion.questionTitle}}</legend>\n        <span class="question-full-credit-label" bb-translate ng-if="assessmentQuestion.questionAttempt.question.fullCredit">components.directives.attempt-canvas.freeform-response.grade.question.full-credit-given</span>\n        <bb-question-grade graded-question-attempt="gradedQuestionAttempt"\n                           hide-grade="!assessmentQuestion.canViewGrades"\n                           input-id="{{::assessmentQuestion.elementId}}"\n                           is-privileged="assessmentQuestion.canEnterGrades"\n                           ng-if="assessmentQuestion.questionConfig.hasPoints">\n        </bb-question-grade>\n        <bb-overflow-menu ng-show="!isAnyQuestionEditing() && !assessmentQuestion.isCurrentCourseComplete"\n                          element-id="{{::assessmentQuestion.elementId}}"\n                          element-name="{{::assessmentQuestion.questionTitle}}"\n                          menu-items="assessmentQuestion.getQuestionRegradingOverflowMenu()"\n                          ignore-accordion="true"\n                          analytics-id-tag-prefix="components.directives.attempt-canvas.getQuestionRegradingOverflowMenu"\n                          >\n        </bb-overflow-menu>\n      </div>\n    </div>\n    <div class="question-content" ng-show="assessmentQuestion.questionSpecificTemplateReady"></div>\n  </fieldset>\n  <fieldset ng-if="assessmentQuestion.isEditing" class="regrading-container assessment-canvas-react"></fieldset>\n</div>\n'},yV5t:function(e,t){e.exports='<a class="content-title"\n   ng-click="contentItemScormLaunch.scormLaunch()"\n   href="javascript:void(0);"\n   aria-describedby="{{contentItemBase.getAriaDescribedBy()}}"\n   analytics-id="content.item.scormlaunch.link"\n   aria-hidden="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() }}"\n   tabindex="{{ contentItemBase.setForcedSequenceLearningModuleAttributes() ? -1 : 0 }}">\n  <span>{{ content.title }}</span>\n</a>\n'},yiTm:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-groups",use:"icon-medium-groups-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-groups"><g clip-path="url(#icon-medium-groups_clip0)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 23.0644C17.3246 21.1155 14.8704 20 12 20s-5.3246 1.1155-7 3.0644M12 20c2.7614 0 5-2.2386 5-5s-2.2386-5-5-5-5 2.2386-5 5 2.2386 5 5 5zM18.5 8C20.433 8 22 6.433 22 4.5S20.433 1 18.5 1 15 2.567 15 4.5 16.567 8 18.5 8z" /><path d="M23 11s-1-3-4.5-3c-2.1456 0-3.3517 1.1274-3.9639 2M5.5 8C3.567 8 2 6.433 2 4.5S3.567 1 5.5 1 9 2.567 9 4.5 7.433 8 5.5 8zM1 11s1-3 4.5-3c2.1456 0 3.3517 1.1274 3.9639 2" /></g><defs><clipPath id="icon-medium-groups_clip0"><path d="M0 0h24v24H0z" /></clipPath></defs></symbol>'});i.add(o);e.exports=o},"ykC+":function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-goal",use:"icon-small-goal-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-goal"><path stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M1 1h14v3H1zM4 12h8v3H4z" /><path d="M14 4s0 5-6 5-6-5-6-5M8 9v3" stroke-width="2" /></symbol>'});i.add(o);e.exports=o},ys4f:function(e,t){e.exports='<div class="true-false-attempt-review true-false">\n  <div class="true-false-question">\n    <bb-rich-text-editor\n      ng-model="assessmentQuestion.questionAttempt.question.questionText.rawText"\n      is-read-only="true"\n      supports-inline-document-render="true"\n      plugin-options="{\'attachment\': true, \'math\': true, \'contentMarket\': true}">\n    </bb-rich-text-editor>\n  </div>\n  \x3c!--In review as instructor or as student with posted grade--\x3e\n  <bb-question-answer-status\n    correctness="::assessmentQuestion.getAnswerResult()"\n    was-late="::assessmentQuestion.wasAnsweredLate()"\n    hide-correctness-text="true"\n    class="true-false-question-answer">\n    <div bb-translate="{{::assessmentQuestion.viewHelper.answerDescriptionKey}}"></div>\n  </bb-question-answer-status>\n  <div class="true-false-answers-container">\n    <ol class="true-false-answers">\n      <li class="true-false-answer-true {{::assessmentQuestion.getAnswerChoiceStyles(true)}}">\n        <div class="answer-circle" bb-translate>components.directives.assessment-question.true-false.abbreviated-true</div>\n        <input type="radio"\n                id="{{assessmentQuestion.elementId + \'true-false-answer-true\' }}"\n                name="{{assessmentQuestion.elementId + \'true-false-answers-choice\' }}"\n                aria-labelledby="{{assessmentQuestion.elementId + \'true-false-answer-true-label\' }}"\n                aria-describedby="{{(assessmentQuestion.canShowCorrectAnswerRelatedDetail() && assessmentQuestion.viewHelper.isAnswerChoiceCorrect(true)) ? \'correct-notification\': null }}"\n                ng-model="assessmentQuestion.questionAttempt.givenAnswer"\n                ng-value="true"\n                disabled\n                analytics-id="assessment.question.true.false.answer.givenAnswer.input.radio"/>\n        <label id="{{assessmentQuestion.elementId + \'true-false-answer-true-label\' }}"\n                for="{{assessmentQuestion.elementId + \'true-false-answer-true\' }}"\n                class="checkbox-label">\n          <span ng-if="assessmentQuestion.viewHelper.showIncorrectIndicator(true)"\n                class="correctness-label" bb-translate>\n            components.directives.assessment-question.true-false.incorrect-label\n          </span>\n          {{::assessmentQuestion.viewHelper.trueAnswerOptionLabel}}\n        </label>\n        <span id="correct-notification" class="correct-answer-text" ng-if="assessmentQuestion.canShowCorrectAnswerRelatedDetail() && assessmentQuestion.viewHelper.isAnswerChoiceCorrect(true)" bb-translate>components.directives.assessment-question.true-false.correct-label</span>\n      </li>\n      <li class="true-false-answer-false {{::assessmentQuestion.getAnswerChoiceStyles(false)}}">\n        <div class="answer-circle" bb-translate>components.directives.assessment-question.true-false.abbreviated-false</div>\n        <input type="radio"\n                id="{{assessmentQuestion.elementId + \'true-false-answer-false\' }}"\n                name="{{assessmentQuestion.elementId + \'true-false-answers-choice\' }}"\n                aria-labelledby="{{assessmentQuestion.elementId + \'true-false-answer-false-label\' }}"\n                aria-describedby="{{(assessmentQuestion.canShowCorrectAnswerRelatedDetail() && assessmentQuestion.viewHelper.isAnswerChoiceCorrect(false)) ? \'correct-notification\': null}}"\n                ng-model="assessmentQuestion.questionAttempt.givenAnswer"\n                ng-value="false"\n                disabled\n                analytics-id="assessment.question.true.false.answer.givenAnswer.input.radio"/>\n        <label id="{{assessmentQuestion.elementId + \'true-false-answer-false-label\' }}"\n                for="{{assessmentQuestion.elementId + \'true-false-answer-false\' }}"\n                class="checkbox-label">\n          <span ng-if="assessmentQuestion.viewHelper.showIncorrectIndicator(false)"\n                class="correctness-label" bb-translate>\n            components.directives.assessment-question.true-false.incorrect-label\n          </span>\n          {{::assessmentQuestion.viewHelper.falseAnswerOptionLabel}}\n        </label>\n        <span id="correct-notification" class="correct-answer-text" ng-if="assessmentQuestion.canShowCorrectAnswerRelatedDetail() && assessmentQuestion.viewHelper.isAnswerChoiceCorrect(false)" bb-translate>components.directives.assessment-question.true-false.correct-label</span>\n      </li>\n    </ol>\n  </div>\n  <bb-automated-question-feedback\n    feedback="assessmentQuestion.getAutomatedQuestionFeedback()"\n    is-collapsible="assessmentQuestion.allowCollapsingOfAutomatedFeedbackIfShown()"\n    editor-plugins-options="automatedFeedbackEditorPluginOptions"\n  />\n</div>\n'},ytQ2:function(e,t){e.exports='<div ng-if="::foundationOffcanvas.wiredup || undefined"\n      class="bb-foundation-offcanvas"\n      ng-transclude\n      bb-click-outside="foundationOffcanvas.handleClickOutside()"\n      is-active="foundationOffcanvas.isPanelOpen"\n      aria-hidden="{{!foundationOffcanvas.isPanelOpen}}"\n      current-panel-only>\n</div>'},"z+6U":function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("Llzl"),i=s("sa5q");const o="ultra.components.directives.content.contentItem.contentItemType.contentItemPage";class a{constructor(e){this.scope=e}shouldAlignMiddle(){return!this.scope.content.canViewAsInstructor()}}a.$inject=["scope"];class r{constructor(e){this.$injector=e,this.restrict="E",this.template=i,this.scope=!1,this.link=(e,t,s)=>{e.contentItemPage=this.$injector.instantiate(a,{scope:e,element:t,attrs:s})}}}r.$inject=["$injector"],n.module(o,[]).directive("bbContentItemPage",["$injector",e=>e.instantiate(r)])},zIKm:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-medium-time-limit",use:"icon-medium-time-limit-usage",viewBox:"0 0 24 24",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="icon-medium-time-limit"><path d="M5 1l6 11-6 11M19 1l-6 11 6 11M4 1h16M4 23h16" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},zexu:function(e,t,s){var n=s("ziER"),i=s("5JeM"),o=new n({id:"icon-small-undo",use:"icon-small-undo-usage",viewBox:"0 0 16 16",content:'<symbol fill="none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" id="icon-small-undo"><path d="M3 3L1 5l2 2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /><path d="M1 5h11c2 0 3 2.0474 3 4s-1 4-3 4H4" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" /></symbol>'});i.add(o);e.exports=o},zisU:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var n=s("zYa8"),i=s("7NIW");const o="ultra.components.directives.bbUiIcon.small.Attention";Object(n.a)(i.Attention,o,"bbUiIconSmallAttention")},zjPK:function(e,t,s){"use strict";s("nsQ1");var n=s("nsO7"),i=s("Llzl"),o=s("0+Qs"),a=s("0JpG"),r=s("Fvsw"),c=s("ohO4"),l=s("IbyE"),d=s("94iD"),u=s("AuQm"),p=s("iU4J");class m{constructor(e,t,s,n,i,o,a,r=[],c=[],l){this.tickInterval=1e4,this.thresholdsInSeconds=[],this.bbInterval=e,this.scope=t,this.localize=s,this.context=n,this.fetchedAttemptTime=i,this.dueDateAsEpochTime=o,this.continuedFromLastStage=l,this.remainSecondsWhenFetch=this.calcRemainSecondsWhenFetch(),this.usedSecondsWhenFetch=this.calcUsedSecondsWhenFetch(),this.upcomingTimers=a,this.fetchTime=(new Date).getTime(),this.remainingTimeReminderThresholds=r,this.upcomingRemainingTimeReminderThresholds=c,this.calculateRoundedUpThresholdsInSeconds()}calculateRoundedUpThresholdsInSeconds(){this.thresholdsInSeconds=this.remainingTimeReminderThresholds.map((e=>{this.validateThreshold(e);const t=this.fetchedAttemptTime.softlimitSeconds*e;return 60*Math.ceil(t/60)}))}validateThreshold(e){if(e<0||e>1)throw new Error("Threshold must be between 0.0 and 1.0")}hasThresholdPassed(e){return!(e>this.remainSecondsWhenFetch)&&e>=this.scope.currentRemainingSeconds}enqueueRemainingTimeReminder(e){let t;t=e<=60?this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.test.settings.timeLimit.remainingTimeReminderSeconds.plural",params:{secondsRemaining:e},noWrap:!0,noEscape:!0}):this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.test.settings.timeLimit.remainingTimeReminderMinutes.plural",params:{minutesRemaining:e/60},noWrap:!0,noEscape:!0}),u.SnackbarManager.getInstance().enqueueSnackbar(u.SnackbarKey.AssessmentTimerToasts,{snackbarMessage:t,isPersistent:!1})}validateRemainingTimeReminderThresholds(){this.thresholdsInSeconds=this.thresholdsInSeconds.filter((e=>{const t=this.hasThresholdPassed(e);return t&&this.enqueueRemainingTimeReminder(e),!t}))}updateCurrentMessage(){this.scope.currentRemainingSeconds<=60?this.scope.currentTimerMessage=this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.test.settings.timeLimit.remainingTimeSeconds.plural",params:{secondsRemaining:Math.floor(this.scope.currentRemainingSeconds)},noWrap:!0}):this.scope.currentTimerMessage=this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.test.settings.timeLimit.remainingTime.plural",params:{minutesRemaining:Math.ceil(this.scope.currentRemainingSeconds/60)},noWrap:!0})}hideTimer(){return!1}tick(){const e=((new Date).getTime()-this.fetchTime)/1e3;this.scope.currentRemainingSeconds=this.remainSecondsWhenFetch-e,this.scope.currentUsedSeconds=this.usedSecondsWhenFetch+e;if(this.scope.currentRemainingSeconds<=60+this.tickInterval/1e3&&this.tickInterval>1e3&&(this.tickInterval=1e3,this.bbInterval.cancel(this.timer),this.timer=this.bbInterval(this.tick.bind(this),this.scope,this.tickInterval)),this.scope.hideTimer=this.hideTimer(),this.updateCurrentMessage(),this.validateRemainingTimeReminderThresholds(),this.scope.currentRemainingSeconds<=0&&(null!=this.endEmission&&(this.scope.$broadcast("bb-time-is-up",this.endEmission),this.bbInterval.cancel(this.timer)),this.upcomingTimers.length>0)){const e=!0,t=this.upcomingTimers.shift(),s=this.upcomingRemainingTimeReminderThresholds.shift();new t(this.bbInterval,this.scope,this.localize,this.context,this.fetchedAttemptTime,this.dueDateAsEpochTime,this.upcomingTimers,s,this.upcomingRemainingTimeReminderThresholds,e).start()}}start(){this.scope.currentTestStage=this.currentTestStage,this.continuedFromLastStage||null==this.resumeEmission||this.scope.$broadcast("bb-test-resumed",this.resumeEmission),this.timer=this.bbInterval(this.tick.bind(this),this.scope,this.tickInterval),this.tick()}}function h(e){return Math.max(e.elapsedSeconds,0)}function b(e){return Math.max(e.softlimitSeconds-Math.max(e.elapsedSeconds,0),0)}function g(e){return Math.max(e.elapsedSeconds-e.softlimitSeconds,0)}class v extends m{constructor(){super(...arguments),this.currentTestStage=d.b.Stage0NoExtraTime,this.endEmission={stopMode:"hard"}}calcRemainSecondsWhenFetch(){return b(this.fetchedAttemptTime)}calcUsedSecondsWhenFetch(){return h(this.fetchedAttemptTime)}}class f extends m{constructor(){super(...arguments),this.currentTestStage=d.b.Stage0UnlimitedExtraTime,this.endEmission={stopMode:"soft"}}calcRemainSecondsWhenFetch(){return b(this.fetchedAttemptTime)}calcUsedSecondsWhenFetch(){return h(this.fetchedAttemptTime)}}class w extends m{constructor(){super(...arguments),this.currentTestStage=d.b.Stage1UnlimitedExtraTime,this.resumeEmission=!0}calcRemainSecondsWhenFetch(){return Number.POSITIVE_INFINITY}calcUsedSecondsWhenFetch(){return g(this.fetchedAttemptTime)}updateCurrentMessage(){this.scope.currentTimerMessage=this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.test.settings.timeLimit.usedExtraTime.plural",params:{usedExtraTime:Math.floor(this.scope.currentUsedSeconds/60)},noWrap:!0})}}class S extends m{constructor(){super(...arguments),this.currentTestStage=d.b.Stage0LimitedExtraTime,this.endEmission={stopMode:"soft"}}calcRemainSecondsWhenFetch(){return b(this.fetchedAttemptTime)}calcUsedSecondsWhenFetch(){return h(this.fetchedAttemptTime)}}class C extends m{constructor(){super(...arguments),this.currentTestStage=d.b.Stage1LimitedExtraTime,this.resumeEmission=!0,this.endEmission={stopMode:"hard"}}calcRemainSecondsWhenFetch(){return e=this.fetchedAttemptTime,Math.max(e.hardlimitSeconds-Math.max(e.softlimitSeconds,e.elapsedSeconds),0);var e}calcUsedSecondsWhenFetch(){return g(this.fetchedAttemptTime)}calculateRoundedUpThresholdsInSeconds(){this.thresholdsInSeconds=this.remainingTimeReminderThresholds.map((e=>{this.validateThreshold(e);const t=(this.fetchedAttemptTime.hardlimitSeconds-this.fetchedAttemptTime.softlimitSeconds)*e;return 60*Math.ceil(t/60)}))}updateCurrentMessage(){this.scope.currentRemainingSeconds<=60?this.scope.currentTimerMessage=this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.test.settings.timeLimit.extraRemainingTimeSeconds.plural",params:{secondsRemaining:Math.floor(this.scope.currentRemainingSeconds)},noWrap:!0}):this.scope.currentTimerMessage=this.localize.translateSync({locale:this.localize.getLocale(this.scope),key:"course.content.assessment.test.settings.timeLimit.extraRemainingTime.plural",params:{minutesRemaining:Math.ceil(this.scope.currentRemainingSeconds/60)},noWrap:!0})}}class y extends m{constructor(){super(...arguments),this.currentTestStage=d.b.StageEnforcedDueDate,this.endEmission={stopMode:"hard"}}calcRemainSecondsWhenFetch(){return Math.max(this.dueDateAsEpochTime-this.context.getServerTimeAsEpochTime(),0)}calcUsedSecondsWhenFetch(){return g(this.fetchedAttemptTime)}hideTimer(){return this.scope.currentRemainingSeconds>y.MAX_SECONDS_TO_SHOW}}y.MAX_SECONDS_TO_SHOW=60*p.b.DEFAULT_MAX_TIME_LIMIT;class O extends m{constructor(){super(...arguments),this.currentTestStage=d.b.StageE,this.endEmission={stopMode:"hard"}}calcRemainSecondsWhenFetch(){return 0}calcUsedSecondsWhenFetch(){return NaN}}const A=[.1],I=[.1,.5],D=[.1],k=e=>e.stages.map((e=>(e=>{let t;switch(e){case d.b.Stage0NoExtraTime:t=v;break;case d.b.Stage0UnlimitedExtraTime:t=f;break;case d.b.Stage1UnlimitedExtraTime:t=w;break;case d.b.Stage0LimitedExtraTime:t=S;break;case d.b.Stage1LimitedExtraTime:t=C;break;case d.b.StageEnforcedDueDate:t=y;break;case d.b.StageE:t=O}return t})(e)));var _=s("1ZbL");const j="ultra.components.directives.assessment-timer-toggle",T={Class:s("IaSh").LocalizedAssessmentTimerToggle,bindingNames:["onToggle","isVisible"],attributes:["assessmentTimerTextId"],renderLocalized:!0};i.module(j,[]).component("bbAssessmentTimerToggle",Object(_.a)(T)),s.d(t,"a",(function(){return $}));const $="ultra.features.course.content.assessment.attempt.assessmentAttempt.timedIndicator",R="bbTimedTestIndicator",E=i.module($,[o.a,j,c.a]);E.directive(R,["$compile",o.b,"$filter",a.serviceName,r.b,c.b,function(e,t,s,i,o,a){return{restrict:"A",link:(e,s,r)=>{e.$on("$destroy",(()=>{u.SnackbarManager.getInstance().dequeueSnackbar(u.SnackbarKey.AssessmentTimerToasts)})),e.getCurrentLevelClass=()=>{if(e.showTimeUpIndicator)return"bbTimedTestIndicator-lv-0";if(null==e.currentRemainingSeconds)return"";const t=[0,300,600,Number.POSITIVE_INFINITY];return"bbTimedTestIndicator-lv-"+n.findIndex(t,(t=>e.currentRemainingSeconds<=t)).toString()},e.timerDetailsVisible=!0,e.onToggleTimerDetails=t=>{e.$apply((()=>{e.timerDetailsVisible=t}))};const c=e.$watch(r.bbTimedTestIndicator,(n=>{if(!n)return;if(c(),e.footerNoticeShow=n.hasTimeLimit||n.testType===d.c.EnforcedDueDateTest,!e.footerNoticeShow)return;s.addClass("is-timed-test");const r=k(n);a.createWaiter(l.FeatureFlagKey.AssessmentTimerToasts).catch((()=>!0)).then((s=>{const a=s?(c=n).stages.map((e=>{if(c.displayedTimeLimitSeconds<600)return[];switch(e){case d.b.Stage0NoExtraTime:case d.b.Stage0UnlimitedExtraTime:case d.b.Stage0LimitedExtraTime:return c.displayedTimeLimitSeconds<3600?A:I;case d.b.Stage1LimitedExtraTime:return D;default:return[]}})):[];var c;if(r.length>0){const s=r.shift(),c=a.shift();new s(t,e,i,o,n.adaptedTime,n.dueDateAsEpochTime,r,c,a).start()}}))}))}}}]),E.directive("bbTimedTestIndicatorLabel",["$compile",o.b,function(e,t){return{restrict:"A",link:(t,s,n)=>{e('\n          <span class="label-timed-indicator" ng-show="!hideTimer" ng-class="getCurrentLevelClass()" aria-live="polite" role="timer">\n            <bb-svg-icon ng-show="currentRemainingSeconds > 600 && !showTimeUpIndicator" size="small" icon="timer" status="active"></bb-svg-icon>\n            <bb-svg-icon ng-show="currentRemainingSeconds <= 600 || showTimeUpIndicator" size="small" icon="timer" status="alert"></bb-svg-icon>\n            <span id="assessment-timer-text" ng-if="timerDetailsVisible">\n              <span ng-show="currentRemainingSeconds <= 0 || showTimeUpIndicator" bb-translate="course.content.assessment.test.settings.timeLimit.timeIsUp"></span>\n              <span ng-show="currentRemainingSeconds > 0 && !showTimeUpIndicator" class="js-remaining-time" >{{ currentTimerMessage }}</span>\n            </span>\n            <bb-assessment-timer-toggle assessment-timer-text-id="assessment-timer-text" on-toggle="onToggleTimerDetails" is-visible="timerDetailsVisible"></bb-assessment-timer-toggle>\n          </span>\n        ')(t).prependTo(s)}}}])},zphb:function(e,t){e.exports='<div class="simple-statistic-contents" ng-class="::item().cssClass">\n  <div bb-tooltip enhanced-tooltip="true" data-tooltip-on-overflow-only="true" title="{{ ::item().data }}">\n    <div class="stat-data"\n         ng-attr-aria-label="{{ item().aria ? item().aria : undefined }}"\n         data-ng-bind-html="::item().trusted"\n         data-ellipsis></div>\n  </div>\n  <div ng-if="::item().subtext" class="stat-sub-text" bb-translate>{{ ::item().subtext }}</div>\n  <div ng-if="::!item().subtext && item().reserveSubtextSpace" class="stat-sub-text" aria-hidden="true">&nbsp;</div>\n</div>'}}]);